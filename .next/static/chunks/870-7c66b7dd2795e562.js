(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[870],{512:function(e){"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise(function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}m(e,t,o,{once:!0}),"error"!==t&&"function"==typeof e.on&&m(e,"error",i,{once:!0})})},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,n,r){if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var i,o,s,u=Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,console&&console.warn&&console.warn(u)}return e}function d(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=d.bind(r);return i.listener=n,r.wrapFn=i,i}function h(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):f(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=Array(t),r=0;r<t;++r)n[r]=e[r];return n}function m(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else if("function"==typeof e.addEventListener)e.addEventListener(t,function i(o){r.once&&e.removeEventListener(t,i),n(o)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var s,a=Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else for(var u=c.length,d=f(c,u),n=0;n<u;++n)r(d[n],this,t);return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,l(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,l(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,s;if(a(t),void 0===(r=this._events)||void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0==arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},6579:function(e,t,n){"use strict";var r=n(9602);e.exports=function(e){var t,i={stun:(e||{}).stun||n(8750),turn:(e||{}).turn||n(6013)},o=(e||{}).stunCount||2,s=(e||{}).turnCount||0;function a(e,t){for(var n,o=[],s=[].concat(i[e]);s.length&&o.length<t;)n=Math.random()*s.length|0,o=o.concat(s.splice(n,1));return o.map(function(t){return"string"==typeof t||t instanceof String?r(e+":"+t):t})}return t=[].concat(a("stun",o)),s&&(t=t.concat(a("turn",s))),t}},2695:function(e,t,n){var r,i=n(7956);"undefined"!=typeof window&&(r=window.AudioContext||window.webkitAudioContext);var o=null;e.exports=function(e,t){var n,s,a,c=new i;if(!r)return c;var t=t||{},u=t.smoothing||.1,d=t.interval||50,l=t.threshold,h=t.play,p=t.history||10,f=!0;(a=(o=t.audioContext||o||new r).createAnalyser()).fftSize=512,a.smoothingTimeConstant=u,s=new Float32Array(a.frequencyBinCount),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(n=o.createMediaElementSource(e),void 0===h&&(h=!0)):n=o.createMediaStreamSource(e),l=l||-50,n.connect(a),h&&a.connect(o.destination),c.speaking=!1,c.suspend=function(){return o.suspend()},c.resume=function(){return o.resume()},Object.defineProperty(c,"state",{get:function(){return o.state}}),o.onstatechange=function(){c.emit("state_change",o.state)},c.setThreshold=function(e){l=e},c.setInterval=function(e){d=e},c.stop=function(){f=!1,c.emit("volume_change",-100,l),c.speaking&&(c.speaking=!1,c.emit("stopped_speaking")),a.disconnect(),n.disconnect()},c.speakingHistory=[];for(var m=0;m<p;m++)c.speakingHistory.push(0);var v=function(){setTimeout(function(){if(f){var e=function(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var r=4,i=t.length;r<i;r++)t[r]>n&&t[r]<0&&(n=t[r]);return n}(a,s);c.emit("volume_change",e,l);var t=0;if(e>l&&!c.speaking){for(var n=c.speakingHistory.length-3;n<c.speakingHistory.length;n++)t+=c.speakingHistory[n];t>=2&&(c.speaking=!0,c.emit("speaking"))}else if(e<l&&c.speaking){for(var n=0;n<c.speakingHistory.length;n++)t+=c.speakingHistory[n];0==t&&(c.speaking=!1,c.emit("stopped_speaking"))}c.speakingHistory.shift(),c.speakingHistory.push(0+(e>l)),v()}},d)};return v(),c}},5335:function(e){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},2714:function(e,t){var n,r,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function o(e){if(!e)return o.__;Array.prototype.reduce||(Array.prototype.reduce=function(e,t){for(var n=t,r=0;r<this.length;r++)n=e(n,this[r],r,this);return n});var t="";return("."+e).split(".").reduce(function(e,n,r,i){t?t+="."+n:t=n;var s=e["__"+t];return void 0===s&&(o.Logger.prototype=e,s=new o.Logger(t),e["__"+t]=s),s},o.__)}!function(e){function t(e,t,n){if(void 0!==t[e]){if(null===t[e]){delete n[e];return}n[e]=t[e]}}function n(t){if(null!=e.enabled&&!e.enabled)return!1;try{if(t.userAgentRegex&&!new RegExp(t.userAgentRegex).test(navigator.userAgent))return!1}catch(e){}try{if(t.ipRegex&&e.clientIP&&!new RegExp(t.ipRegex).test(e.clientIP))return!1}catch(e){}return!0}function r(e,t){try{if(e.disallow&&new RegExp(e.disallow).test(t))return!1}catch(e){}return!0}function o(e){return"function"==typeof e?e instanceof RegExp?e.toString():e():e}e.requestId="",e.entryId=0,e._createXMLHttpRequest=function(){return new XMLHttpRequest},e._getTime=function(){return(new Date).getTime()},e._console=console,e._appenderNames=[];var s,a=function(e,t,n){this.msg=e,this.meta=t,this.finalString=n};function c(t){var n,r=o(t);switch(typeof r){case"string":return new a(r,null,r);case"number":case"boolean":return new a(n=r.toString(),null,n);case"undefined":return new a("undefined",null,"undefined");case"object":if(r instanceof RegExp||r instanceof String||r instanceof Number||r instanceof Boolean)return new a(n=r.toString(),null,n);return n="function"==typeof e.serialize?e.serialize.call(this,r):JSON.stringify(r),new a("",r,n);default:return new a("unknown",null,"unknown")}}function u(){return 1e3}function d(){return 2e3}function l(){return 3e3}function h(){return 4e3}function p(){return 5e3}function f(){return 6e3}e.setOptions=function(e){return t("enabled",e,this),t("maxMessages",e,this),t("defaultAjaxUrl",e,this),t("clientIP",e,this),t("requestId",e,this),t("defaultBeforeSend",e,this),t("serialize",e,this),this},e.getAllLevel=function(){return -2147483648},e.getTraceLevel=u,e.getDebugLevel=d,e.getInfoLevel=l,e.getWarnLevel=h,e.getErrorLevel=p,e.getFatalLevel=f,e.getOffLevel=function(){return 2147483647};var m=function(e,t){this.inner=t,this.name="JL.Exception",this.message=c(e).finalString};e.Exception=m,m.prototype=Error();var v=function(e,t,n,r,i){this.l=e,this.m=t,this.n=n,this.t=r,this.u=i};function g(t,n,r){return e.entryId++,new v(t,n,r,e._getTime(),e.entryId)}function b(e){e.id&&(clearTimeout(e.id),e.id=null)}function y(e,t,n){var r=this;e.id||(e.id=setTimeout(function(){n.call(r)},t))}e.LogItem=v;var E=function(){function i(t,n){this.appenderName=t,this.sendLogItems=n,this.level=e.getTraceLevel(),this.sendWithBufferLevel=2147483647,this.storeInBufferLevel=-2147483648,this.bufferSize=0,this.batchSize=1,this.maxBatchSize=20,this.batchTimeout=2147483647,this.sendTimeout=5e3,this.buffer=[],this.batchBuffer=[],this.batchTimeoutTimer={id:null},this.sendTimeoutTimer={id:null},this.nbrLogItemsSkipped=0,this.nbrLogItemsBeingSent=0;var r="Trying to create an appender without a name or with an empty name";if(void 0==t)throw r;if(-1!=e._appenderNames.indexOf(t)){if(!t)throw r;throw"Multiple appenders use the same name "+t}e._appenderNames.push(t)}return i.prototype.addLogItemsToBuffer=function(t){if(this.batchBuffer.length>=this.maxBatchSize){this.nbrLogItemsSkipped+=t.length;return}if(null!=e.maxMessages){if(e.maxMessages<1)return;e.maxMessages-=t.length}this.batchBuffer=this.batchBuffer.concat(t);var n=this;y(this.batchTimeoutTimer,this.batchTimeout,function(){n.sendBatch.call(n)})},i.prototype.batchBufferHasOverdueMessages=function(){for(var t=0;t<this.batchBuffer.length;t++)if(e._getTime()-this.batchBuffer[t].t>this.batchTimeout)return!0;return!1},i.prototype.batchBufferHasStrandedMessage=function(){return null!=e.maxMessages&&e.maxMessages<1&&this.batchBuffer.length>0},i.prototype.sendBatchIfComplete=function(){(this.batchBuffer.length>=this.batchSize||this.batchBufferHasOverdueMessages()||this.batchBufferHasStrandedMessage())&&this.sendBatch()},i.prototype.onSendingEnded=function(){b(this.sendTimeoutTimer),this.nbrLogItemsBeingSent=0,this.sendBatchIfComplete()},i.prototype.setOptions=function(n){if(t("level",n,this),t("ipRegex",n,this),t("userAgentRegex",n,this),t("disallow",n,this),t("sendWithBufferLevel",n,this),t("storeInBufferLevel",n,this),t("bufferSize",n,this),t("batchSize",n,this),t("maxBatchSize",n,this),t("batchTimeout",n,this),t("sendTimeout",n,this),this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize),this.maxBatchSize<this.batchSize)throw new e.Exception({message:"maxBatchSize cannot be smaller than batchSize",maxBatchSize:this.maxBatchSize,batchSize:this.batchSize});return this},i.prototype.log=function(e,t,i,o,s,a,c){var u;if(n(this)&&r(this,a)&&!(s<this.storeInBufferLevel)){if(u=g(s,a,c),s<this.level){this.bufferSize>0&&(this.buffer.push(u),this.buffer.length>this.bufferSize&&this.buffer.shift());return}this.addLogItemsToBuffer([u]),s>=this.sendWithBufferLevel&&this.buffer.length&&(this.addLogItemsToBuffer(this.buffer),this.buffer.length=0),this.sendBatchIfComplete()}},i.prototype.sendBatch=function(){if(!(this.nbrLogItemsBeingSent>0)&&(b(this.batchTimeoutTimer),0!=this.batchBuffer.length)){this.nbrLogItemsBeingSent=this.batchBuffer.length;var e=this;y(this.sendTimeoutTimer,this.sendTimeout,function(){e.onSendingEnded.call(e)}),this.sendLogItems(this.batchBuffer,function(){e.batchBuffer.splice(0,e.nbrLogItemsBeingSent),e.nbrLogItemsSkipped>0&&(e.batchBuffer.push(g(h(),"Lost "+e.nbrLogItemsSkipped+" messages. Either connection with the server was down or logging was disabled via the enabled option. Reduce lost messages by increasing the ajaxAppender option maxBatchSize.",e.appenderName)),e.nbrLogItemsSkipped=0),e.onSendingEnded.call(e)})}},i}();e.Appender=E;var S=function(r){function o(e){return r.call(this,e,o.prototype.sendLogItemsAjax)||this}return i(o,r),o.prototype.setOptions=function(e){return t("url",e,this),t("beforeSend",e,this),r.prototype.setOptions.call(this,e),this},o.prototype.sendLogItemsAjax=function(t,r){try{if(!n(this))return;this.xhr&&0!=this.xhr.readyState&&4!=this.xhr.readyState&&this.xhr.abort(),this.xhr=e._createXMLHttpRequest();var i="/jsnlog.logger";null!=e.defaultAjaxUrl&&(i=e.defaultAjaxUrl),this.url&&(i=this.url),this.xhr.open("POST",i),this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("JSNLog-RequestId",e.requestId);var o=this;this.xhr.onreadystatechange=function(){4==o.xhr.readyState&&o.xhr.status>=200&&o.xhr.status<300&&r()};var s={r:e.requestId,lg:t};"function"==typeof this.beforeSend?this.beforeSend.call(this,this.xhr,s):"function"==typeof e.defaultBeforeSend&&e.defaultBeforeSend.call(this,this.xhr,s);var a=JSON.stringify(s);this.xhr.send(a)}catch(e){}},o}(E);e.AjaxAppender=S;var w=function(t){function r(e){return t.call(this,e,r.prototype.sendLogItemsConsole)||this}return i(r,t),r.prototype.clog=function(t){e._console.log(t)},r.prototype.cerror=function(t){e._console.error?e._console.error(t):this.clog(t)},r.prototype.cwarn=function(t){e._console.warn?e._console.warn(t):this.clog(t)},r.prototype.cinfo=function(t){e._console.info?e._console.info(t):this.clog(t)},r.prototype.cdebug=function(t){e._console.debug?e._console.debug(t):this.cinfo(t)},r.prototype.sendLogItemsConsole=function(t,r){try{if(!n(this)||!e._console)return;for(i=0;i<t.length;++i){var i,o=t[i],s=o.n+": "+o.m;"undefined"==typeof window&&(s=new Date(o.t)+" | "+s),o.l<=e.getDebugLevel()?this.cdebug(s):o.l<=e.getInfoLevel()?this.cinfo(s):o.l<=e.getWarnLevel()?this.cwarn(s):this.cerror(s)}}catch(e){}r()},r}(E);e.ConsoleAppender=w;var O=function(){function e(e){this.loggerName=e,this.seenRegexes=[]}return e.prototype.setOptions=function(e){return t("level",e,this),t("userAgentRegex",e,this),t("disallow",e,this),t("ipRegex",e,this),t("appenders",e,this),t("onceOnly",e,this),this.seenRegexes=[],this},e.prototype.buildExceptionObject=function(e){var t={};return e.stack?t.stack=e.stack:t.e=e,e.message&&(t.message=e.message),e.name&&(t.name=e.name),e.data&&(t.data=e.data),e.inner&&(t.inner=this.buildExceptionObject(e.inner)),t},e.prototype.log=function(e,t,i){var s,a,u=0;if(!this.appenders)return this;if(e>=this.level&&n(this)&&(i?(a=this.buildExceptionObject(i)).logData=o(t):a=t,r(this,(s=c(a)).finalString))){if(this.onceOnly)for(u=this.onceOnly.length-1;u>=0;){if(new RegExp(this.onceOnly[u]).test(s.finalString)){if(this.seenRegexes[u])return this;this.seenRegexes[u]=!0}u--}for(s.meta=s.meta||{},u=this.appenders.length-1;u>=0;)this.appenders[u].log(e<=1e3?"trace":e<=2e3?"debug":e<=3e3?"info":e<=4e3?"warn":e<=5e3?"error":"fatal",s.msg,s.meta,function(){},e,s.finalString,this.loggerName),u--}return this},e.prototype.trace=function(e){return this.log(u(),e)},e.prototype.debug=function(e){return this.log(d(),e)},e.prototype.info=function(e){return this.log(l(),e)},e.prototype.warn=function(e){return this.log(h(),e)},e.prototype.error=function(e){return this.log(p(),e)},e.prototype.fatal=function(e){return this.log(f(),e)},e.prototype.fatalException=function(e,t){return this.log(f(),e,t)},e}();e.Logger=O,e.createAjaxAppender=function(e){return new S(e)},e.createConsoleAppender=function(e){return new w(e)},s="undefined"!=typeof window?new S(""):new w(""),e.__=new e.Logger(""),e.__.setOptions({level:e.getDebugLevel(),appenders:[s]})}(o||(o={})),t.__esModule=!0,t.JL=o,"function"==typeof r&&r.amd&&r("jsnlog",[],function(){return o}),"function"==typeof __jsnlog_configure&&__jsnlog_configure(o),"undefined"==typeof window||window.onerror||(window.onerror=function(e,t,n,r,i){return o("onerrorLogger").fatalException({msg:"Uncaught Exception",errorMsg:e?e.message||e:"",url:t,"line number":n,column:r},i),!1}),"undefined"==typeof window||window.onunhandledrejection||(window.onunhandledrejection=function(e){o("onerrorLogger").fatalException({msg:"unhandledrejection",errorMsg:e.reason?e.reason.message:e.message||null},e.reason)})},4713:function(e){"use strict";function t(){this._types=Object.create(null),this._extensions=Object.create(null);for(let e=0;e<arguments.length;e++)this.define(arguments[e]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}t.prototype.define=function(e,t){for(let n in e){let r=e[n].map(function(e){return e.toLowerCase()});n=n.toLowerCase();for(let e=0;e<r.length;e++){let i=r[e];if("*"!==i[0]){if(!t&&i in this._types)throw Error('Attempt to change mapping for "'+i+'" extension from "'+this._types[i]+'" to "'+n+'". Pass `force=true` to allow this, otherwise remove "'+i+'" from the list of extensions for "'+n+'".');this._types[i]=n}}if(t||!this._extensions[n]){let e=r[0];this._extensions[n]="*"!==e[0]?e:e.substr(1)}}},t.prototype.getType=function(e){let t=(e=String(e)).replace(/^.*[/\\]/,"").toLowerCase(),n=t.replace(/^.*\./,"").toLowerCase(),r=t.length<e.length;return(n.length<t.length-1||!r)&&this._types[n]||null},t.prototype.getExtension=function(e){return(e=/^\s*([^;\s]*)/.test(e)&&RegExp.$1)&&this._extensions[e.toLowerCase()]||null},e.exports=t},8499:function(e,t,n){"use strict";let r=n(4713);e.exports=new r(n(8223))},8223:function(e){e.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}},7447:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{unstable_getImgProps:function(){return c},default:function(){return u}});let r=n(1024),i=n(8630),o=n(6184),s=n(1749),a=r._(n(536)),c=e=>{(0,o.warnOnce)("Warning: unstable_getImgProps() is experimental and may change or be removed at any time. Use at your own risk.");let{props:t}=(0,i.getImgProps)(e,{defaultLoader:a.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,n]of Object.entries(t))void 0===n&&delete t[e];return{props:t}},u=s.Image},6691:function(e,t,n){e.exports=n(7447)},1396:function(e,t,n){e.exports=n(5250)},9602:function(e){var t=["stun:","turn:"];e.exports=function(e){var n,r,i=(e||{}).url||e,o={};return("string"==typeof i||i instanceof String)&&(i=i.trim(),n=t[t.indexOf(i.slice(0,5))])?(r=(i=i.slice(5)).split("@"),o.username=e.username,o.credential=e.credential,r.length>1&&(i=r[1],r=r[0].split(":"),o.username=r[0],o.credential=(e||{}).credential||r[1]||""),o.url=n+i,o.urls=[o.url],o):e}},2767:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LocalRecorderState=void 0,(n=t.LocalRecorderState||(t.LocalRecorderState={})).READY="READY",n.RECORDING="RECORDING",n.PAUSED="PAUSED",n.FINISHED="FINISHED"},5512:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduError=t.OpenViduErrorName=void 0,(n=t.OpenViduErrorName||(t.OpenViduErrorName={})).BROWSER_NOT_SUPPORTED="BROWSER_NOT_SUPPORTED",n.DEVICE_ACCESS_DENIED="DEVICE_ACCESS_DENIED",n.DEVICE_ALREADY_IN_USE="DEVICE_ALREADY_IN_USE",n.SCREEN_CAPTURE_DENIED="SCREEN_CAPTURE_DENIED",n.SCREEN_SHARING_NOT_SUPPORTED="SCREEN_SHARING_NOT_SUPPORTED",n.SCREEN_EXTENSION_NOT_INSTALLED="SCREEN_EXTENSION_NOT_INSTALLED",n.SCREEN_EXTENSION_DISABLED="SCREEN_EXTENSION_DISABLED",n.INPUT_VIDEO_DEVICE_NOT_FOUND="INPUT_VIDEO_DEVICE_NOT_FOUND",n.INPUT_AUDIO_DEVICE_NOT_FOUND="INPUT_AUDIO_DEVICE_NOT_FOUND",n.INPUT_AUDIO_DEVICE_GENERIC_ERROR="INPUT_AUDIO_DEVICE_GENERIC_ERROR",n.NO_INPUT_SOURCE_SET="NO_INPUT_SOURCE_SET",n.PUBLISHER_PROPERTIES_ERROR="PUBLISHER_PROPERTIES_ERROR",n.OPENVIDU_PERMISSION_DENIED="OPENVIDU_PERMISSION_DENIED",n.OPENVIDU_NOT_CONNECTED="OPENVIDU_NOT_CONNECTED",n.VIRTUAL_BACKGROUND_ERROR="VIRTUAL_BACKGROUND_ERROR",n.GENERIC_ERROR="GENERIC_ERROR",t.OpenViduError=function(e,t){this.name=e,this.message=t}},4e3:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TypeOfVideo=void 0,(n=t.TypeOfVideo||(t.TypeOfVideo={})).CAMERA="CAMERA",n.SCREEN="SCREEN",n.CUSTOM="CUSTOM",n.IPCAM="IPCAM"},1250:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.VideoInsertMode=void 0,(n=t.VideoInsertMode||(t.VideoInsertMode={})).AFTER="AFTER",n.APPEND="APPEND",n.BEFORE="BEFORE",n.PREPEND="PREPEND",n.REPLACE="REPLACE"},2802:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionEvent=void 0;var o=function(e){function t(t,n,r,i,o){var s=e.call(this,t,n,r)||this;return s.connection=i,s.reason=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(9704).Event);t.ConnectionEvent=o},9950:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionPropertyChangedEvent=void 0;var o=function(e){function t(t,n,r,i,o){var s=e.call(this,!1,t,"connectionPropertyChanged")||this;return s.connection=n,s.changedProperty=r,s.newValue=i,s.oldValue=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(9704).Event);t.ConnectionPropertyChangedEvent=o},9704:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var n=function(){function e(e,t,n){this.hasBeenPrevented=!1,this.cancelable=e,this.target=t,this.type=n}return e.prototype.isDefaultPrevented=function(){return this.hasBeenPrevented},e.prototype.preventDefault=function(){this.callDefaultBehavior=function(){},this.hasBeenPrevented=!0},e}();t.Event=n},730:function(e,t,n){"use strict";var r,i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ExceptionEvent=t.ExceptionEventName=void 0;var s=n(9704);(r=t.ExceptionEventName||(t.ExceptionEventName={})).ICE_CANDIDATE_ERROR="ICE_CANDIDATE_ERROR",r.ICE_CONNECTION_FAILED="ICE_CONNECTION_FAILED",r.ICE_CONNECTION_DISCONNECTED="ICE_CONNECTION_DISCONNECTED",r.NO_STREAM_PLAYING_EVENT="NO_STREAM_PLAYING_EVENT",r.SPEECH_TO_TEXT_DISCONNECTED="SPEECH_TO_TEXT_DISCONNECTED";var a=function(e){function t(t,n,r,i,o){var s=e.call(this,!1,t,"exception")||this;return s.name=n,s.origin=r,s.message=i,s.data=o,s}return o(t,e),t.prototype.callDefaultBehavior=function(){},t}(s.Event);t.ExceptionEvent=a},9026:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.FilterEvent=void 0;var o=function(e){function t(t,n,r){var i=e.call(this,!1,t,n)||this;return i.data=r,i}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(9704).Event);t.FilterEvent=o},2420:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkQualityLevelChangedEvent=void 0;var o=function(e){function t(t,n,r,i){var o=e.call(this,!1,t,"networkQualityLevelChanged")||this;return o.newValue=n,o.oldValue=r,o.connection=i,o}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(9704).Event);t.NetworkQualityLevelChangedEvent=o},8349:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PublisherSpeakingEvent=void 0;var o=function(e){function t(t,n,r,i){var o=e.call(this,!1,t,n)||this;return o.type=n,o.connection=r,o.streamId=i,o}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(9704).Event);t.PublisherSpeakingEvent=o},1372:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.RecordingEvent=void 0;var o=function(e){function t(t,n,r,i,o){var s=e.call(this,!1,t,n)||this;return s.id=r,i!==r&&(s.name=i),s.reason=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(9704).Event);t.RecordingEvent=o},2343:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SessionDisconnectedEvent=void 0;var o=n(9704),s=n(5995).OpenViduLogger.getInstance(),a=function(e){function t(t,n){var r=e.call(this,!0,t,"sessionDisconnected")||this;return r.reason=n,r}return i(t,e),t.prototype.callDefaultBehavior=function(){s.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'");var e=this.target;e.remoteConnections.forEach(function(t){var n,r,i,o,s,a,c,u,d=t.connectionId;if(null===(n=e.remoteConnections.get(d))||void 0===n?void 0:n.stream){null===(r=e.remoteConnections.get(d))||void 0===r||r.stream.disposeWebRtcPeer(),null===(i=e.remoteConnections.get(d))||void 0===i||i.stream.disposeMediaStream(),(null===(o=e.remoteConnections.get(d))||void 0===o?void 0:o.stream.streamManager)&&(null===(s=e.remoteConnections.get(d))||void 0===s||s.stream.streamManager.removeAllVideos());var l=null===(c=null===(a=e.remoteConnections.get(d))||void 0===a?void 0:a.stream)||void 0===c?void 0:c.streamId;l&&e.remoteStreamsCreated.delete(l),null===(u=e.remoteConnections.get(d))||void 0===u||u.dispose()}e.remoteConnections.delete(d)})},t}(o.Event);t.SessionDisconnectedEvent=a},2316:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SignalEvent=void 0;var o=function(e){function t(t,n,r,i){var o=e.call(this,!1,t,"signal")||this;return n&&(o.type="signal:"+n),o.data=r,o.from=i,o}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(9704).Event);t.SignalEvent=o},252:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SpeechToTextEvent=void 0;var o=function(e){function t(t,n,r,i,o,s){var a=e.call(this,!1,t,"speechToTextMessage")||this;return a.connection=n,a.text=r,a.reason=i,a.raw=o,a.lang=s,a}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(9704).Event);t.SpeechToTextEvent=o},702:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.StreamEvent=void 0;var o=n(9704),s=n(2079),a=n(7945),c=n(5995).OpenViduLogger.getInstance(),u=function(e){function t(t,n,r,i,o){var s=e.call(this,t,n,r)||this;return s.stream=i,s.reason=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){if("streamDestroyed"===this.type){if(this.target instanceof a.Session)c.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'"),this.stream.disposeWebRtcPeer();else if(this.target instanceof s.Publisher){c.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Publisher'"),clearInterval(this.target.screenShareResizeInterval),this.stream.isLocalStreamReadyToPublish=!1;for(var e=this.target.openvidu.publishers,t=0;t<e.length;t++)if(e[t]===this.target){e.splice(t,1);break}}this.stream.disposeMediaStream(),this.stream.streamManager&&this.stream.streamManager.removeAllVideos(),this.stream.session.remoteStreamsCreated.delete(this.stream.streamId);var n=this.stream.session.remoteConnections.get(this.stream.connection.connectionId);if(n&&n.remoteOptions)for(var r=n.remoteOptions.streams,t=r.length-1;t>=0;--t)r[t].id===this.stream.streamId&&r.splice(t,1)}},t}(o.Event);t.StreamEvent=u},5097:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.StreamManagerEvent=void 0;var o=function(e){function t(t,n,r){var i=e.call(this,!1,t,n)||this;return i.value=r,i}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(9704).Event);t.StreamManagerEvent=o},3867:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.StreamPropertyChangedEvent=void 0;var o=function(e){function t(t,n,r,i,o,s){var a=e.call(this,!1,t,"streamPropertyChanged")||this;return a.stream=n,a.changedProperty=r,a.newValue=i,a.oldValue=o,a.reason=s,a}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(9704).Event);t.StreamPropertyChangedEvent=o},6964:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9141:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.VideoElementEvent=void 0;var o=function(e){function t(t,n,r){var i=e.call(this,!1,n,r)||this;return i.element=t,i}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(9704).Event);t.VideoElementEvent=o},8762:function(e){function t(){var e={};this.forEach=function(t){for(var n in e){var r=e[n];for(var i in r)t(r[i])}},this.get=function(t,n){var r=e[n];if(void 0!=r)return r[t]},this.remove=function(t,n){var r=e[n];if(void 0!=r){for(var i in delete r[t],r)return!1;delete e[n]}},this.set=function(t,n,r){if(void 0==t)return this.remove(n,r);var i=e[r];void 0==i&&(e[r]=i={}),i[n]=t}}t.prototype.pop=function(e,t){var n=this.get(e,t);if(void 0!=n)return this.remove(e,t),n},e.exports=t},2502:function(e,t,n){var r=n(4435);t.JsonRpcClient=r},4435:function(e,t,n){var r=n(5932),i=n(8736),o=n(5995).OpenViduLogger;Date.now=Date.now||function(){return+new Date};var s="RECONNECTING",a="CONNECTED",c="DISCONNECTED",u=o.getInstance();e.exports=function(e){var t,n=this,o=e.ws,d=-1,l=0,h=!0,p=!1,f=c,m=o.onreconnecting,v=o.onreconnected,g=o.onconnected,b=o.onerror;e.rpc.pull=function(e,t){t.reply(null,"push")},o.onreconnecting=function(){if(u.debug("--------- ONRECONNECTING -----------"),f===s){u.error("Websocket already in RECONNECTING state when receiving a new ONRECONNECTING message. Ignoring it");return}_(),f=s,m&&m()},o.onreconnected=function(){if(u.debug("--------- ONRECONNECTED -----------"),f===a){u.error("Websocket already in CONNECTED state when receiving a new ONRECONNECTED message. Ignoring it");return}f=a,w(),v&&v()},o.onconnected=function(){if(u.debug("--------- ONCONNECTED -----------"),f===a){u.error("Websocket already in CONNECTED state when receiving a new ONCONNECTED message. Ignoring it");return}f=a,h=!0,C(),g&&g()},o.onerror=function(e){u.debug("--------- ONERROR -----------"),f=c,_(),b&&b(e)};var y=new i(o);u.debug("Connecting websocket to URI: "+o.uri);var E={request_timeout:e.rpc.requestTimeout,ping_request_timeout:e.rpc.heartbeatRequestTimeout},S=new r(r.packers.JsonRPC,E,y,function(t){u.debug("Received request: "+JSON.stringify(t));try{var n=e.rpc[t.method];void 0===n?u.error("Method "+t.method+" not registered in client"):n(t.params,t)}catch(e){u.error("Exception processing request: "+JSON.stringify(t)),u.error(e)}});function w(){u.debug("notReconnectIfNumLessThan = "+l+" (old="+d+")"),d=l}function O(){if(h){var t,r=null;(0==l||l==d)&&(r={interval:e.heartbeat||5e3}),l++,n.send("ping",r,(t=l,function(e,n){e&&(u.debug("Error in ping request #"+t+" ("+e.message+")"),t>d&&(h=!1,w(),u.debug("Server did not respond to ping message #"+t+". Reconnecting... "),y.reconnectWs()))}))}else u.debug("Trying to send ping, but ping is not enabled")}function C(){p||(u.debug("Starting ping (if configured)"),p=!0,void 0!=e.heartbeat&&(t=setInterval(O,e.heartbeat),O()))}function _(){clearInterval(t),p=!1,h=!1,l=-1,S.cancel()}this.send=function(e,t,n){var r=Date.now();S.encode(e,t,function(i,o){if(i){try{u.error("ERROR:"+i.message+" in Request: method:"+e+" params:"+JSON.stringify(t)+" request:"+i.request),i.data&&u.error("ERROR DATA:"+JSON.stringify(i.data))}catch(e){}i.requestTime=r}n&&(void 0!=o&&"pong"!==o.value&&u.debug("Response: "+JSON.stringify(o)),n(i,o))})},this.close=function(e,n){u.debug("Closing  with code: "+e+" because: "+n),void 0!=t&&(u.debug("Clearing ping interval"),clearInterval(t)),p=!1,h=!1,y.close(e,n)},this.reconnect=function(){y.reconnectWs()},this.resetPing=function(){h=!0,l=0,C()},this.getReadyState=function(){return y.getReadyState()}}},9984:function(e,t,n){var r=n(8736);t.WebSocketWithReconnection=r},8736:function(e,t,n){"use strict";var r=n(5995).OpenViduLogger.getInstance();e.exports=function(e){var t,n=!1,i=e.uri,o=!1,s=new WebSocket(i);s.onopen=function(){r.debug("WebSocket connected to "+i),e.onconnected&&e.onconnected()},s.onerror=function(t){r.error("Could not connect to "+i+" (invoking onerror if defined)",t),e.onerror&&e.onerror(t)};var a=function(){3===s.readyState?n?r.debug("Connection closed by user"):e.ismasternodecrashed()?r.error("Master Node has crashed. Stopping reconnection process"):(r.debug("Connection closed unexpectedly. Reconnecting..."),c(2e3,1)):r.debug("Close callback from previous websocket. Ignoring it")};function c(n,u){var d,l;if(r.debug("reconnect (attempt #"+u+", max="+n+")"),1===u){if(o){r.warn("Trying to reconnect when already reconnecting... Ignoring this reconnection.");return}o=!0,e.onreconnecting&&e.onreconnecting()}r.debug("Reconnection attempt #"+u),s.close(4104,"Connection closed for reconnection"),d=i,(l=new URLSearchParams(new URL(d).search)).has("reconnect")||(d=Array.from(l).length>0?d+"&reconnect=true":d+"?reconnect=true"),i=d,(s=new WebSocket(i)).onopen=function(){r.debug("Reconnected to "+i+" after "+u+" attempts..."),o=!1,t(),e.onreconnected&&e.onreconnected(),s.onclose=a},s.onerror=function(t){r.warn("Reconnection error: ",t),u===n?e.ondisconnect&&e.ondisconnect():setTimeout(function(){c(n,u+1)},3e3)}}s.onclose=a,this.close=function(e,t){n=!0,s.close(e,t)},this.reconnectWs=function(){r.debug("reconnectWs"),c(2e3,1)},this.send=function(e){s.send(e)},this.addEventListener=function(e,n){(t=function(){s.addEventListener(e,n)})()},this.getReadyState=function(){return s.readyState}}},5932:function(e,t,n){var r=!1;if(Object.defineProperty)try{Object.defineProperty({},"x",{})}catch(e){r=!0}Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i});var i=n(512).EventEmitter,o=n(5335),s=n(1531),a=n(8762);function c(e){if(e){if(e instanceof Function)return{send:e};if(e.send instanceof Function)return e;if(e.postMessage instanceof Function)return e.send=e.postMessage,e;if(e.write instanceof Function)return e.send=e.write,e;if(void 0===e.onmessage&&!(e.pause instanceof Function))throw SyntaxError("Transport is not a function nor a valid object")}}function u(e,t){r?(this.method=e,this.params=t):(Object.defineProperty(this,"method",{value:e,enumerable:!0}),Object.defineProperty(this,"params",{value:t,enumerable:!0}))}function d(e,t,n,s){var d=this;if(!e)throw SyntaxError("Packer is not defined");if(!e.pack||!e.unpack)throw SyntaxError("Packer is invalid");var l=function(e){if(!e)return{};for(var t in e){var n=e[t];"string"==typeof n&&(e[t]={response:n})}return e}(e.responseMethods);if(t instanceof Function){if(void 0!=n)throw SyntaxError("There can't be parameters after onRequest");s=t,n=void 0,t=void 0}if(t&&t.send instanceof Function){if(n&&!(n instanceof Function))throw SyntaxError("Only a function can be after transport");s=n,n=t,t=void 0}if(n instanceof Function){if(void 0!=s)throw SyntaxError("There can't be parameters after onRequest");s=n,n=void 0}if(n&&n.send instanceof Function&&s&&!(s instanceof Function))throw SyntaxError("Only a function can be after transport");t=t||{},i.call(this),s&&this.on("request",s),r?this.peerID=t.peerID:Object.defineProperty(this,"peerID",{value:t.peerID});var h=t.max_retries||0;function p(e){d.decode(e.data||e)}this.getTransport=function(){return n},this.setTransport=function(e){n&&(n.removeEventListener?n.removeEventListener("message",p):n.removeListener&&n.removeListener("data",p)),e&&(e.addEventListener?e.addEventListener("message",p):e.addListener&&e.addListener("data",p)),n=c(e)},r||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)}),this.setTransport(n);var f=t.request_timeout||5e3,m=t.ping_request_timeout||f,v=t.response_timeout||5e3,g=t.duplicates_timeout||5e3,b=0,y=new a,E=new a,S=new a,w={};function O(e,t){var n=setTimeout(function(){S.remove(e,t)},g);S.set(n,e,t)}function C(t,n,i,o,s){u.call(this,t,n),this.getTransport=function(){return s},this.setTransport=function(e){s=c(e)},r||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)});var a=E.get(i,o);s||d.getTransport()||(r?this.duplicated=!!a:Object.defineProperty(this,"duplicated",{value:!!a}));var h=l[t];this.pack=e.pack.bind(e,this,i),this.reply=function(t,n,r){var s,u;if(t instanceof Function||t&&t.send instanceof Function){if(void 0!=n)throw SyntaxError("There can't be parameters after callback");r=t,n=null,t=void 0}else if(n instanceof Function||n&&n.send instanceof Function){if(void 0!=r)throw SyntaxError("There can't be parameters after callback");r=n,n=null}return(r=c(r),a&&clearTimeout(a.timeout),void 0!=o&&(t&&(t.dest=o),n&&(n.dest=o)),t||void 0!=n)?(void 0!=d.peerID&&(t?t.from=d.peerID:n.from=d.peerID),s=h?void 0==h.error&&t?{error:t}:{method:t?h.error:h.response,params:t||n}:{error:t,result:n},s=e.pack(s,i)):s=a?a.message:e.pack({result:null},i),(u={message:s,timeout:setTimeout(function(){E.remove(i,o)},v)},E.set(u,i,o),r=r||this.getTransport()||d.getTransport())?r.send(s):s}}function _(e){var t=w[e];if(t){delete w[e];var n=y.pop(t.id,t.dest);n&&(clearTimeout(n.timeout),O(t.id,t.dest))}}o(C,u),this.cancel=function(e){if(e)return _(e);for(var e in w)_(e)},this.close=function(){var e=this.getTransport();e&&e.close&&e.close(4003,"Cancel request"),this.cancel(),S.forEach(clearTimeout),E.forEach(function(e){clearTimeout(e.timeout)})},this.encode=function(t,n,r,i,o){if(n instanceof Function){if(void 0!=r)throw SyntaxError("There can't be parameters after callback");o=n,i=void 0,r=void 0,n=void 0}else if(r instanceof Function){if(void 0!=i)throw SyntaxError("There can't be parameters after callback");o=r,i=void 0,r=void 0}else if(i instanceof Function){if(void 0!=o)throw SyntaxError("There can't be parameters after callback");o=i,i=void 0}void 0!=d.peerID&&((n=n||{}).from=d.peerID),void 0!=r&&((n=n||{}).dest=r);var s={method:t,params:n};if(o){var a=b++,u=0;function p(e,t){d.cancel(s),o(e,t)}var v={message:s=e.pack(s,a),callback:p,responseMethods:l[t]||{}},g=c(i);function E(e){var n="ping"===t?m:f;return(v.timeout=setTimeout(C,n*Math.pow(2,u++)),w[s]={id:a,dest:r},y.set(v,a,r),e=e||g||d.getTransport())?e.send(s):s}function O(e){return e=c(e),console.warn(u+" retry for request message:",s),clearTimeout(S.pop(a,r)),E(e)}function C(){if(u<h)return O(i);var e=Error("Request has timed out");e.request=s,e.retry=O,p(e)}return E(i)}return(s=e.pack(s),i=i||this.getTransport())?i.send(s):s},this.decode=function(t,n){if(!t)throw TypeError("Message is not defined");try{t=e.unpack(t)}catch(e){return console.debug(e,t)}var r=t.id,i=t.ack,o=t.method,s=t.params||{},a=s.from,l=s.dest;if(void 0==d.peerID||a!=d.peerID){if(void 0==r&&void 0==i){var h=new u(o,s);if(d.emit("request",h))return;return h}if(o){if(void 0==l||l==d.peerID){var p=y.get(i,a);if(p){var f=p.responseMethods;return o==f.error?w(p,s):o==f.response?w(p,null,s):b()}var m=S.get(i,a);if(m)return _(m)}return b()}var v=t.error,g=t.result;if((!v||!v.dest||v.dest==d.peerID)&&(!g||!g.dest||g.dest==d.peerID)){var p=y.get(i,a);if(!p){var m=S.get(i,a);return m?_(m):console.warn("No callback was defined for this message",t)}w(p,v,g)}}function b(){if(n=c(n)||d.getTransport()){var e=E.get(r,a);if(e)return n.send(e.message)}var t=new C(o,s,void 0!=r?r:i,a,n);if(!d.emit("request",t))return t}function w(e,t,n){e.callback(t,n)}function _(e){console.warn("Response already processed",t),clearTimeout(e),O(i,a)}}}o(d,i),d.RpcNotification=u,e.exports=d;var l=n(2502),h=n(9984);d.clients=l,d.clients.transports=h,d.packers=s},7949:function(e,t){t.pack=function(e,t){var n={jsonrpc:"2.0"};if(e.method)n.method=e.method,e.params&&(n.params=e.params),void 0!=t&&(n.id=t);else if(void 0!=t){if(e.error){if(void 0!==e.result)throw TypeError("Both result and error are defined");n.error=e.error}else if(void 0!==e.result)n.result=e.result;else throw TypeError("No result or error is defined");n.id=t}return JSON.stringify(n)},t.unpack=function(e){var t=e;("string"==typeof e||e instanceof String)&&(t=JSON.parse(e));var n=t.jsonrpc;if("2.0"!==n)throw TypeError("Invalid JsonRPC version '"+n+"': "+e);if(void 0==t.method){if(void 0==t.id)throw TypeError("Invalid message: "+e);var r=void 0!==t.result,i=void 0!==t.error;if(r&&i)throw TypeError("Both result and error are defined: "+e);if(!r&&!i)throw TypeError("No result or error is defined: "+e);t.ack=t.id,delete t.id}return t}},6835:function(e,t){t.pack=function(e){throw TypeError("Not yet implemented")},t.unpack=function(e){throw TypeError("Not yet implemented")}},1531:function(e,t,n){var r=n(7949),i=n(6835);t.JsonRPC=r,t.XmlRPC=i},452:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleLogger=void 0,t.ConsoleLogger=function(e){this.logger=e,this.log=e.log,this.info=e.info,this.debug=e.debug,this.warn=e.warn,this.error=e.error}},5995:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduLogger=void 0;var r=n(2714),i=n(452),o=n(805),s=function(){function e(){this.JSNLOG_URL="/openvidu/elk/openvidu-browser-logs",this.MAX_JSNLOG_BATCH_LOG_MESSAGES=100,this.MAX_MSECONDS_BATCH_MESSAGES=5e3,this.MAX_LENGTH_STRING_JSON=1e3,this.defaultConsoleLogger=new i.ConsoleLogger(globalThis.console),this.isProdMode=!1,this.isJSNLogSetup=!1}return e.configureJSNLog=function(e,t){var n=this;try{if(globalThis.LOG_JSNLOG_RESULTS||this.instance&&e.isAtLeastPro&&this.instance.isOpenViduBrowserLogsDebugActive(e)&&this.instance.canConfigureJSNLog(e,this.instance)){e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug_app&&this.instance.replaceWindowConsole(),this.instance.isJSNLogSetup=!1,this.instance.info("Configuring JSNLogs.");var i=e.finalUserId,s=e.session.sessionId;this.instance.currentAppender=r.JL.createAjaxAppender("appender-".concat(i,"-").concat(s)),this.instance.currentAppender.setOptions({beforeSend:function(e){var r=e.onreadystatechange;e.onreadystatechange=function(){n.isInvalidResponse(e)&&(Object.defineProperty(e,"readyState",{value:4}),Object.defineProperty(e,"status",{value:200}),n.instance.disableLogger()),r()},e.setRequestHeader("Authorization","Basic "+btoa("".concat(i,"%/%").concat(s)+":"+t)),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.setRequestHeader("OV-Final-User-Id",i),e.setRequestHeader("OV-Session-Id",s),e.setRequestHeader("OV-Token",t)},maxBatchSize:1e3,batchSize:this.instance.MAX_JSNLOG_BATCH_LOG_MESSAGES,batchTimeout:this.instance.MAX_MSECONDS_BATCH_MESSAGES}),r.JL.setOptions({defaultAjaxUrl:e.httpUri+this.instance.JSNLOG_URL,serialize:function(e){var t,r=JSON.stringify(e,(t=new WeakSet,function(e,n){if("object"==typeof n&&null!=n){if(t.has(n)||globalThis.HTMLElement&&n instanceof HTMLElement)return;t.add(n)}return n}));return r.length>n.instance.MAX_LENGTH_STRING_JSON&&(r="".concat(r.substring(0,n.instance.MAX_LENGTH_STRING_JSON),"...")),globalThis.LOG_JSNLOG_RESULTS&&console.log(r),r},enabled:!0}),(0,r.JL)().setOptions({appenders:[this.instance.currentAppender]}),this.instance.isJSNLogSetup=!0,this.instance.loggingSessionId=s,this.instance.info("JSNLog configured.")}}catch(e){console.error("Error configuring JSNLog: "),console.error(e),this.instance.disableLogger()}},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.isInvalidResponse=function(e){return 401==e.status||403==e.status||404==e.status||0==e.status},e.prototype.canConfigureJSNLog=function(e,t){return e.session.sessionId!=t.loggingSessionId},e.prototype.isOpenViduBrowserLogsDebugActive=function(e){return e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug||e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug_app},e.prototype.getConsoleWithJSNLog=function(){var e;return e=this,{log:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.log.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().info(arguments)},info:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.info.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().info(arguments)},debug:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.debug.apply(e.defaultConsoleLogger.logger,arguments)},warn:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.warn.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().warn(arguments)},error:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.error.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().error(arguments)}}},e.prototype.replaceWindowConsole=function(){globalThis.console=this.defaultConsoleLogger.logger,globalThis.console.log=this.getConsoleWithJSNLog().log,globalThis.console.info=this.getConsoleWithJSNLog().info,globalThis.console.debug=this.getConsoleWithJSNLog().debug,globalThis.console.warn=this.getConsoleWithJSNLog().warn,globalThis.console.error=this.getConsoleWithJSNLog().error},e.prototype.disableLogger=function(){r.JL.setOptions({enabled:!1}),this.isJSNLogSetup=!1,this.loggingSessionId=void 0,this.currentAppender=void 0,globalThis.console=this.defaultConsoleLogger.logger,globalThis.console.log=this.defaultConsoleLogger.log,globalThis.console.info=this.defaultConsoleLogger.info,globalThis.console.debug=this.defaultConsoleLogger.debug,globalThis.console.warn=this.defaultConsoleLogger.warn,globalThis.console.error=this.defaultConsoleLogger.error},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.log.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().info(arguments)},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.debug.apply(this.defaultConsoleLogger.logger,arguments)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.info.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().info(arguments)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.defaultConsoleLogger.warn.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().warn(arguments)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.defaultConsoleLogger.error.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().error(arguments)},e.prototype.flush=function(){this.isJSNLogSetup&&null!=this.currentAppender&&this.currentAppender.sendBatch()},e.prototype.enableProdMode=function(){this.isProdMode=!0},e}();t.OpenViduLogger=s},805:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduLoggerConfiguration=void 0,(n=t.OpenViduLoggerConfiguration||(t.OpenViduLoggerConfiguration={})).disabled="disabled",n.debug="debug",n.debug_app="debug_app"},3314:function(e,t){var n;function r(e,t,n){var r={audio:!1,video:{mandatory:{chromeMediaSource:e?"screen":"desktop",maxWidth:globalThis.screen.width>1920?globalThis.screen.width:1920,maxHeight:globalThis.screen.height>1080?globalThis.screen.height:1080},optional:[]}};return n&&(r.audio={mandatory:{chromeMediaSource:e?"screen":"desktop"},optional:[]}),t&&(r.video.mandatory.chromeMediaSourceId=t,r.audio&&r.audio.mandatory&&(r.audio.mandatory.chromeMediaSourceId=t)),r}function i(e){if(!n){o(function(){i(e)});return}if(!n.isLoaded){setTimeout(function(){i(e)},100);return}e?e.forEach?n.contentWindow.postMessage({captureCustomSourceId:e},"*"):n.contentWindow.postMessage({captureSourceIdWithAudio:!0},"*"):n.contentWindow.postMessage({captureSourceId:!0},"*")}function o(e){if(n){e();return}(n=document.createElement("iframe")).onload=function(){n.isLoaded=!0,e()},n.src="https://openvidu.github.io/openvidu-screen-sharing-chrome-extension/",n.style.display="none",(document.body||document.documentElement).appendChild(n)}function s(){if(!n){o(s);return}if(!n.isLoaded){setTimeout(s,100);return}n.contentWindow.postMessage({getChromeExtensionStatus:!0},"*")}globalThis.getScreenId=function(e,t,n){if(-1!==navigator.userAgent.indexOf("Edge")&&(navigator.msSaveOrOpenBlob||navigator.msSaveBlob)){t({video:!0});return}if(navigator.mozGetUserMedia){t(null,"firefox",{video:{mozMediaSource:e,mediaSource:e}});return}globalThis.addEventListener("message",function e(n){n.data&&(n.data.chromeMediaSourceId&&("PermissionDeniedError"===n.data.chromeMediaSourceId?t("permission-denied"):t(null,n.data.chromeMediaSourceId,r(null,n.data.chromeMediaSourceId,n.data.canRequestAudioTrack)),globalThis.removeEventListener("message",e)),n.data.chromeExtensionStatus&&(t(n.data.chromeExtensionStatus,null,r(n.data.chromeExtensionStatus)),globalThis.removeEventListener("message",e)))}),n?setTimeout(function(){i(n)},100):setTimeout(i,100)},globalThis.getScreenConstraints=function(e){o(function(){getScreenId(function(t,n,r){r||(r={video:!0}),e(t,r.video)})})},globalThis.getChromeExtensionStatus=function(e){if(navigator.mozGetUserMedia){e("installed-enabled");return}globalThis.addEventListener("message",function t(n){n.data&&n.data.chromeExtensionStatus&&(e(n.data.chromeExtensionStatus),globalThis.removeEventListener("message",t))}),setTimeout(s,100)},t.getScreenId=globalThis.getScreenId},8628:function(e,t){var n,r,i="screen";if("undefined"!=typeof window&&"undefined"!=typeof navigator&&void 0!==navigator.userAgent){var o=void 0!==window.InstallTrigger;window.opera||navigator.userAgent.indexOf(" OPR/"),window.chrome,window.addEventListener("message",function(e){e.origin==window.location.origin&&function(e){if("PermissionDeniedError"==e){if(r)return r("PermissionDeniedError");throw Error("PermissionDeniedError")}"rtcmulticonnection-extension-loaded"==e&&(i="desktop"),e.sourceId&&r&&r(n=e.sourceId,!0===e.canRequestAudioTrack)}(e.data)})}function s(e){if(!e)throw'"callback" parameter is mandatory.';if(n)return e(n);r=e,window.postMessage("get-sourceId","*")}function a(e,t){if(n="",o)return e(null,{mozMediaSource:"window",mediaSource:"window"});var a={mandatory:{chromeMediaSource:i,maxWidth:screen.width>1920?screen.width:1920,maxHeight:screen.height>1080?screen.height:1080},optional:[]};if("desktop"==i&&!n){t?function(e){if(!e)throw'"callback" parameter is mandatory.';if(n)return e(n);r=e,window.postMessage("audio-plus-tab","*")}(function(t,n){a.mandatory.chromeMediaSourceId=t,n&&(a.canRequestAudioTrack=!0),e("PermissionDeniedError"==t?t:null,a)}):s(function(t){a.mandatory.chromeMediaSourceId=t,e("PermissionDeniedError"==t?t:null,a)});return}"desktop"==i&&(a.mandatory.chromeMediaSourceId=n),e(null,a)}t.getScreenConstraints=a,t.getScreenConstraintsWithAudio=function(e){a(e,!0)},t.isChromeExtensionAvailable=function(e){if(e){if("desktop"==i)return e(!0);window.postMessage("are-you-there","*"),setTimeout(function(){"screen"==i?e(!1):e(!0)},2e3)}},t.getChromeExtensionStatus=function(e,t){if(o)return t("not-chrome");2!=arguments.length&&(t=e,e="lfcgfepafnobdloecchnfaclibenjold");var n=document.createElement("img");n.src="chrome-extension://"+e+"/icon.png",n.onload=function(){i="screen",window.postMessage("are-you-there","*"),setTimeout(function(){"screen"==i?t("installed-disabled"):t("installed-enabled")},2e3)},n.onerror=function(){t("not-installed")}},t.getSourceId=s},909:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformUtils=void 0;var r=n(2812),i=function(){function e(){}return e.getInstance=function(){return this.instance||(this.instance=new e),e.instance},e.prototype.isChromeBrowser=function(){return"Chrome"===r.name},e.prototype.isSafariBrowser=function(){return"Safari"===r.name},e.prototype.isChromeMobileBrowser=function(){return"Chrome Mobile"===r.name},e.prototype.isFirefoxBrowser=function(){return"Firefox"===r.name},e.prototype.isFirefoxMobileBrowser=function(){return"Firefox Mobile"===r.name||"Firefox for iOS"===r.name},e.prototype.isOperaBrowser=function(){return"Opera"===r.name},e.prototype.isOperaMobileBrowser=function(){return"Opera Mobile"===r.name},e.prototype.isEdgeBrowser=function(){var e=(null==r?void 0:r.version)?parseFloat(r.version):-1;return"Microsoft Edge"===r.name&&e>=80},e.prototype.isEdgeMobileBrowser=function(){var e,t,n=(null==r?void 0:r.version)?parseFloat(r.version):-1;return"Microsoft Edge"===r.name&&((null===(e=r.os)||void 0===e?void 0:e.family)==="Android"||(null===(t=r.os)||void 0===t?void 0:t.family)==="iOS")&&n>45},e.prototype.isAndroidBrowser=function(){return"Android Browser"===r.name},e.prototype.isElectron=function(){return"Electron"===r.name},e.prototype.isNodeJs=function(){return"Node.js"===r.name},e.prototype.isSamsungBrowser=function(){return"Samsung Internet Mobile"===r.name||"Samsung Internet"===r.name},e.prototype.isMotorolaEdgeDevice=function(){var e;return(null===(e=r.product)||void 0===e?void 0:e.toLowerCase().includes("motorola edge"))||!1},e.prototype.isIPhoneOrIPad=function(){var e=r.ua?r.ua:navigator.userAgent,t="ontouchend"in document,n=/\b(\w*Macintosh\w*)\b/.test(e)&&t,i=/\b(\w*iPhone\w*)\b/.test(e)&&/\b(\w*Mobile\w*)\b/.test(e)&&t;return n||i},e.prototype.isIOSWithSafari=function(){var e=r.ua?r.ua:navigator.userAgent;return this.isIPhoneOrIPad()&&/\b(\w*Apple\w*)\b/.test(navigator.vendor)&&/\b(\w*Safari\w*)\b/.test(e)&&!/\b(\w*CriOS\w*)\b/.test(e)&&!/\b(\w*FxiOS\w*)\b/.test(e)},e.prototype.isIonicIos=function(){return this.isIPhoneOrIPad()&&-1===r.ua.indexOf("Safari")},e.prototype.isIonicAndroid=function(){return"Android"===r.os.family&&"Android Browser"==r.name},e.prototype.isMobileDevice=function(){return"iOS"===r.os.family||"Android"===r.os.family},e.prototype.isReactNative=function(){return!1},e.prototype.isChromium=function(){return this.isChromeBrowser()||this.isChromeMobileBrowser()||this.isOperaBrowser()||this.isOperaMobileBrowser()||this.isEdgeBrowser()||this.isEdgeMobileBrowser()||this.isSamsungBrowser()||this.isIonicAndroid()||this.isIonicIos()||this.isElectron()||this.isMotorolaEdgeDevice()},e.prototype.canScreenShare=function(){var e=(null==r?void 0:r.version)?parseFloat(r.version):-1;return!this.isMobileDevice()&&(this.isChromeBrowser()||this.isFirefoxBrowser()||this.isOperaBrowser()||this.isElectron()||this.isEdgeBrowser()||this.isSafariBrowser()&&e>=13)},e.prototype.getName=function(){return r.name||""},e.prototype.getVersion=function(){return r.version||""},e.prototype.getFamily=function(){return r.os.family||""},e.prototype.getDescription=function(){return r.description||""},e}();t.PlatformUtils=i},3755:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRtcPeerSendrecv=t.WebRtcPeerSendonly=t.WebRtcPeerRecvonly=t.WebRtcPeer=void 0;var c=n(6579),u=n(4916),d=n(730),l=n(5995),h=n(909),p=l.OpenViduLogger.getInstance(),f=function(){function e(e){var t=this;this.remoteCandidatesQueue=[],this.localCandidatesQueue=[],this.iceCandidateList=[],h.PlatformUtils.getInstance(),this.configuration=o(o({},e),{iceServers:e.iceServers&&e.iceServers.length>0?e.iceServers:c(),mediaStream:void 0!==e.mediaStream?e.mediaStream:null,mode:e.mode?e.mode:"sendrecv",id:e.id?e.id:this.generateUniqueId()}),p.debug("[WebRtcPeer] configuration:\n".concat(JSON.stringify(this.configuration,null,2))),this.pc=new RTCPeerConnection({iceServers:this.configuration.iceServers}),this.pc.addEventListener("icecandidate",function(e){if(null!==e.candidate){var n=e.candidate,r=new RTCIceCandidate(n);t.configuration.onIceCandidate(r),""!==r.candidate&&t.localCandidatesQueue.push(r)}}),this.pc.addEventListener("signalingstatechange",function(){return s(t,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:if("stable"!==this.pc.signalingState)return[3,6];n.label=1;case 1:if(!(this.iceCandidateList.length>0))return[3,6];e=this.iceCandidateList.shift(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this.pc.addIceCandidate(e)];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),p.error("Error when calling RTCPeerConnection#addIceCandidate for RTCPeerConnection "+this.getId(),t),[3,5];case 5:return[3,1];case 6:return[2]}})})})}return e.prototype.getId=function(){return this.configuration.id},e.prototype.dispose=function(){p.debug("Disposing WebRtcPeer"),this.pc&&"closed"!==this.pc.signalingState&&(this.pc.close(),this.remoteCandidatesQueue=[],this.localCandidatesQueue=[])},e.prototype.createOfferLegacy=function(){this.configuration.mediaStream&&this.deprecatedPeerConnectionTrackApi();var e=this.configuration.mediaConstraints.audio,t=this.configuration.mediaConstraints.video,n={offerToReceiveAudio:"sendonly"!==this.configuration.mode&&e,offerToReceiveVideo:"sendonly"!==this.configuration.mode&&t};return p.debug("[createOfferLegacy] RTCPeerConnection.createOffer() options:",JSON.stringify(n)),this.pc.createOffer(n)},e.prototype.createOffer=function(){var e,t,n,r,i,o,c,u;return s(this,void 0,void 0,function(){var s,d,l,h,f,m,v,g,b,y,E,S,w,O,C,_,I,R,T,k,x,P,N;return a(this,function(a){switch(a.label){case 0:if(!("addTransceiver"in this.pc))return p.warn("[createOffer] Method RTCPeerConnection.addTransceiver() is NOT available; using LEGACY offerToReceive{Audio,Video}"),[2,this.createOfferLegacy()];if(p.debug("[createOffer] Method RTCPeerConnection.addTransceiver() is available; using it"),!("recvonly"!==this.configuration.mode))return[3,7];if(!this.configuration.mediaStream)throw Error("[WebRtcPeer.createOffer] Direction is '".concat(this.configuration.mode,"', but no stream was configured to be sent"));s=0,d=this.configuration.mediaStream.getTracks(),a.label=1;case 1:if(!(s<d.length))return[3,6];if(l=d[s],h={direction:this.configuration.mode,streams:[this.configuration.mediaStream]},"video"===l.kind&&this.configuration.simulcast)for(f=l.getSettings(),m=l.getConstraints(),v=null!==(n=null!==(t=null!==(e=f.width)&&void 0!==e?e:m.width.ideal)&&void 0!==t?t:m.width)&&void 0!==n?n:0,g=null!==(o=null!==(i=null!==(r=f.height)&&void 0!==r?r:m.height.ideal)&&void 0!==i?i:m.height)&&void 0!==o?o:0,p.info("[createOffer] Video track dimensions: ".concat(v,"x").concat(g)),y=0,y=(b=v*g)>=518400?3:b>=129600?2:1,h.sendEncodings=[],E=0;E<y;E++)w={rid:"rdiv"+(S=Math.pow(2,y-E-1)).toString(),scalabilityMode:"L1T1"},["detail","text"].includes(l.contentHint)?(w.scaleResolutionDownBy=1,w.maxFramerate=Math.floor(30/S)):w.scaleResolutionDownBy=S,h.sendEncodings.push(w);if(O=this.pc.addTransceiver(l,h),"video"!==l.kind||(C=O.sender.getParameters(),_=!1,(null===(c=C.degradationPreference)||void 0===c?void 0:c.length)||(["detail","text"].includes(l.contentHint)?C.degradationPreference="maintain-resolution":C.degradationPreference="balanced",p.info("[createOffer] Video sender Degradation Preference set: ".concat(C.degradationPreference)),_=!0),this.configuration.simulcast&&(null===(u=C.encodings)||void 0===u?void 0:u.length)!==h.sendEncodings.length&&(C.encodings=h.sendEncodings,_=!0),!_))return[3,5];p.debug("[createOffer] Setting new RTCRtpSendParameters to video sender"),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,O.sender.setParameters(C)];case 3:return a.sent(),[3,5];case 4:throw I=a.sent(),R="[WebRtcPeer.createOffer] Cannot set RTCRtpSendParameters to video sender",I instanceof Error&&(R+=": ".concat(I.message)),Error(R);case 5:return s++,[3,1];case 6:return[3,8];case 7:for(T=0,k=["audio","video"];T<k.length;T++)x=k[T],this.configuration.mediaConstraints[x]&&(this.configuration.mediaStream=new MediaStream,this.pc.addTransceiver(x,{direction:this.configuration.mode,streams:[this.configuration.mediaStream]}));a.label=8;case 8:return a.trys.push([8,10,,11]),[4,this.pc.createOffer()];case 9:return P=a.sent(),[3,11];case 10:throw N=a.sent(),R="[WebRtcPeer.createOffer] Browser failed creating an SDP Offer",N instanceof Error&&(R+=": ".concat(N.message)),Error(R);case 11:return[2,P]}})})},e.prototype.deprecatedPeerConnectionTrackApi=function(){for(var e=0,t=this.configuration.mediaStream.getTracks();e<t.length;e++){var n=t[e];this.pc.addTrack(n,this.configuration.mediaStream)}},e.prototype.createAnswer=function(){var e=this;return new Promise(function(t,n){if("getTransceivers"in e.pc){p.debug("[createAnswer] Method RTCPeerConnection.getTransceivers() is available; using it");for(var r=function(t){if(!e.configuration.mediaConstraints[t])return"continue";var r=e.pc.getTransceivers().find(function(e){return e.receiver.track.kind===t});if(!r)return{value:n(Error("".concat(t," requested, but no transceiver was created from remote description")))};r.direction=e.configuration.mode},i=0,o=["audio","video"];i<o.length;i++){var s=r(o[i]);if("object"==typeof s)return s.value}e.pc.createAnswer().then(function(e){return t(e)}).catch(function(e){return n(e)})}else{var a=void 0;if(e.configuration.mediaConstraints){var c={offerToReceiveAudio:"boolean"!=typeof e.configuration.mediaConstraints.audio||e.configuration.mediaConstraints.audio,offerToReceiveVideo:"boolean"!=typeof e.configuration.mediaConstraints.video||e.configuration.mediaConstraints.video};e.pc.createAnswer(c).then(function(e){return t(e)}).catch(function(e){return n(e)})}}})},e.prototype.processLocalOffer=function(e){var t=this;return new Promise(function(n,r){t.pc.setLocalDescription(e).then(function(){var e=t.pc.localDescription;return e?(p.debug("Local description set",e.sdp),n()):r("Local description is not defined")}).catch(function(e){return r(e)})})},e.prototype.processRemoteOffer=function(e){var t=this;return new Promise(function(n,r){var i={type:"offer",sdp:e};if(p.debug("SDP offer received, setting remote description",i),"closed"===t.pc.signalingState)return r("RTCPeerConnection is closed when trying to set remote description");t.setRemoteDescription(i).then(function(){return n()}).catch(function(e){return r(e)})})},e.prototype.processLocalAnswer=function(e){var t=this;return new Promise(function(n,r){if(p.debug("SDP answer created, setting local description"),"closed"===t.pc.signalingState)return r("RTCPeerConnection is closed when trying to set local description");t.pc.setLocalDescription(e).then(function(){return n()}).catch(function(e){return r(e)})})},e.prototype.processRemoteAnswer=function(e){var t=this;return new Promise(function(n,r){if(p.debug("SDP answer received, setting remote description"),"closed"===t.pc.signalingState)return r("RTCPeerConnection is closed when trying to set remote description");t.setRemoteDescription({type:"answer",sdp:e}).then(function(){n()}).catch(function(e){return r(e)})})},e.prototype.setRemoteDescription=function(e){return s(this,void 0,void 0,function(){return a(this,function(t){return[2,this.pc.setRemoteDescription(e)]})})},e.prototype.addIceCandidate=function(e){var t=this;return new Promise(function(n,r){switch(p.debug("Remote ICE candidate received",e),t.remoteCandidatesQueue.push(e),t.pc.signalingState){case"closed":r(Error("PeerConnection object is closed"));break;case"stable":t.pc.remoteDescription?t.pc.addIceCandidate(e).then(function(){return n()}).catch(function(e){return r(e)}):(t.iceCandidateList.push(e),n());break;default:t.iceCandidateList.push(e),n()}})},e.prototype.addIceConnectionStateChangeListener=function(e){var t=this;this.pc.addEventListener("iceconnectionstatechange",function(){switch(t.pc.iceConnectionState){case"disconnected":var n="IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "disconnected". Possible network disconnection';p.warn(n),t.configuration.onIceConnectionStateException(d.ExceptionEventName.ICE_CONNECTION_DISCONNECTED,n);break;case"failed":var r="IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') to "failed"';p.error(r),t.configuration.onIceConnectionStateException(d.ExceptionEventName.ICE_CONNECTION_FAILED,r);break;case"closed":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "closed"');break;case"new":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "new"');break;case"checking":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "checking"');break;case"connected":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "connected"');break;case"completed":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "completed"')}})},e.prototype.generateUniqueId=function(){return(0,u.v4)()},e}();t.WebRtcPeer=f;var m=function(e){function t(t){return t.mode="recvonly",e.call(this,t)||this}return i(t,e),t}(f);t.WebRtcPeerRecvonly=m;var v=function(e){function t(t){return t.mode="sendonly",e.call(this,t)||this}return i(t,e),t}(f);t.WebRtcPeerSendonly=v;var g=function(e){function t(t){return t.mode="sendrecv",e.call(this,t)||this}return i(t,e),t}(f);t.WebRtcPeerSendrecv=g},9509:function(e,t,n){"use strict";var r,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRtcStats=void 0;var s=n(5995),a=n(909),c=s.OpenViduLogger.getInstance(),u=function(){function e(e){this.stream=e,this.STATS_ITEM_NAME="webrtc-stats-config",this.webRtcStatsEnabled=!1,this.statsInterval=1,r=a.PlatformUtils.getInstance()}return e.prototype.isEnabled=function(){return this.webRtcStatsEnabled},e.prototype.initWebRtcStats=function(){var e,t=this;try{e=localStorage.getItem(this.STATS_ITEM_NAME)}catch(e){}if(e){this.webRtcStatsEnabled=!0;var n=JSON.parse(e);c.warn("WebRtc stats enabled for stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId),c.warn("localStorage item: "+JSON.stringify(n)),this.POST_URL=n.httpEndpoint,this.statsInterval=n.interval,this.webRtcStatsIntervalId=setInterval(function(){return i(t,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.sendStatsToHttpEndpoint()];case 1:return e.sent(),[2]}})})},1e3*this.statsInterval)}else c.debug("WebRtc stats not enabled")},e.prototype.getSelectedIceCandidateInfo=function(){var e=this;return new Promise(function(t,n){return i(e,void 0,void 0,function(){var e,n,i,s,a,c,u,d,l,h,p,f,m,v,g,b,y,E,S,w,O;return o(this,function(o){switch(o.label){case 0:return[4,this.stream.getRTCPeerConnection().getStats()];case 1:if(e=o.sent(),i=new Map,s=new Map,a=new Map,e.forEach(function(e){switch("transport"===e.type&&(r.isChromium()||r.isSafariBrowser()||r.isReactNative())&&(n=e),e.type){case"candidate-pair":i.set(e.id,e);break;case"local-candidate":s.set(e.id,e);break;case"remote-candidate":a.set(e.id,e)}}),null!=n)u=n.selectedCandidatePairId,c=i.get(u);else for(h=0,d=i.size,l=i.values();h<d;h++)if((p=l.next().value).selected){c=p;break}if(f=c.localCandidateId,m=c.remoteCandidateId,v=s.get(f))for(b=0,g=this.stream.getLocalIceCandidateList().filter(function(e){return!!e.candidate&&(e.candidate.indexOf(v.ip)>=0||e.candidate.indexOf(v.address)>=0)&&e.candidate.indexOf(v.port)>=0}),v.raw=[],y=g;b<y.length;b++)E=y[b],v.raw.push(E.candidate);else v="ERROR: No active local ICE candidate. Probably ICE-TCP is being used";if(S=a.get(m))for(w=0,g=this.stream.getRemoteIceCandidateList().filter(function(e){return!!e.candidate&&(e.candidate.indexOf(S.ip)>=0||e.candidate.indexOf(S.address)>=0)&&e.candidate.indexOf(S.port)>=0}),S.raw=[],O=g;w<O.length;w++)E=O[w],S.raw.push(E.candidate);else S="ERROR: No active remote ICE candidate. Probably ICE-TCP is being used";return[2,t({localCandidate:v,remoteCandidate:S})]}})})})},e.prototype.stopWebRtcStats=function(){this.webRtcStatsEnabled&&(clearInterval(this.webRtcStatsIntervalId),c.warn("WebRtc stats stopped for disposed stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId))},e.prototype.sendStats=function(e,t){return i(this,void 0,void 0,function(){var n,r;return o(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),n={headers:{"Content-type":"application/json"},body:JSON.stringify(t),method:"POST"},[4,fetch(e,n)];case 1:return i.sent(),[3,3];case 2:return r=i.sent(),c.error("sendStats error: ".concat(JSON.stringify(r))),[3,3];case 3:return[2]}})})},e.prototype.sendStatsToHttpEndpoint=function(){return i(this,void 0,void 0,function(){var e,t,n;return o(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this.getCommonStats()];case 1:return e=r.sent(),t=this.generateJSONStatsResponse(e),[4,this.sendStats(this.POST_URL,t)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),c.log(n),[3,4];case 4:return[2]}})})},e.prototype.getCommonStats=function(){return i(this,void 0,void 0,function(){var e=this;return o(this,function(t){return[2,new Promise(function(t,n){return i(e,void 0,void 0,function(){var e,r,i,s,a,u=this;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.stream.getRTCPeerConnection().getStats()];case 1:return e=o.sent(),r=this.getWebRtcStatsResponseOutline(),i=["framesReceived","framesDropped","framesSent","frameHeight","frameWidth"],s=["availableOutgoingBitrate","currentRoundTripTime"],e.forEach(function(e){var t=null!=e.mediaType?e.mediaType:e.kind,n=function(n,o){null!=e[o]&&null!=r[n]&&(!t&&i.indexOf(o)>-1&&(t="video"),null!=n&&null!=t&&null!=o&&null!=r[n][t]?r[n][t][o]=Number(e[o]):null!=n&&null!=o&&s.includes(o)&&(r[n][o]=Number(e[o])))};switch(e.type){case"outbound-rtp":n("outbound","bytesSent"),n("outbound","packetsSent"),n("outbound","framesEncoded"),n("outbound","nackCount"),n("outbound","firCount"),n("outbound","pliCount"),n("outbound","qpSum");break;case"inbound-rtp":n("inbound","bytesReceived"),n("inbound","packetsReceived"),n("inbound","packetsLost"),n("inbound","jitter"),n("inbound","framesDecoded"),n("inbound","nackCount"),n("inbound","firCount"),n("inbound","pliCount");break;case"track":n("inbound","jitterBufferDelay"),n("inbound","framesReceived"),n("outbound","framesDropped"),n("outbound","framesSent"),n(u.stream.isLocal()?"outbound":"inbound","frameHeight"),n(u.stream.isLocal()?"outbound":"inbound","frameWidth");break;case"candidate-pair":n("candidatepair","currentRoundTripTime"),n("candidatepair","availableOutgoingBitrate")}}),(null==r?void 0:r.candidatepair)&&0!==Object.keys(r.candidatepair).length||delete r.candidatepair,[2,t(r)];case 2:return a=o.sent(),c.error("Error getting common stats: ",a),[2,n(a)];case 3:return[2]}})})})]})})},e.prototype.generateJSONStatsResponse=function(e){return{"@timestamp":new Date().toISOString(),participant_id:this.stream.connection.data,session_id:this.stream.session.sessionId,platform:r.getName(),platform_description:r.getDescription(),stream:"webRTC",webrtc_stats:e}},e.prototype.getWebRtcStatsResponseOutline=function(){return this.stream.isLocal()?{outbound:{audio:{},video:{}},candidatepair:{}}:{inbound:{audio:{},video:{}}}},e}();t.WebRtcStats=u},3415:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=void 0;var r=n(3639),i=n(5995),o=n(730),s=i.OpenViduLogger.getInstance(),a=function(){function e(e,t){this.session=e,this.disposed=!1;var n="'Connection' created ";t.role?(this.localOptions=t,this.connectionId=this.localOptions.id,this.creationTime=this.localOptions.createdAt,this.data=this.localOptions.metadata,this.rpcSessionId=this.localOptions.sessionId,this.role=this.localOptions.role,this.record=this.localOptions.record,n+="(local)"):(this.remoteOptions=t,this.connectionId=this.remoteOptions.id,this.creationTime=this.remoteOptions.createdAt,this.remoteOptions.metadata&&(this.data=this.remoteOptions.metadata),this.remoteOptions.streams&&this.initRemoteStreams(this.remoteOptions.streams),n+="(remote) with 'connectionId' ["+this.remoteOptions.id+"]"),s.info(n)}return e.prototype.sendIceCandidate=function(e){var t=this;this.disposed?s.warn("Connection ".concat(this.connectionId," disposed when trying to send an ICE candidate. ICE candidate not sent")):(s.debug((this.stream.outboundStreamOpts?"Local":"Remote")+"candidate for"+this.connectionId,e),this.session.openvidu.sendRequest("onIceCandidate",{endpointName:this.connectionId,candidate:e.candidate,sdpMid:e.sdpMid,sdpMLineIndex:e.sdpMLineIndex},function(e,n){e&&(s.error("Error sending ICE candidate: "+JSON.stringify(e)),t.session.emitEvent("exception",[new o.ExceptionEvent(t.session,o.ExceptionEventName.ICE_CANDIDATE_ERROR,t.session,"There was an unexpected error on the server-side processing an ICE candidate generated and sent by the client-side",e)]))}))},e.prototype.initRemoteStreams=function(e){var t=this;e.forEach(function(e){var n={id:e.id,createdAt:e.createdAt,connection:t,hasAudio:e.hasAudio,hasVideo:e.hasVideo,audioActive:e.audioActive,videoActive:e.videoActive,typeOfVideo:e.typeOfVideo,frameRate:e.frameRate,videoDimensions:e.videoDimensions?JSON.parse(e.videoDimensions):void 0,filter:e.filter?e.filter:void 0},i=new r.Stream(t.session,n);t.addStream(i)}),s.info("Remote 'Connection' with 'connectionId' ["+this.connectionId+"] is now configured for receiving Streams with options: ",this.stream.inboundStreamOpts)},e.prototype.addStream=function(e){e.connection=this,this.stream=e},e.prototype.removeStream=function(){delete this.stream},e.prototype.dispose=function(){this.disposed=!0,this.removeStream()},e}();t.Connection=a},9009:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventDispatcher=void 0;var r=n(5995),i=n(6419),o=r.OpenViduLogger.getInstance(),s=function(){function e(){this.userHandlerArrowHandler=new WeakMap,this.ee=new i}return e.prototype.onAux=function(e,t,n){var r=function(e){e?o.debug(t,e):o.debug(t),n(e)};return this.userHandlerArrowHandler.set(n,r),this.ee.on(e,r),this},e.prototype.onceAux=function(e,t,n){var r=this,i=function(e){e?o.debug(t,e):o.debug(t),n(e),r.userHandlerArrowHandler.delete(n)};return this.userHandlerArrowHandler.set(n,i),this.ee.once(e,i),this},e.prototype.offAux=function(e,t){if(t){var n=this.userHandlerArrowHandler.get(t);n&&this.ee.off(e,n),this.userHandlerArrowHandler.delete(t)}else this.ee.removeAllListeners(e);return this},e}();t.EventDispatcher=s},2666:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Filter=void 0;var r=n(3867),i=n(5512),o=n(5995).OpenViduLogger.getInstance(),s=function(){function e(e,t){this.handlers=new Map,this.type=e,this.options=t}return e.prototype.execMethod=function(e,t){var n=this;return new Promise(function(s,a){o.info("Executing filter method to stream "+n.stream.streamId);var c,u,d=function(t){o.info("Filter method successfully executed on Stream "+n.stream.streamId);var i=Object.assign({},n.stream.filter);return n.stream.filter.lastExecMethod={method:e,params:u},t&&(n.stream.session.emitEvent("streamPropertyChanged",[new r.StreamPropertyChangedEvent(n.stream.session,n.stream,"filter",n.stream.filter,i,"execFilterMethod")]),n.stream.streamManager.emitEvent("streamPropertyChanged",[new r.StreamPropertyChangedEvent(n.stream.streamManager,n.stream,"filter",n.stream.filter,i,"execFilterMethod")])),s()};if(n.type.startsWith("VB:")){if("string"==typeof t)try{t=JSON.parse(t)}catch(e){return a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"Wrong params syntax: "+e))}if(u=t,"update"!==e)return a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,'Unknown Virtual Background method "'.concat(e,'"')));if(!(null===(c=n.stream.virtualBackgroundSinkElements)||void 0===c?void 0:c.VB))return a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"There is no Virtual Background filter applied"));n.stream.virtualBackgroundSinkElements.VB.updateValues(t).then(function(){return d(!1)}).catch(function(e){return e.name===i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR?a(new i.OpenViduError(e.name,e.message)):a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"Error updating values on Virtual Background filter: "+e))})}else{var l=void 0;if("string"!=typeof t)try{l=JSON.stringify(t)}catch(e){var h="'params' property must be a JSON formatted object";return o.error(h),a(h)}else l=t;u=l,n.stream.session.openvidu.sendRequest("execFilterMethod",{streamId:n.stream.streamId,method:e,params:l},function(e,t){return e?(o.error("Error executing filter method for Stream "+n.stream.streamId,e),401===e.code)?a(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to execute a filter method")):a(e):d(!0)})}})},e.prototype.addEventListener=function(e,t){var n=this;return new Promise(function(r,s){o.info("Adding filter event listener to event "+e+" to stream "+n.stream.streamId),n.stream.session.openvidu.sendRequest("addFilterEventListener",{streamId:n.stream.streamId,eventType:e},function(a,c){return a?(o.error("Error adding filter event listener to event "+e+"for Stream "+n.stream.streamId,a),401===a.code)?s(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):s(a):(n.handlers.set(e,t),o.info("Filter event listener to event "+e+" successfully applied on Stream "+n.stream.streamId),r())})})},e.prototype.removeEventListener=function(e){var t=this;return new Promise(function(n,r){o.info("Removing filter event listener to event "+e+" to stream "+t.stream.streamId),t.stream.session.openvidu.sendRequest("removeFilterEventListener",{streamId:t.stream.streamId,eventType:e},function(s,a){return s?(o.error("Error removing filter event listener to event "+e+"for Stream "+t.stream.streamId,s),401===s.code)?r(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):r(s):(t.handlers.delete(e),o.info("Filter event listener to event "+e+" successfully removed on Stream "+t.stream.streamId),n())})})},e}();t.Filter=s},7391:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalRecorder=void 0;var r,i=n(2767),o=n(5995),s=n(909),a=n(8499),c=o.OpenViduLogger.getInstance(),u=function(){function e(e){this.stream=e,this.chunks=[],r=s.PlatformUtils.getInstance(),this.connectionId=this.stream.connection?this.stream.connection.connectionId:"default-connection",this.id=this.stream.streamId+"_"+this.connectionId+"_localrecord",this.state=i.LocalRecorderState.READY}return e.prototype.record=function(e){var t=this;return new Promise(function(n,r){try{if("string"==typeof e||e instanceof String)return r("When calling LocalRecorder.record(options) parameter 'options' cannot be a string. Must be an object like { mimeType: \"".concat(e,'" }'));if("undefined"==typeof MediaRecorder)throw c.error("MediaRecorder not supported on your device. See compatibility in https://caniuse.com/#search=MediaRecorder"),Error("MediaRecorder not supported on your device. See compatibility in https://caniuse.com/#search=MediaRecorder");if(t.state!==i.LocalRecorderState.READY)throw Error("'LocalRecord.record()' needs 'LocalRecord.state' to be 'READY' (current value: '"+t.state+"'). Call 'LocalRecorder.clean()' or init a new LocalRecorder before");c.log("Starting local recording of stream '"+t.stream.streamId+"' of connection '"+t.connectionId+"'"),e?e.mimeType||(e.mimeType="video/webm"):e={mimeType:"video/webm"},t.mediaRecorder=new MediaRecorder(t.stream.getMediaStream(),e),t.mediaRecorder.start()}catch(e){return r(e)}return t.mediaRecorder.ondataavailable=function(e){e.data.size>0&&t.chunks.push(e.data)},t.mediaRecorder.onerror=function(e){c.error("MediaRecorder error: ",e)},t.mediaRecorder.onstart=function(){c.log("MediaRecorder started (state="+t.mediaRecorder.state+")")},t.mediaRecorder.onstop=function(){t.onStopDefault()},t.mediaRecorder.onpause=function(){c.log("MediaRecorder paused (state="+t.mediaRecorder.state+")")},t.mediaRecorder.onresume=function(){c.log("MediaRecorder resumed (state="+t.mediaRecorder.state+")")},t.state=i.LocalRecorderState.RECORDING,n()})},e.prototype.stop=function(){var e=this;return new Promise(function(t,n){try{if(e.state===i.LocalRecorderState.READY||e.state===i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.stop()' needs 'LocalRecord.state' to be 'RECORDING' or 'PAUSED' (current value: '"+e.state+"'). Call 'LocalRecorder.start()' before");e.mediaRecorder.onstop=function(){return e.onStopDefault(),t()},e.mediaRecorder.stop()}catch(e){return n(e)}})},e.prototype.pause=function(){var e=this;return new Promise(function(t,n){try{if(e.state!==i.LocalRecorderState.RECORDING)return n(Error("'LocalRecord.pause()' needs 'LocalRecord.state' to be 'RECORDING' (current value: '"+e.state+"'). Call 'LocalRecorder.start()' or 'LocalRecorder.resume()' before"));return e.mediaRecorder.pause(),e.state=i.LocalRecorderState.PAUSED,t()}catch(e){return n(e)}})},e.prototype.resume=function(){var e=this;return new Promise(function(t,n){try{if(e.state!==i.LocalRecorderState.PAUSED)throw Error("'LocalRecord.resume()' needs 'LocalRecord.state' to be 'PAUSED' (current value: '"+e.state+"'). Call 'LocalRecorder.pause()' before");return e.mediaRecorder.resume(),e.state=i.LocalRecorderState.RECORDING,t()}catch(e){return n(e)}})},e.prototype.preview=function(e){if(this.state!==i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.preview()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");if(this.videoPreview=document.createElement("video"),this.videoPreview.id=this.id,this.videoPreview.autoplay=!0,r.isSafariBrowser()&&(this.videoPreview.playsInline=!0),"string"==typeof e){var t=document.getElementById(e);t&&(this.videoPreview=t.appendChild(this.videoPreview))}else this.videoPreview=e.appendChild(this.videoPreview);return this.videoPreview.src=this.videoPreviewSrc,this.videoPreview},e.prototype.clean=function(){var e=this,t=function(){delete e.blob,e.chunks=[],e.state=i.LocalRecorderState.READY};this.state===i.LocalRecorderState.RECORDING||this.state===i.LocalRecorderState.PAUSED?this.stop().then(function(){return t()}).catch(function(){return t()}):t()},e.prototype.download=function(){if(this.state!==i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.download()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");var e=document.createElement("a");e.style.display="none",document.body.appendChild(e);var t=globalThis.URL.createObjectURL(this.blob);e.href=t,e.download=this.id+"."+a.getExtension(this.blob.type),e.click(),globalThis.URL.revokeObjectURL(t),document.body.removeChild(e)},e.prototype.getBlob=function(){if(this.state===i.LocalRecorderState.FINISHED)return this.blob;throw Error("Call 'LocalRecord.stop()' before getting Blob file")},e.prototype.uploadAsBinary=function(e,t){var n=this;return new Promise(function(r,o){if(n.state!==i.LocalRecorderState.FINISHED)return o(Error("'LocalRecord.uploadAsBinary()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+n.state+"'). Call 'LocalRecorder.stop()' before"));var s=new XMLHttpRequest;if(s.open("POST",e,!0),"object"==typeof t)for(var a=0,c=Object.keys(t);a<c.length;a++){var u=c[a];s.setRequestHeader(u,t[u])}s.onreadystatechange=function(){if(4===s.readyState)return"2"===s.status.toString().charAt(0)?r(s.responseText):o(s.status)},s.send(n.blob)})},e.prototype.uploadAsMultipartfile=function(e,t){var n=this;return new Promise(function(r,o){if(n.state!==i.LocalRecorderState.FINISHED)return o(Error("'LocalRecord.uploadAsMultipartfile()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+n.state+"'). Call 'LocalRecorder.stop()' before"));var s=new XMLHttpRequest;if(s.open("POST",e,!0),"object"==typeof t)for(var c=0,u=Object.keys(t);c<u.length;c++){var d=u[c];s.setRequestHeader(d,t[d])}var l=new FormData;l.append("file",n.blob,n.id+"."+a.getExtension(n.blob.type)),s.onreadystatechange=function(){if(4===s.readyState)return"2"===s.status.toString().charAt(0)?r(s.responseText):o(s.status)},s.send(l)})},e.prototype.onStopDefault=function(){c.log("MediaRecorder stopped  (state="+this.mediaRecorder.state+")"),this.blob=new Blob(this.chunks,{type:this.mediaRecorder.mimeType}),this.chunks=[],this.videoPreviewSrc=globalThis.URL.createObjectURL(this.blob),this.state=i.LocalRecorderState.FINISHED},e}();t.LocalRecorder=u},8827:function(e,t,n){"use strict";var r,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.OpenVidu=void 0;var s=n(7391),a=n(2079),c=n(7945),u=n(2343),d=n(3867),l=n(5512),h=n(1250),p=n(5995),f=n(909),m=n(3314),v=n(8628),g=n(805),b=n(6419),y=n(5932),E=n(6391),S=p.OpenViduLogger.getInstance(),w=function(){function e(){var e=this;this.masterNodeHasCrashed=!1,this.publishers=[],this.secret="",this.recorder=!1,this.stt=!1,this.life=-1,this.advancedConfiguration={},this.webrtcStatsInterval=-1,this.sendBrowserLogs=g.OpenViduLoggerConfiguration.disabled,this.isAtLeastPro=!1,this.isEnterprise=!1,this.ee=new b,r=f.PlatformUtils.getInstance(),this.libraryVersion=E.version,S.info("OpenVidu initialized"),S.info("Platform detected: "+r.getDescription()),S.info("openvidu-browser version: "+this.libraryVersion),(r.isMobileDevice()||r.isReactNative())&&this.onOrientationChanged(function(){e.publishers.forEach(function(t){t.stream.isLocalStreamPublished&&t.stream&&t.stream.hasVideo&&e.sendNewVideoDimensionsIfRequired(t,"deviceRotated",75,10)})})}return e.prototype.initSession=function(){return this.session=new c.Session(this),this.session},e.prototype.initPublisher=function(e,t,n){r=t&&"function"!=typeof t?{audioSource:void 0!==(r=t).audioSource?r.audioSource:void 0,frameRate:"undefined"!=typeof MediaStreamTrack&&r.videoSource instanceof MediaStreamTrack?void 0:void 0!==r.frameRate?r.frameRate:void 0,insertMode:void 0!==r.insertMode?"string"==typeof r.insertMode?h.VideoInsertMode[r.insertMode]:r.insertMode:h.VideoInsertMode.APPEND,mirror:void 0===r.mirror||r.mirror,publishAudio:void 0===r.publishAudio||r.publishAudio,publishVideo:void 0===r.publishVideo||r.publishVideo,resolution:"undefined"!=typeof MediaStreamTrack&&r.videoSource instanceof MediaStreamTrack?void 0:void 0!==r.resolution?r.resolution:"640x480",videoSource:void 0!==r.videoSource?r.videoSource:void 0,videoSimulcast:r.videoSimulcast,filter:r.filter}:{insertMode:h.VideoInsertMode.APPEND,mirror:!0,publishAudio:!0,publishVideo:!0,resolution:"640x480"};var r,i,o=new a.Publisher(e,r,this);return t&&"function"==typeof t?i=t:n&&(i=n),o.initialize().then(function(){void 0!==i&&i(void 0),o.emitEvent("accessAllowed",[])}).catch(function(e){void 0!==i&&i(e),o.emitEvent("accessDenied",[e])}),this.publishers.push(o),o},e.prototype.initPublisherAsync=function(e,t){var n=this;return new Promise(function(r,i){var o,s=function(e){return e?i(e):r(o)};o=t?n.initPublisher(e,t,s):n.initPublisher(e,s)})},e.prototype.initLocalRecorder=function(e){return new s.LocalRecorder(e)},e.prototype.checkSystemRequirements=function(){return r.isIPhoneOrIPad()?r.isIOSWithSafari()||r.isChromeMobileBrowser()||r.isFirefoxMobileBrowser()||r.isOperaMobileBrowser()||r.isEdgeMobileBrowser()||r.isIonicIos():r.isChromeBrowser()||r.isChromeMobileBrowser()||r.isFirefoxBrowser()||r.isFirefoxMobileBrowser()||r.isOperaBrowser()||r.isOperaMobileBrowser()||r.isEdgeBrowser()||r.isEdgeMobileBrowser()||r.isSamsungBrowser()||r.isSafariBrowser()||r.isAndroidBrowser()||r.isElectron()||r.isNodeJs()||r.isMotorolaEdgeDevice()},e.prototype.checkScreenSharingCapabilities=function(){return r.canScreenShare()},e.prototype.getDevices=function(){return new Promise(function(e,t){navigator.mediaDevices.enumerateDevices().then(function(t){var n,i=[];if(!r.isIonicAndroid()||"undefined"==typeof cordova||null===(n=null==cordova?void 0:cordova.plugins)||void 0===n||!n.EnumerateDevicesPlugin)return t.forEach(function(e){("audioinput"===e.kind||"videoinput"===e.kind)&&i.push({kind:e.kind,deviceId:e.deviceId,label:e.label})}),e(i);cordova.plugins.EnumerateDevicesPlugin.getEnumerateDevices().then(function(n){var r=[],o=[],s=[];return r=n.filter(function(e){return"audioinput"===e.kind}),o=t.filter(function(e){return"videoinput"===e.kind}),s=t.filter(function(e){return"audioinput"===e.kind}),o.forEach(function(e,t){if(e.label)i.push({kind:e.kind,deviceId:e.deviceId,label:e.label});else{var n="";n=0===t?"Front Camera":1===t?"Back Camera":"Unknown Camera",i.push({kind:e.kind,deviceId:e.deviceId,label:n})}}),s.forEach(function(e,t){if(e.label)i.push({kind:e.kind,deviceId:e.deviceId,label:e.label});else{var n="";switch(t){case 0:n="Default";break;case 1:var o=r.filter(function(e){return e.label.includes("Built")})[0];n=o?o.label:"Built-in Microphone";break;case 2:var s=r.filter(function(e){return e.label.includes("Wired")})[0];n=s?s.label:"Headset earpiece";break;case 3:var a=r.filter(function(e){return e.label.includes("Bluetooth")})[0];n=a?a.label:"Wireless";break;default:n="Unknown Microphone"}i.push({kind:e.kind,deviceId:e.deviceId,label:n})}}),e(i)})}).catch(function(e){return S.error("Error getting devices",e),t(e)})})},e.prototype.getUserMedia=function(e){var t,n;return i(this,void 0,void 0,function(){var s,a,c,u,d,h,p,f,m,v=this;return o(this,function(g){switch(g.label){case 0:s=function(e,t){return i(v,void 0,void 0,function(){var n,r,i;return o(this,function(o){switch(o.label){case 0:n={audio:void 0===t.audio||t.audio,video:!1},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(n)];case 2:return r=o.sent(),e.addTrack(r.getAudioTracks()[0]),[2,e];case 3:throw i=o.sent(),e.getAudioTracks().forEach(function(e){e.stop()}),e.getVideoTracks().forEach(function(e){e.stop()}),this.generateAudioDeviceError(i,n);case 4:return[2]}})})},g.label=1;case 1:return g.trys.push([1,20,,21]),[4,this.generateMediaConstraints(e)];case 2:if(!((a=g.sent()).videoTrack&&a.audioTrack||a.audioTrack&&(null===(t=a.constraints)||void 0===t?void 0:t.video)===!1||a.videoTrack&&(null===(n=a.constraints)||void 0===n?void 0:n.audio)===!1))return[3,3];return[2,this.addAlreadyProvidedTracks(a,new MediaStream)];case 3:if(a.videoTrack&&delete a.constraints.video,a.audioTrack&&delete a.constraints.audio,c=!1,"string"!=typeof e.videoSource||!("screen"===e.videoSource||"window"===e.videoSource||r.isElectron()&&e.videoSource.startsWith("screen:")))return[3,12];if(c=!a.audioTrack&&null!==e.audioSource&&!1!==e.audioSource,!(navigator.mediaDevices.getDisplayMedia&&!r.isElectron()))return[3,11];g.label=4;case 4:return g.trys.push([4,9,,10]),[4,navigator.mediaDevices.getDisplayMedia({video:!0,audio:"screen"===e.audioSource})];case 5:if(u=g.sent(),this.addAlreadyProvidedTracks(a,u),!c)return[3,7];return[4,s(u,a.constraints)];case 6:return[2,g.sent()];case 7:return[2,u];case 8:return[3,10];case 9:throw d=g.sent(),h=l.OpenViduErrorName.SCREEN_CAPTURE_DENIED,p=d.toString(),new l.OpenViduError(h,p);case 10:return[3,11];case 11:return[3,12];case 12:f=c?{video:a.constraints.video}:a.constraints,g.label=13;case 13:return g.trys.push([13,18,,19]),[4,navigator.mediaDevices.getUserMedia(f)];case 14:if(u=g.sent(),this.addAlreadyProvidedTracks(a,u),!c)return[3,16];return[4,s(u,a.constraints)];case 15:return[2,g.sent()];case 16:return[2,u];case 17:return[3,19];case 18:throw m=g.sent(),h=void 0,p=m.toString(),h="screen"!==e.videoSource?l.OpenViduErrorName.DEVICE_ACCESS_DENIED:l.OpenViduErrorName.SCREEN_CAPTURE_DENIED,new l.OpenViduError(h,p);case 19:return[3,21];case 20:throw g.sent();case 21:return[2]}})})},e.prototype.enableProdMode=function(){S.enableProdMode()},e.prototype.setAdvancedConfiguration=function(e){this.advancedConfiguration=e},e.prototype.onOrientationChanged=function(e){globalThis.addEventListener("orientationchange",e)},e.prototype.sendNewVideoDimensionsIfRequired=function(e,t,n,r){var i,o,s,a,c=this,u=0,d=(null===(o=null===(i=null==e?void 0:e.stream)||void 0===i?void 0:i.videoDimensions)||void 0===o?void 0:o.width)||0,l=(null===(a=null===(s=null==e?void 0:e.stream)||void 0===s?void 0:s.videoDimensions)||void 0===a?void 0:a.height)||0,h=setInterval(function(){++u>r&&clearTimeout(h),e.getVideoDimensions().then(function(n){(n.width!==d||n.height!==l)&&(clearTimeout(h),c.sendVideoDimensionsChangedEvent(e,t,d,l,n.width,n.height))})},n)},e.prototype.sendVideoDimensionsChangedEvent=function(e,t,n,r,i,o){var s=this;e.stream.videoDimensions={width:i||0,height:o||0},this.sendRequest("streamPropertyChanged",{streamId:e.stream.streamId,property:"videoDimensions",newValue:JSON.stringify(e.stream.videoDimensions),reason:t},function(i,o){i?S.error("Error sending 'streamPropertyChanged' event",i):(s.session.emitEvent("streamPropertyChanged",[new d.StreamPropertyChangedEvent(s.session,e.stream,"videoDimensions",e.stream.videoDimensions,{width:n,height:r},t)]),e.emitEvent("streamPropertyChanged",[new d.StreamPropertyChangedEvent(e,e.stream,"videoDimensions",e.stream.videoDimensions,{width:n,height:r},t)]),s.session.sendVideoData(e))})},e.prototype.sendTrackChangedEvent=function(e,t,n,r){var i=this,o={label:t},s={label:n},a="trackReplaced";e.stream.isLocalStreamPublished?this.sendRequest("streamPropertyChanged",{streamId:e.stream.streamId,property:r,newValue:s,reason:a},function(t,n){t?S.error("Error sending 'streamPropertyChanged' event",t):(i.session.emitEvent("streamPropertyChanged",[new d.StreamPropertyChangedEvent(i.session,e.stream,r,s,o,a)]),e.emitEvent("streamPropertyChanged",[new d.StreamPropertyChangedEvent(e,e.stream,r,s,o,a)]))}):(this.session.emitEvent("streamPropertyChanged",[new d.StreamPropertyChangedEvent(this.session,e.stream,r,s,o,a)]),e.emitEvent("streamPropertyChanged",[new d.StreamPropertyChangedEvent(e,e.stream,r,s,o,a)]))},e.prototype.generateMediaConstraints=function(e){var t=this;return new Promise(function(n,r){var i={audioTrack:void 0,videoTrack:void 0,constraints:{audio:void 0,video:void 0}},o=e.audioSource,s=e.videoSource;if((null===o||!1===o)&&(i.constraints.audio=!1),(null===s||!1===s)&&(i.constraints.video=!1),!1===i.constraints.audio&&!1===i.constraints.video)return r(new l.OpenViduError(l.OpenViduErrorName.NO_INPUT_SOURCE_SET,"Properties 'audioSource' and 'videoSource' cannot be set to false or null at the same time"));if("undefined"!=typeof MediaStreamTrack&&o instanceof MediaStreamTrack&&(i.audioTrack=o),"undefined"!=typeof MediaStreamTrack&&s instanceof MediaStreamTrack&&(i.videoTrack=s),void 0===o&&(i.constraints.audio=!0),void 0===s&&(i.constraints.video={width:{ideal:640},height:{ideal:480}}),null!==s&&!1!==s){if(e.resolution){var a=e.resolution.toLowerCase().split("x"),c=Number(a[0]),u=Number(a[1]);i.constraints.video={width:{ideal:c},height:{ideal:u}}}e.frameRate&&(i.constraints.video.frameRate={ideal:e.frameRate})}return t.configureDeviceIdOrScreensharing(i,e,n,r),n(i)})},e.prototype.startWs=function(e){var t={heartbeat:5e3,ws:{uri:this.wsUri+"?sessionId="+this.session.sessionId,onconnected:e,ondisconnect:this.disconnectCallback.bind(this),onreconnecting:this.reconnectingCallback.bind(this),onreconnected:this.reconnectedCallback.bind(this),ismasternodecrashed:this.isMasterNodeCrashed.bind(this)},rpc:{requestTimeout:1e4,heartbeatRequestTimeout:5e3,participantJoined:this.session.onParticipantJoined.bind(this.session),participantPublished:this.session.onParticipantPublished.bind(this.session),participantUnpublished:this.session.onParticipantUnpublished.bind(this.session),participantLeft:this.session.onParticipantLeft.bind(this.session),participantEvicted:this.session.onParticipantEvicted.bind(this.session),recordingStarted:this.session.onRecordingStarted.bind(this.session),recordingStopped:this.session.onRecordingStopped.bind(this.session),broadcastStarted:this.session.onBroadcastStarted.bind(this.session),broadcastStopped:this.session.onBroadcastStopped.bind(this.session),sendMessage:this.session.onNewMessage.bind(this.session),streamPropertyChanged:this.session.onStreamPropertyChanged.bind(this.session),connectionPropertyChanged:this.session.onConnectionPropertyChanged.bind(this.session),networkQualityLevelChanged:this.session.onNetworkQualityLevelChangedChanged.bind(this.session),filterEventDispatched:this.session.onFilterEventDispatched.bind(this.session),iceCandidate:this.session.recvIceCandidate.bind(this.session),mediaError:this.session.onMediaError.bind(this.session),masterNodeCrashedNotification:this.onMasterNodeCrashedNotification.bind(this),forciblyReconnectSubscriber:this.session.onForciblyReconnectSubscriber.bind(this.session),speechToTextMessage:this.session.onSpeechToTextMessage.bind(this.session),speechToTextDisconnected:this.session.onSpeechToTextDisconnected.bind(this.session)}};this.jsonRpcClient=new y.clients.JsonRpcClient(t)},e.prototype.onMasterNodeCrashedNotification=function(e){console.error("Master Node has crashed"),this.masterNodeHasCrashed=!0,this.session.onLostConnection("nodeCrashed"),this.jsonRpcClient.close(4103,"Master Node has crashed")},e.prototype.getWsReadyState=function(){return this.jsonRpcClient.getReadyState()},e.prototype.closeWs=function(){this.jsonRpcClient.close(4102,"Connection closed by client")},e.prototype.sendRequest=function(e,t,n){var r;t&&t instanceof Function&&(n=t,t={}),S.debug('Sending request: {method:"'+e+'", params: '+JSON.stringify(t)+"}"),null===(r=this.jsonRpcClient)||void 0===r||r.send(e,t,n)},e.prototype.getWsUri=function(){return this.wsUri},e.prototype.getSecret=function(){return this.secret},e.prototype.getRecorder=function(){return this.recorder},e.prototype.getStt=function(){return this.stt},e.prototype.generateAudioDeviceError=function(e,t){var n,r;switch("Error"===e.name&&(e.name=e.constructor.name),e.name.toLowerCase()){case"notfounderror":return n=l.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r=e.toString(),new l.OpenViduError(n,r);case"notallowederror":return n=l.OpenViduErrorName.DEVICE_ACCESS_DENIED,r=e.toString(),new l.OpenViduError(n,r);case"overconstrainederror":return"deviceid"===e.constraint.toLowerCase()?(n=l.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r="Audio input device with deviceId '"+t.audio.deviceId.exact+"' not found"):(n=l.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,r="Audio input device doesn't support the value passed for constraint '"+e.constraint+"'"),new l.OpenViduError(n,r);case"notreadableerror":return n=l.OpenViduErrorName.DEVICE_ALREADY_IN_USE,r=e.toString(),new l.OpenViduError(n,r);default:return new l.OpenViduError(l.OpenViduErrorName.INPUT_AUDIO_DEVICE_GENERIC_ERROR,e.toString())}},e.prototype.addAlreadyProvidedTracks=function(e,t,n){return e.videoTrack&&(t.addTrack(e.videoTrack),n&&(e.constraints.video?n.lastVideoTrackConstraints=e.constraints.video:n.lastVideoTrackConstraints=e.videoTrack.getConstraints())),e.audioTrack&&t.addTrack(e.audioTrack),t},e.prototype.configureDeviceIdOrScreensharing=function(e,t,n,i){var o=this,s=t.audioSource,a=t.videoSource;if("string"==typeof s&&"screen"!==s&&(e.constraints.audio={deviceId:{exact:s}}),"string"==typeof a){if(this.isScreenShare(a)){if(this.checkScreenSharingCapabilities()){if(r.isElectron()){var c="screen:",u=a.substr(a.indexOf(c)+c.length);return e.constraints.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:u}},n(e)}if(!this.advancedConfiguration.screenShareChromeExtension||r.isFirefoxBrowser()||r.isFirefoxMobileBrowser()||navigator.mediaDevices.getDisplayMedia){if(navigator.mediaDevices.getDisplayMedia)return n(e);var d=r.isFirefoxBrowser()||r.isFirefoxMobileBrowser()?t.videoSource:void 0;return void m.getScreenId(d,function(t,r,s){if(!t)return e.constraints.video=s.video,n(e);if("not-installed"===t){var a=o.advancedConfiguration.screenShareChromeExtension?o.advancedConfiguration.screenShareChromeExtension:"https://chrome.google.com/webstore/detail/openvidu-screensharing/lfcgfepafnobdloecchnfaclibenjold",c=new l.OpenViduError(l.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,a);return S.error(c),i(c)}if("installed-disabled"===t){var c=new l.OpenViduError(l.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");return S.error(c),i(c)}if("permission-denied"===t){var c=new l.OpenViduError(l.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");return S.error(c),i(c)}var c=new l.OpenViduError(l.OpenViduErrorName.GENERIC_ERROR,"Unknown error when accessing screen share");return S.error(c),S.error(t),i(c)})}return void v.getScreenConstraints(function(t,r){if(!t&&(!r.mandatory||"screen"!==r.mandatory.chromeMediaSource))return e.constraints.video=r,n(e);if("permission-denied"===t||"PermissionDeniedError"===t){var s=new l.OpenViduError(l.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");return S.error(s),i(s)}var a=o.advancedConfiguration.screenShareChromeExtension.split("/").pop().trim();v.getChromeExtensionStatus(a,function(e){if("installed-disabled"===e){var t=new l.OpenViduError(l.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");return S.error(t),i(t)}if("not-installed"===e){var n=new l.OpenViduError(l.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,o.advancedConfiguration.screenShareChromeExtension);return S.error(n),i(n)}})})}var h=new l.OpenViduError(l.OpenViduErrorName.SCREEN_SHARING_NOT_SUPPORTED,"You can only screen share in desktop Chrome, Firefox, Opera, Safari (>=13.0), Edge (>= 80) or Electron. Detected client: "+r.getName()+" "+r.getVersion());return S.error(h),i(h)}this.setVideoSource(e,a),"screen"===s&&(S.warn('Parameter "audioSource" is set to "screen", which means rquesting audio from screen sharing source. But "videoSource" is not set to "screen". No audio source will be requested'),e.constraints.audio=!1)}},e.prototype.setVideoSource=function(e,t){e.constraints.video||(e.constraints.video={}),e.constraints.video.deviceId={exact:t}},e.prototype.disconnectCallback=function(){S.warn("Websocket connection lost"),this.isRoomAvailable()?this.session.onLostConnection("networkDisconnect"):alert("Connection error. Please reload page.")},e.prototype.reconnectingCallback=function(){S.warn("Websocket connection lost (reconnecting)"),this.isRoomAvailable()?this.session.emitEvent("reconnecting",[]):alert("Connection error. Please reload page.")},e.prototype.reconnectWebsocketThroughRpcConnectMethod=function(e){var t=this;this.sendRequest("connect",{sessionId:e,reconnect:!0},function(e,n){if(e){if(t.isMasterNodeCrashed())S.warn("Master Node has crashed!");else{S.error(e);var r=function(e,n){S.warn(n),t.session.onLostConnection(e),t.jsonRpcClient.close(4101,"Reconnection fault: "+n)};40007===e.code&&"reconnection error"===e.message&&console.error("Invalid RPC sessionId. Client network disconnection or Master Node crash"),-1===t.life?r("networkDisconnect","WS successfully reconnected but the user was already evicted due to timeout"):t.sendRequest("sessionStatus",{sessionId:t.session.sessionId},function(e,n){null!=e?console.error("Error checking session status",e):t.life===n.life?r("networkDisconnect","WS successfully reconnected but the user was already evicted due to timeout"):r("nodeCrashed","WS successfully reconnected to OpenVidu Server but your Master Node crashed")})}}else t.jsonRpcClient.resetPing(),t.session.onRecoveredConnection()})},e.prototype.reconnectedCallback=function(){if(S.warn("Websocket reconnected"),this.isRoomAvailable()){if(this.session.connection)this.reconnectWebsocketThroughRpcConnectMethod(this.session.connection.rpcSessionId);else{S.warn("There was no previous connection when running reconnection callback");var e=new u.SessionDisconnectedEvent(this.session,"networkDisconnect");this.session.ee.emitEvent("sessionDisconnected",[e]),e.callDefaultBehavior()}}else alert("Connection error. Please reload page.")},e.prototype.isMasterNodeCrashed=function(){return this.masterNodeHasCrashed},e.prototype.isRoomAvailable=function(){return void 0!==this.session&&this.session instanceof c.Session||(S.warn("Session instance not found"),!1)},e.prototype.isScreenShare=function(e){return"screen"===e||"window"===e||r.isElectron()&&e.startsWith("screen:")},e}();t.OpenVidu=w},2079:function(e,t,n){"use strict";var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Publisher=void 0;var c=n(7945),u=n(3639),d=n(1323),l=n(702),h=n(3867),p=n(5512),f=n(5995),m=n(909),v=n(4e3),g=f.OpenViduLogger.getInstance(),b=function(e){function t(t,n,r){var o=e.call(this,new u.Stream(r.session?r.session:new c.Session(r),{publisherProperties:n,mediaConstraints:{}}),t)||this;return o.accessAllowed=!1,o.isSubscribedToRemote=!1,o.accessDenied=!1,i=m.PlatformUtils.getInstance(),o.properties=n,o.openvidu=r,o.stream.ee.on("local-stream-destroyed",function(e){o.stream.isLocalStreamPublished=!1;var t=new l.StreamEvent(!0,o,"streamDestroyed",o.stream,e);o.emitEvent("streamDestroyed",[t]),t.callDefaultBehavior()}),o}return o(t,e),t.prototype.publishAudio=function(e){var t=this;this.stream.audioActive!==e&&((this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream()).getAudioTracks().forEach(function(t){t.enabled=e}),this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"audioActive",newValue:e,reason:"publishAudio"},function(n,r){n?g.error("Error sending 'streamPropertyChanged' event",n):(t.session.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(t.session,t.stream,"audioActive",e,!e,"publishAudio")]),t.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(t,t.stream,"audioActive",e,!e,"publishAudio")]),t.session.sendVideoData(t.stream.streamManager))}),this.stream.audioActive=e,g.info("'Publisher' has "+(e?"published":"unpublished")+" its audio stream"))},t.prototype.publishVideo=function(e,t){var n=this;return new Promise(function(r,i){return s(n,void 0,void 0,function(){var n,o,c,u,d,l=this;return a(this,function(p){switch(p.label){case 0:if(!(this.stream.videoActive!==e))return[3,9];if(n=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream(),o=!1,n.getVideoTracks().forEach(function(n){n.enabled=e,e||!0!==t?e&&"ended"===n.readyState&&(o=!0):n.stop()}),!(!e&&!0===t&&this.stream.filter&&this.stream.filter.type.startsWith("VB:")))return[3,2];return this.stream.lastVBFilter=this.stream.filter,[4,this.stream.removeFilterAux(!0)];case 1:p.sent(),p.label=2;case 2:if(!o)return[3,8];if(c=n.getVideoTracks()[0],n.removeTrack(c),u=function(e){return s(l,void 0,void 0,function(){var t=this;return a(this,function(r){switch(r.label){case 0:if(n.addTrack(e),!this.stream.isLocalStreamPublished)return[3,2];return[4,this.replaceTrackInRtcRtpSender(e)];case 1:r.sent(),r.label=2;case 2:return this.stream.lastVBFilter&&setTimeout(function(){return s(t,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:return e=this.stream.lastVBFilter.options,(t=this.stream.lastVBFilter.lastExecMethod)&&"update"===t.method&&(e=Object.assign({},e,t.params)),[4,this.stream.applyFilter(this.stream.lastVBFilter.type,e)];case 1:return n.sent(),delete this.stream.lastVBFilter,[2]}})})},1),[2]}})})},!(t&&t instanceof MediaStreamTrack))return[3,4];return[4,u(t)];case 3:case 6:return p.sent(),[3,8];case 4:return p.trys.push([4,7,,8]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:this.stream.lastVideoTrackConstraints})];case 5:return d=p.sent(),[4,u(d.getVideoTracks()[0])];case 7:return[2,i(p.sent())];case 8:return this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"videoActive",newValue:e,reason:"publishVideo"},function(t,n){t?g.error("Error sending 'streamPropertyChanged' event",t):(l.session.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(l.session,l.stream,"videoActive",e,!e,"publishVideo")]),l.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(l,l.stream,"videoActive",e,!e,"publishVideo")]),l.session.sendVideoData(l.stream.streamManager))}),this.stream.videoActive=e,g.info("'Publisher' has "+(e?"published":"unpublished")+" its video stream"),[2,r()];case 9:return[2]}})})})},t.prototype.subscribeToRemote=function(e){e=void 0===e||e,this.isSubscribedToRemote=e,this.stream.subscribeToMyRemote(e)},t.prototype.on=function(t,n){var r=this;return e.prototype.on.call(this,t,n),"streamCreated"===t&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new l.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.on("stream-created-by-publisher",function(){r.emitEvent("streamCreated",[new l.StreamEvent(!1,r,"streamCreated",r.stream,"")])})),"accessAllowed"===t&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),"accessDenied"===t&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},t.prototype.once=function(t,n){var r=this;return e.prototype.once.call(this,t,n),"streamCreated"===t&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new l.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.once("stream-created-by-publisher",function(){r.emitEvent("streamCreated",[new l.StreamEvent(!1,r,"streamCreated",r.stream,"")])})),"accessAllowed"===t&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),"accessDenied"===t&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},t.prototype.off=function(t,n){return e.prototype.off.call(this,t,n),this},t.prototype.replaceTrack=function(e){return s(this,void 0,void 0,function(){return a(this,function(t){return[2,this.replaceTrackAux(e,!0)]})})},t.prototype.initialize=function(){var e=this;return new Promise(function(t,n){return s(e,void 0,void 0,function(){var e,r,o,c,u,d,l,h,f,m,b,y,E,S,w,O,C=this;return a(this,function(_){switch(_.label){case 0:e={},r={},o=2e3,u=function(e){return C.accessDenied=!0,C.accessAllowed=!1,g.error("Publisher initialization failed. ".concat(e.name,": ").concat(e.message)),n(e)},d=function(e){var n,r;if(C.accessAllowed=!0,C.accessDenied=!1,"undefined"!=typeof MediaStreamTrack&&C.properties.audioSource instanceof MediaStreamTrack&&(e.removeTrack(e.getAudioTracks()[0]),e.addTrack(C.properties.audioSource)),"undefined"!=typeof MediaStreamTrack&&C.properties.videoSource instanceof MediaStreamTrack&&(e.removeTrack(e.getVideoTracks()[0]),e.addTrack(C.properties.videoSource)),e.getAudioTracks()[0]){var i=void 0!==C.stream.audioActive&&null!==C.stream.audioActive?C.stream.audioActive:!!C.stream.outboundStreamOpts.publisherProperties.publishAudio;e.getAudioTracks()[0].enabled=i}if(e.getVideoTracks()[0]){var i=void 0!==C.stream.videoActive&&null!==C.stream.videoActive?C.stream.videoActive:!!C.stream.outboundStreamOpts.publisherProperties.publishVideo;e.getVideoTracks()[0].enabled=i}for(var o=0,s=e.getAudioTracks();o<s.length;o++){var a=s[o];(null===(n=a.contentHint)||void 0===n?void 0:n.length)||(a.contentHint="",g.info("Audio track Content Hint set: '".concat(a.contentHint,"'")))}for(var c=0,u=e.getVideoTracks();c<u.length;c++){var a=u[c];if(!(null===(r=a.contentHint)||void 0===r?void 0:r.length)){switch(C.stream.typeOfVideo){case v.TypeOfVideo.SCREEN:a.contentHint="detail";break;case v.TypeOfVideo.CUSTOM:g.warn("CUSTOM type video track was provided without Content Hint!"),a.contentHint="motion";break;case v.TypeOfVideo.CAMERA:case v.TypeOfVideo.IPCAM:default:a.contentHint="motion"}g.info("Video track Content Hint set: '".concat(a.contentHint,"'"))}}return C.initializeVideoReference(e),C.stream.displayMyRemote()||C.stream.updateMediaStreamInVideos(),delete C.firstVideoElement,C.stream.isSendVideo()?C.getVideoDimensions().then(function(t){C.stream.videoDimensions={width:t.width,height:t.height},C.stream.isSendScreen()&&(C.stream.isSendAudio()&&0===e.getAudioTracks().length&&(C.stream.audioActive=!1,C.stream.hasAudio=!1,C.stream.outboundStreamOpts.publisherProperties.publishAudio=!1,C.stream.outboundStreamOpts.publisherProperties.audioSource=!1),C.screenShareResizeInterval=setInterval(function(){var t=e.getVideoTracks()[0].getSettings(),n=t.width,r=t.height,i=null!=n&&n!==C.stream.videoDimensions.width,o=null!=r&&r!==C.stream.videoDimensions.height;C.stream.isLocalStreamPublished&&(i||o)&&C.openvidu.sendVideoDimensionsChangedEvent(C,"screenResized",C.stream.videoDimensions.width,C.stream.videoDimensions.height,n||0,r||0)},650)),C.stream.isLocalStreamReadyToPublish=!0,C.stream.ee.emitEvent("stream-ready-to-publish",[])}):(C.stream.isLocalStreamReadyToPublish=!0,C.stream.ee.emitEvent("stream-ready-to-publish",[])),t()},l=function(t,n){return s(C,void 0,void 0,function(){var i,s;return a(this,function(a){switch(a.label){case 0:if(this.clearPermissionDialogTimer(c,o),!(this.stream.isSendScreen()&&"screen"!==this.properties.audioSource&&this.stream.isSendAudio()))return[3,5];r.audio=n,r.video=!1,c=Date.now(),this.setPermissionDialogTimer(o),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(r)];case 2:return i=a.sent(),this.clearPermissionDialogTimer(c,o),t.addTrack(i.getAudioTracks()[0]),d(t),[3,4];case 3:return s=a.sent(),this.clearPermissionDialogTimer(c,o),t.getAudioTracks().forEach(function(e){e.stop()}),t.getVideoTracks().forEach(function(e){e.stop()}),u(this.openvidu.generateAudioDeviceError(s,e)),[2];case 4:return[3,6];case 5:d(t),a.label=6;case 6:return[2]}})})},h=function(t){return s(C,void 0,void 0,function(){var n,r,i,s;return a(this,function(a){switch(a.label){case 0:switch(g.error("getMediaError: ".concat(t.toString())),this.clearPermissionDialogTimer(c,o),"Error"===t.name&&(t.name=t.constructor.name),t.name.toLowerCase()){case"notfounderror":return[3,1];case"notallowederror":return[3,5];case"overconstrainederror":return[3,6];case"aborterror":case"notreadableerror":return[3,10]}return[3,11];case 1:return a.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:e.video})];case 2:return a.sent().getVideoTracks().forEach(function(e){e.stop()}),n=p.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r=t.toString(),u(new p.OpenViduError(n,r)),[3,4];case 3:return i=a.sent(),n=p.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,r=i.toString(),u(new p.OpenViduError(n,r)),[3,4];case 4:case 9:return[3,12];case 5:return n=this.stream.isSendScreen()?p.OpenViduErrorName.SCREEN_CAPTURE_DENIED:p.OpenViduErrorName.DEVICE_ACCESS_DENIED,r=t.toString(),u(new p.OpenViduError(n,r)),[3,12];case 6:return a.trys.push([6,8,,9]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:e.video})];case 7:return a.sent().getVideoTracks().forEach(function(e){e.stop()}),"deviceid"===t.constraint.toLowerCase()?(n=p.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r="Audio input device with deviceId '"+e.audio.deviceId.exact+"' not found"):(n=p.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,r="Audio input device doesn't support the value passed for constraint '"+t.constraint+"'"),u(new p.OpenViduError(n,r)),[3,9];case 8:return"deviceid"===(s=a.sent()).constraint.toLowerCase()?(n=p.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,r="Video input device with deviceId '"+e.video.deviceId.exact+"' not found"):(n=p.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,r="Video input device doesn't support the value passed for constraint '"+s.constraint+"'"),u(new p.OpenViduError(n,r)),[3,9];case 10:return n=p.OpenViduErrorName.DEVICE_ALREADY_IN_USE,r=t.toString(),u(new p.OpenViduError(n,r)),[3,12];case 11:return n=p.OpenViduErrorName.GENERIC_ERROR,r=t.toString(),u(new p.OpenViduError(n,r)),[3,12];case 12:return[2]}})})},_.label=1;case 1:return _.trys.push([1,14,,15]),[4,this.openvidu.generateMediaConstraints(this.properties)];case 2:if(!((f=_.sent()).videoTrack&&f.audioTrack||f.audioTrack&&(null===(w=f.constraints)||void 0===w?void 0:w.video)===!1||f.videoTrack&&(null===(O=f.constraints)||void 0===O?void 0:O.audio)===!1))return[3,3];return d(this.openvidu.addAlreadyProvidedTracks(f,new MediaStream,this.stream)),[3,13];case 3:m={mediaConstraints:e=f.constraints,publisherProperties:this.properties},this.stream.setOutboundStreamOptions(m),b=void 0===e.audio||e.audio,r.audio=!this.stream.isSendScreen()&&b,r.video=e.video,c=Date.now(),this.setPermissionDialogTimer(o),_.label=4;case 4:if(_.trys.push([4,11,,13]),!(this.stream.isSendScreen()&&navigator.mediaDevices.getDisplayMedia&&!i.isElectron()))return[3,7];return[4,navigator.mediaDevices.getDisplayMedia({video:!0,audio:"screen"===this.properties.audioSource})];case 5:return y=_.sent(),this.openvidu.addAlreadyProvidedTracks(f,y),[4,l(y,b)];case 6:return _.sent(),[3,10];case 7:return this.stream.lastVideoTrackConstraints=r.video,[4,navigator.mediaDevices.getUserMedia(r)];case 8:return y=_.sent(),this.openvidu.addAlreadyProvidedTracks(f,y,this.stream),[4,l(y,b)];case 9:_.sent(),_.label=10;case 10:return[3,13];case 11:return E=_.sent(),[4,h(E)];case 12:return _.sent(),[3,13];case 13:return[3,15];case 14:return S=_.sent(),u(S),[3,15];case 15:return[2]}})})})},t.prototype.replaceTrackAux=function(e,t){return s(this,void 0,void 0,function(){var n,r;return a(this,function(i){switch(i.label){case 0:n=e.enabled,"video"===e.kind?e.enabled=this.stream.videoActive:"audio"===e.kind&&(e.enabled=this.stream.audioActive),i.label=1;case 1:if(i.trys.push([1,5,,6]),!this.stream.isLocalStreamPublished)return[3,3];return this.replaceTrackInMediaStream(e,t),[4,this.replaceTrackInRtcRtpSender(e)];case 2:return[2,i.sent()];case 3:return[2,this.replaceTrackInMediaStream(e,t)];case 4:return[3,6];case 5:throw r=i.sent(),e.enabled=n,r;case 6:return[2]}})})},t.prototype.getVideoDimensions=function(){var e=this;return new Promise(function(t,n){var r,o=(i.isIonicIos()||i.isIOSWithSafari())&&e.videoReference.readyState<1,s=function(){if("function"==typeof e.stream.getMediaStream().getVideoTracks()[0].getSettings){var n,s,a=e.stream.getMediaStream().getVideoTracks()[0].getSettings();n=a.width||e.videoReference.videoWidth,s=a.height||e.videoReference.videoHeight}else g.warn("MediaStreamTrack does not have getSettings method on "+i.getDescription()),n=e.videoReference.videoWidth,s=e.videoReference.videoHeight;return null!=r&&e.videoReference.removeEventListener("loadedmetadata",r),o&&document.body.removeChild(e.videoReference),t({width:n,height:s})};e.videoReference.readyState>=1?s():(r=function(){if(e.videoReference.videoWidth)s();else var t=setInterval(function(){e.videoReference.videoWidth&&(clearInterval(t),s())},40)},e.videoReference.addEventListener("loadedmetadata",r),o&&document.body.appendChild(e.videoReference))})},t.prototype.reestablishStreamPlayingEvent=function(){this.ee.getListeners("streamPlaying").length>0&&this.addPlayEventToFirstVideo()},t.prototype.initializeVideoReference=function(e){this.videoReference=document.createElement("video"),this.videoReference.style.display="none",this.videoReference.muted=!0,this.videoReference.autoplay=!0,this.videoReference.controls=!1,(i.isSafariBrowser()||i.isIPhoneOrIPad()&&(i.isChromeMobileBrowser()||i.isEdgeMobileBrowser()||i.isOperaMobileBrowser()||i.isFirefoxMobileBrowser()))&&(this.videoReference.playsInline=!0),this.stream.setMediaStream(e),this.firstVideoElement&&this.createVideoElement(this.firstVideoElement.targetElement,this.properties.insertMode),this.videoReference.srcObject=this.stream.getMediaStream()},t.prototype.replaceTrackInMediaStream=function(e,t){var n,r=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream();"video"===e.kind?(n=r.getVideoTracks()[0],t&&(this.stream.lastVideoTrackConstraints=e.getConstraints())):n=r.getAudioTracks()[0],n.enabled=!1,n.stop(),r.removeTrack(n),r.addTrack(e);var i={oldLabel:(null==n?void 0:n.label)||"",newLabel:(null==e?void 0:e.label)||""};"video"===e.kind&&t?(this.openvidu.sendNewVideoDimensionsIfRequired(this,"trackReplaced",50,30),this.openvidu.sendTrackChangedEvent(this,i.oldLabel,i.newLabel,"videoTrack"),this.stream.isLocalStreamPublished&&this.session.sendVideoData(this.stream.streamManager,5,!0,5)):"audio"===e.kind&&t&&this.openvidu.sendTrackChangedEvent(this,i.oldLabel,i.newLabel,"audioTrack"),"audio"===e.kind&&(this.stream.disableHarkSpeakingEvent(!1),this.stream.disableHarkStoppedSpeakingEvent(!1),this.stream.disableHarkVolumeChangeEvent(!1),this.stream.initHarkEvents())},t.prototype.setPermissionDialogTimer=function(e){var t=this;this.permissionDialogTimeout=setTimeout(function(){t.emitEvent("accessDialogOpened",[])},e)},t.prototype.clearPermissionDialogTimer=function(e,t){clearTimeout(this.permissionDialogTimeout),Date.now()-e>t&&this.emitEvent("accessDialogClosed",[])},t.prototype.replaceTrackInRtcRtpSender=function(e){return s(this,void 0,void 0,function(){var t,n;return a(this,function(r){switch(r.label){case 0:if(t=this.stream.getRTCPeerConnection().getSenders(),"video"===e.kind){if(!(n=t.find(function(e){return!!e.track&&"video"===e.track.kind})))throw Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object")}else if("audio"===e.kind){if(!(n=t.find(function(e){return!!e.track&&"audio"===e.track.kind})))throw Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object")}else throw Error("Unknown track kind "+e.kind);return[4,n.replaceTrack(e)];case 1:return r.sent(),[2]}})})},t}(d.StreamManager);t.Publisher=b},7945:function(e,t,n){"use strict";var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Session=void 0;var c=n(3415),u=n(2666),d=n(3397),l=n(9009),h=n(2802),p=n(9026),f=n(1372),m=n(2343),v=n(2316),g=n(252),b=n(702),y=n(3867),E=n(9950),S=n(2420),w=n(5512),O=n(1250),C=n(5995),_=n(909),I=n(9999),R=n(1867),T=n(730),k=C.OpenViduLogger.getInstance(),x=function(e){function t(t){var n=e.call(this)||this;return n.streamManagers=[],n.remoteStreamsCreated=new Map,n.remoteConnections=new Map,i=_.PlatformUtils.getInstance(),n.openvidu=t,n}return o(t,e),t.prototype.connect=function(e,t){var n=this;return new Promise(function(r,o){if(n.processToken(e),!n.openvidu.checkSystemRequirements())return o(new w.OpenViduError(w.OpenViduErrorName.BROWSER_NOT_SUPPORTED,"Browser "+i.getName()+" (version "+i.getVersion()+") for "+i.getFamily()+" is not supported in OpenVidu"));n.options={sessionId:n.sessionId,participantId:e,metadata:t?n.stringClientMetadata(t):""},n.connectAux(e).then(function(){return r()}).catch(function(e){return o(e)})})},t.prototype.disconnect=function(){this.leave(!1,"disconnect")},t.prototype.subscribe=function(e,t,n,r){var i={};i=n&&"function"!=typeof n?{insertMode:void 0!==n.insertMode?"string"==typeof n.insertMode?O.VideoInsertMode[n.insertMode]:i.insertMode:O.VideoInsertMode.APPEND,subscribeToAudio:void 0===n.subscribeToAudio||n.subscribeToAudio,subscribeToVideo:void 0===n.subscribeToVideo||n.subscribeToVideo}:{insertMode:O.VideoInsertMode.APPEND,subscribeToAudio:!0,subscribeToVideo:!0};var o=void 0;if(n&&"function"==typeof n?o=n:r&&(o=r),!this.sessionConnected())throw void 0!==o&&o(this.notConnectedError()),this.notConnectedError();k.info("Subscribing to "+e.connection.connectionId),e.subscribe().then(function(){k.info("Subscribed correctly to "+e.connection.connectionId),void 0!==o&&o(void 0)}).catch(function(e){void 0!==o&&o(e)});var s=new d.Subscriber(e,t,i);return s.targetElement&&e.streamManager.createVideoElement(s.targetElement,i.insertMode),s},t.prototype.subscribeAsync=function(e,t,n){var r=this;return new Promise(function(i,o){if(!r.sessionConnected())return o(r.notConnectedError());var s,a=function(e){return e?o(e):i(s)};s=n?r.subscribe(e,t,n,a):r.subscribe(e,t,a)})},t.prototype.unsubscribe=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());var i=e.stream.connection.connectionId;k.info("Unsubscribing from "+i),t.openvidu.sendRequest("unsubscribeFromVideo",{sender:e.stream.connection.connectionId},function(t,o){return t?(k.error("Error unsubscribing from "+i),r(t)):(k.info("Unsubscribed correctly from "+i),e.stream.streamManager.removeAllVideos(),e.stream.disposeWebRtcPeer(),e.stream.disposeMediaStream(),n())})})},t.prototype.publish=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());e.session=t,e.stream.session=t,e.stream.publishedOnce?e.initialize().then(function(){t.connection.addStream(e.stream),e.reestablishStreamPlayingEvent(),e.stream.publish().then(function(){return t.sendVideoData(e,8,!0,5),n()}).catch(function(e){return r(e)})}).catch(function(e){return r(e)}):(t.connection.addStream(e.stream),e.stream.publish().then(function(){return t.sendVideoData(e,8,!0,5),n()}).catch(function(e){return r(e)}))})},t.prototype.unpublish=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())throw t.notConnectedError();var i=e.stream;return i.connection?i.connection!==t.connection?r(Error("The associated Connection object of this Publisher is not your local Connection.  Only moderators can force unpublish on remote Streams via 'forceUnpublish' method")):void(k.info("Unpublishing local media ("+i.connection.connectionId+")"),t.openvidu.sendRequest("unpublishVideo",function(t,o){if(t)return r(t);k.info("Media unpublished correctly"),i.disposeWebRtcPeer(),i.connection.stream==i&&delete i.connection.stream;var s=new b.StreamEvent(!0,e,"streamDestroyed",e.stream,"unpublish");return e.emitEvent("streamDestroyed",[s]),s.callDefaultBehavior(),n()})):r(Error("The associated Connection object of this Publisher is null"))})},t.prototype.forceDisconnect=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());k.info("Forcing disconnect for connection "+e.connectionId),t.openvidu.sendRequest("forceDisconnect",{connectionId:e.connectionId},function(t,i){return t?(k.error("Error forcing disconnect for Connection "+e.connectionId,t),401===t.code)?r(new w.OpenViduError(w.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force a disconnection")):r(t):(k.info("Forcing disconnect correctly for Connection "+e.connectionId),n())})})},t.prototype.forceUnpublish=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());k.info("Forcing unpublish for stream "+e.streamId),t.openvidu.sendRequest("forceUnpublish",{streamId:e.streamId},function(t,i){return t?(k.error("Error forcing unpublish for Stream "+e.streamId,t),401===t.code)?r(new w.OpenViduError(w.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force an unpublishing")):r(t):(k.info("Forcing unpublish correctly for Stream "+e.streamId),n())})})},t.prototype.signal=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());var i={};if(e.to&&e.to.length>0){var o=[];e.to.forEach(function(e){e.connectionId&&o.push(e.connectionId)}),i.to=o}else i.to=[];i.data=e.data?e.data:"";var s=e.type?e.type:"signal";s&&"signal:"!==s.substring(0,7)&&(s="signal:"+s),i.type=s,t.openvidu.sendRequest("sendMessage",{message:JSON.stringify(i)},function(e,t){return e?r(e):n()})})},t.prototype.subscribeToSpeechToText=function(e,t){var n=this;return new Promise(function(r,i){n.openvidu.sendRequest("subscribeToSpeechToText",{connectionId:e.connection.connectionId,lang:t},function(e,t){return e?i(e):r()})})},t.prototype.unsubscribeFromSpeechToText=function(e){var t=this;return new Promise(function(n,r){t.openvidu.sendRequest("unsubscribeFromSpeechToText",{connectionId:e.connection.connectionId},function(e,t){return e?r(e):n()})})},t.prototype.on=function(t,n){var r,i,o,s;return e.prototype.onAux.call(this,t,"Event '"+t+"' triggered by 'Session'",n),"publisherStartSpeaking"===t&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableHarkSpeakingEvent()}),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.hasAudio)&&this.connection.stream.enableHarkSpeakingEvent()),"publisherStopSpeaking"===t&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableHarkStoppedSpeakingEvent()}),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.hasAudio)&&this.connection.stream.enableHarkStoppedSpeakingEvent()),this},t.prototype.once=function(t,n){var r,i,o,s;return e.prototype.onceAux.call(this,t,"Event '"+t+"' triggered once by 'Session'",n),"publisherStartSpeaking"===t&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableOnceHarkSpeakingEvent()}),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.hasAudio)&&this.connection.stream.enableOnceHarkSpeakingEvent()),"publisherStopSpeaking"===t&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableOnceHarkStoppedSpeakingEvent()}),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.hasAudio)&&this.connection.stream.enableOnceHarkStoppedSpeakingEvent()),this},t.prototype.off=function(t,n){var r,i,o,s,a=this;return e.prototype.offAux.call(this,t,n),"publisherStartSpeaking"===t&&!this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1)&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.streamManager)&&!a.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,e.stream.streamManager)&&e.stream.disableHarkSpeakingEvent(!1)}),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.streamManager)&&!this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.connection.stream.streamManager)&&this.connection.stream.disableHarkSpeakingEvent(!1)),"publisherStopSpeaking"===t&&!this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1)&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.streamManager)&&!a.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,e.stream.streamManager)&&e.stream.disableHarkStoppedSpeakingEvent(!1)}),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.streamManager)&&!this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.connection.stream.streamManager)&&this.connection.stream.disableHarkStoppedSpeakingEvent(!1)),this},t.prototype.onParticipantJoined=function(e){var t=this;this.getConnection(e.id,"").then(function(e){k.warn("Connection "+e.connectionId+" already exists in connections list")}).catch(function(n){var r=new c.Connection(t,e);t.remoteConnections.set(e.id,r),t.ee.emitEvent("connectionCreated",[new h.ConnectionEvent(!1,t,"connectionCreated",r,"")])})},t.prototype.onParticipantLeft=function(e){var t=this;this.getRemoteConnection(e.connectionId,"onParticipantLeft").then(function(n){if(n.stream){var r=n.stream,i=new b.StreamEvent(!0,t,"streamDestroyed",r,e.reason);t.ee.emitEvent("streamDestroyed",[i]),i.callDefaultBehavior(),t.remoteStreamsCreated.delete(r.streamId)}n.dispose(),t.remoteConnections.delete(n.connectionId),t.ee.emitEvent("connectionDestroyed",[new h.ConnectionEvent(!1,t,"connectionDestroyed",n,e.reason)])}).catch(function(e){k.error(e)})},t.prototype.onParticipantPublished=function(e){var t,n=this,r=function(e){n.remoteConnections.set(e.connectionId,e),n.remoteStreamsCreated.get(e.stream.streamId)||n.ee.emitEvent("streamCreated",[new b.StreamEvent(!1,n,"streamCreated",e.stream,"")]),n.remoteStreamsCreated.set(e.stream.streamId,!0)};this.getRemoteConnection(e.id,"onParticipantPublished").then(function(n){t=n,e.metadata=n.data,t.remoteOptions=e,t.initRemoteStreams(e.streams),r(t)}).catch(function(i){r(t=new c.Connection(n,e))})},t.prototype.onParticipantUnpublished=function(e){var t=this;e.connectionId===this.connection.connectionId?this.stopPublisherStream(e.reason):this.getRemoteConnection(e.connectionId,"onParticipantUnpublished").then(function(n){var r=new b.StreamEvent(!0,t,"streamDestroyed",n.stream,e.reason);if(t.ee.emitEvent("streamDestroyed",[r]),r.callDefaultBehavior(),null!=n.stream){var i=n.stream.streamId;t.remoteStreamsCreated.delete(i),n.removeStream()}}).catch(function(e){k.error(e)})},t.prototype.onParticipantEvicted=function(e){e.connectionId===this.connection.connectionId&&this.sessionId&&!this.connection.disposed&&this.leave(!0,e.reason)},t.prototype.onNewMessage=function(e){var t=this;k.info("New signal: "+JSON.stringify(e));var n=e.type?e.type.replace(/^(signal:)/,""):void 0;e.from?this.getConnection(e.from,"Connection '"+e.from+"' unknown when 'onNewMessage'. Existing remote connections: "+JSON.stringify(this.remoteConnections.keys())+". Existing local connection: "+this.connection.connectionId).then(function(r){t.ee.emitEvent("signal",[new v.SignalEvent(t,n,e.data,r)]),e.type&&"signal"!==e.type&&t.ee.emitEvent(e.type,[new v.SignalEvent(t,n,e.data,r)])}).catch(function(e){k.error(e)}):(this.ee.emitEvent("signal",[new v.SignalEvent(this,n,e.data,void 0)]),e.type&&"signal"!==e.type&&this.ee.emitEvent(e.type,[new v.SignalEvent(this,n,e.data,void 0)]))},t.prototype.onStreamPropertyChanged=function(e){var t=this,n=function(n){var r,i;if(n.stream&&n.stream.streamId===e.streamId){var o=n.stream,s=void 0;switch(e.property){case"audioActive":s=o.audioActive,e.newValue="true"===e.newValue,o.audioActive=e.newValue;break;case"videoActive":s=o.videoActive,e.newValue="true"===e.newValue,o.videoActive=e.newValue;var a=null===(i=null===(r=null==o?void 0:o.getMediaStream())||void 0===r?void 0:r.getVideoTracks())||void 0===i?void 0:i[0];a&&!a.enabled&&o.videoActive&&(a.enabled=!0);break;case"videoTrack":case"audioTrack":e.newValue=JSON.parse(e.newValue);break;case"videoDimensions":s=o.videoDimensions,e.newValue=JSON.parse(JSON.parse(e.newValue)),o.videoDimensions=e.newValue;break;case"filter":s=o.filter,e.newValue=Object.keys(e.newValue).length>0?e.newValue:void 0,void 0!==e.newValue?(o.filter=new u.Filter(e.newValue.type,e.newValue.options),o.filter.stream=o,e.newValue.lastExecMethod&&(o.filter.lastExecMethod=e.newValue.lastExecMethod)):delete o.filter,e.newValue=o.filter}t.ee.emitEvent("streamPropertyChanged",[new y.StreamPropertyChangedEvent(t,o,e.property,e.newValue,s,e.reason)]),o.streamManager&&o.streamManager.emitEvent("streamPropertyChanged",[new y.StreamPropertyChangedEvent(o.streamManager,o,e.property,e.newValue,s,e.reason)])}else k.error("No stream with streamId '"+e.streamId+"' found for connection '"+e.connectionId+"' on 'streamPropertyChanged' event")};e.connectionId===this.connection.connectionId?n(this.connection):this.getRemoteConnection(e.connectionId,"onStreamPropertyChanged").then(function(e){n(e)}).catch(function(e){k.error(e)})},t.prototype.onConnectionPropertyChanged=function(e){var t;switch(e.property){case"role":t=this.connection.role.slice(),this.connection.role=e.newValue,this.connection.localOptions.role=e.newValue;break;case"record":t=this.connection.record,e.newValue="true"===e.newValue,this.connection.record=e.newValue,this.connection.localOptions.record=e.newValue}this.ee.emitEvent("connectionPropertyChanged",[new E.ConnectionPropertyChangedEvent(this,this.connection,e.property,e.newValue,t)])},t.prototype.onNetworkQualityLevelChangedChanged=function(e){var t=this;e.connectionId===this.connection.connectionId?this.ee.emitEvent("networkQualityLevelChanged",[new S.NetworkQualityLevelChangedEvent(this,e.newValue,e.oldValue,this.connection)]):this.getConnection(e.connectionId,"Connection not found for connectionId "+e.connectionId).then(function(n){t.ee.emitEvent("networkQualityLevelChanged",[new S.NetworkQualityLevelChangedEvent(t,e.newValue,e.oldValue,n)])}).catch(function(e){k.error(e)})},t.prototype.recvIceCandidate=function(e){var t={candidate:e.candidate,sdpMLineIndex:e.sdpMLineIndex,sdpMid:e.sdpMid},n=new RTCIceCandidate(t);this.getConnection(e.senderConnectionId,"Connection not found for connectionId "+e.senderConnectionId+" owning endpoint "+e.endpointName+". Ice candidate will be ignored: "+n).then(function(t){var r=t.stream;r.getWebRtcPeer().addIceCandidate(n).catch(function(t){k.error("Error adding candidate for "+r.streamId+" stream of endpoint "+e.endpointName+": "+t)})}).catch(function(e){k.error(e)})},t.prototype.onSessionClosed=function(e){k.info("Session closed: "+JSON.stringify(e));var t=e.sessionId;void 0!==t?this.ee.emitEvent("session-closed",[{session:t}]):k.warn("Session undefined on session closed",e)},t.prototype.onLostConnection=function(e){k.warn("Lost connection in Session "+this.sessionId),this.sessionId&&this.connection&&!this.connection.disposed&&this.leave(!0,e)},t.prototype.onRecoveredConnection=function(){k.info("Recovered connection in Session "+this.sessionId),this.reconnectBrokenStreams(),this.ee.emitEvent("reconnected",[])},t.prototype.onMediaError=function(e){k.error("Media error: "+JSON.stringify(e));var t=e.error;t?this.ee.emitEvent("error-media",[{error:t}]):k.warn("Received undefined media error:",e)},t.prototype.onRecordingStarted=function(e){this.ee.emitEvent("recordingStarted",[new f.RecordingEvent(this,"recordingStarted",e.id,e.name)])},t.prototype.onRecordingStopped=function(e){this.ee.emitEvent("recordingStopped",[new f.RecordingEvent(this,"recordingStopped",e.id,e.name,e.reason)])},t.prototype.onBroadcastStarted=function(){this.ee.emitEvent("broadcastStarted",[])},t.prototype.onBroadcastStopped=function(){this.ee.emitEvent("broadcastStopped",[])},t.prototype.onFilterEventDispatched=function(e){var t=this,n=e.connectionId;this.getConnection(n,"No connection found for connectionId "+n).then(function(n){k.info('Filter event of type "'.concat(e.eventType,'" dispatched'));var r=n.stream;if(!r||!r.filter)return k.error('Filter event of type "'.concat(e.eventType,'" dispatched for stream ').concat(r.streamId," but there is no ").concat(r?"filter":"stream"," defined"));var i=r.filter.handlers.get(e.eventType);if(i&&"function"==typeof i)i.call(t,new p.FilterEvent(r.filter,e.eventType,e.data));else{var o=Array.from(r.filter.handlers.keys());return k.error('Filter event of type "'.concat(e.eventType,'" not handled or not a function! Active filter events: ').concat(o.join(",")))}})},t.prototype.onForciblyReconnectSubscriber=function(e){var t=this;return new Promise(function(n,r){t.getRemoteConnection(e.connectionId,"onForciblyReconnectSubscriber").then(function(i){if(i.stream&&i.stream.streamId===e.streamId){var o=i.stream;if(o.setupReconnectionEventEmitter(n,r)){if(null!=o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent)return o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=e,r("Ongoing forced subscriber reconnection");o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=e;var s=function(){var e=o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent;delete o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent,t.onForciblyReconnectSubscriber(e)};return o.reconnectionEventEmitter.once("success",function(){s()}),void o.reconnectionEventEmitter.once("error",function(){s()})}o.completeWebRtcPeerReceive(!0,!0,e.sdpOffer).then(function(){return o.finalResolveForSubscription(!0,n)}).catch(function(t){return o.finalRejectForSubscription(!0,"Error while forcibly reconnecting remote stream ".concat(e.streamId,": ").concat(t.toString()),r)})}else{var a="No stream with streamId '"+e.streamId+"' found for connection '"+e.connectionId+"' on 'streamPropertyChanged' event";return k.error(a),r(a)}}).catch(function(e){return k.error(e),r(e)})})},t.prototype.reconnectBrokenStreams=function(){k.info("Re-establishing media connections...");var e=!1;this.connection.stream&&this.connection.stream.streamIceConnectionStateBroken()&&(k.warn("Re-establishing Publisher "+this.connection.stream.streamId),this.connection.stream.initWebRtcPeerSend(!0),e=!0),this.remoteConnections.forEach(function(t){t.stream&&t.stream.streamIceConnectionStateBroken()&&(k.warn("Re-establishing Subscriber "+t.stream.streamId),t.stream.initWebRtcPeerReceive(!0),e=!0)}),e||k.info("There were no media streams in need of a reconnection")},t.prototype.onSpeechToTextMessage=function(e){return s(this,void 0,void 0,function(){var t,n;return a(this,function(r){switch(r.label){case 0:return[4,this.getConnection(e.connectionId,"No connection found for connectionId "+e.connectionId)];case 1:return t=r.sent(),n=new g.SpeechToTextEvent(this,t,e.text,e.reason.toLowerCase(),e.raw,e.lang),this.ee.emitEvent("speechToTextMessage",[n]),[2]}})})},t.prototype.onSpeechToTextDisconnected=function(e){return s(this,void 0,void 0,function(){return a(this,function(t){return this.emitEvent("exception",[new T.ExceptionEvent(this,T.ExceptionEventName.SPEECH_TO_TEXT_DISCONNECTED,this,e.message)]),[2]})})},t.prototype.emitEvent=function(e,t){this.ee.emitEvent(e,t)},t.prototype.leave=function(e,t){var n=this;if(e=!!e,k.info("Leaving Session (forced="+e+")"),this.stopVideoDataIntervals(),this.connection){if(this.connection.disposed||e?this.openvidu.closeWs():this.openvidu.sendRequest("leaveRoom",function(e,t){e&&k.error("leaveRoom error: ".concat(JSON.stringify(e))),n.openvidu.closeWs()}),this.stopPublisherStream(t),!this.connection.disposed){var r=new m.SessionDisconnectedEvent(this,t);this.ee.emitEvent("sessionDisconnected",[r]),r.callDefaultBehavior()}}else k.warn("You were not connected to the session "+this.sessionId);k.flush()},t.prototype.initializeParams=function(e){return{token:e||"",session:this.sessionId,platform:i.getDescription()?i.getDescription():"unknown",sdkVersion:this.openvidu.libraryVersion,metadata:this.options.metadata?this.options.metadata:"",secret:this.openvidu.getSecret(),recorder:this.openvidu.getRecorder(),stt:this.openvidu.getStt()}},t.prototype.sendVideoData=function(e,t,n,r){var o,c,u=this;if(void 0===t&&(t=1),void 0===n&&(n=!1),void 0===r&&(r=1),i.isChromeBrowser()||i.isChromeMobileBrowser()||i.isOperaBrowser()||i.isOperaMobileBrowser()||i.isEdgeBrowser()||i.isEdgeMobileBrowser()||i.isElectron()||i.isSafariBrowser()&&!i.isIonicIos()||i.isAndroidBrowser()||i.isSamsungBrowser()||i.isIonicAndroid()||i.isIOSWithSafari()){var d=function(){return s(u,void 0,void 0,function(){var t,n,r;return a(this,function(i){switch(i.label){case 0:if("connected"!==(t=e.stream.getRTCPeerConnection()).connectionState)return[3,2];return[4,t.getStats()];case 1:n=i.sent(),r=[],n.forEach(function(e){"frameWidth"in e&&"frameHeight"in e&&0===r.length&&r.push(e)}),r.length>0&&this.openvidu.sendRequest("videoData",{height:r[0].frameHeight,width:r[0].frameWidth,videoActive:null!=e.stream.videoActive&&e.stream.videoActive,audioActive:null!=e.stream.audioActive&&e.stream.audioActive},function(e,t){e&&k.error("Error sending 'videoData' event",e)}),i.label=2;case 2:return[2]}})})};if(n){var l=1;this.videoDataInterval=setInterval(function(){l<r?(l++,d()):clearInterval(u.videoDataInterval)},1e3*t)}else this.videoDataTimeout=setTimeout(d,1e3*t)}else i.isFirefoxBrowser()||i.isFirefoxMobileBrowser()||i.isIonicIos()||i.isReactNative()?this.openvidu.sendRequest("videoData",{height:(null===(o=e.stream.videoDimensions)||void 0===o?void 0:o.height)||0,width:(null===(c=e.stream.videoDimensions)||void 0===c?void 0:c.width)||0,videoActive:null!=e.stream.videoActive&&e.stream.videoActive,audioActive:null!=e.stream.audioActive&&e.stream.audioActive},function(e,t){e&&k.error("Error sending 'videoData' event",e)}):k.error("Browser "+i.getName()+" (version "+i.getVersion()+") for "+i.getFamily()+" is not supported in OpenVidu for Network Quality")},t.prototype.sessionConnected=function(){return null!=this.connection},t.prototype.notConnectedError=function(){return new w.OpenViduError(w.OpenViduErrorName.OPENVIDU_NOT_CONNECTED,"There is no connection to the session. Method 'Session.connect' must be successfully completed first")},t.prototype.anySpeechEventListenerEnabled=function(e,t,n){var r=this.ee.getListeners(e);if(t&&(r=r.filter(function(e){return e.once})),r.length>0)return!0;var i=0;if(n){var o=n.ee.getListeners(e);t&&(o=o.filter(function(e){return e.once})),i=o.length}return i>0},t.prototype.getTokenParams=function(e){var t=e.match(/^(wss?)\:\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);if(t){var n={protocol:t[1],host:t[2],hostname:t[3],port:t[4],pathname:t[5],search:t[6],hash:t[7]},r=decodeURI(e.split("?")[1]).split("&").map(function(e){return e.split("=")}).reduce(function(e,t){var n=t[0],r=t[1];return e[n]=r,e},{});return{sessionId:r.sessionId,secret:r.secret,recorder:r.recorder,stt:r.stt,webrtcStatsInterval:r.webrtcStatsInterval,sendBrowserLogs:r.sendBrowserLogs,edition:r.edition,wsUri:n.protocol+"://"+n.host+"/openvidu",httpUri:"https://"+n.host}}throw Error('Token not valid: "'.concat(e,'"'))},t.prototype.connectAux=function(e){var t=this;return new Promise(function(n,r){t.openvidu.startWs(function(i){if(i)return r(i);var o=t.initializeParams(e);t.openvidu.sendRequest("joinRoom",o,function(i,o){if(i)return r(i);t.processJoinRoomResponse(o,e),t.connection=new c.Connection(t,o);var s={connections:[],streams:[]};return o.value.forEach(function(e){var n=new c.Connection(t,e);t.remoteConnections.set(n.connectionId,n),s.connections.push(n),n.stream&&(t.remoteStreamsCreated.set(n.stream.streamId,!0),s.streams.push(n.stream))}),t.ee.emitEvent("connectionCreated",[new h.ConnectionEvent(!1,t,"connectionCreated",t.connection,"")]),s.connections.forEach(function(e){t.ee.emitEvent("connectionCreated",[new h.ConnectionEvent(!1,t,"connectionCreated",e,"")])}),s.streams.forEach(function(e){t.ee.emitEvent("streamCreated",[new b.StreamEvent(!1,t,"streamCreated",e,"")])}),o.recordingId&&o.recordingName&&t.ee.emitEvent("recordingStarted",[new f.RecordingEvent(t,"recordingStarted",o.recordingId,o.recordingName)]),n()})})})},t.prototype.stopPublisherStream=function(e){this.connection.stream&&(this.connection.stream.disposeWebRtcPeer(),this.connection.stream.isLocalStreamPublished&&this.connection.stream.ee.emitEvent("local-stream-destroyed",[e]))},t.prototype.stopVideoDataIntervals=function(){clearInterval(this.videoDataInterval),clearTimeout(this.videoDataTimeout)},t.prototype.stringClientMetadata=function(e){return"string"!=typeof e?JSON.stringify(e):e},t.prototype.getConnection=function(e,t){var n=this;return new Promise(function(r,i){var o=n.remoteConnections.get(e);return o?r(o):n.connection.connectionId===e?r(n.connection):i(new w.OpenViduError(w.OpenViduErrorName.GENERIC_ERROR,t))})},t.prototype.getRemoteConnection=function(e,t){var n=this;return new Promise(function(r,i){var o=n.remoteConnections.get(e);if(o)return r(o);var s="Remote connection "+e+" unknown when '"+t+"'. Existing remote connections: "+JSON.stringify(n.remoteConnections.keys());return i(new w.OpenViduError(w.OpenViduErrorName.GENERIC_ERROR,s))})},t.prototype.processToken=function(e){var t=this.getTokenParams(e);this.sessionId=t.sessionId,t.secret&&(this.openvidu.secret=t.secret),t.recorder&&(this.openvidu.recorder=!0),t.stt&&(this.openvidu.stt=!0),t.webrtcStatsInterval&&(this.openvidu.webrtcStatsInterval=t.webrtcStatsInterval),t.sendBrowserLogs&&(this.openvidu.sendBrowserLogs=t.sendBrowserLogs),this.openvidu.isAtLeastPro="pro"===t.edition||"enterprise"===t.edition,this.openvidu.isEnterprise="enterprise"===t.edition,this.openvidu.wsUri=t.wsUri,this.openvidu.httpUri=t.httpUri},t.prototype.processJoinRoomResponse=function(e,t){if(this.sessionId=e.session,null!=e.customIceServers&&e.customIceServers.length>0){this.openvidu.iceServers=[];for(var n=0,r=e.customIceServers;n<r.length;n++){var i=r[n],o={urls:[i.url]};k.log("STUN/TURN server IP: "+i.url),null!=i.username&&null!=i.credential&&(o.username=i.username,o.credential=i.credential,k.log("TURN credentials ["+i.username+":"+i.credential+"]")),this.openvidu.iceServers.push(o)}}this.openvidu.role=e.role,this.openvidu.finalUserId=e.finalUserId,this.openvidu.mediaServer=e.mediaServer,this.openvidu.videoSimulcast=e.videoSimulcast,this.capabilities={subscribe:!0,publish:"SUBSCRIBER"!==this.openvidu.role,forceUnpublish:"MODERATOR"===this.openvidu.role,forceDisconnect:"MODERATOR"===this.openvidu.role},k.info("openvidu-server version: "+e.version),null!=e.life&&(this.openvidu.life=e.life);var s=R(e.version)-R(this.openvidu.libraryVersion);I(e.version)===I(this.openvidu.libraryVersion)&&(0==s||1==s)?1==s&&k.warn("openvidu-browser version ".concat(this.openvidu.libraryVersion," does not match openvidu-server version ").concat(e.version,". ")+"These versions are still compatible with each other, but openvidu-browser version must be updated as soon as possible to ".concat(I(e.version),".").concat(R(e.version),".x. ")+"This client using openvidu-browser ".concat(this.openvidu.libraryVersion," will become incompatible with the next release of openvidu-server")):k.error("openvidu-browser (".concat(this.openvidu.libraryVersion,") and openvidu-server (").concat(e.version,") versions are incompatible. ")+"Errors are likely to occur. openvidu-browser SDK is only compatible with the same version or the immediately following minor version of an OpenVidu deployment"),C.OpenViduLogger.configureJSNLog(this.openvidu,t),this.token=t},t}(l.EventDispatcher);t.Session=x},3639:function(e,t,n){"use strict";var r,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Stream=void 0;var s=n(2666),a=n(3397),c=n(3755),u=n(9509),d=n(730),l=n(8349),h=n(5097),p=n(3867),f=n(5512),m=n(4e3),v=n(5995),g=n(909),b=n(4916),y=n(2695),E=n(6419),S=v.OpenViduLogger.getInstance(),w=function(){function e(e,t){var n=this;this.isSubscribeToRemote=!1,this.isLocalStreamReadyToPublish=!1,this.isLocalStreamPublished=!1,this.publishedOnce=!1,this.harkSpeakingEnabled=!1,this.harkSpeakingEnabledOnce=!1,this.harkStoppedSpeakingEnabled=!1,this.harkStoppedSpeakingEnabledOnce=!1,this.harkVolumeChangeEnabled=!1,this.harkVolumeChangeEnabledOnce=!1,this.ee=new E,r=g.PlatformUtils.getInstance(),this.session=e,t.hasOwnProperty("id")?(this.inboundStreamOpts=t,this.streamId=this.inboundStreamOpts.id,this.creationTime=this.inboundStreamOpts.createdAt,this.hasAudio=this.inboundStreamOpts.hasAudio,this.hasVideo=this.inboundStreamOpts.hasVideo,this.hasAudio&&(this.audioActive=this.inboundStreamOpts.audioActive),this.hasVideo&&(this.videoActive=this.inboundStreamOpts.videoActive,this.typeOfVideo=this.inboundStreamOpts.typeOfVideo?this.inboundStreamOpts.typeOfVideo:void 0,this.frameRate=-1===this.inboundStreamOpts.frameRate?void 0:this.inboundStreamOpts.frameRate,this.videoDimensions=this.inboundStreamOpts.videoDimensions),this.inboundStreamOpts.filter&&Object.keys(this.inboundStreamOpts.filter).length>0&&(this.inboundStreamOpts.filter.lastExecMethod&&0===Object.keys(this.inboundStreamOpts.filter.lastExecMethod).length&&delete this.inboundStreamOpts.filter.lastExecMethod,this.filter=this.inboundStreamOpts.filter)):(this.outboundStreamOpts=t,this.hasAudio=this.isSendAudio(),this.hasVideo=this.isSendVideo(),this.hasAudio&&(this.audioActive=!!this.outboundStreamOpts.publisherProperties.publishAudio),this.hasVideo&&(this.videoActive=!!this.outboundStreamOpts.publisherProperties.publishVideo,this.frameRate=this.outboundStreamOpts.publisherProperties.frameRate,"undefined"!=typeof MediaStreamTrack&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?this.typeOfVideo=m.TypeOfVideo.CUSTOM:this.typeOfVideo=this.isSendScreen()?m.TypeOfVideo.SCREEN:m.TypeOfVideo.CAMERA),this.outboundStreamOpts.publisherProperties.filter&&(this.filter=this.outboundStreamOpts.publisherProperties.filter)),this.ee.on("mediastream-updated",function(){var e;n.streamManager.updateMediaStream(n.mediaStream),S.debug("Video srcObject ["+(null===(e=n.mediaStream)||void 0===e?void 0:e.id)+"] updated in stream ["+n.streamId+"]")})}return e.prototype.reconnect=function(){return this.reconnectStream("API")},e.prototype.applyFilter=function(e,t){var n=this;return new Promise(function(r,a){return i(n,void 0,void 0,function(){var n,c,u,d,l,h,m=this;return o(this,function(v){if(this.filter)return[2,a(new f.OpenViduError(f.OpenViduErrorName.GENERIC_ERROR,"There is already a filter applied to Stream "+this.streamId))];if(n=function(n,i){if(n)return(S.error("Error applying filter for Stream "+m.streamId,n),401===n.code)?a(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to apply a filter")):a(n);S.info("Filter successfully applied on Stream "+m.streamId);var o=m.filter;return m.filter=new s.Filter(e,t),m.filter.stream=m,i&&(m.session.emitEvent("streamPropertyChanged",[new p.StreamPropertyChangedEvent(m.session,m,"filter",m.filter,o,"applyFilter")]),m.streamManager.emitEvent("streamPropertyChanged",[new p.StreamPropertyChangedEvent(m.streamManager,m,"filter",m.filter,o,"applyFilter")])),r(m.filter)},e.startsWith("VB:")){if(!this.hasVideo)return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"The Virtual Background filter requires a video track to be applied"))];if(!this.mediaStream||0===this.streamManager.videos.length)return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"The StreamManager requires some video element to be attached to it in order to apply a Virtual Background filter"))];if(!(c=this.session.token?this.session.token:t.token))return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,'Virtual Background requires the client to be connected to a Session or to have a "token" property available in "options" parameter with a valid OpenVidu token'))];if("pro"!==(u=this.session.getTokenParams(c)).edition&&"enterprise"!==u.edition)return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"OpenVidu Virtual Background API is available from OpenVidu Pro edition onwards"))];c=encodeURIComponent(btoa(c)),S.info("Applying Virtual Background to stream "+this.streamId),d=function(){return i(m,void 0,void 0,function(){var r,i,s,a,d,l;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,8,,9]),r=this.streamId+"_"+(0,b.v4)(),i=this.mediaStream.clone(),(s=this.streamManager.videos[0].video.cloneNode(!1)).id=VirtualBackground.VirtualBackground.SOURCE_VIDEO_PREFIX+r,s.srcObject=i,s.muted=!0,this.virtualBackgroundSourceElements={videoClone:s,mediaStreamClone:i},VirtualBackground.VirtualBackground.hideHtmlElement(s,!1),VirtualBackground.VirtualBackground.appendHtmlElementToHiddenContainer(s,r),[4,s.play()];case 1:switch(o.sent(),a=new VirtualBackground.VirtualBackground({id:r,openviduServerUrl:new URL(u.httpUri),openviduToken:c,inputVideo:s,inputResolution:"160x96",outputFramerate:24}),d=void 0,e){case"VB:blur":return[3,2];case"VB:image":return[3,4]}return[3,6];case 2:return[4,a.backgroundBlur(t)];case 3:case 5:return d=o.sent(),[3,7];case 4:return[4,a.backgroundImage(t)];case 6:throw Error("Unknown Virtual Background filter: "+e);case 7:return this.virtualBackgroundSinkElements={VB:a,video:d},s.style.display="none",this.streamManager.remote?this.streamManager.replaceTrackInMediaStream(this.virtualBackgroundSinkElements.video.srcObject.getVideoTracks()[0],!1):this.streamManager.replaceTrackAux(this.virtualBackgroundSinkElements.video.srcObject.getVideoTracks()[0],!1),n(void 0,!1),[3,9];case 8:return(l=o.sent()).name===f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR?n(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,l.message),!1):n(l,!1),[3,9];case 9:return[2]}})})},"undefined"==typeof VirtualBackground?((l=document.createElement("script")).type="text/javascript",l.src=u.httpUri+"/openvidu/virtual-background/openvidu-virtual-background.js?token="+c,l.onload=function(){return i(m,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,d()];case 1:return n.sent(),r(new s.Filter(e,t)),[3,3];case 2:return a(n.sent()),[3,3];case 3:return[2]}})})},document.body.appendChild(l)):d().then(function(){return r(new s.Filter(e,t))}).catch(function(e){return a(e)})}else{if(!this.session.sessionConnected())return[2,a(this.session.notConnectedError())];S.info("Applying server filter to stream "+this.streamId),"string"!=typeof(h=t=null!=t?t:{})&&(h=JSON.stringify(h)),this.session.openvidu.sendRequest("applyFilter",{streamId:this.streamId,type:e,options:h},function(e,t){n(e,!0)})}return[2]})})})},e.prototype.removeFilter=function(){return i(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.removeFilterAux(!1)];case 1:return[2,e.sent()]}})})},e.prototype.getRTCPeerConnection=function(){return this.webRtcPeer.pc},e.prototype.getMediaStream=function(){return this.mediaStream},e.prototype.removeFilterAux=function(e){var t=this;return new Promise(function(n,r){return i(t,void 0,void 0,function(){var t,i,s,a,c=this;return o(this,function(o){switch(o.label){case 0:if(t=function(e,t){if(e)return(delete c.filter,S.error("Error removing filter for Stream "+c.streamId,e),401===e.code)?r(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to remove a filter")):r(e);S.info("Filter successfully removed from Stream "+c.streamId);var i=c.filter;return delete c.filter,t&&(c.session.emitEvent("streamPropertyChanged",[new p.StreamPropertyChangedEvent(c.session,c,"filter",c.filter,i,"applyFilter")]),c.streamManager.emitEvent("streamPropertyChanged",[new p.StreamPropertyChangedEvent(c.streamManager,c,"filter",c.filter,i,"applyFilter")])),n()},!this.filter)return[3,11];if(!(null===(a=this.filter)||void 0===a?void 0:a.type.startsWith("VB:")))return[3,9];o.label=1;case 1:if(o.trys.push([1,7,,8]),i=this.virtualBackgroundSourceElements.mediaStreamClone,e)return[3,5];if(!this.streamManager.remote)return[3,2];return this.streamManager.replaceTrackInMediaStream(i.getVideoTracks()[0],!1),[3,4];case 2:return[4,this.streamManager.replaceTrackAux(i.getVideoTracks()[0],!1)];case 3:o.sent(),o.label=4;case 4:return[3,6];case 5:i.getTracks().forEach(function(e){return e.stop()}),o.label=6;case 6:return this.virtualBackgroundSinkElements.VB.cleanUp(),delete this.virtualBackgroundSinkElements,delete this.virtualBackgroundSourceElements,[2,t(void 0,!1)];case 7:return s=o.sent(),[2,t(s,!1)];case 8:return[3,10];case 9:if(!this.session.sessionConnected())return[2,r(this.session.notConnectedError())];S.info("Removing filter of stream "+this.streamId),this.session.openvidu.sendRequest("removeFilter",{streamId:this.streamId},function(e,n){return t(e,!0)}),o.label=10;case 10:return[3,12];case 11:return[2,r(new f.OpenViduError(f.OpenViduErrorName.GENERIC_ERROR,"Stream "+this.streamId+" has no filter applied"))];case 12:return[2]}})})})},e.prototype.setMediaStream=function(e){this.mediaStream=e},e.prototype.updateMediaStreamInVideos=function(){this.ee.emitEvent("mediastream-updated",[])},e.prototype.getWebRtcPeer=function(){return this.webRtcPeer},e.prototype.subscribeToMyRemote=function(e){this.isSubscribeToRemote=e},e.prototype.setOutboundStreamOptions=function(e){this.outboundStreamOpts=e},e.prototype.subscribe=function(){var e=this;return new Promise(function(t,n){e.initWebRtcPeerReceive(!1).then(function(){return t()}).catch(function(e){return n(e)})})},e.prototype.publish=function(){var e=this;return new Promise(function(t,n){e.isLocalStreamReadyToPublish?e.initWebRtcPeerSend(!1).then(function(){return t()}).catch(function(e){return n(e)}):e.ee.once("stream-ready-to-publish",function(){e.publish().then(function(){return t()}).catch(function(e){return n(e)})})})},e.prototype.disposeWebRtcPeer=function(){var e;this.webRtcPeer&&(this.webRtcPeer.dispose(),e=this.webRtcPeer.getId()),this.stopWebRtcStats(),S.info((this.outboundStreamOpts?"Outbound ":"Inbound ")+"RTCPeerConnection with id ["+e+"] from 'Stream' with id ["+this.streamId+"] is now closed")},e.prototype.disposeMediaStream=function(){return i(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:if(!(this.filter&&this.filter.type.startsWith("VB:")))return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.removeFilterAux(!0)];case 2:return t.sent(),console.debug("Success removing Virtual Background filter for stream ".concat(this.streamId)),[3,4];case 3:return e=t.sent(),console.error("Error removing Virtual Background filter for stream ".concat(this.streamId),e),[3,4];case 4:return this.mediaStream&&(this.mediaStream.getAudioTracks().forEach(function(e){e.stop()}),this.mediaStream.getVideoTracks().forEach(function(e){e.stop()}),delete this.mediaStream),this.localMediaStreamWhenSubscribedToRemote&&(this.localMediaStreamWhenSubscribedToRemote.getAudioTracks().forEach(function(e){e.stop()}),this.localMediaStreamWhenSubscribedToRemote.getVideoTracks().forEach(function(e){e.stop()}),delete this.localMediaStreamWhenSubscribedToRemote),this.speechEvent&&(this.speechEvent.stop&&this.speechEvent.stop(),delete this.speechEvent),S.info((this.outboundStreamOpts?"Local ":"Remote ")+"MediaStream from 'Stream' with id ["+this.streamId+"] is now disposed"),[2]}})})},e.prototype.displayMyRemote=function(){return this.isSubscribeToRemote},e.prototype.isSendAudio=function(){return!!this.outboundStreamOpts&&null!==this.outboundStreamOpts.publisherProperties.audioSource&&!1!==this.outboundStreamOpts.publisherProperties.audioSource},e.prototype.isSendVideo=function(){return!!this.outboundStreamOpts&&null!==this.outboundStreamOpts.publisherProperties.videoSource&&!1!==this.outboundStreamOpts.publisherProperties.videoSource},e.prototype.isSendScreen=function(){var e=!1;if("undefined"!=typeof MediaStreamTrack&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack){var t=this.outboundStreamOpts.publisherProperties.videoSource.getSettings();t.displaySurface&&(e=["monitor","window","browser"].includes(t.displaySurface))}return!e&&r.isElectron()&&(e="string"==typeof this.outboundStreamOpts.publisherProperties.videoSource&&this.outboundStreamOpts.publisherProperties.videoSource.startsWith("screen:")),e||(e="screen"===this.outboundStreamOpts.publisherProperties.videoSource),!!this.outboundStreamOpts&&e},e.prototype.enableHarkSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkSpeakingEnabled&&this.speechEvent&&(this.harkSpeakingEnabled=!0,this.speechEvent.on("speaking",function(){e.session.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStartSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStartSpeaking",e.connection,e.streamId)]),e.harkSpeakingEnabledOnce=!1}))},e.prototype.enableOnceHarkSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkSpeakingEnabledOnce&&this.speechEvent&&(this.harkSpeakingEnabledOnce=!0,this.speechEvent.once("speaking",function(){e.harkSpeakingEnabledOnce&&(e.session.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStartSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStartSpeaking",e.connection,e.streamId)])),e.disableHarkSpeakingEvent(!0)}))},e.prototype.disableHarkSpeakingEvent=function(e){if(this.speechEvent){if(this.harkSpeakingEnabledOnce=!1,e){if(this.harkSpeakingEnabled)return}else this.harkSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.enableHarkStoppedSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkStoppedSpeakingEnabled&&this.speechEvent&&(this.harkStoppedSpeakingEnabled=!0,this.speechEvent.on("stopped_speaking",function(){e.session.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStopSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStopSpeaking",e.connection,e.streamId)]),e.harkStoppedSpeakingEnabledOnce=!1}))},e.prototype.enableOnceHarkStoppedSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkStoppedSpeakingEnabledOnce&&this.speechEvent&&(this.harkStoppedSpeakingEnabledOnce=!0,this.speechEvent.once("stopped_speaking",function(){e.harkStoppedSpeakingEnabledOnce&&(e.session.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStopSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStopSpeaking",e.connection,e.streamId)])),e.disableHarkStoppedSpeakingEvent(!0)}))},e.prototype.disableHarkStoppedSpeakingEvent=function(e){if(this.speechEvent){if(this.harkStoppedSpeakingEnabledOnce=!1,e){if(this.harkStoppedSpeakingEnabled)return}else this.harkStoppedSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce?this.speechEvent.off("stopped_speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.enableHarkVolumeChangeEvent=function(e){var t=this;this.setHarkListenerIfNotExists()?(!this.harkVolumeChangeEnabled||e)&&(this.harkVolumeChangeEnabled=!0,this.speechEvent.on("volume_change",function(e){var n=t.speechEvent.oldVolumeValue;t.speechEvent.oldVolumeValue=e,t.streamManager.emitEvent("streamAudioVolumeChange",[new h.StreamManagerEvent(t.streamManager,"streamAudioVolumeChange",{newValue:e,oldValue:n})])})):this.harkVolumeChangeEnabled=!0},e.prototype.enableOnceHarkVolumeChangeEvent=function(e){var t=this;this.setHarkListenerIfNotExists()?(!this.harkVolumeChangeEnabledOnce||e)&&(this.harkVolumeChangeEnabledOnce=!0,this.speechEvent.once("volume_change",function(e){var n=t.speechEvent.oldVolumeValue;t.speechEvent.oldVolumeValue=e,t.disableHarkVolumeChangeEvent(!0),t.streamManager.emitEvent("streamAudioVolumeChange",[new h.StreamManagerEvent(t.streamManager,"streamAudioVolumeChange",{newValue:e,oldValue:n})])})):this.harkVolumeChangeEnabledOnce=!0},e.prototype.disableHarkVolumeChangeEvent=function(e){if(this.speechEvent){if(this.harkVolumeChangeEnabledOnce=!1,e){if(this.harkVolumeChangeEnabled)return}else this.harkVolumeChangeEnabled=!1;this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("volume_change"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.isLocal=function(){return!this.inboundStreamOpts&&!!this.outboundStreamOpts},e.prototype.getSelectedIceCandidate=function(){var e=this;return new Promise(function(t,n){e.webRtcStats.getSelectedIceCandidateInfo().then(function(e){return t(e)}).catch(function(e){return n(e)})})},e.prototype.getRemoteIceCandidateList=function(){return this.webRtcPeer.remoteCandidatesQueue},e.prototype.getLocalIceCandidateList=function(){return this.webRtcPeer.localCandidatesQueue},e.prototype.streamIceConnectionStateBroken=function(){if(!this.getWebRtcPeer()||!this.getRTCPeerConnection())return!1;if(this.session.openvidu.advancedConfiguration.forceMediaReconnectionAfterNetworkDrop)return S.warn('OpenVidu Browser advanced configuration option "forceMediaReconnectionAfterNetworkDrop" is enabled. Stream '.concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") will force a reconnection")),!0;var e=this.getRTCPeerConnection().iceConnectionState;return"connected"!==e&&"completed"!==e},e.prototype.setHarkListenerIfNotExists=function(){if(this.mediaStream){if(!this.speechEvent){var e=this.harkOptions?this.harkOptions:this.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{};e.interval="number"==typeof e.interval?e.interval:100,e.threshold="number"==typeof e.threshold?e.threshold:-50,this.speechEvent=y(this.mediaStream,e)}return!0}return!1},e.prototype.setupReconnectionEventEmitter=function(e,t){return void 0==this.reconnectionEventEmitter?(this.reconnectionEventEmitter=new E,!1):(console.warn("Trying to reconnect stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") but an ongoing reconnection process is active. Waiting for response...")),this.reconnectionEventEmitter.once("success",function(){return e()}),this.reconnectionEventEmitter.once("error",function(e){return t(e)}),!0)},e.prototype.initWebRtcPeerSend=function(e){var t=this;return new Promise(function(n,r){if(e){if(t.setupReconnectionEventEmitter(n,r))return}else t.initHarkEvents();var i,o=function(){var r;return e&&(null===(r=t.reconnectionEventEmitter)||void 0===r||r.emitEvent("success"),delete t.reconnectionEventEmitter),n()},s=function(n){var i;return e&&(null===(i=t.reconnectionEventEmitter)||void 0===i||i.emitEvent("error",[n]),delete t.reconnectionEventEmitter),r(n)},a=function(n){var r;if(S.debug("Sending SDP offer to publish as "+t.streamId,n),e)r={stream:t.streamId,sdpString:n};else{var i=void 0;t.isSendVideo()&&(i="undefined"!=typeof MediaStreamTrack&&t.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?m.TypeOfVideo.CUSTOM:t.isSendScreen()?m.TypeOfVideo.SCREEN:m.TypeOfVideo.CAMERA),r={doLoopback:t.displayMyRemote()||!1,hasAudio:t.isSendAudio(),hasVideo:t.isSendVideo(),audioActive:t.audioActive,videoActive:t.videoActive,typeOfVideo:i,frameRate:t.frameRate?t.frameRate:-1,videoDimensions:JSON.stringify(t.videoDimensions),filter:t.outboundStreamOpts.publisherProperties.filter,sdpOffer:n}}t.session.openvidu.sendRequest(e?"reconnectStream":"publishVideo",r,function(n,r){n?401===n.code?s(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to publish")):s("Error on publishVideo: "+JSON.stringify(n)):t.webRtcPeer.processRemoteAnswer(r.sdpAnswer).then(function(){t.streamId=r.id,t.creationTime=r.createdAt,t.isLocalStreamPublished=!0,t.publishedOnce=!0,t.displayMyRemote()&&(t.localMediaStreamWhenSubscribedToRemote=t.mediaStream,t.remotePeerSuccessfullyEstablished(e)),e?t.ee.emitEvent("stream-reconnected-by-publisher",[]):t.ee.emitEvent("stream-created-by-publisher",[]),t.initWebRtcStats(),S.info("'Publisher' ("+t.streamId+") successfully "+(e?"reconnected":"published")+" to session"),o()}).catch(function(e){s(e)})})},u={mediaConstraints:{audio:t.hasAudio,video:t.hasVideo},simulcast:null!==(i=t.outboundStreamOpts.publisherProperties.videoSimulcast)&&void 0!==i?i:t.session.openvidu.videoSimulcast,onIceCandidate:t.connection.sendIceCandidate.bind(t.connection),onIceConnectionStateException:t.onIceConnectionStateExceptionHandler.bind(t),iceServers:t.getIceServersConf(),mediaStream:t.mediaStream,mediaServer:t.session.openvidu.mediaServer,typeOfVideo:t.typeOfVideo?m.TypeOfVideo[t.typeOfVideo]:void 0};"mediasoup"!==t.session.openvidu.mediaServer&&(u.simulcast=!1),e&&t.disposeWebRtcPeer(),t.displayMyRemote()?t.webRtcPeer=new c.WebRtcPeerSendrecv(u):t.webRtcPeer=new c.WebRtcPeerSendonly(u),t.webRtcPeer.addIceConnectionStateChangeListener("publisher of "+t.connection.connectionId),t.webRtcPeer.createOffer().then(function(e){t.webRtcPeer.processLocalOffer(e).then(function(){a(e.sdp)}).catch(function(e){s(Error("(publish) SDP process local offer error: "+JSON.stringify(e)))})}).catch(function(e){s(Error("(publish) SDP create offer error: "+JSON.stringify(e)))})})},e.prototype.finalResolveForSubscription=function(e,t){var n;return S.info("'Subscriber' ("+this.streamId+") successfully "+(e?"reconnected":"subscribed")),this.remotePeerSuccessfullyEstablished(e),this.initWebRtcStats(),e&&(null===(n=this.reconnectionEventEmitter)||void 0===n||n.emitEvent("success"),delete this.reconnectionEventEmitter),t()},e.prototype.finalRejectForSubscription=function(e,t,n){var r;return S.error("Error for 'Subscriber' ("+this.streamId+") while trying to "+(e?"reconnect":"subscribe")+": "+t.toString()),e&&(null===(r=this.reconnectionEventEmitter)||void 0===r||r.emitEvent("error",[t]),delete this.reconnectionEventEmitter),n(t)},e.prototype.initWebRtcPeerReceive=function(e){var t=this;return new Promise(function(n,r){e&&t.setupReconnectionEventEmitter(n,r)||("mediasoup"===t.session.openvidu.mediaServer?t.initWebRtcPeerReceiveFromServer(e).then(function(){return t.finalResolveForSubscription(e,n)}).catch(function(n){return t.finalRejectForSubscription(e,n,r)}):t.initWebRtcPeerReceiveFromClient(e).then(function(){return t.finalResolveForSubscription(e,n)}).catch(function(n){return t.finalRejectForSubscription(e,n,r)}))})},e.prototype.initWebRtcPeerReceiveFromClient=function(e){var t=this;return new Promise(function(n,r){t.completeWebRtcPeerReceive(e,!1).then(function(e){t.webRtcPeer.processRemoteAnswer(e.sdpAnswer).then(function(){return n()}).catch(function(e){return r(e)})}).catch(function(e){return r(e)})})},e.prototype.initWebRtcPeerReceiveFromServer=function(e){var t=this;return new Promise(function(n,r){t.session.openvidu.sendRequest("prepareReceiveVideoFrom",{sender:t.streamId,reconnect:e},function(i,o){if(i)return r(Error("Error on prepareReceiveVideoFrom: "+JSON.stringify(i)));t.completeWebRtcPeerReceive(e,!1,o.sdpOffer).then(function(){return n()}).catch(function(e){return r(e)})})})},e.prototype.completeWebRtcPeerReceive=function(e,t,n){var r=this;return new Promise(function(i,o){S.debug("'Session.subscribe(Stream)' called");var s=function(s){S.debug("Sending local SDP ".concat(n?"answer":"offer"," to subscribe to ").concat(r.streamId),s);var a=e?"reconnectStream":"receiveVideoFrom",c={};c[e?"stream":"sender"]=r.streamId,n?c[e?"sdpString":"sdpAnswer"]=s:c.sdpOffer=s,e&&(c.forciblyReconnect=t),r.session.openvidu.sendRequest(a,c,function(e,t){return e?o(Error("Error on "+a+" : "+JSON.stringify(e))):i(t)})},a={mediaConstraints:{audio:r.hasAudio,video:r.hasVideo},simulcast:!1,onIceCandidate:r.connection.sendIceCandidate.bind(r.connection),onIceConnectionStateException:r.onIceConnectionStateExceptionHandler.bind(r),iceServers:r.getIceServersConf(),mediaServer:r.session.openvidu.mediaServer,typeOfVideo:r.typeOfVideo?m.TypeOfVideo[r.typeOfVideo]:void 0};e&&r.disposeWebRtcPeer(),r.webRtcPeer=new c.WebRtcPeerRecvonly(a),r.webRtcPeer.addIceConnectionStateChangeListener(r.streamId),n?r.webRtcPeer.processRemoteOffer(n).then(function(){r.webRtcPeer.createAnswer().then(function(e){r.webRtcPeer.processLocalAnswer(e).then(function(){s(e.sdp)}).catch(function(e){return o(Error("(subscribe) SDP process local answer error: "+JSON.stringify(e)))})}).catch(function(e){return o(Error("(subscribe) SDP create answer error: "+JSON.stringify(e)))})}).catch(function(e){return o(Error("(subscribe) SDP process remote offer error: "+JSON.stringify(e)))}):r.webRtcPeer.createOffer().then(function(e){r.webRtcPeer.processLocalOffer(e).then(function(){s(e.sdp)}).catch(function(e){return o(Error("(subscribe) SDP process local offer error: "+JSON.stringify(e)))})}).catch(function(e){return o(Error("(subscribe) SDP create offer error: "+JSON.stringify(e)))})})},e.prototype.remotePeerSuccessfullyEstablished=function(e){e&&null!=this.mediaStream&&this.disposeMediaStream(),this.mediaStream=new MediaStream;for(var t,n=0,r=this.webRtcPeer.pc.getReceivers();n<r.length;n++)(t=r[n]).track&&this.mediaStream.addTrack(t.track);if(S.debug("Peer remote stream",this.mediaStream),this.mediaStream){if(this.streamManager instanceof a.Subscriber){if(this.mediaStream.getAudioTracks()[0]){var i=e?this.audioActive:!!this.streamManager.properties.subscribeToAudio;this.mediaStream.getAudioTracks()[0].enabled=i}if(this.mediaStream.getVideoTracks()[0]){var i=e?this.videoActive:!!this.videoActive&&!!this.streamManager.properties.subscribeToVideo;this.mediaStream.getVideoTracks()[0].enabled=i}}this.updateMediaStreamInVideos(),this.initHarkEvents()}},e.prototype.initHarkEvents=function(){this.mediaStream.getAudioTracks()[0]&&(this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!0,this.streamManager)&&this.enableOnceHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.streamManager)&&this.enableHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!0,this.streamManager)&&this.enableOnceHarkStoppedSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.streamManager)&&this.enableHarkStoppedSpeakingEvent(),this.harkVolumeChangeEnabledOnce&&this.enableOnceHarkVolumeChangeEvent(!0),this.harkVolumeChangeEnabled&&this.enableHarkVolumeChangeEvent(!0))},e.prototype.onIceConnectionStateExceptionHandler=function(e,t,n){switch(e){case d.ExceptionEventName.ICE_CONNECTION_FAILED:this.onIceConnectionFailed();break;case d.ExceptionEventName.ICE_CONNECTION_DISCONNECTED:this.onIceConnectionDisconnected()}this.session.emitEvent("exception",[new d.ExceptionEvent(this.session,e,this,t,n)])},e.prototype.onIceConnectionFailed=function(){S.log("[ICE_CONNECTION_FAILED] Handling ICE_CONNECTION_FAILED event. Reconnecting stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",")")),this.reconnectStreamAndLogResultingIceConnectionState(d.ExceptionEventName.ICE_CONNECTION_FAILED)},e.prototype.onIceConnectionDisconnected=function(){var e=this;S.log("[ICE_CONNECTION_DISCONNECTED] Handling ICE_CONNECTION_DISCONNECTED event. Waiting for ICE to be restored and reconnect stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") if not possible"));var t=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3;this.awaitWebRtcPeerConnectionState(t).then(function(n){switch(n){case"failed":S.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(e.streamId," (").concat(e.isLocal()?"Publisher":"Subscriber",") is now failed after ICE_CONNECTION_DISCONNECTED"));break;case"connected":case"completed":S.log("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(e.streamId," (").concat(e.isLocal()?"Publisher":"Subscriber",") automatically restored after ICE_CONNECTION_DISCONNECTED. Current ICE connection state: ").concat(n));break;case"closed":case"checking":case"new":case"disconnected":S.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(e.streamId," (").concat(e.isLocal()?"Publisher":"Subscriber",") couldn't be restored after ICE_CONNECTION_DISCONNECTED event. Current ICE connection state after ").concat(t," ms: ").concat(n)),e.reconnectStreamAndLogResultingIceConnectionState(d.ExceptionEventName.ICE_CONNECTION_DISCONNECTED)}})},e.prototype.reconnectStreamAndLogResultingIceConnectionState=function(e){return i(this,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.reconnectStreamAndReturnIceConnectionState(e)];case 1:switch(t=r.sent()){case"connected":case"completed":S.log("[".concat(e,"] Stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") successfully reconnected after ").concat(e,". Current ICE connection state: ").concat(t));break;default:S.error("[".concat(e,"] Stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") failed to reconnect after ").concat(e,". Current ICE connection state: ").concat(t))}return[3,3];case 2:return n=r.sent(),S.error("[".concat(e,"] Error reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") after ").concat(e,": ").concat(n)),[3,3];case 3:return[2]}})})},e.prototype.reconnectStreamAndReturnIceConnectionState=function(e){return i(this,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:S.log("[".concat(e,"] Reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") after event ").concat(e)),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.reconnectStream(e)];case 2:return r.sent(),t=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3,[2,this.awaitWebRtcPeerConnectionState(t)];case 3:return n=r.sent(),S.warn("[".concat(e,"] Error reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber","). Reason: ").concat(n)),[2,this.awaitWebRtcPeerConnectionState(1)];case 4:return[2]}})})},e.prototype.awaitWebRtcPeerConnectionState=function(e){return i(this,void 0,void 0,function(){var t,n,r,i;return o(this,function(o){switch(o.label){case 0:t=this.getRTCPeerConnection().iceConnectionState,r=Math.ceil(e/(n=150)),i=0,o.label=1;case 1:if(!(i<r)||"connected"===(t=this.getRTCPeerConnection().iceConnectionState)||"completed"===t)return[3,4];return[4,new Promise(function(e){return setTimeout(e,n)})];case 2:o.sent(),o.label=3;case 3:return i++,[3,1];case 4:return[2,t]}})})},e.prototype.reconnectStream=function(e){return i(this,void 0,void 0,function(){var t;return o(this,function(n){switch(n.label){case 0:return[4,this.isWebsocketConnected(e,3e3)];case 1:if(n.sent()){if(S.log("[".concat(e,"] Trying to reconnect stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") and the websocket is opened")),this.isLocal())return[2,this.initWebRtcPeerSend(!0)];return[2,this.initWebRtcPeerReceive(!0)]}throw t="[".concat(e,"] Trying to reconnect stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") but the websocket wasn't opened"),S.error(t),Error(t)}})})},e.prototype.isWebsocketConnected=function(e,t){var n=this;return new Promise(function(r,i){var o=n.session.openvidu.getWsReadyState();if(1!==o)return console.warn("[".concat(e,"] Websocket readyState is ").concat(o)),r(!1);var s=setTimeout(function(){return console.warn("[".concat(e,"] Websocket timeout of ").concat(t,"ms")),r(!1)},t);n.session.openvidu.sendRequest("echo",{},function(t,n){return(clearTimeout(s),t)?(console.warn("[".concat(e,"] Websocket 'echo' returned error: ").concat(t)),r(!1)):r(!0)})})},e.prototype.initWebRtcStats=function(){this.webRtcStats=new u.WebRtcStats(this),this.webRtcStats.initWebRtcStats()},e.prototype.stopWebRtcStats=function(){this.webRtcStats&&this.webRtcStats.isEnabled()&&this.webRtcStats.stopWebRtcStats()},e.prototype.getIceServersConf=function(){return this.session.openvidu.advancedConfiguration.iceServers?"freeice"===this.session.openvidu.advancedConfiguration.iceServers?void 0:this.session.openvidu.advancedConfiguration.iceServers:this.session.openvidu.iceServers?this.session.openvidu.iceServers:void 0},e.prototype.gatherStatsForPeer=function(){var e=this;return new Promise(function(t,n){e.isLocal()?e.getRTCPeerConnection().getSenders().forEach(function(t){return t.getStats().then(function(t){t.forEach(function(t){if(e.isReportWanted(t)){var n={};n.type=t.type,n.timestamp=t.timestamp,n.id=t.id,"outbound-rtp"===t.type&&(n.ssrc=t.ssrc,n.firCount=t.firCount,n.pliCount=t.pliCount,n.nackCount=t.nackCount,n.qpSum=t.qpSum,t.kind?n.mediaType=t.kind:t.mediaType?n.mediaType=t.mediaType:n.mediaType=-1!==t.id.indexOf("VideoStream")?"video":"audio","video"===n.mediaType&&(n.framesEncoded=t.framesEncoded),n.packetsSent=t.packetsSent,n.bytesSent=t.bytesSent),"candidate-pair"===t.type&&void 0!==t.totalRoundTripTime&&(n.availableOutgoingBitrate=t.availableOutgoingBitrate,n.rtt=t.currentRoundTripTime,n.averageRtt=t.totalRoundTripTime/t.responsesReceived),"remote-inbound-rtp"===t.type||t.type,S.log(n)}})})}):e.getRTCPeerConnection().getReceivers().forEach(function(t){return t.getStats().then(function(t){t.forEach(function(t){if(e.isReportWanted(t)){var n={};n.type=t.type,n.timestamp=t.timestamp,n.id=t.id,"inbound-rtp"===t.type&&(n.ssrc=t.ssrc,n.firCount=t.firCount,n.pliCount=t.pliCount,n.nackCount=t.nackCount,n.qpSum=t.qpSum,t.kind?n.mediaType=t.kind:t.mediaType?n.mediaType=t.mediaType:n.mediaType=-1!==t.id.indexOf("VideoStream")?"video":"audio","video"===n.mediaType&&(n.framesDecoded=t.framesDecoded),n.packetsReceived=t.packetsReceived,n.packetsLost=t.packetsLost,n.jitter=t.jitter,n.bytesReceived=t.bytesReceived),"candidate-pair"===t.type&&void 0!==t.totalRoundTripTime&&(n.availableIncomingBitrate=t.availableIncomingBitrate,n.rtt=t.currentRoundTripTime,n.averageRtt=t.totalRoundTripTime/t.responsesReceived),"remote-inbound-rtp"===t.type||t.type,S.log(n)}})})})})},e.prototype.isReportWanted=function(e){return"inbound-rtp"===e.type&&!this.isLocal()||"outbound-rtp"===e.type&&this.isLocal()||"candidate-pair"===e.type&&e.nominated&&e.bytesSent>0},e}();t.Stream=w},1323:function(e,t,n){"use strict";var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.StreamManager=void 0;var s=n(9009),a=n(5097),c=n(9141),u=n(730),d=n(1250),l=n(5995),h=n(909),p=l.OpenViduLogger.getInstance(),f=function(e){function t(t,n){var r=e.call(this)||this;if(r.videos=[],r.lazyLaunchVideoElementCreatedEvent=!1,i=h.PlatformUtils.getInstance(),r.stream=t,r.stream.streamManager=r,r.remote=!r.stream.isLocal(),n){var o=void 0;"string"==typeof n?o=document.getElementById(n):n instanceof HTMLElement&&(o=n),o&&(r.firstVideoElement={targetElement:o,video:document.createElement("video"),id:"",canplayListenerAdded:!1},(i.isSafariBrowser()||i.isIPhoneOrIPad()&&(i.isChromeMobileBrowser()||i.isEdgeMobileBrowser()||i.isOperaMobileBrowser()||i.isFirefoxMobileBrowser()))&&(r.firstVideoElement.video.playsInline=!0),r.targetElement=o,r.element=o)}return r.canPlayListener=function(){r.deactivateStreamPlayingEventExceptionTimeout(),r.ee.emitEvent("streamPlaying",[new a.StreamManagerEvent(r,"streamPlaying",void 0)])},r}return o(t,e),t.prototype.on=function(t,n){return e.prototype.onAux.call(this,t,"Event '"+t+"' triggered by '"+(this.remote?"Subscriber":"Publisher")+"'",n),"videoElementCreated"===t&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&(this.ee.emitEvent("videoElementCreated",[new c.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!1),"streamPlaying"===t&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&this.ee.emitEvent("streamPlaying",[new a.StreamManagerEvent(this,"streamPlaying",void 0)]),this.stream.hasAudio&&("publisherStartSpeaking"===t&&this.stream.enableHarkSpeakingEvent(),"publisherStopSpeaking"===t&&this.stream.enableHarkStoppedSpeakingEvent(),"streamAudioVolumeChange"===t&&this.stream.enableHarkVolumeChangeEvent(!1)),this},t.prototype.once=function(t,n){return e.prototype.onceAux.call(this,t,"Event '"+t+"' triggered once by '"+(this.remote?"Subscriber":"Publisher")+"'",n),"videoElementCreated"===t&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&this.ee.emitEvent("videoElementCreated",[new c.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),"streamPlaying"===t&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&this.ee.emitEvent("streamPlaying",[new a.StreamManagerEvent(this,"streamPlaying",void 0)]),this.stream.hasAudio&&("publisherStartSpeaking"===t&&this.stream.enableOnceHarkSpeakingEvent(),"publisherStopSpeaking"===t&&this.stream.enableOnceHarkStoppedSpeakingEvent(),"streamAudioVolumeChange"===t&&this.stream.enableOnceHarkVolumeChangeEvent(!1)),this},t.prototype.off=function(t,n){return e.prototype.offAux.call(this,t,n),"publisherStartSpeaking"===t&&0===this.ee.getListeners(t).length+this.stream.session.ee.getListeners(t).length&&this.stream.disableHarkSpeakingEvent(!1),"publisherStopSpeaking"===t&&0===this.ee.getListeners(t).length+this.stream.session.ee.getListeners(t).length&&this.stream.disableHarkStoppedSpeakingEvent(!1),"streamAudioVolumeChange"===t&&0===this.ee.getListeners(t).length&&this.stream.disableHarkVolumeChangeEvent(!1),this},t.prototype.addVideoElement=function(e){this.initializeVideoProperties(e),!this.remote&&this.stream.displayMyRemote()&&e.srcObject!==this.stream.getMediaStream()&&(e.srcObject=this.stream.getMediaStream());for(var t=0,n=this.videos;t<n.length;t++)if(n[t].video===e)return 0;for(var r=1,i=0,o=this.stream.session.streamManagers;i<o.length;i++)if(o[i].disassociateVideo(e)){r=-1;break}return this.stream.session.streamManagers.forEach(function(t){t.disassociateVideo(e)}),this.pushNewStreamManagerVideo({video:e,id:e.id,canplayListenerAdded:!1}),p.info("New video element associated to ",this),r},t.prototype.createVideoElement=function(e,t){if("string"==typeof e){if(!(n=document.getElementById(e)))throw Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+e)}else if(e instanceof HTMLElement)n=e;else throw Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+e);var n,r=this.createVideo();this.initializeVideoProperties(r);var i=t||d.VideoInsertMode.APPEND;switch(i){case d.VideoInsertMode.AFTER:n.parentNode.insertBefore(r,n.nextSibling);break;case d.VideoInsertMode.APPEND:n.appendChild(r);break;case d.VideoInsertMode.BEFORE:n.parentNode.insertBefore(r,n);break;case d.VideoInsertMode.PREPEND:n.insertBefore(r,n.childNodes[0]);break;case d.VideoInsertMode.REPLACE:n.parentNode.replaceChild(r,n);break;default:i=d.VideoInsertMode.APPEND,n.appendChild(r)}var o={targetElement:n,video:r,insertMode:i,id:r.id,canplayListenerAdded:!1};return this.pushNewStreamManagerVideo(o),this.ee.emitEvent("videoElementCreated",[new c.VideoElementEvent(o.video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!!this.firstVideoElement,r},t.prototype.updatePublisherSpeakingEventsOptions=function(e){var t=this.stream.harkOptions?this.stream.harkOptions:this.stream.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{},n="number"==typeof e.interval?e.interval:"number"==typeof t.interval?t.interval:100,r="number"==typeof e.threshold?e.threshold:"number"==typeof t.threshold?t.threshold:-50;this.stream.harkOptions={interval:n,threshold:r},this.stream.speechEvent&&(this.stream.speechEvent.setInterval(n),this.stream.speechEvent.setThreshold(r))},t.prototype.initializeVideoProperties=function(e){!this.remote&&this.stream.displayMyRemote()||e.srcObject===this.stream.getMediaStream()||(e.srcObject=this.stream.getMediaStream()),e.autoplay=!0,e.controls=!1,(i.isSafariBrowser()||i.isIPhoneOrIPad()&&(i.isChromeMobileBrowser()||i.isEdgeMobileBrowser()||i.isOperaMobileBrowser()||i.isFirefoxMobileBrowser()))&&(e.playsInline=!0),e.id||(e.id=(this.remote?"remote-":"local-")+"video-"+this.stream.streamId,this.id||!this.targetElement||(this.id=e.id)),this.remote&&this.isMirroredVideo(e)?this.removeMirrorVideo(e):this.remote||this.stream.displayMyRemote()||(e.muted=!0,this.isMirroredVideo(e)&&!this.stream.outboundStreamOpts.publisherProperties.mirror?this.removeMirrorVideo(e):this.stream.outboundStreamOpts.publisherProperties.mirror&&!this.stream.isSendScreen()&&this.mirrorVideo(e))},t.prototype.removeAllVideos=function(){for(var e=this,t=this.stream.session.streamManagers.length-1;t>=0;--t)this.stream.session.streamManagers[t]===this&&this.stream.session.streamManagers.splice(t,1);this.videos.forEach(function(t){t.video&&t.video.removeEventListener&&t.video.removeEventListener("canplay",e.canPlayListener),t.canplayListenerAdded=!1,t.targetElement&&(t.video.parentNode.removeChild(t.video),e.ee.emitEvent("videoElementDestroyed",[new c.VideoElementEvent(t.video,e,"videoElementDestroyed")])),e.removeSrcObject(t),e.videos.filter(function(e){return!e.targetElement})})},t.prototype.disassociateVideo=function(e){for(var t=!1,n=0;n<this.videos.length;n++)if(this.videos[n].video===e){this.videos[n].video.removeEventListener("canplay",this.canPlayListener),this.videos.splice(n,1),t=!0,p.info("Video element disassociated from ",this);break}return t},t.prototype.addPlayEventToFirstVideo=function(){this.videos[0]&&this.videos[0].video&&!this.videos[0].canplayListenerAdded&&(this.activateStreamPlayingEventExceptionTimeout(),this.videos[0].video.addEventListener("canplay",this.canPlayListener),this.videos[0].canplayListenerAdded=!0)},t.prototype.updateMediaStream=function(e){this.videos.forEach(function(t){if(t.video.srcObject=e,i.isIonicIos()){var n=t.video.parentElement,r=t.video;n.replaceChild(r,t.video),t.video=r}})},t.prototype.emitEvent=function(e,t){this.ee.emitEvent(e,t)},t.prototype.createVideo=function(){return document.createElement("video")},t.prototype.removeSrcObject=function(e){e.video.srcObject=null,this.deactivateStreamPlayingEventExceptionTimeout()},t.prototype.pushNewStreamManagerVideo=function(e){this.videos.push(e),this.addPlayEventToFirstVideo(),-1===this.stream.session.streamManagers.indexOf(this)&&this.stream.session.streamManagers.push(this)},t.prototype.mirrorVideo=function(e){i.isIonicIos()||(e.style.transform="rotateY(180deg)",e.style.webkitTransform="rotateY(180deg)")},t.prototype.removeMirrorVideo=function(e){e.style.transform="unset",e.style.webkitTransform="unset"},t.prototype.isMirroredVideo=function(e){return"rotateY(180deg)"===e.style.transform||"rotateY(180deg)"===e.style.webkitTransform},t.prototype.activateStreamPlayingEventExceptionTimeout=function(){var e=this;if(this.remote&&null==this.streamPlayingEventExceptionTimeout){var t=this.stream.session.openvidu.advancedConfiguration.noStreamPlayingEventExceptionTimeout||4e3;this.streamPlayingEventExceptionTimeout=setTimeout(function(){var n="StreamManager of Stream "+e.stream.streamId+" ("+(e.remote?"Subscriber":"Publisher")+') did not trigger "streamPlaying" event in '+t+" ms";p.warn(n),e.stream.session.emitEvent("exception",[new u.ExceptionEvent(e.stream.session,u.ExceptionEventName.NO_STREAM_PLAYING_EVENT,e,n)]),delete e.streamPlayingEventExceptionTimeout},t)}},t.prototype.deactivateStreamPlayingEventExceptionTimeout=function(){clearTimeout(this.streamPlayingEventExceptionTimeout),delete this.streamPlayingEventExceptionTimeout},t}(s.EventDispatcher);t.StreamManager=f},3397:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Subscriber=void 0;var o=n(1323),s=n(5995).OpenViduLogger.getInstance(),a=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.element=i.targetElement,i.stream=t,i.properties=r,i}return i(t,e),t.prototype.subscribeToAudio=function(e){return this.stream.getMediaStream().getAudioTracks().forEach(function(t){t.enabled=e}),this.stream.audioActive=e,s.info("'Subscriber' has "+(e?"subscribed to":"unsubscribed from")+" its audio stream"),this},t.prototype.subscribeToVideo=function(e){return this.stream.getMediaStream().getVideoTracks().forEach(function(t){t.enabled=e}),this.stream.videoActive=e,s.info("'Subscriber' has "+(e?"subscribed to":"unsubscribed from")+" its video stream"),this},t.prototype.replaceTrackInMediaStream=function(e,t){var n,r=this.stream.getMediaStream();"video"===e.kind?(n=r.getVideoTracks()[0],t&&(this.stream.lastVideoTrackConstraints=e.getConstraints())):n=r.getAudioTracks()[0],r.removeTrack(n),n.stop(),r.addTrack(e)},t}(o.StreamManager);t.Subscriber=a},2746:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.EventDispatcher=t.ExceptionEventName=t.ExceptionEvent=t.SpeechToTextEvent=t.NetworkQualityLevelChangedEvent=t.FilterEvent=t.ConnectionPropertyChangedEvent=t.StreamPropertyChangedEvent=t.VideoElementEvent=t.StreamManagerEvent=t.StreamEvent=t.SignalEvent=t.SessionDisconnectedEvent=t.RecordingEvent=t.PublisherSpeakingEvent=t.ConnectionEvent=t.Event=t.VideoInsertMode=t.TypeOfVideo=t.OpenViduErrorName=t.OpenViduError=t.LocalRecorderState=t.Filter=t.LocalRecorder=t.Connection=t.Stream=t.StreamManager=t.Subscriber=t.Publisher=t.Session=t.OpenVidu=void 0;var o=n(2714),s=n(8827);Object.defineProperty(t,"OpenVidu",{enumerable:!0,get:function(){return s.OpenVidu}});var a=n(7945);Object.defineProperty(t,"Session",{enumerable:!0,get:function(){return a.Session}});var c=n(2079);Object.defineProperty(t,"Publisher",{enumerable:!0,get:function(){return c.Publisher}});var u=n(3397);Object.defineProperty(t,"Subscriber",{enumerable:!0,get:function(){return u.Subscriber}});var d=n(1323);Object.defineProperty(t,"StreamManager",{enumerable:!0,get:function(){return d.StreamManager}});var l=n(3639);Object.defineProperty(t,"Stream",{enumerable:!0,get:function(){return l.Stream}});var h=n(3415);Object.defineProperty(t,"Connection",{enumerable:!0,get:function(){return h.Connection}});var p=n(7391);Object.defineProperty(t,"LocalRecorder",{enumerable:!0,get:function(){return p.LocalRecorder}});var f=n(2666);Object.defineProperty(t,"Filter",{enumerable:!0,get:function(){return f.Filter}});var m=n(2767);Object.defineProperty(t,"LocalRecorderState",{enumerable:!0,get:function(){return m.LocalRecorderState}});var v=n(5512);Object.defineProperty(t,"OpenViduError",{enumerable:!0,get:function(){return v.OpenViduError}}),Object.defineProperty(t,"OpenViduErrorName",{enumerable:!0,get:function(){return v.OpenViduErrorName}});var g=n(4e3);Object.defineProperty(t,"TypeOfVideo",{enumerable:!0,get:function(){return g.TypeOfVideo}});var b=n(1250);Object.defineProperty(t,"VideoInsertMode",{enumerable:!0,get:function(){return b.VideoInsertMode}});var y=n(9704);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return y.Event}});var E=n(2802);Object.defineProperty(t,"ConnectionEvent",{enumerable:!0,get:function(){return E.ConnectionEvent}});var S=n(8349);Object.defineProperty(t,"PublisherSpeakingEvent",{enumerable:!0,get:function(){return S.PublisherSpeakingEvent}});var w=n(1372);Object.defineProperty(t,"RecordingEvent",{enumerable:!0,get:function(){return w.RecordingEvent}});var O=n(2343);Object.defineProperty(t,"SessionDisconnectedEvent",{enumerable:!0,get:function(){return O.SessionDisconnectedEvent}});var C=n(2316);Object.defineProperty(t,"SignalEvent",{enumerable:!0,get:function(){return C.SignalEvent}});var _=n(702);Object.defineProperty(t,"StreamEvent",{enumerable:!0,get:function(){return _.StreamEvent}});var I=n(5097);Object.defineProperty(t,"StreamManagerEvent",{enumerable:!0,get:function(){return I.StreamManagerEvent}});var R=n(9141);Object.defineProperty(t,"VideoElementEvent",{enumerable:!0,get:function(){return R.VideoElementEvent}});var T=n(3867);Object.defineProperty(t,"StreamPropertyChangedEvent",{enumerable:!0,get:function(){return T.StreamPropertyChangedEvent}});var k=n(9950);Object.defineProperty(t,"ConnectionPropertyChangedEvent",{enumerable:!0,get:function(){return k.ConnectionPropertyChangedEvent}});var x=n(9026);Object.defineProperty(t,"FilterEvent",{enumerable:!0,get:function(){return x.FilterEvent}});var P=n(2420);Object.defineProperty(t,"NetworkQualityLevelChangedEvent",{enumerable:!0,get:function(){return P.NetworkQualityLevelChangedEvent}});var N=n(252);Object.defineProperty(t,"SpeechToTextEvent",{enumerable:!0,get:function(){return N.SpeechToTextEvent}});var L=n(730);Object.defineProperty(t,"ExceptionEvent",{enumerable:!0,get:function(){return L.ExceptionEvent}}),Object.defineProperty(t,"ExceptionEventName",{enumerable:!0,get:function(){return L.ExceptionEventName}});var A=n(9009);Object.defineProperty(t,"EventDispatcher",{enumerable:!0,get:function(){return A.EventDispatcher}}),i(n(6964),t),o.JL.setOptions({enabled:!1})},5673:function(e,t,n){let r=n(1826),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(1706),{re:s,t:a}=n(3456),c=n(7266),{compareIdentifiers:u}=n(6585);class d{constructor(e,t){if(t=c(t),e instanceof d){if(!!t.loose===e.loose&&!!t.includePrerelease===e.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw TypeError(`Invalid Version: ${e}`);if(e.length>i)throw TypeError(`version is longer than ${i} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!n)throw TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){let t=+e;if(t>=0&&t<o)return t}return e}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof d)){if("string"==typeof e&&e===this.version)return 0;e=new d(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof d||(e=new d(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof d||(e=new d(e,this.options)),this.prerelease.length&&!e.prerelease.length)return -1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return -1;if(n===i)continue;else return u(n,i)}while(++t)}compareBuild(e){e instanceof d||(e=new d(e,this.options));let t=0;do{let n=this.build[t],i=e.build[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return -1;if(n===i)continue;else return u(n,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=d},9999:function(e,t,n){let r=n(5673);e.exports=(e,t)=>new r(e,t).major},1867:function(e,t,n){let r=n(5673);e.exports=(e,t)=>new r(e,t).minor},1706:function(e){let t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:t,MAX_SAFE_COMPONENT_LENGTH:16}},1826:function(e,t,n){var r=n(5566);let i="object"==typeof r&&r.env&&r.env.NODE_DEBUG&&/\bsemver\b/i.test(r.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=i},6585:function(e){let t=/^[0-9]+$/,n=(e,n)=>{let r=t.test(e),i=t.test(n);return r&&i&&(e=+e,n=+n),e===n?0:r&&!i?-1:i&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},7266:function(e){let t=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:t.filter(t=>e[t]).reduce((e,t)=>(e[t]=!0,e),{}):{}},3456:function(e,t,n){let{MAX_SAFE_COMPONENT_LENGTH:r}=n(1706),i=n(1826),o=(t=e.exports={}).re=[],s=t.src=[],a=t.t={},c=0,u=(e,t,n)=>{let r=c++;i(e,r,t),a[e]=r,s[r]=t,o[r]=new RegExp(t,n?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${s[a.NUMERICIDENTIFIER]}|${s[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${s[a.NUMERICIDENTIFIERLOOSE]}|${s[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${s[a.PRERELEASEIDENTIFIER]}(?:\\.${s[a.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${s[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[a.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${s[a.BUILDIDENTIFIER]}(?:\\.${s[a.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${s[a.MAINVERSION]}${s[a.PRERELEASE]}?${s[a.BUILD]}?`),u("FULL",`^${s[a.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${s[a.MAINVERSIONLOOSE]}${s[a.PRERELEASELOOSE]}?${s[a.BUILD]}?`),u("LOOSE",`^${s[a.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${s[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${s[a.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:${s[a.PRERELEASE]})?${s[a.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:${s[a.PRERELEASELOOSE]})?${s[a.BUILD]}?)?)?`),u("XRANGE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),u("COERCERTL",s[a.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${s[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${s[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${s[a.LONECARET]}${s[a.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${s[a.LONECARET]}${s[a.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${s[a.GTLT]}\\s*(${s[a.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]}|${s[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${s[a.XRANGEPLAIN]})\\s+-\\s+(${s[a.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${s[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[a.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},2812:function(e,t,n){var r;e=n.nmd(e),(function(){"use strict";var i={function:!0,object:!0},o=i[typeof window]&&window||this,s=i[typeof t]&&t,a=i.object&&e&&!e.nodeType&&e,c=s&&a&&"object"==typeof n.g&&n.g;c&&(c.global===c||c.window===c||c.self===c)&&(o=c);var u=/\bOpera/,d=Object.prototype,l=d.hasOwnProperty,h=d.toString;function p(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function f(e){return e=y(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:p(e)}function m(e,t){for(var n in e)l.call(e,n)&&t(e[n],n,e)}function v(e){return null==e?p(e):h.call(e).slice(8,-1)}function g(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function b(e,t){var n=null;return function(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r&&r>-1&&r<=9007199254740991)for(;++n<r;)t(e[n],n,e);else m(e,t)}(e,function(r,i){n=t(n,r,i,e)}),n}function y(e){return String(e).replace(/^ +| +$/g,"")}var E=function e(t){var n,r,i,s,a,c=o,d=t&&"object"==typeof t&&"String"!=v(t);d&&(c=t,t=null);var l=c.navigator||{},p=l.userAgent||"";t||(t=p);var E=d?!!l.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(h.toString()),S="Object",w=d&&c.java?"JavaPackage":v(c.java),O=/\bJava/.test(w)&&c.java,C=O&&v(c.environment)==(d?S:"Environment"),_=c.document||{},I=c.operamini||c.opera,R=u.test(R=d&&I?I["[[Class]]"]:v(I))?R:I=null,T=t,k=[],x=null,P=t==p,N=P&&I&&"function"==typeof I.version&&I.version(),L=b([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(e,n){return e||RegExp("\\b"+(n.pattern||g(n))+"\\b","i").exec(t)&&(n.label||n)}),A=b(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],function(e,n){return e||RegExp("\\b"+(n.pattern||g(n))+"\\b","i").exec(t)&&(n.label||n)}),M=j([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),V=b({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}},function(e,n,r){return e||(n[M]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(M)]||RegExp("\\b"+g(r)+"(?:\\b|\\w*\\d)","i").exec(t))&&r}),D=b(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],function(e,n){var r,i,o,s=n.pattern||g(n);return!e&&(e=RegExp("\\b"+s+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(r=e,i=n.label||n,o={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"},s&&i&&/^Win/i.test(r)&&!/^Windows Phone /i.test(r)&&(o=o[/[\d.]+$/.exec(r)])&&(r="Windows "+o),r=String(r),s&&i&&(r=r.replace(RegExp(s,"i"),i)),e=r=f(r.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])),e});function j(e){return b(e,function(e,n){var r=n.pattern||g(n);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=f(e[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e})}function B(e){return b(e,function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null})}if(L&&(L=[L]),/\bAndroid\b/.test(D)&&!M&&(s=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(M=y(s[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),V&&!M?M=j([V]):V&&M&&(M=M.replace(RegExp("^("+g(V)+")[-_.\\s]","i"),V+" ").replace(RegExp("^("+g(V)+")[-_.]?(\\w)","i"),V+" $2")),(s=/\bGoogle TV\b/.exec(M))&&(M=s[0]),/\bSimulator\b/i.test(t)&&(M=(M?M+" ":"")+"Simulator"),"Opera Mini"==A&&/\bOPiOS\b/.test(t)&&k.push("running in Turbo/Uncompressed mode"),"IE"==A&&/\blike iPhone OS\b/.test(t)?(V=(s=e(t.replace(/like iPhone OS/,""))).manufacturer,M=s.product):/^iP/.test(M)?(A||(A="Safari"),D="iOS"+((s=/ OS ([\d_]+)/i.exec(t))?" "+s[1].replace(/_/g,"."):"")):"Konqueror"==A&&/^Linux\b/i.test(D)?D="Kubuntu":V&&"Google"!=V&&(/Chrome/.test(A)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(M))||/\bAndroid\b/.test(D)&&/^Chrome/.test(A)&&/\bVersion\//i.test(t)?(A="Android Browser",D=/\bAndroid\b/.test(D)?D:"Android"):"Silk"==A?(/\bMobi/i.test(t)||(D="Android",k.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&k.unshift("accelerated")):"UC Browser"==A&&/\bUCWEB\b/.test(t)?k.push("speed mode"):"PaleMoon"==A&&(s=/\bFirefox\/([\d.]+)\b/.exec(t))?k.push("identifying as Firefox "+s[1]):"Firefox"==A&&(s=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(D||(D="Firefox OS"),M||(M=s[1])):!A||(s=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(A))?(A&&!M&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(s+"/")+8))&&(A=null),(s=M||V||D)&&(M||V||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(D))&&(A=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(D)?D:s)+" Browser")):"Electron"==A&&(s=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&k.push("Chromium "+s),N||(N=B(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",g(A),"(?:Firefox|Minefield|NetFront)"])),(s="iCab"==L&&parseFloat(N)>3&&"WebKit"||/\bOpera\b/.test(A)&&(/\bOPR\b/.test(t)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(L)&&"WebKit"||!L&&/\bMSIE\b/i.test(t)&&("Mac OS"==D?"Tasman":"Trident")||"WebKit"==L&&/\bPlayStation\b(?! Vita\b)/i.test(A)&&"NetFront")&&(L=[s]),"IE"==A&&(s=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(A+=" Mobile",D="Windows Phone "+(/\+$/.test(s)?s:s+".x"),k.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(A="IE Mobile",D="Windows Phone 8.x",k.unshift("desktop mode"),N||(N=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=A&&"Trident"==L&&(s=/\brv:([\d.]+)/.exec(t))&&(A&&k.push("identifying as "+A+(N?" "+N:"")),A="IE",N=s[1]),P){if(r="global",i=null!=(n=c)?typeof n[r]:"number",/^(?:boolean|number|string|undefined)$/.test(i)||"object"==i&&!n[r])v(s=c.runtime)==(d?S:"ScriptBridgingProxyObject")?(A="Adobe AIR",D=s.flash.system.Capabilities.os):v(s=c.phantom)==(d?S:"RuntimeObject")?(A="PhantomJS",N=(s=s.version||null)&&s.major+"."+s.minor+"."+s.patch):"number"==typeof _.documentMode&&(s=/\bTrident\/(\d+)/i.exec(t))?(N=[N,_.documentMode],(s=+s[1]+4)!=N[1]&&(k.push("IE "+N[1]+" mode"),L&&(L[1]=""),N[1]=s),N="IE"==A?String(N[1].toFixed(1)):N[0]):"number"==typeof _.documentMode&&/^(?:Chrome|Firefox)\b/.test(A)&&(k.push("masking as "+A+" "+N),A="IE",N="11.0",L=["Trident"],D="Windows");else if(O&&(T=(s=O.lang.System).getProperty("os.arch"),D=D||s.getProperty("os.name")+" "+s.getProperty("os.version")),C){try{N=c.require("ringo/engine").version.join("."),A="RingoJS"}catch(e){(s=c.system)&&s.global.system==c.system&&(A="Narwhal",D||(D=s[0].os||null))}A||(A="Rhino")}else"object"==typeof c.process&&!c.process.browser&&(s=c.process)&&("object"==typeof s.versions&&("string"==typeof s.versions.electron?(k.push("Node "+s.versions.node),A="Electron",N=s.versions.electron):"string"==typeof s.versions.nw&&(k.push("Chromium "+N,"Node "+s.versions.node),A="NW.js",N=s.versions.nw)),A||(A="Node.js",T=s.arch,D=s.platform,N=(N=/[\d.]+/.exec(s.version))?N[0]:null));D=D&&f(D)}if(N&&(s=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(N)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(P&&l.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(x=/b/i.test(s)?"beta":"alpha",N=N.replace(RegExp(s+"\\+?$"),"")+("beta"==x?O?"b":"β":O?"a":"α")+(/\d+\+?/.exec(s)||"")),"Fennec"==A||"Firefox"==A&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(D))A="Firefox Mobile";else if("Maxthon"==A&&N)N=N.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(M))"Xbox 360"==M&&(D=null),"Xbox 360"==M&&/\bIEMobile\b/.test(t)&&k.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(A)||A&&!M&&!/Browser|Mobi/.test(A))&&("Windows CE"==D||/Mobi/i.test(t)))A+=" Mobile";else if("IE"==A&&P)try{null===c.external&&k.unshift("platform preview")}catch(e){k.unshift("embedded")}else(/\bBlackBerry\b/.test(M)||/\bBB10\b/.test(t))&&(s=(RegExp(M.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||N)?(D=((s=[s,/BB10/.test(t)])[1]?(M=null,V="BlackBerry"):"Device Software")+" "+s[0],N=null):this!=m&&"Wii"!=M&&(P&&I||/Opera/.test(A)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==A&&/\bOS X (?:\d+\.){2,}/.test(D)||"IE"==A&&(D&&!/^Win/.test(D)&&N>5.5||/\bWindows XP\b/.test(D)&&N>8||8==N&&!/\bTrident\b/.test(t)))&&!u.test(s=e.call(m,t.replace(u,"")+";"))&&s.name&&(s="ing as "+s.name+((s=s.version)?" "+s:""),u.test(A)?(/\bIE\b/.test(s)&&"Mac OS"==D&&(D=null),s="identify"+s):(s="mask"+s,A=R?f(R.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(s)&&(D=null),P||(N=null)),L=["Presto"],k.push(s));(s=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(s=[parseFloat(s.replace(/\.(\d)$/,".0$1")),s],"Safari"==A&&"+"==s[1].slice(-1)?(A="WebKit Nightly",x="alpha",N=s[1].slice(0,-1)):(N==s[1]||N==(s[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1]))&&(N=null),s[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==s[0]&&537.36==s[2]&&parseFloat(s[1])>=28&&"WebKit"==L&&(L=["Blink"]),P&&(E||s[1])?(L&&(L[1]="like Chrome"),s=s[1]||((s=s[0])<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?"13+":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?"21+":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:"Blink"!=L?"27":"28")):(L&&(L[1]="like Safari"),s=(s=s[0])<400?1:s<500?2:s<526?3:s<533?4:s<534?"4+":s<535?5:s<537?6:s<538?7:s<601?8:s<602?9:s<604?10:s<606?11:s<608?12:"12"),L&&(L[1]+=" "+(s+="number"==typeof s?".x":/[.+]/.test(s)?"":"+")),"Safari"==A&&(!N||parseInt(N)>45)?N=s:"Chrome"==A&&/\bHeadlessChrome/i.test(t)&&k.unshift("headless")),"Opera"==A&&(s=/\bzbov|zvav$/.exec(D))?(A+=" ",k.unshift("desktop mode"),"zvav"==s?(A+="Mini",N=null):A+="Mobile",D=D.replace(RegExp(" *"+s+"$"),"")):"Safari"==A&&/\bChrome\b/.exec(L&&L[1])?(k.unshift("desktop mode"),A="Chrome Mobile",N=null,/\bOS X\b/.test(D)?(V="Apple",D="iOS 4.3+"):D=null):/\bSRWare Iron\b/.test(A)&&!N&&(N=B("Chrome")),N&&0==N.indexOf(s=/[\d.]+$/.exec(D))&&t.indexOf("/"+s+"-")>-1&&(D=y(D.replace(s,""))),D&&-1!=D.indexOf(A)&&!RegExp(A+" OS").test(D)&&(D=D.replace(RegExp(" *"+g(A)+" *"),"")),L&&!/\b(?:Avant|Nook)\b/.test(A)&&(/Browser|Lunascape|Maxthon/.test(A)||"Safari"!=A&&/^iOS/.test(D)&&/\bSafari\b/.test(L[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(A)&&L[1])&&(s=L[L.length-1])&&k.push(s),k.length&&(k=["("+k.join("; ")+")"]),V&&M&&0>M.indexOf(V)&&k.push("on "+V),M&&k.push((/^on /.test(k[k.length-1])?"":"on ")+M),D&&(a=(s=/ ([\d.+]+)$/.exec(D))&&"/"==D.charAt(D.length-s[0].length-1),D={architecture:32,family:s&&!a?D.replace(s[0],""):D,version:s?s[1]:null,toString:function(){var e=this.version;return this.family+(e&&!a?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(s=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(T))&&!/\bi686\b/i.test(T)?(D&&(D.architecture=64,D.family=D.family.replace(RegExp(" *"+s),"")),A&&(/\bWOW64\b/i.test(t)||P&&/\w(?:86|32)$/.test(l.cpuClass||l.platform)&&!/\bWin64; x64\b/i.test(t))&&k.unshift("32-bit")):D&&/^OS X/.test(D.family)&&"Chrome"==A&&parseFloat(N)>=39&&(D.architecture=64),t||(t=null);var U={};return U.description=t,U.layout=L&&L[0],U.manufacturer=V,U.name=A,U.prerelease=x,U.product=M,U.ua=t,U.version=A&&N,U.os=D||{architecture:null,family:null,version:null,toString:function(){return"null"}},U.parse=e,U.toString=function(){return this.description||""},U.version&&k.unshift(N),U.name&&k.unshift(A),D&&A&&!(D==String(D).split(" ")[0]&&(D==A.split(" ")[0]||M))&&k.push(M?"("+D+")":"on "+D),k.length&&(U.description=k.join(" ")),U}();o.platform=E,void 0!==(r=(function(){return E}).call(t,n,t,e))&&(e.exports=r)}).call(this)},5566:function(e){var t,n,r,i=e.exports={};function o(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var c=[],u=!1,d=-1;function l(){u&&r&&(u=!1,r.length?c=r.concat(c):d=-1,c.length&&h())}function h(){if(!u){var e=a(l);u=!0;for(var t=c.length;t;){for(r=c,c=[];++d<t;)r&&r[d].run();d=-1,t=c.length}r=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||u||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=f,i.addListener=f,i.once=f,i.off=f,i.removeListener=f,i.removeAllListeners=f,i.emit=f,i.prependListener=f,i.prependOnceListener=f,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}},4176:function(e,t){"use strict";var n,r=Object.prototype.hasOwnProperty;function i(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function o(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){var i,s,a=[];for(s in"string"!=typeof(t=t||"")&&(t="?"),e)if(r.call(e,s)){if(!(i=e[s])&&(null===i||i===n||isNaN(i))&&(i=""),s=o(s),i=o(i),null===s||null===i)continue;a.push(s+"="+i)}return a.length?t+a.join("&"):""},t.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,r={};t=n.exec(e);){var o=i(t[1]),s=i(t[2]);null===o||null===s||o in r||(r[o]=s)}return r}},7642:function(e){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},3085:function(e,t,n){"use strict";var r=n(8663);e.exports=n(4045)(r),"_sockjs_onload"in n.g&&setTimeout(n.g._sockjs_onload,1)},5346:function(e,t,n){"use strict";var r=n(5335),i=n(6111);function o(){i.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}r(o,i),e.exports=o},3742:function(e,t,n){"use strict";var r=n(5335),i=n(6142);function o(){i.call(this)}r(o,i),o.prototype.removeAllListeners=function(e){e?delete this._listeners[e]:this._listeners={}},o.prototype.once=function(e,t){var n=this,r=!1;this.on(e,function i(){n.removeListener(e,i),r||(r=!0,t.apply(this,arguments))})},o.prototype.emit=function(){var e=arguments[0],t=this._listeners[e];if(t){for(var n=arguments.length,r=Array(n-1),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=0;o<t.length;o++)t[o].apply(this,r)}},o.prototype.on=o.prototype.addListener=i.prototype.addEventListener,o.prototype.removeListener=i.prototype.removeEventListener,e.exports.v=o},6111:function(e){"use strict";function t(e){this.type=e}t.prototype.initEvent=function(e,t,n){return this.type=e,this.bubbles=t,this.cancelable=n,this.timeStamp=+new Date,this},t.prototype.stopPropagation=function(){},t.prototype.preventDefault=function(){},t.CAPTURING_PHASE=1,t.AT_TARGET=2,t.BUBBLING_PHASE=3,e.exports=t},6142:function(e){"use strict";function t(){this._listeners={}}t.prototype.addEventListener=function(e,t){e in this._listeners||(this._listeners[e]=[]);var n=this._listeners[e];-1===n.indexOf(t)&&(n=n.concat([t])),this._listeners[e]=n},t.prototype.removeEventListener=function(e,t){var n=this._listeners[e];if(n){var r=n.indexOf(t);if(-1!==r){n.length>1?this._listeners[e]=n.slice(0,r).concat(n.slice(r+1)):delete this._listeners[e];return}}},t.prototype.dispatchEvent=function(){var e=arguments[0],t=e.type,n=1==arguments.length?[e]:Array.apply(null,arguments);if(this["on"+t]&&this["on"+t].apply(this,n),t in this._listeners)for(var r=this._listeners[t],i=0;i<r.length;i++)r[i].apply(this,n)},e.exports=t},5562:function(e,t,n){"use strict";var r=n(5335),i=n(6111);function o(e){i.call(this),this.initEvent("message",!1,!1),this.data=e}r(o,i),e.exports=o},7653:function(e,t,n){"use strict";var r=n(7957);function i(e){this._transport=e,e.on("message",this._transportMessage.bind(this)),e.on("close",this._transportClose.bind(this))}i.prototype._transportClose=function(e,t){r.postMessage("c",JSON.stringify([e,t]))},i.prototype._transportMessage=function(e){r.postMessage("t",e)},i.prototype._send=function(e){this._transport.send(e)},i.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},e.exports=i},3902:function(e,t,n){"use strict";var r=n(5302),i=n(8728),o=n(7653),s=n(8936),a=n(7957),c=n(1424),u=function(){};e.exports=function(e,t){var n,d={};t.forEach(function(e){e.facadeTransport&&(d[e.facadeTransport.transportName]=e.facadeTransport)}),d[s.transportName]=s,e.bootstrap_iframe=function(){var t;a.currentWindowId=c.hash.slice(1),i.attachEvent("message",function(i){if(i.source===parent&&(void 0===n&&(n=i.origin),i.origin===n)){try{s=JSON.parse(i.data)}catch(e){u("bad json",i.data);return}if(s.windowId===a.currentWindowId)switch(s.type){case"s":try{l=JSON.parse(s.data)}catch(e){u("bad json",s.data);break}var s,l,h=l[0],p=l[1],f=l[2],m=l[3];if(u(h,p,f,m),h!==e.version)throw Error('Incompatible SockJS! Main site uses: "'+h+'", the iframe: "'+e.version+'".');if(!r.isOriginEqual(f,c.href)||!r.isOriginEqual(m,c.href))throw Error("Can't connect to different domain from within an iframe. ("+c.href+", "+f+", "+m+")");t=new o(new d[p](f,m));break;case"m":t._send(s.data);break;case"c":t&&t._close(),t=null}}}),a.postMessage("s")}}},5293:function(e,t,n){"use strict";var r=n(3742).v,i=n(5335),o=n(4405),s=function(){};function a(e,t){r.call(this);var n=this,i=+new Date;this.xo=new t("GET",e),this.xo.once("finish",function(e,t){var r,a;if(200===e){if(a=+new Date-i,t)try{r=JSON.parse(t)}catch(e){s("bad json",t)}o.isObject(r)||(r={})}n.emit("finish",r,a),n.removeAllListeners()})}i(a,r),a.prototype.close=function(){this.removeAllListeners(),this.xo.close()},e.exports=a},8936:function(e,t,n){"use strict";var r=n(5335),i=n(3742).v,o=n(4731),s=n(5293);function a(e){var t=this;i.call(this),this.ir=new s(e,o),this.ir.once("finish",function(e,n){t.ir=null,t.emit("message",JSON.stringify([e,n]))})}r(a,i),a.transportName="iframe-info-receiver",a.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},e.exports=a},236:function(e,t,n){"use strict";var r=n(3742).v,i=n(5335),o=n(8728),s=n(918),a=n(8936),c=function(){};function u(e,t){var i=this;r.call(this);var u=function(){var n=i.ifr=new s(a.transportName,t,e);n.once("message",function(e){if(e){try{t=JSON.parse(e)}catch(t){c("bad json",e),i.emit("finish"),i.close();return}var t,n=t[0],r=t[1];i.emit("finish",n,r)}i.close()}),n.once("close",function(){i.emit("finish"),i.close()})};n.g.document.body?u():o.attachEvent("load",u)}i(u,r),u.enabled=function(){return s.enabled()},u.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},e.exports=u},690:function(e,t,n){"use strict";var r=n(3742).v,i=n(5335),o=n(5302),s=n(5526),a=n(6212),c=n(4731),u=n(8078),d=n(236),l=n(5293),h=function(){};function p(e,t){h(e);var n=this;r.call(this),setTimeout(function(){n.doXhr(e,t)},0)}i(p,r),p._getReceiver=function(e,t,n){return n.sameOrigin?new l(t,c):a.enabled?new l(t,a):s.enabled&&n.sameScheme?new l(t,s):d.enabled()?new d(e,t):new l(t,u)},p.prototype.doXhr=function(e,t){var n=this,r=o.addPath(e,"/info");h("doXhr",r),this.xo=p._getReceiver(e,r,t),this.timeoutRef=setTimeout(function(){h("timeout"),n._cleanup(!1),n.emit("finish")},p.timeout),this.xo.once("finish",function(e,t){h("finish",e,t),n._cleanup(!0),n.emit("finish",e,t)})},p.prototype._cleanup=function(e){h("_cleanup"),clearTimeout(this.timeoutRef),this.timeoutRef=null,!e&&this.xo&&this.xo.close(),this.xo=null},p.prototype.close=function(){h("close"),this.removeAllListeners(),this._cleanup(!1)},p.timeout=8e3,e.exports=p},1424:function(e,t,n){"use strict";e.exports=n.g.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}},4045:function(e,t,n){"use strict";n(7514);var r,i=n(9868),o=n(5335),s=n(2716),a=n(3190),c=n(5302),u=n(8728),d=n(2488),l=n(4405),h=n(8126),p=n(6815),f=n(6111),m=n(6142),v=n(1424),g=n(5346),b=n(5562),y=n(690),E=function(){};function S(e,t,n){if(!(this instanceof S))return new S(e,t,n);if(arguments.length<1)throw TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");m.call(this),this.readyState=S.CONNECTING,this.extensions="",this.protocol="",(n=n||{}).protocols_whitelist&&p.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=n.transports,this._transportOptions=n.transportOptions||{},this._timeout=n.timeout||0;var r=n.sessionId||8;if("function"==typeof r)this._generateSessionId=r;else if("number"==typeof r)this._generateSessionId=function(){return s.string(r)};else throw TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._server=n.server||s.numberString(1e3);var o=new i(e);if(o.host&&o.protocol){if(o.hash)throw SyntaxError("The URL must not contain a fragment");if("http:"!==o.protocol&&"https:"!==o.protocol)throw SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+o.protocol+"' is not allowed.")}else throw SyntaxError("The URL '"+e+"' is invalid");var a="https:"===o.protocol;if("https:"===v.protocol&&!a&&!c.isLoopbackAddr(o.hostname))throw Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");t?Array.isArray(t)||(t=[t]):t=[];var u=t.sort();u.forEach(function(e,t){if(!e)throw SyntaxError("The protocols entry '"+e+"' is invalid.");if(t<u.length-1&&e===u[t+1])throw SyntaxError("The protocols entry '"+e+"' is duplicated.")});var d=c.getOrigin(v.href);this._origin=d?d.toLowerCase():null,o.set("pathname",o.pathname.replace(/\/+$/,"")),this.url=o.href,E("using url",this.url),this._urlInfo={nullOrigin:!h.hasDomain(),sameOrigin:c.isOriginEqual(this.url,v.href),sameScheme:c.isSchemeEqual(this.url,v.href)},this._ir=new y(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}function w(e){return 1e3===e||e>=3e3&&e<=4999}o(S,m),S.prototype.close=function(e,t){if(e&&!w(e))throw Error("InvalidAccessError: Invalid code");if(t&&t.length>123)throw SyntaxError("reason argument has an invalid length");this.readyState!==S.CLOSING&&this.readyState!==S.CLOSED&&this._close(e||1e3,t||"Normal closure",!0)},S.prototype.send=function(e){if("string"!=typeof e&&(e=""+e),this.readyState===S.CONNECTING)throw Error("InvalidStateError: The connection has not been established yet");this.readyState===S.OPEN&&this._transport.send(a.quote(e))},S.version=n(8297),S.CONNECTING=0,S.OPEN=1,S.CLOSING=2,S.CLOSED=3,S.prototype._receiveInfo=function(e,t){if(E("_receiveInfo",t),this._ir=null,!e){this._close(1002,"Cannot connect to server");return}this._rto=this.countRTO(t),this._transUrl=e.base_url?e.base_url:this.url,E("info",e=l.extend(e,this._urlInfo));var n=r.filterToEnabled(this._transportsWhitelist,e);this._transports=n.main,E(this._transports.length+" enabled transports"),this._connect()},S.prototype._connect=function(){for(var e=this._transports.shift();e;e=this._transports.shift()){if(E("attempt",e.transportName),e.needBody&&(!n.g.document.body||void 0!==n.g.document.readyState&&"complete"!==n.g.document.readyState&&"interactive"!==n.g.document.readyState)){E("waiting for body"),this._transports.unshift(e),u.attachEvent("load",this._connect.bind(this));return}var t=Math.max(this._timeout,this._rto*e.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),t),E("using timeout",t);var r=c.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),i=this._transportOptions[e.transportName];E("transport url",r);var o=new e(r,this._transUrl,i);o.on("message",this._transportMessage.bind(this)),o.once("close",this._transportClose.bind(this)),o.transportName=e.transportName,this._transport=o;return}this._close(2e3,"All transports failed",!1)},S.prototype._transportTimeout=function(){E("_transportTimeout"),this.readyState===S.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))},S.prototype._transportMessage=function(e){E("_transportMessage",e);var t,n=this,r=e.slice(0,1),i=e.slice(1);switch(r){case"o":this._open();return;case"h":this.dispatchEvent(new f("heartbeat")),E("heartbeat",this.transport);return}if(i)try{t=JSON.parse(i)}catch(e){E("bad json",i)}if(void 0===t){E("empty payload",i);return}switch(r){case"a":Array.isArray(t)&&t.forEach(function(e){E("message",n.transport,e),n.dispatchEvent(new b(e))});break;case"m":E("message",this.transport,t),this.dispatchEvent(new b(t));break;case"c":Array.isArray(t)&&2===t.length&&this._close(t[0],t[1],!0)}},S.prototype._transportClose=function(e,t){if(E("_transportClose",this.transport,e,t),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),!w(e)&&2e3!==e&&this.readyState===S.CONNECTING){this._connect();return}this._close(e,t)},S.prototype._open=function(){E("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===S.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=S.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new f("open")),E("connected",this.transport)):this._close(1006,"Server lost session")},S.prototype._close=function(e,t,n){E("_close",this.transport,e,t,n,this.readyState);var r=!1;if(this._ir&&(r=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===S.CLOSED)throw Error("InvalidStateError: SockJS has already been closed");this.readyState=S.CLOSING,setTimeout((function(){this.readyState=S.CLOSED,r&&this.dispatchEvent(new f("error"));var i=new g("close");i.wasClean=n||!1,i.code=e||1e3,i.reason=t,this.dispatchEvent(i),this.onmessage=this.onclose=this.onerror=null,E("disconnected")}).bind(this),0)},S.prototype.countRTO=function(e){return e>100?4*e:300+e},e.exports=function(e){return r=d(e),n(3902)(S,e),S}},7514:function(){"use strict";var e,t,n,r,i,o=Array.prototype,s=Object.prototype,a=Function.prototype,c=String.prototype,u=o.slice,d=s.toString,l=function(e){return"[object Function]"===s.toString.call(e)},h=function(e){return"[object String]"===d.call(e)};i=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}()?function(e,t,n,r){!r&&t in e||Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:n})}:function(e,t,n,r){!r&&t in e||(e[t]=n)};var p=function(e,t,n){for(var r in t)s.hasOwnProperty.call(t,r)&&i(e,r,t[r],n)},f=function(e){if(null==e)throw TypeError("can't convert "+e+" to object");return Object(e)};function m(){}p(a,{bind:function(e){var t=this;if(!l(t))throw TypeError("Function.prototype.bind called on incompatible "+t);for(var n=u.call(arguments,1),r=Math.max(0,t.length-n.length),i=[],o=0;o<r;o++)i.push("$"+o);var s=Function("binder","return function ("+i.join(",")+"){ return binder.apply(this, arguments); }")(function(){if(!(this instanceof s))return t.apply(e,n.concat(u.call(arguments)));var r=t.apply(this,n.concat(u.call(arguments)));return Object(r)===r?r:this});return t.prototype&&(m.prototype=t.prototype,s.prototype=new m,m.prototype=null),s}}),p(Array,{isArray:function(e){return"[object Array]"===d.call(e)}});var v=Object("a"),g="a"!==v[0]||!(0 in v);p(o,{forEach:function(e){var t=f(this),n=g&&h(this)?this.split(""):t,r=arguments[1],i=-1,o=n.length>>>0;if(!l(e))throw TypeError();for(;++i<o;)i in n&&e.call(r,n[i],i,t)}},(e=o.forEach,t=!0,n=!0,e&&(e.call("foo",function(e,n,r){"object"!=typeof r&&(t=!1)}),e.call([1],function(){n="string"==typeof this},"x")),!e||!t||!n)),p(o,{indexOf:function(e){var t,n,r=g&&h(this)?this.split(""):f(this),i=r.length>>>0;if(!i)return -1;var o=0;for(arguments.length>1&&(t=arguments[1],(n=+t)!=n?n=0:0!==n&&n!==1/0&&n!==-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n))),o=n),o=o>=0?o:Math.max(0,i+o);o<i;o++)if(o in r&&r[o]===e)return o;return -1}},Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2));var b=c.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?(r=void 0===/()??/.exec("")[1],c.split=function(e,t){var n=this;if(void 0===e&&0===t)return[];if("[object RegExp]"!==d.call(e))return b.call(this,e,t);var i,s,a,c,u=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),h=0;for(e=RegExp(e.source,l+"g"),n+="",r||(i=RegExp("^"+e.source+"$(?!\\s)",l)),t=void 0===t?4294967295:t>>>0;(s=e.exec(n))&&(!((a=s.index+s[0].length)>h)||(u.push(n.slice(h,s.index)),!r&&s.length>1&&s[0].replace(i,function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(s[e]=void 0)}),s.length>1&&s.index<n.length&&o.push.apply(u,s.slice(1)),c=s[0].length,h=a,!(u.length>=t)));)e.lastIndex===s.index&&e.lastIndex++;return h===n.length?(c||!e.test(""))&&u.push(""):u.push(n.slice(h)),u.length>t?u.slice(0,t):u}):"0".split(void 0,0).length&&(c.split=function(e,t){return void 0===e&&0===t?[]:b.call(this,e,t)});var y=c.substr;p(c,{substr:function(e,t){return y.call(this,e<0&&(e=this.length+e)<0?0:e,t)}},"".substr&&"b"!=="0b".substr(-1))},8663:function(e,t,n){"use strict";e.exports=[n(2160),n(6900),n(5920),n(2764),n(9662)(n(2764)),n(8726),n(9662)(n(8726)),n(5859),n(5545),n(9662)(n(5859)),n(3892)]},6330:function(e,t,n){"use strict";var r=n(3742).v,i=n(5335),o=n(8728),s=n(5302),a=n.g.XMLHttpRequest,c=function(){};function u(e,t,n,i){c(e,t);var o=this;r.call(this),setTimeout(function(){o._start(e,t,n,i)},0)}i(u,r),u.prototype._start=function(e,t,n,r){var i=this;try{this.xhr=new a}catch(e){}if(!this.xhr){c("no xhr"),this.emit("finish",0,"no xhr support"),this._cleanup();return}t=s.addQuery(t,"t="+ +new Date),this.unloadRef=o.unloadAdd(function(){c("unload cleanup"),i._cleanup(!0)});try{this.xhr.open(e,t,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){c("xhr timeout"),i.emit("finish",0,""),i._cleanup(!1)})}catch(e){c("exception",e),this.emit("finish",0,""),this._cleanup(!1);return}if(r&&r.noCredentials||!u.supportsCORS||(c("withCredentials"),this.xhr.withCredentials=!0),r&&r.headers)for(var d in r.headers)this.xhr.setRequestHeader(d,r.headers[d]);this.xhr.onreadystatechange=function(){if(i.xhr){var e,t,n=i.xhr;switch(c("readyState",n.readyState),n.readyState){case 3:try{t=n.status,e=n.responseText}catch(e){}c("status",t),1223===t&&(t=204),200===t&&e&&e.length>0&&(c("chunk"),i.emit("chunk",t,e));break;case 4:c("status",t=n.status),1223===t&&(t=204),(12005===t||12029===t)&&(t=0),c("finish",t,n.responseText),i.emit("finish",t,n.responseText),i._cleanup(!1)}}};try{i.xhr.send(n)}catch(e){i.emit("finish",0,""),i._cleanup(!1)}},u.prototype._cleanup=function(e){if(c("cleanup"),this.xhr){if(this.removeAllListeners(),o.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),e)try{this.xhr.abort()}catch(e){}this.unloadRef=this.xhr=null}},u.prototype.close=function(){c("close"),this._cleanup(!0)},u.enabled=!!a;var d=["Active"].concat("Object").join("X");!u.enabled&&d in n.g&&(c("overriding xmlhttprequest"),a=function(){try{return new n.g[d]("Microsoft.XMLHTTP")}catch(e){return null}},u.enabled=(new a,!0));var l=!1;try{l="withCredentials"in new a}catch(e){}u.supportsCORS=l,e.exports=u},2427:function(e,t,n){e.exports=n.g.EventSource},3435:function(e,t,n){"use strict";var r=n.g.WebSocket||n.g.MozWebSocket;r?e.exports=function(e){return new r(e)}:e.exports=void 0},2764:function(e,t,n){"use strict";var r=n(5335),i=n(7696),o=n(1226),s=n(6212),a=n(2427);function c(e){if(!c.enabled())throw Error("Transport created when disabled");i.call(this,e,"/eventsource",o,s)}r(c,i),c.enabled=function(){return!!a},c.transportName="eventsource",c.roundTrips=2,e.exports=c},8726:function(e,t,n){"use strict";var r=n(5335),i=n(9384),o=n(4731),s=n(7696);function a(e){if(!i.enabled)throw Error("Transport created when disabled");s.call(this,e,"/htmlfile",i,o)}r(a,s),a.enabled=function(e){return i.enabled&&e.sameOrigin},a.transportName="htmlfile",a.roundTrips=2,e.exports=a},918:function(e,t,n){"use strict";var r=n(5335),i=n(3742).v,o=n(8297),s=n(5302),a=n(7957),c=n(8728),u=n(2716),d=function(){};function l(e,t,n){if(!l.enabled())throw Error("Transport created when disabled");i.call(this);var r=this;this.origin=s.getOrigin(n),this.baseUrl=n,this.transUrl=t,this.transport=e,this.windowId=u.string(8);var o=s.addPath(n,"/iframe.html")+"#"+this.windowId;d(e,t,o),this.iframeObj=a.createIframe(o,function(e){d("err callback"),r.emit("close",1006,"Unable to load an iframe ("+e+")"),r.close()}),this.onmessageCallback=this._message.bind(this),c.attachEvent("message",this.onmessageCallback)}r(l,i),l.prototype.close=function(){if(d("close"),this.removeAllListeners(),this.iframeObj){c.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch(e){}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},l.prototype._message=function(e){var t,n;if(d("message",e.data),!s.isOriginEqual(e.origin,this.origin)){d("not same origin",e.origin,this.origin);return}try{t=JSON.parse(e.data)}catch(t){d("bad json",e.data);return}if(t.windowId!==this.windowId){d("mismatched window id",t.windowId,this.windowId);return}switch(t.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([o,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",t.data);break;case"c":try{n=JSON.parse(t.data)}catch(e){d("bad json",t.data);return}this.emit("close",n[0],n[1]),this.close()}},l.prototype.postMessage=function(e,t){d("postMessage",e,t),this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:e,data:t||""}),this.origin)},l.prototype.send=function(e){d("send",e),this.postMessage("m",e)},l.enabled=function(){return a.iframeEnabled},l.transportName="iframe",l.roundTrips=2,e.exports=l},3892:function(e,t,n){"use strict";var r=n(5335),i=n(4965),o=n(3773),s=n(4656);function a(e){if(!a.enabled())throw Error("Transport created when disabled");i.call(this,e,"/jsonp",s,o)}r(a,i),a.enabled=function(){return!!n.g.document},a.transportName="jsonp-polling",a.roundTrips=1,a.needBody=!0,e.exports=a},7696:function(e,t,n){"use strict";var r=n(5335),i=n(5302),o=n(4965),s=function(){};function a(e,t,n,r){o.call(this,e,t,function(e,t,n){s("create ajax sender",e,t);var o={};"string"==typeof t&&(o.headers={"Content-type":"text/plain"});var a=new r("POST",i.addPath(e,"/xhr_send"),t,o);return a.once("finish",function(e){if(s("finish",e),a=null,200!==e&&204!==e)return n(Error("http status "+e));n()}),function(){s("abort"),a.close(),a=null;var e=Error("Aborted");e.code=1e3,n(e)}},n,r)}r(a,o),e.exports=a},5463:function(e,t,n){"use strict";var r=n(5335),i=n(3742).v,o=function(){};function s(e,t){o(e),i.call(this),this.sendBuffer=[],this.sender=t,this.url=e}r(s,i),s.prototype.send=function(e){o("send",e),this.sendBuffer.push(e),this.sendStop||this.sendSchedule()},s.prototype.sendScheduleWait=function(){o("sendScheduleWait");var e,t=this;this.sendStop=function(){o("sendStop"),t.sendStop=null,clearTimeout(e)},e=setTimeout(function(){o("timeout"),t.sendStop=null,t.sendSchedule()},25)},s.prototype.sendSchedule=function(){o("sendSchedule",this.sendBuffer.length);var e=this;if(this.sendBuffer.length>0){var t="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,t,function(t){e.sendStop=null,t?(o("error",t),e.emit("close",t.code||1006,"Sending error: "+t),e.close()):e.sendScheduleWait()}),this.sendBuffer=[]}},s.prototype._cleanup=function(){o("_cleanup"),this.removeAllListeners()},s.prototype.close=function(){o("close"),this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)},e.exports=s},9662:function(e,t,n){"use strict";var r=n(5335),i=n(918),o=n(4405);e.exports=function(e){function t(t,n){i.call(this,e.transportName,t,n)}return r(t,i),t.enabled=function(t,r){if(!n.g.document)return!1;var s=o.extend({},r);return s.sameOrigin=!0,e.enabled(s)&&i.enabled()},t.transportName="iframe-"+e.transportName,t.needBody=!0,t.roundTrips=i.roundTrips+e.roundTrips-1,t.facadeTransport=e,t}},1905:function(e,t,n){"use strict";var r=n(5335),i=n(3742).v,o=function(){};function s(e,t,n){o(t),i.call(this),this.Receiver=e,this.receiveUrl=t,this.AjaxObject=n,this._scheduleReceiver()}r(s,i),s.prototype._scheduleReceiver=function(){o("_scheduleReceiver");var e=this,t=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);t.on("message",function(t){o("message",t),e.emit("message",t)}),t.once("close",function(n,r){o("close",n,r,e.pollIsClosing),e.poll=t=null,e.pollIsClosing||("network"===r?e._scheduleReceiver():(e.emit("close",n||1006,r),e.removeAllListeners()))})},s.prototype.abort=function(){o("abort"),this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},e.exports=s},4965:function(e,t,n){"use strict";var r=n(5335),i=n(5302),o=n(5463),s=n(1905),a=function(){};function c(e,t,n,r,c){var u=i.addPath(e,t);a(u);var d=this;o.call(this,e,n),this.poll=new s(r,u,c),this.poll.on("message",function(e){a("poll message",e),d.emit("message",e)}),this.poll.once("close",function(e,t){a("poll close",e,t),d.poll=null,d.emit("close",e,t),d.close()})}r(c,o),c.prototype.close=function(){o.prototype.close.call(this),a("close"),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)},e.exports=c},1226:function(e,t,n){"use strict";var r=n(5335),i=n(3742).v,o=n(2427),s=function(){};function a(e){s(e),i.call(this);var t=this,n=this.es=new o(e);n.onmessage=function(e){s("message",e.data),t.emit("message",decodeURI(e.data))},n.onerror=function(e){s("error",n.readyState,e);var r=2!==n.readyState?"network":"permanent";t._cleanup(),t._close(r)}}r(a,i),a.prototype.abort=function(){s("abort"),this._cleanup(),this._close("user")},a.prototype._cleanup=function(){s("cleanup");var e=this.es;e&&(e.onmessage=e.onerror=null,e.close(),this.es=null)},a.prototype._close=function(e){s("close",e);var t=this;setTimeout(function(){t.emit("close",null,e),t.removeAllListeners()},200)},e.exports=a},9384:function(e,t,n){"use strict";var r=n(5335),i=n(7957),o=n(5302),s=n(3742).v,a=n(2716),c=function(){};function u(e){c(e),s.call(this);var t=this;i.polluteGlobalNamespace(),this.id="a"+a.string(6),e=o.addQuery(e,"c="+decodeURIComponent(i.WPrefix+"."+this.id)),c("using htmlfile",u.htmlfileEnabled);var r=u.htmlfileEnabled?i.createHtmlfile:i.createIframe;n.g[i.WPrefix][this.id]={start:function(){c("start"),t.iframeObj.loaded()},message:function(e){c("message",e),t.emit("message",e)},stop:function(){c("stop"),t._cleanup(),t._close("network")}},this.iframeObj=r(e,function(){c("callback"),t._cleanup(),t._close("permanent")})}r(u,s),u.prototype.abort=function(){c("abort"),this._cleanup(),this._close("user")},u.prototype._cleanup=function(){c("_cleanup"),this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete n.g[i.WPrefix][this.id]},u.prototype._close=function(e){c("_close",e),this.emit("close",null,e),this.removeAllListeners()},u.htmlfileEnabled=!1;var d=["Active"].concat("Object").join("X");if(d in n.g)try{u.htmlfileEnabled=(new n.g[d]("htmlfile"),!0)}catch(e){}u.enabled=u.htmlfileEnabled||i.iframeEnabled,e.exports=u},3773:function(e,t,n){"use strict";var r=n(7957),i=n(2716),o=n(8126),s=n(5302),a=n(5335),c=n(3742).v,u=function(){};function d(e){u(e);var t=this;c.call(this),r.polluteGlobalNamespace(),this.id="a"+i.string(6);var o=s.addQuery(e,"c="+encodeURIComponent(r.WPrefix+"."+this.id));n.g[r.WPrefix][this.id]=this._callback.bind(this),this._createScript(o),this.timeoutId=setTimeout(function(){u("timeout"),t._abort(Error("JSONP script loaded abnormally (timeout)"))},d.timeout)}a(d,c),d.prototype.abort=function(){if(u("abort"),n.g[r.WPrefix][this.id]){var e=Error("JSONP user aborted read");e.code=1e3,this._abort(e)}},d.timeout=35e3,d.scriptErrorTimeout=1e3,d.prototype._callback=function(e){u("_callback",e),this._cleanup(),this.aborting||(e&&(u("message",e),this.emit("message",e)),this.emit("close",null,"network"),this.removeAllListeners())},d.prototype._abort=function(e){u("_abort",e),this._cleanup(),this.aborting=!0,this.emit("close",e.code,e.message),this.removeAllListeners()},d.prototype._cleanup=function(){if(u("_cleanup"),clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var e=this.script;e.parentNode.removeChild(e),e.onreadystatechange=e.onerror=e.onload=e.onclick=null,this.script=null}delete n.g[r.WPrefix][this.id]},d.prototype._scriptError=function(){u("_scriptError");var e=this;this.errorTimer||(this.errorTimer=setTimeout(function(){e.loadedOkay||e._abort(Error("JSONP script loaded abnormally (onerror)"))},d.scriptErrorTimeout))},d.prototype._createScript=function(e){u("_createScript",e);var t,r=this,s=this.script=n.g.document.createElement("script");if(s.id="a"+i.string(8),s.src=e,s.type="text/javascript",s.charset="UTF-8",s.onerror=this._scriptError.bind(this),s.onload=function(){u("onload"),r._abort(Error("JSONP script loaded abnormally (onload)"))},s.onreadystatechange=function(){if(u("onreadystatechange",s.readyState),/loaded|closed/.test(s.readyState)){if(s&&s.htmlFor&&s.onclick){r.loadedOkay=!0;try{s.onclick()}catch(e){}}s&&r._abort(Error("JSONP script loaded abnormally (onreadystatechange)"))}},void 0===s.async&&n.g.document.attachEvent){if(o.isOpera())(t=this.script2=n.g.document.createElement("script")).text="try{var a = document.getElementById('"+s.id+"'); if(a)a.onerror();}catch(x){};",s.async=t.async=!1;else{try{s.htmlFor=s.id,s.event="onclick"}catch(e){}s.async=!0}}void 0!==s.async&&(s.async=!0);var a=n.g.document.getElementsByTagName("head")[0];a.insertBefore(s,a.firstChild),t&&a.insertBefore(t,a.firstChild)},e.exports=d},2551:function(e,t,n){"use strict";var r=n(5335),i=n(3742).v,o=function(){};function s(e,t){o(e),i.call(this);var n=this;this.bufferPosition=0,this.xo=new t("POST",e,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(e,t){o("finish",e,t),n._chunkHandler(e,t),n.xo=null;var r=200===e?"network":"permanent";o("close",r),n.emit("close",null,r),n._cleanup()})}r(s,i),s.prototype._chunkHandler=function(e,t){if(o("_chunkHandler",e),200===e&&t)for(var n=-1;;this.bufferPosition+=n+1){var r=t.slice(this.bufferPosition);if(-1===(n=r.indexOf("\n")))break;var i=r.slice(0,n);i&&(o("message",i),this.emit("message",i))}},s.prototype._cleanup=function(){o("_cleanup"),this.removeAllListeners()},s.prototype.abort=function(){o("abort"),this.xo&&(this.xo.close(),o("close"),this.emit("close",null,"user"),this.xo=null),this._cleanup()},e.exports=s},4656:function(e,t,n){"use strict";var r,i,o=n(2716),s=n(5302),a=function(){};e.exports=function(e,t,c){a(e,t),r||(a("createForm"),(r=n.g.document.createElement("form")).style.display="none",r.style.position="absolute",r.method="POST",r.enctype="application/x-www-form-urlencoded",r.acceptCharset="UTF-8",(i=n.g.document.createElement("textarea")).name="d",r.appendChild(i),n.g.document.body.appendChild(r));var u="a"+o.string(8);r.target=u,r.action=s.addQuery(s.addPath(e,"/jsonp_send"),"i="+u);var d=function(e){a("createIframe",e);try{return n.g.document.createElement('<iframe name="'+e+'">')}catch(r){var t=n.g.document.createElement("iframe");return t.name=e,t}}(u);d.id=u,d.style.display="none",r.appendChild(d);try{i.value=t}catch(e){}r.submit();var l=function(e){a("completed",u,e),d.onerror&&(d.onreadystatechange=d.onerror=d.onload=null,setTimeout(function(){a("cleaning up",u),d.parentNode.removeChild(d),d=null},500),i.value="",c(e))};return d.onerror=function(){a("onerror",u),l()},d.onload=function(){a("onload",u),l()},d.onreadystatechange=function(e){a("onreadystatechange",u,d.readyState,e),"complete"===d.readyState&&l()},function(){a("aborted",u),l(Error("Aborted"))}}},5526:function(e,t,n){"use strict";var r=n(3742).v,i=n(5335),o=n(8728),s=n(8126),a=n(5302),c=function(){};function u(e,t,n){c(e,t);var i=this;r.call(this),setTimeout(function(){i._start(e,t,n)},0)}i(u,r),u.prototype._start=function(e,t,r){c("_start");var i=this,s=new n.g.XDomainRequest;t=a.addQuery(t,"t="+ +new Date),s.onerror=function(){c("onerror"),i._error()},s.ontimeout=function(){c("ontimeout"),i._error()},s.onprogress=function(){c("progress",s.responseText),i.emit("chunk",200,s.responseText)},s.onload=function(){c("load"),i.emit("finish",200,s.responseText),i._cleanup(!1)},this.xdr=s,this.unloadRef=o.unloadAdd(function(){i._cleanup(!0)});try{this.xdr.open(e,t),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(r)}catch(e){this._error()}},u.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},u.prototype._cleanup=function(e){if(c("cleanup",e),this.xdr){if(this.removeAllListeners(),o.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,e)try{this.xdr.abort()}catch(e){}this.unloadRef=this.xdr=null}},u.prototype.close=function(){c("close"),this._cleanup(!0)},u.enabled=!!(n.g.XDomainRequest&&s.hasDomain()),e.exports=u},6212:function(e,t,n){"use strict";var r=n(5335),i=n(6330);function o(e,t,n,r){i.call(this,e,t,n,r)}r(o,i),o.enabled=i.enabled&&i.supportsCORS,e.exports=o},8078:function(e,t,n){"use strict";var r=n(3742).v;function i(){var e=this;r.call(this),this.to=setTimeout(function(){e.emit("finish",200,"{}")},i.timeout)}n(5335)(i,r),i.prototype.close=function(){clearTimeout(this.to)},i.timeout=2e3,e.exports=i},4731:function(e,t,n){"use strict";var r=n(5335),i=n(6330);function o(e,t,n){i.call(this,e,t,n,{noCredentials:!0})}r(o,i),o.enabled=i.enabled,e.exports=o},2160:function(e,t,n){"use strict";var r=n(8728),i=n(5302),o=n(5335),s=n(3742).v,a=n(3435),c=function(){};function u(e,t,n){if(!u.enabled())throw Error("Transport created when disabled");s.call(this),c("constructor",e);var o=this,d=i.addPath(e,"/websocket");d="https"===d.slice(0,5)?"wss"+d.slice(5):"ws"+d.slice(4),this.url=d,this.ws=new a(this.url,[],n),this.ws.onmessage=function(e){c("message event",e.data),o.emit("message",e.data)},this.unloadRef=r.unloadAdd(function(){c("unload"),o.ws.close()}),this.ws.onclose=function(e){c("close event",e.code,e.reason),o.emit("close",e.code,e.reason),o._cleanup()},this.ws.onerror=function(e){c("error event",e),o.emit("close",1006,"WebSocket connection broken"),o._cleanup()}}o(u,s),u.prototype.send=function(e){var t="["+e+"]";c("send",t),this.ws.send(t)},u.prototype.close=function(){c("close");var e=this.ws;this._cleanup(),e&&e.close()},u.prototype._cleanup=function(){c("_cleanup");var e=this.ws;e&&(e.onmessage=e.onclose=e.onerror=null),r.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},u.enabled=function(){return c("enabled"),!!a},u.transportName="websocket",u.roundTrips=2,e.exports=u},5545:function(e,t,n){"use strict";var r=n(5335),i=n(7696),o=n(5920),s=n(2551),a=n(5526);function c(e){if(!a.enabled)throw Error("Transport created when disabled");i.call(this,e,"/xhr",s,a)}r(c,i),c.enabled=o.enabled,c.transportName="xdr-polling",c.roundTrips=2,e.exports=c},5920:function(e,t,n){"use strict";var r=n(5335),i=n(7696),o=n(2551),s=n(5526);function a(e){if(!s.enabled)throw Error("Transport created when disabled");i.call(this,e,"/xhr_streaming",o,s)}r(a,i),a.enabled=function(e){return!e.cookie_needed&&!e.nullOrigin&&s.enabled&&e.sameScheme},a.transportName="xdr-streaming",a.roundTrips=2,e.exports=a},5859:function(e,t,n){"use strict";var r=n(5335),i=n(7696),o=n(2551),s=n(6212),a=n(4731);function c(e){if(!a.enabled&&!s.enabled)throw Error("Transport created when disabled");i.call(this,e,"/xhr",o,s)}r(c,i),c.enabled=function(e){return!e.nullOrigin&&(!!a.enabled&&!!e.sameOrigin||s.enabled)},c.transportName="xhr-polling",c.roundTrips=2,e.exports=c},6900:function(e,t,n){"use strict";var r=n(5335),i=n(7696),o=n(2551),s=n(6212),a=n(4731),c=n(8126);function u(e){if(!a.enabled&&!s.enabled)throw Error("Transport created when disabled");i.call(this,e,"/xhr_streaming",o,s)}r(u,i),u.enabled=function(e){return!(e.nullOrigin||c.isOpera())&&s.enabled},u.transportName="xhr-streaming",u.roundTrips=2,u.needBody=!!n.g.document,e.exports=u},6207:function(e,t,n){"use strict";n.g.crypto&&n.g.crypto.getRandomValues?e.exports.randomBytes=function(e){var t=new Uint8Array(e);return n.g.crypto.getRandomValues(t),t}:e.exports.randomBytes=function(e){for(var t=Array(e),n=0;n<e;n++)t[n]=Math.floor(256*Math.random());return t}},8126:function(e,t,n){"use strict";e.exports={isOpera:function(){return n.g.navigator&&/opera/i.test(n.g.navigator.userAgent)},isKonqueror:function(){return n.g.navigator&&/konqueror/i.test(n.g.navigator.userAgent)},hasDomain:function(){if(!n.g.document)return!0;try{return!!n.g.document.domain}catch(e){return!1}}}},3190:function(e){"use strict";var t,n=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,r=function(e){var t,n={},r=[];for(t=0;t<65536;t++)r.push(String.fromCharCode(t));return e.lastIndex=0,r.join("").replace(e,function(e){return n[e]="\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4),""}),e.lastIndex=0,n};e.exports={quote:function(e){var i=JSON.stringify(e);return(n.lastIndex=0,n.test(i))?(t||(t=r(n)),i.replace(n,function(e){return t[e]})):i}}},8728:function(e,t,n){"use strict";var r=n(2716),i={},o=!1,s=n.g.chrome&&n.g.chrome.app&&n.g.chrome.app.runtime;e.exports={attachEvent:function(e,t){void 0!==n.g.addEventListener?n.g.addEventListener(e,t,!1):n.g.document&&n.g.attachEvent&&(n.g.document.attachEvent("on"+e,t),n.g.attachEvent("on"+e,t))},detachEvent:function(e,t){void 0!==n.g.addEventListener?n.g.removeEventListener(e,t,!1):n.g.document&&n.g.detachEvent&&(n.g.document.detachEvent("on"+e,t),n.g.detachEvent("on"+e,t))},unloadAdd:function(e){if(s)return null;var t=r.string(8);return i[t]=e,o&&setTimeout(this.triggerUnloadCallbacks,0),t},unloadDel:function(e){e in i&&delete i[e]},triggerUnloadCallbacks:function(){for(var e in i)i[e](),delete i[e]}},s||e.exports.attachEvent("unload",function(){o||(o=!0,e.exports.triggerUnloadCallbacks())})},7957:function(e,t,n){"use strict";var r=n(8728),i=n(8126),o=function(){};e.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){e.exports.WPrefix in n.g||(n.g[e.exports.WPrefix]={})},postMessage:function(t,r){n.g.parent!==n.g?n.g.parent.postMessage(JSON.stringify({windowId:e.exports.currentWindowId,type:t,data:r||""}),"*"):o("Cannot postMessage, no parent window.",t,r)},createIframe:function(e,t){var i,s,a=n.g.document.createElement("iframe"),c=function(){o("unattach"),clearTimeout(i);try{a.onload=null}catch(e){}a.onerror=null},u=function(){o("cleanup"),a&&(c(),setTimeout(function(){a&&a.parentNode.removeChild(a),a=null},0),r.unloadDel(s))},d=function(e){o("onerror",e),a&&(u(),t(e))};return a.src=e,a.style.display="none",a.style.position="absolute",a.onerror=function(){d("onerror")},a.onload=function(){o("onload"),clearTimeout(i),i=setTimeout(function(){d("onload timeout")},2e3)},n.g.document.body.appendChild(a),i=setTimeout(function(){d("timeout")},15e3),s=r.unloadAdd(u),{post:function(e,t){o("post",e,t),setTimeout(function(){try{a&&a.contentWindow&&a.contentWindow.postMessage(e,t)}catch(e){}},0)},cleanup:u,loaded:c}},createHtmlfile:function(t,i){var s,a,c,u=["Active"].concat("Object").join("X"),d=new n.g[u]("htmlfile"),l=function(){clearTimeout(s),c.onerror=null},h=function(){d&&(l(),r.unloadDel(a),c.parentNode.removeChild(c),c=d=null,CollectGarbage())},p=function(e){o("onerror",e),d&&(h(),i(e))};d.open(),d.write('<html><script>document.domain="'+n.g.document.domain+'";</script></html>'),d.close(),d.parentWindow[e.exports.WPrefix]=n.g[e.exports.WPrefix];var f=d.createElement("div");return d.body.appendChild(f),c=d.createElement("iframe"),f.appendChild(c),c.src=t,c.onerror=function(){p("onerror")},s=setTimeout(function(){p("timeout")},15e3),a=r.unloadAdd(h),{post:function(e,t){try{setTimeout(function(){c&&c.contentWindow&&c.contentWindow.postMessage(e,t)},0)}catch(e){}},cleanup:h,loaded:l}}},e.exports.iframeEnabled=!1,n.g.document&&(e.exports.iframeEnabled=("function"==typeof n.g.postMessage||"object"==typeof n.g.postMessage)&&!i.isKonqueror())},6815:function(e,t,n){"use strict";var r={};["log","debug","warn"].forEach(function(e){var t;try{t=n.g.console&&n.g.console[e]&&n.g.console[e].apply}catch(e){}r[e]=t?function(){return n.g.console[e].apply(n.g.console,arguments)}:"log"===e?function(){}:r.log}),e.exports=r},4405:function(e){"use strict";e.exports={isObject:function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},extend:function(e){if(!this.isObject(e))return e;for(var t,n,r=1,i=arguments.length;r<i;r++)for(n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}}},2716:function(e,t,n){"use strict";var r=n(6207),i="abcdefghijklmnopqrstuvwxyz012345";e.exports={string:function(e){for(var t=i.length,n=r.randomBytes(e),o=[],s=0;s<e;s++)o.push(i.substr(n[s]%t,1));return o.join("")},number:function(e){return Math.floor(Math.random()*e)},numberString:function(e){var t=(""+(e-1)).length;return(Array(t+1).join("0")+this.number(e)).slice(-t)}}},2488:function(e){"use strict";var t=function(){};e.exports=function(e){return{filterToEnabled:function(n,r){var i={main:[],facade:[]};return n?"string"==typeof n&&(n=[n]):n=[],e.forEach(function(e){if(e){if("websocket"===e.transportName&&!1===r.websocket){t("disabled from server","websocket");return}if(n.length&&-1===n.indexOf(e.transportName)){t("not in whitelist",e.transportName);return}e.enabled(r)?(t("enabled",e.transportName),i.main.push(e),e.facadeTransport&&i.facade.push(e.facadeTransport)):t("disabled",e.transportName)}}),i}}}},5302:function(e,t,n){"use strict";var r=n(9868),i=function(){};e.exports={getOrigin:function(e){if(!e)return null;var t=new r(e);if("file:"===t.protocol)return null;var n=t.port;return n||(n="https:"===t.protocol?"443":"80"),t.protocol+"//"+t.hostname+":"+n},isOriginEqual:function(e,t){var n=this.getOrigin(e)===this.getOrigin(t);return i("same",e,t,n),n},isSchemeEqual:function(e,t){return e.split(":")[0]===t.split(":")[0]},addPath:function(e,t){var n=e.split("?");return n[0]+t+(n[1]?"?"+n[1]:"")},addQuery:function(e,t){return e+(-1===e.indexOf("?")?"?"+t:"&"+t)},isLoopbackAddr:function(e){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^\[::1\]$/.test(e)}}},8297:function(e){e.exports="1.6.1"},9868:function(e,t,n){"use strict";var r=n(7642),i=n(4176),o=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,s=/[\n\r\t]/g,a=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,c=/:\d+$/,u=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,d=/^[a-zA-Z]:/;function l(e){return(e||"").toString().replace(o,"")}var h=[["#","hash"],["?","query"],function(e,t){return m(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],p={hash:1,query:1};function f(e){var t,r=("undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{}).location||{},i={},o=typeof(e=e||r);if("blob:"===e.protocol)i=new g(unescape(e.pathname),{});else if("string"===o)for(t in i=new g(e,{}),p)delete i[t];else if("object"===o){for(t in e)t in p||(i[t]=e[t]);void 0===i.slashes&&(i.slashes=a.test(e.href))}return i}function m(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function v(e,t){e=(e=l(e)).replace(s,""),t=t||{};var n,r=u.exec(e),i=r[1]?r[1].toLowerCase():"",o=!!r[2],a=!!r[3],c=0;return o?a?(n=r[2]+r[3]+r[4],c=r[2].length+r[3].length):(n=r[2]+r[4],c=r[2].length):a?(n=r[3]+r[4],c=r[3].length):n=r[4],"file:"===i?c>=2&&(n=n.slice(2)):m(i)?n=r[4]:i?o&&(n=n.slice(2)):c>=2&&m(t.protocol)&&(n=r[4]),{protocol:i,slashes:o||m(i),slashesCount:c,rest:n}}function g(e,t,n){if(e=(e=l(e)).replace(s,""),!(this instanceof g))return new g(e,t,n);var o,a,c,u,p,b,y=h.slice(),E=typeof t,S=0;for("object"!==E&&"string"!==E&&(n=t,t=null),n&&"function"!=typeof n&&(n=i.parse),o=!(a=v(e||"",t=f(t))).protocol&&!a.slashes,this.slashes=a.slashes||o&&t.slashes,this.protocol=a.protocol||t.protocol||"",e=a.rest,("file:"===a.protocol&&(2!==a.slashesCount||d.test(e))||!a.slashes&&(a.protocol||a.slashesCount<2||!m(this.protocol)))&&(y[3]=[/(.*)/,"pathname"]);S<y.length;S++){if("function"==typeof(u=y[S])){e=u(e,this);continue}c=u[0],b=u[1],c!=c?this[b]=e:"string"==typeof c?~(p="@"===c?e.lastIndexOf(c):e.indexOf(c))&&("number"==typeof u[2]?(this[b]=e.slice(0,p),e=e.slice(p+u[2])):(this[b]=e.slice(p),e=e.slice(0,p))):(p=c.exec(e))&&(this[b]=p[1],e=e.slice(0,p.index)),this[b]=this[b]||o&&u[3]&&t[b]||"",u[4]&&(this[b]=this[b].toLowerCase())}n&&(this.query=n(this.query)),o&&t.slashes&&"/"!==this.pathname.charAt(0)&&(""!==this.pathname||""!==t.pathname)&&(this.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,i=n[r-1],o=!1,s=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),s++):s&&(0===r&&(o=!0),n.splice(r,1),s--);return o&&n.unshift(""),("."===i||".."===i)&&n.push(""),n.join("/")}(this.pathname,t.pathname)),"/"!==this.pathname.charAt(0)&&m(this.protocol)&&(this.pathname="/"+this.pathname),r(this.port,this.protocol)||(this.host=this.hostname,this.port=""),this.username=this.password="",this.auth&&(~(p=this.auth.indexOf(":"))?(this.username=this.auth.slice(0,p),this.username=encodeURIComponent(decodeURIComponent(this.username)),this.password=this.auth.slice(p+1),this.password=encodeURIComponent(decodeURIComponent(this.password))):this.username=encodeURIComponent(decodeURIComponent(this.auth)),this.auth=this.password?this.username+":"+this.password:this.username),this.origin="file:"!==this.protocol&&m(this.protocol)&&this.host?this.protocol+"//"+this.host:"null",this.href=this.toString()}g.prototype={set:function(e,t,n){switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||i.parse)(t)),this[e]=t;break;case"port":this[e]=t,r(t,this.protocol)?t&&(this.host=this.hostname+":"+t):(this.host=this.hostname,this[e]="");break;case"hostname":this[e]=t,this.port&&(t+=":"+this.port),this.host=t;break;case"host":this[e]=t,c.test(t)?(t=t.split(":"),this.port=t.pop(),this.hostname=t.join(":")):(this.hostname=t,this.port="");break;case"protocol":this.protocol=t.toLowerCase(),this.slashes=!n;break;case"pathname":case"hash":if(t){var o="pathname"===e?"/":"#";this[e]=t.charAt(0)!==o?o+t:t}else this[e]=t;break;case"username":case"password":this[e]=encodeURIComponent(t);break;case"auth":var s=t.indexOf(":");~s?(this.username=t.slice(0,s),this.username=encodeURIComponent(decodeURIComponent(this.username)),this.password=t.slice(s+1),this.password=encodeURIComponent(decodeURIComponent(this.password))):this.username=encodeURIComponent(decodeURIComponent(t))}for(var a=0;a<h.length;a++){var u=h[a];u[4]&&(this[u[1]]=this[u[1]].toLowerCase())}return this.auth=this.password?this.username+":"+this.password:this.username,this.origin="file:"!==this.protocol&&m(this.protocol)&&this.host?this.protocol+"//"+this.host:"null",this.href=this.toString(),this},toString:function(e){e&&"function"==typeof e||(e=i.stringify);var t,n=this.host,r=this.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var o=r+(this.protocol&&this.slashes||m(this.protocol)?"//":"");return this.username?(o+=this.username,this.password&&(o+=":"+this.password),o+="@"):this.password?o+=":"+this.password+"@":"file:"!==this.protocol&&m(this.protocol)&&!n&&"/"!==this.pathname&&(o+="@"),(":"===n[n.length-1]||c.test(this.hostname)&&!this.port)&&(n+=":"),o+=n+this.pathname,(t="object"==typeof this.query?e(this.query):this.query)&&(o+="?"!==t.charAt(0)?"?"+t:t),this.hash&&(o+=this.hash),o}},g.extractProtocol=v,g.location=f,g.trimLeft=l,g.qs=i,e.exports=g},4916:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return c.default}});var r=h(n(1481)),i=h(n(7683)),o=h(n(7841)),s=h(n(8627)),a=h(n(6662)),c=h(n(8029)),u=h(n(6804)),d=h(n(9021)),l=h(n(2367));function h(e){return e&&e.__esModule?e:{default:e}}},3750:function(e,t){"use strict";function n(e){return(e+64>>>9<<4)+14+1}function r(e,t){let n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function i(e,t,n,i,o,s){var a;return r((a=r(r(t,e),r(i,s)))<<o|a>>>32-o,n)}function o(e,t,n,r,o,s,a){return i(t&n|~t&r,e,t,o,s,a)}function s(e,t,n,r,o,s,a){return i(t&r|n&~r,e,t,o,s,a)}function a(e,t,n,r,o,s,a){return i(t^n^r,e,t,o,s,a)}function c(e,t,n,r,o,s,a){return i(n^(t|~r),e,t,o,s,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=function(e){if("string"==typeof e){let t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){let t=[],n=32*e.length,r="0123456789abcdef";for(let i=0;i<n;i+=8){let n=e[i>>5]>>>i%32&255,o=parseInt(r.charAt(n>>>4&15)+r.charAt(15&n),16);t.push(o)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;let i=1732584193,u=-271733879,d=-1732584194,l=271733878;for(let t=0;t<e.length;t+=16){let n=i,h=u,p=d,f=l;i=o(i,u,d,l,e[t],7,-680876936),l=o(l,i,u,d,e[t+1],12,-389564586),d=o(d,l,i,u,e[t+2],17,606105819),u=o(u,d,l,i,e[t+3],22,-1044525330),i=o(i,u,d,l,e[t+4],7,-176418897),l=o(l,i,u,d,e[t+5],12,1200080426),d=o(d,l,i,u,e[t+6],17,-1473231341),u=o(u,d,l,i,e[t+7],22,-45705983),i=o(i,u,d,l,e[t+8],7,1770035416),l=o(l,i,u,d,e[t+9],12,-1958414417),d=o(d,l,i,u,e[t+10],17,-42063),u=o(u,d,l,i,e[t+11],22,-1990404162),i=o(i,u,d,l,e[t+12],7,1804603682),l=o(l,i,u,d,e[t+13],12,-40341101),d=o(d,l,i,u,e[t+14],17,-1502002290),u=o(u,d,l,i,e[t+15],22,1236535329),i=s(i,u,d,l,e[t+1],5,-165796510),l=s(l,i,u,d,e[t+6],9,-1069501632),d=s(d,l,i,u,e[t+11],14,643717713),u=s(u,d,l,i,e[t],20,-373897302),i=s(i,u,d,l,e[t+5],5,-701558691),l=s(l,i,u,d,e[t+10],9,38016083),d=s(d,l,i,u,e[t+15],14,-660478335),u=s(u,d,l,i,e[t+4],20,-405537848),i=s(i,u,d,l,e[t+9],5,568446438),l=s(l,i,u,d,e[t+14],9,-1019803690),d=s(d,l,i,u,e[t+3],14,-187363961),u=s(u,d,l,i,e[t+8],20,1163531501),i=s(i,u,d,l,e[t+13],5,-1444681467),l=s(l,i,u,d,e[t+2],9,-51403784),d=s(d,l,i,u,e[t+7],14,1735328473),u=s(u,d,l,i,e[t+12],20,-1926607734),i=a(i,u,d,l,e[t+5],4,-378558),l=a(l,i,u,d,e[t+8],11,-2022574463),d=a(d,l,i,u,e[t+11],16,1839030562),u=a(u,d,l,i,e[t+14],23,-35309556),i=a(i,u,d,l,e[t+1],4,-1530992060),l=a(l,i,u,d,e[t+4],11,1272893353),d=a(d,l,i,u,e[t+7],16,-155497632),u=a(u,d,l,i,e[t+10],23,-1094730640),i=a(i,u,d,l,e[t+13],4,681279174),l=a(l,i,u,d,e[t],11,-358537222),d=a(d,l,i,u,e[t+3],16,-722521979),u=a(u,d,l,i,e[t+6],23,76029189),i=a(i,u,d,l,e[t+9],4,-640364487),l=a(l,i,u,d,e[t+12],11,-421815835),d=a(d,l,i,u,e[t+15],16,530742520),u=a(u,d,l,i,e[t+2],23,-995338651),i=c(i,u,d,l,e[t],6,-198630844),l=c(l,i,u,d,e[t+7],10,1126891415),d=c(d,l,i,u,e[t+14],15,-1416354905),u=c(u,d,l,i,e[t+5],21,-57434055),i=c(i,u,d,l,e[t+12],6,1700485571),l=c(l,i,u,d,e[t+3],10,-1894986606),d=c(d,l,i,u,e[t+10],15,-1051523),u=c(u,d,l,i,e[t+1],21,-2054922799),i=c(i,u,d,l,e[t+8],6,1873313359),l=c(l,i,u,d,e[t+15],10,-30611744),d=c(d,l,i,u,e[t+6],15,-1560198380),u=c(u,d,l,i,e[t+13],21,1309151649),i=c(i,u,d,l,e[t+4],6,-145523070),l=c(l,i,u,d,e[t+11],10,-1120210379),d=c(d,l,i,u,e[t+2],15,718787259),u=c(u,d,l,i,e[t+9],21,-343485551),i=r(i,n),u=r(u,h),d=r(d,p),l=r(l,f)}return[i,u,d,l]}(function(e){if(0===e.length)return[];let t=8*e.length,r=new Uint32Array(n(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))}},8169:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;let n="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);t.default={randomUUID:n}},6662:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="00000000-0000-0000-0000-000000000000"},2367:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(6804))&&r.__esModule?r:{default:r};t.default=function(e){let t;if(!(0,i.default)(e))throw TypeError("Invalid UUID");let n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}},4486:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},9563:function(e,t){"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(r)};let r=new Uint8Array(16)},5926:function(e,t){"use strict";function n(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=function(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){let t=unescape(encodeURIComponent(e));e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let i=Math.ceil((e.length/4+2)/16),o=Array(i);for(let t=0;t<i;++t){let n=new Uint32Array(16);for(let r=0;r<16;++r)n[r]=e[64*t+4*r]<<24|e[64*t+4*r+1]<<16|e[64*t+4*r+2]<<8|e[64*t+4*r+3];o[t]=n}o[i-1][14]=(e.length-1)*8/4294967296,o[i-1][14]=Math.floor(o[i-1][14]),o[i-1][15]=(e.length-1)*8&4294967295;for(let e=0;e<i;++e){let i=new Uint32Array(80);for(let t=0;t<16;++t)i[t]=o[e][t];for(let e=16;e<80;++e)i[e]=n(i[e-3]^i[e-8]^i[e-14]^i[e-16],1);let s=r[0],a=r[1],c=r[2],u=r[3],d=r[4];for(let e=0;e<80;++e){let r=Math.floor(e/20),o=n(s,5)+function(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:case 3:return t^n^r;case 2:return t&n^t&r^n&r}}(r,a,c,u)+d+t[r]+i[e]>>>0;d=u,u=c,c=n(a,30)>>>0,a=s,s=o}r[0]=r[0]+s>>>0,r[1]=r[1]+a>>>0,r[2]=r[2]+c>>>0,r[3]=r[3]+u>>>0,r[4]=r[4]+d>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}},9021:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.unsafeStringify=s;var r,i=(r=n(6804))&&r.__esModule?r:{default:r};let o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));function s(e,t=0){return(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase()}t.default=function(e,t=0){let n=s(e,t);if(!(0,i.default)(n))throw TypeError("Stringified UUID is invalid");return n}},1481:function(e,t,n){"use strict";let r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,s=(o=n(9563))&&o.__esModule?o:{default:o},a=n(9021);let c=0,u=0;t.default=function(e,t,n){let o=t&&n||0,d=t||Array(16),l=(e=e||{}).node||r,h=void 0!==e.clockseq?e.clockseq:i;if(null==l||null==h){let t=e.random||(e.rng||s.default)();null==l&&(l=r=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==h&&(h=i=(t[6]<<8|t[7])&16383)}let p=void 0!==e.msecs?e.msecs:Date.now(),f=void 0!==e.nsecs?e.nsecs:u+1,m=p-c+(f-u)/1e4;if(m<0&&void 0===e.clockseq&&(h=h+1&16383),(m<0||p>c)&&void 0===e.nsecs&&(f=0),f>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");c=p,u=f,i=h;let v=((268435455&(p+=122192928e5))*1e4+f)%4294967296;d[o++]=v>>>24&255,d[o++]=v>>>16&255,d[o++]=v>>>8&255,d[o++]=255&v;let g=p/4294967296*1e4&268435455;d[o++]=g>>>8&255,d[o++]=255&g,d[o++]=g>>>24&15|16,d[o++]=g>>>16&255,d[o++]=h>>>8|128,d[o++]=255&h;for(let e=0;e<6;++e)d[o+e]=l[e];return t||(0,a.unsafeStringify)(d)}},7683:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(1209)),i=o(n(3750));function o(e){return e&&e.__esModule?e:{default:e}}let s=(0,r.default)("v3",48,i.default);t.default=s},1209:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0,t.default=function(e,t,n){function r(e,r,s,a){var c;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));let t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=(0,o.default)(r)),(null===(c=r)||void 0===c?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+e.length);if(u.set(r),u.set(e,r.length),(u=n(u))[6]=15&u[6]|t,u[8]=63&u[8]|128,s){a=a||0;for(let e=0;e<16;++e)s[a+e]=u[e];return s}return(0,i.unsafeStringify)(u)}try{r.name=e}catch(e){}return r.DNS=s,r.URL=a,r};var r,i=n(9021),o=(r=n(2367))&&r.__esModule?r:{default:r};let s="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=s;let a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=a},7841:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(n(8169)),i=s(n(9563)),o=n(9021);function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n){if(r.default.randomUUID&&!t&&!e)return r.default.randomUUID();let s=(e=e||{}).random||(e.rng||i.default)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=s[e];return t}return(0,o.unsafeStringify)(s)}},8627:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(1209)),i=o(n(5926));function o(e){return e&&e.__esModule?e:{default:e}}let s=(0,r.default)("v5",80,i.default);t.default=s},6804:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(4486))&&r.__esModule?r:{default:r};t.default=function(e){return"string"==typeof e&&i.default.test(e)}},8029:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(6804))&&r.__esModule?r:{default:r};t.default=function(e){if(!(0,i.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},7956:function(e){function t(){}e.exports=t,t.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,n){this.callbacks=this.callbacks||{};var r=3==arguments.length,i=r?arguments[1]:void 0,o=r?arguments[2]:arguments[1];return o._groupName=i,(this.callbacks[e]=this.callbacks[e]||[]).push(o),this},t.once=function(e,t,n){var r=this,i=3==arguments.length,o=i?arguments[1]:void 0,s=i?arguments[2]:arguments[1];return this.on(e,o,function t(){r.off(e,t),s.apply(this,arguments)}),this},t.releaseGroup=function(e){var t,n,r,i;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(n=0,r=(i=this.callbacks[t]).length;n<r;n++)i[n]._groupName===e&&(i.splice(n,1),n--,r--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var n,r=this.callbacks[e];return r&&(1==arguments.length?delete this.callbacks[e]:-1!==(n=r.indexOf(t))&&(r.splice(n,1),0===r.length&&delete this.callbacks[e])),this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,n,r,i=[].slice.call(arguments,1),o=this.callbacks[e],s=this.getWildcardCallbacks(e);if(o)for(t=0,n=(r=o.slice()).length;t<n&&r[t];++t)r[t].apply(this,i);if(s)for(t=0,n=s.length,n=(r=s.slice()).length;t<n&&r[t];++t)r[t].apply(this,[e].concat(i));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,r=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(r=r.concat(this.callbacks[t]));return r}},t.mixin(t)},6419:function(e,t,n){var r;/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */!function(t){"use strict";function i(){}var o=i.prototype,s=t.EventEmitter;function a(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return -1}function c(e){return function(){return this[e].apply(this,arguments)}}o.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp)for(n in t={},r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n]);else t=r[e]||(r[e]=[]);return t},o.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},o.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},o.addListener=function(e,t){if(!function e(t){return"function"==typeof t||t instanceof RegExp||!!t&&"object"==typeof t&&e(t.listener)}(t))throw TypeError("listener must be a function");var n,r=this.getListenersAsObject(e),i="object"==typeof t;for(n in r)r.hasOwnProperty(n)&&-1===a(r[n],t)&&r[n].push(i?t:{listener:t,once:!1});return this},o.on=c("addListener"),o.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},o.once=c("addOnceListener"),o.defineEvent=function(e){return this.getListeners(e),this},o.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},o.removeListener=function(e,t){var n,r,i=this.getListenersAsObject(e);for(r in i)i.hasOwnProperty(r)&&-1!==(n=a(i[r],t))&&i[r].splice(n,1);return this},o.off=c("removeListener"),o.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},o.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},o.manipulateListeners=function(e,t,n){var r,i,o=e?this.removeListener:this.addListener,s=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)o.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"==typeof i?o.call(this,r,i):s.call(this,r,i));return this},o.removeEvent=function(e){var t,n=this._getEvents();if("string"==typeof e)delete n[e];else if(e instanceof RegExp)for(t in n)n.hasOwnProperty(t)&&e.test(t)&&delete n[t];else delete this._events;return this},o.removeAllListeners=c("removeEvent"),o.emitEvent=function(e,t){var n,r,i,o,s=this.getListenersAsObject(e);for(o in s)if(s.hasOwnProperty(o))for(i=0,n=s[o].slice(0);i<n.length;i++)!0===(r=n[i]).once&&this.removeListener(e,r.listener),r.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},o.trigger=c("emitEvent"),o.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},o.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},o._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},o._getEvents=function(){return this._events||(this._events={})},i.noConflict=function(){return t.EventEmitter=s,i},void 0!==(r=(function(){return i}).call(t,n,t,e))&&(e.exports=r)}("undefined"!=typeof window?window:this||{})},2597:function(e,t,n){"use strict";var r=n(2265);let i=r.forwardRef(function({title:e,titleId:t,...n},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},n),e?r.createElement("title",{id:t},e):null,r.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12ZM9 8.25a.75.75 0 0 0-.75.75v6c0 .414.336.75.75.75h.75a.75.75 0 0 0 .75-.75V9a.75.75 0 0 0-.75-.75H9Zm5.25 0a.75.75 0 0 0-.75.75v6c0 .414.336.75.75.75H15a.75.75 0 0 0 .75-.75V9a.75.75 0 0 0-.75-.75h-.75Z",clipRule:"evenodd"}))});t.Z=i},3974:function(e,t,n){"use strict";var r=n(2265);let i=r.forwardRef(function({title:e,titleId:t,...n},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},n),e?r.createElement("title",{id:t},e):null,r.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm14.024-.983a1.125 1.125 0 0 1 0 1.966l-5.603 3.113A1.125 1.125 0 0 1 9 15.113V8.887c0-.857.921-1.4 1.671-.983l5.603 3.113Z",clipRule:"evenodd"}))});t.Z=i},6542:function(e,t,n){"use strict";var r=n(2265);let i=r.forwardRef(function({title:e,titleId:t,...n},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},n),e?r.createElement("title",{id:t},e):null,r.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 0 1-1.313-1.313V9.564Z",clipRule:"evenodd"}))});t.Z=i},27:function(e,t,n){"use strict";var r,i,o,s;n.d(t,{L:function(){return m}});class a{constructor(e){this.versions=e}supportedVersions(){return this.versions.join(",")}protocolVersions(){return this.versions.map(e=>`v${e.replace(".","")}.stomp`)}}a.V1_0="1.0",a.V1_1="1.1",a.V1_2="1.2",a.default=new a([a.V1_2,a.V1_1,a.V1_0]);let c={LF:"\n",NULL:"\x00"};class u{constructor(e){let{command:t,headers:n,body:r,binaryBody:i,escapeHeaderValues:o,skipContentLengthHeader:s}=e;this.command=t,this.headers=Object.assign({},n||{}),i?(this._binaryBody=i,this.isBinaryBody=!0):(this._body=r||"",this.isBinaryBody=!1),this.escapeHeaderValues=o||!1,this.skipContentLengthHeader=s||!1}get body(){return!this._body&&this.isBinaryBody&&(this._body=new TextDecoder().decode(this._binaryBody)),this._body||""}get binaryBody(){return this._binaryBody||this.isBinaryBody||(this._binaryBody=new TextEncoder().encode(this._body)),this._binaryBody}static fromRawFrame(e,t){let n={},r=e=>e.replace(/^\s+|\s+$/g,"");for(let i of e.headers.reverse()){i.indexOf(":");let o=r(i[0]),s=r(i[1]);t&&"CONNECT"!==e.command&&"CONNECTED"!==e.command&&(s=u.hdrValueUnEscape(s)),n[o]=s}return new u({command:e.command,headers:n,binaryBody:e.binaryBody,escapeHeaderValues:t})}toString(){return this.serializeCmdAndHeaders()}serialize(){let e=this.serializeCmdAndHeaders();return this.isBinaryBody?u.toUnit8Array(e,this._binaryBody).buffer:e+this._body+c.NULL}serializeCmdAndHeaders(){let e=[this.command];for(let t of(this.skipContentLengthHeader&&delete this.headers["content-length"],Object.keys(this.headers||{}))){let n=this.headers[t];this.escapeHeaderValues&&"CONNECT"!==this.command&&"CONNECTED"!==this.command?e.push(`${t}:${u.hdrValueEscape(`${n}`)}`):e.push(`${t}:${n}`)}return!this.isBinaryBody&&(this.isBodyEmpty()||this.skipContentLengthHeader)||e.push(`content-length:${this.bodyLength()}`),e.join(c.LF)+c.LF+c.LF}isBodyEmpty(){return 0===this.bodyLength()}bodyLength(){let e=this.binaryBody;return e?e.length:0}static sizeOfUTF8(e){return e?new TextEncoder().encode(e).length:0}static toUnit8Array(e,t){let n=new TextEncoder().encode(e),r=new Uint8Array([0]),i=new Uint8Array(n.length+t.length+r.length);return i.set(n),i.set(t,n.length),i.set(r,n.length+t.length),i}static marshall(e){return new u(e).serialize()}static hdrValueEscape(e){return e.replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/:/g,"\\c")}static hdrValueUnEscape(e){return e.replace(/\\r/g,"\r").replace(/\\n/g,"\n").replace(/\\c/g,":").replace(/\\\\/g,"\\")}}class d{constructor(e,t){this.onFrame=e,this.onIncomingPing=t,this._encoder=new TextEncoder,this._decoder=new TextDecoder,this._token=[],this._initState()}parseChunk(e,t=!1){let n;if(n="string"==typeof e?this._encoder.encode(e):new Uint8Array(e),t&&0!==n[n.length-1]){let e=new Uint8Array(n.length+1);e.set(n,0),e[n.length]=0,n=e}for(let e=0;e<n.length;e++){let t=n[e];this._onByte(t)}}_collectFrame(e){if(0!==e&&13!==e){if(10===e){this.onIncomingPing();return}this._onByte=this._collectCommand,this._reinjectByte(e)}}_collectCommand(e){if(13!==e){if(10===e){this._results.command=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaders;return}this._consumeByte(e)}}_collectHeaders(e){if(13!==e){if(10===e){this._setupCollectBody();return}this._onByte=this._collectHeaderKey,this._reinjectByte(e)}}_reinjectByte(e){this._onByte(e)}_collectHeaderKey(e){if(58===e){this._headerKey=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaderValue;return}this._consumeByte(e)}_collectHeaderValue(e){if(13!==e){if(10===e){this._results.headers.push([this._headerKey,this._consumeTokenAsUTF8()]),this._headerKey=void 0,this._onByte=this._collectHeaders;return}this._consumeByte(e)}}_setupCollectBody(){let e=this._results.headers.filter(e=>"content-length"===e[0])[0];e?(this._bodyBytesRemaining=parseInt(e[1],10),this._onByte=this._collectBodyFixedSize):this._onByte=this._collectBodyNullTerminated}_collectBodyNullTerminated(e){if(0===e){this._retrievedBody();return}this._consumeByte(e)}_collectBodyFixedSize(e){if(0==this._bodyBytesRemaining--){this._retrievedBody();return}this._consumeByte(e)}_retrievedBody(){this._results.binaryBody=this._consumeTokenAsRaw();try{this.onFrame(this._results)}catch(e){console.log("Ignoring an exception thrown by a frame handler. Original exception: ",e)}this._initState()}_consumeByte(e){this._token.push(e)}_consumeTokenAsUTF8(){return this._decoder.decode(this._consumeTokenAsRaw())}_consumeTokenAsRaw(){let e=new Uint8Array(this._token);return this._token=[],e}_initState(){this._results={command:void 0,headers:[],binaryBody:void 0},this._token=[],this._headerKey=void 0,this._onByte=this._collectFrame}}(o=r=r||(r={}))[o.CONNECTING=0]="CONNECTING",o[o.OPEN=1]="OPEN",o[o.CLOSING=2]="CLOSING",o[o.CLOSED=3]="CLOSED",(s=i=i||(i={}))[s.ACTIVE=0]="ACTIVE",s[s.DEACTIVATING=1]="DEACTIVATING",s[s.INACTIVE=2]="INACTIVE";class l{constructor(e,t,n){this._client=e,this._webSocket=t,this._connected=!1,this._serverFrameHandlers={CONNECTED:e=>{this.debug(`connected to server ${e.headers.server}`),this._connected=!0,this._connectedVersion=e.headers.version,this._connectedVersion===a.V1_2&&(this._escapeHeaderValues=!0),this._setupHeartbeat(e.headers),this.onConnect(e)},MESSAGE:e=>{let t=e.headers.subscription,n=this._subscriptions[t]||this.onUnhandledMessage,r=this,i=this._connectedVersion===a.V1_2?e.headers.ack:e.headers["message-id"];e.ack=(e={})=>r.ack(i,t,e),e.nack=(e={})=>r.nack(i,t,e),n(e)},RECEIPT:e=>{let t=this._receiptWatchers[e.headers["receipt-id"]];t?(t(e),delete this._receiptWatchers[e.headers["receipt-id"]]):this.onUnhandledReceipt(e)},ERROR:e=>{this.onStompError(e)}},this._counter=0,this._subscriptions={},this._receiptWatchers={},this._partialData="",this._escapeHeaderValues=!1,this._lastServerActivityTS=Date.now(),this.debug=n.debug,this.stompVersions=n.stompVersions,this.connectHeaders=n.connectHeaders,this.disconnectHeaders=n.disconnectHeaders,this.heartbeatIncoming=n.heartbeatIncoming,this.heartbeatOutgoing=n.heartbeatOutgoing,this.splitLargeFrames=n.splitLargeFrames,this.maxWebSocketChunkSize=n.maxWebSocketChunkSize,this.forceBinaryWSFrames=n.forceBinaryWSFrames,this.logRawCommunication=n.logRawCommunication,this.appendMissingNULLonIncoming=n.appendMissingNULLonIncoming,this.discardWebsocketOnCommFailure=n.discardWebsocketOnCommFailure,this.onConnect=n.onConnect,this.onDisconnect=n.onDisconnect,this.onStompError=n.onStompError,this.onWebSocketClose=n.onWebSocketClose,this.onWebSocketError=n.onWebSocketError,this.onUnhandledMessage=n.onUnhandledMessage,this.onUnhandledReceipt=n.onUnhandledReceipt,this.onUnhandledFrame=n.onUnhandledFrame}get connectedVersion(){return this._connectedVersion}get connected(){return this._connected}start(){let e=new d(e=>{let t=u.fromRawFrame(e,this._escapeHeaderValues);this.logRawCommunication||this.debug(`<<< ${t}`),(this._serverFrameHandlers[t.command]||this.onUnhandledFrame)(t)},()=>{this.debug("<<< PONG")});this._webSocket.onmessage=t=>{if(this.debug("Received data"),this._lastServerActivityTS=Date.now(),this.logRawCommunication){let e=t.data instanceof ArrayBuffer?new TextDecoder().decode(t.data):t.data;this.debug(`<<< ${e}`)}e.parseChunk(t.data,this.appendMissingNULLonIncoming)},this._webSocket.onclose=e=>{this.debug(`Connection closed to ${this._webSocket.url}`),this._cleanUp(),this.onWebSocketClose(e)},this._webSocket.onerror=e=>{this.onWebSocketError(e)},this._webSocket.onopen=()=>{let e=Object.assign({},this.connectHeaders);this.debug("Web Socket Opened..."),e["accept-version"]=this.stompVersions.supportedVersions(),e["heart-beat"]=[this.heartbeatOutgoing,this.heartbeatIncoming].join(","),this._transmit({command:"CONNECT",headers:e})}}_setupHeartbeat(e){if(e.version!==a.V1_1&&e.version!==a.V1_2||!e["heart-beat"])return;let[t,n]=e["heart-beat"].split(",").map(e=>parseInt(e,10));if(0!==this.heartbeatOutgoing&&0!==n){let e=Math.max(this.heartbeatOutgoing,n);this.debug(`send PING every ${e}ms`),this._pinger=setInterval(()=>{this._webSocket.readyState===r.OPEN&&(this._webSocket.send(c.LF),this.debug(">>> PING"))},e)}if(0!==this.heartbeatIncoming&&0!==t){let e=Math.max(this.heartbeatIncoming,t);this.debug(`check PONG every ${e}ms`),this._ponger=setInterval(()=>{let t=Date.now()-this._lastServerActivityTS;t>2*e&&(this.debug(`did not receive server activity for the last ${t}ms`),this._closeOrDiscardWebsocket())},e)}}_closeOrDiscardWebsocket(){this.discardWebsocketOnCommFailure?(this.debug("Discarding websocket, the underlying socket may linger for a while"),this.discardWebsocket()):(this.debug("Issuing close on the websocket"),this._closeWebsocket())}forceDisconnect(){this._webSocket&&(this._webSocket.readyState===r.CONNECTING||this._webSocket.readyState===r.OPEN)&&this._closeOrDiscardWebsocket()}_closeWebsocket(){this._webSocket.onmessage=()=>{},this._webSocket.close()}discardWebsocket(){if("function"!=typeof this._webSocket.terminate){var e,t;e=this._webSocket,t=e=>this.debug(e),e.terminate=function(){let n=()=>{};this.onerror=n,this.onmessage=n,this.onopen=n;let r=new Date,i=Math.random().toString().substring(2,8),o=this.onclose;this.onclose=e=>{let n=new Date().getTime()-r.getTime();t(`Discarded socket (#${i})  closed after ${n}ms, with code/reason: ${e.code}/${e.reason}`)},this.close(),o?.call(e,{code:4001,reason:`Quick discarding socket (#${i}) without waiting for the shutdown sequence.`,wasClean:!1})}}this._webSocket.terminate()}_transmit(e){let{command:t,headers:n,body:r,binaryBody:i,skipContentLengthHeader:o}=e,s=new u({command:t,headers:n,body:r,binaryBody:i,escapeHeaderValues:this._escapeHeaderValues,skipContentLengthHeader:o}),a=s.serialize();if(this.logRawCommunication?this.debug(`>>> ${a}`):this.debug(`>>> ${s}`),this.forceBinaryWSFrames&&"string"==typeof a&&(a=new TextEncoder().encode(a)),"string"==typeof a&&this.splitLargeFrames){let e=a;for(;e.length>0;){let t=e.substring(0,this.maxWebSocketChunkSize);e=e.substring(this.maxWebSocketChunkSize),this._webSocket.send(t),this.debug(`chunk sent = ${t.length}, remaining = ${e.length}`)}}else this._webSocket.send(a)}dispose(){if(this.connected)try{let e=Object.assign({},this.disconnectHeaders);e.receipt||(e.receipt=`close-${this._counter++}`),this.watchForReceipt(e.receipt,e=>{this._closeWebsocket(),this._cleanUp(),this.onDisconnect(e)}),this._transmit({command:"DISCONNECT",headers:e})}catch(e){this.debug(`Ignoring error during disconnect ${e}`)}else(this._webSocket.readyState===r.CONNECTING||this._webSocket.readyState===r.OPEN)&&this._closeWebsocket()}_cleanUp(){this._connected=!1,this._pinger&&(clearInterval(this._pinger),this._pinger=void 0),this._ponger&&(clearInterval(this._ponger),this._ponger=void 0)}publish(e){let{destination:t,headers:n,body:r,binaryBody:i,skipContentLengthHeader:o}=e,s=Object.assign({destination:t},n);this._transmit({command:"SEND",headers:s,body:r,binaryBody:i,skipContentLengthHeader:o})}watchForReceipt(e,t){this._receiptWatchers[e]=t}subscribe(e,t,n={}){(n=Object.assign({},n)).id||(n.id=`sub-${this._counter++}`),n.destination=e,this._subscriptions[n.id]=t,this._transmit({command:"SUBSCRIBE",headers:n});let r=this;return{id:n.id,unsubscribe:e=>r.unsubscribe(n.id,e)}}unsubscribe(e,t={}){t=Object.assign({},t),delete this._subscriptions[e],t.id=e,this._transmit({command:"UNSUBSCRIBE",headers:t})}begin(e){let t=e||`tx-${this._counter++}`;this._transmit({command:"BEGIN",headers:{transaction:t}});let n=this;return{id:t,commit(){n.commit(t)},abort(){n.abort(t)}}}commit(e){this._transmit({command:"COMMIT",headers:{transaction:e}})}abort(e){this._transmit({command:"ABORT",headers:{transaction:e}})}ack(e,t,n={}){n=Object.assign({},n),this._connectedVersion===a.V1_2?n.id=e:n["message-id"]=e,n.subscription=t,this._transmit({command:"ACK",headers:n})}nack(e,t,n={}){return n=Object.assign({},n),this._connectedVersion===a.V1_2?n.id=e:n["message-id"]=e,n.subscription=t,this._transmit({command:"NACK",headers:n})}}class h{constructor(e={}){this.stompVersions=a.default,this.connectionTimeout=0,this.reconnectDelay=5e3,this.heartbeatIncoming=1e4,this.heartbeatOutgoing=1e4,this.splitLargeFrames=!1,this.maxWebSocketChunkSize=8192,this.forceBinaryWSFrames=!1,this.appendMissingNULLonIncoming=!1,this.discardWebsocketOnCommFailure=!1,this.state=i.INACTIVE;let t=()=>{};this.debug=t,this.beforeConnect=t,this.onConnect=t,this.onDisconnect=t,this.onUnhandledMessage=t,this.onUnhandledReceipt=t,this.onUnhandledFrame=t,this.onStompError=t,this.onWebSocketClose=t,this.onWebSocketError=t,this.logRawCommunication=!1,this.onChangeState=t,this.connectHeaders={},this._disconnectHeaders={},this.configure(e)}get webSocket(){return this._stompHandler?._webSocket}get disconnectHeaders(){return this._disconnectHeaders}set disconnectHeaders(e){this._disconnectHeaders=e,this._stompHandler&&(this._stompHandler.disconnectHeaders=this._disconnectHeaders)}get connected(){return!!this._stompHandler&&this._stompHandler.connected}get connectedVersion(){return this._stompHandler?this._stompHandler.connectedVersion:void 0}get active(){return this.state===i.ACTIVE}_changeState(e){this.state=e,this.onChangeState(e)}configure(e){Object.assign(this,e)}activate(){let e=()=>{if(this.active){this.debug("Already ACTIVE, ignoring request to activate");return}this._changeState(i.ACTIVE),this._connect()};this.state===i.DEACTIVATING?(this.debug("Waiting for deactivation to finish before activating"),this.deactivate().then(()=>{e()})):e()}async _connect(){if(await this.beforeConnect(),this._stompHandler){this.debug("There is already a stompHandler, skipping the call to connect");return}if(!this.active){this.debug("Client has been marked inactive, will not attempt to connect");return}this.connectionTimeout>0&&(this._connectionWatcher&&clearTimeout(this._connectionWatcher),this._connectionWatcher=setTimeout(()=>{this.connected||(this.debug(`Connection not established in ${this.connectionTimeout}ms, closing socket`),this.forceDisconnect())},this.connectionTimeout)),this.debug("Opening Web Socket...");let e=this._createWebSocket();this._stompHandler=new l(this,e,{debug:this.debug,stompVersions:this.stompVersions,connectHeaders:this.connectHeaders,disconnectHeaders:this._disconnectHeaders,heartbeatIncoming:this.heartbeatIncoming,heartbeatOutgoing:this.heartbeatOutgoing,splitLargeFrames:this.splitLargeFrames,maxWebSocketChunkSize:this.maxWebSocketChunkSize,forceBinaryWSFrames:this.forceBinaryWSFrames,logRawCommunication:this.logRawCommunication,appendMissingNULLonIncoming:this.appendMissingNULLonIncoming,discardWebsocketOnCommFailure:this.discardWebsocketOnCommFailure,onConnect:e=>{if(this._connectionWatcher&&(clearTimeout(this._connectionWatcher),this._connectionWatcher=void 0),!this.active){this.debug("STOMP got connected while deactivate was issued, will disconnect now"),this._disposeStompHandler();return}this.onConnect(e)},onDisconnect:e=>{this.onDisconnect(e)},onStompError:e=>{this.onStompError(e)},onWebSocketClose:e=>{this._stompHandler=void 0,this.state===i.DEACTIVATING&&this._changeState(i.INACTIVE),this.onWebSocketClose(e),this.active&&this._schedule_reconnect()},onWebSocketError:e=>{this.onWebSocketError(e)},onUnhandledMessage:e=>{this.onUnhandledMessage(e)},onUnhandledReceipt:e=>{this.onUnhandledReceipt(e)},onUnhandledFrame:e=>{this.onUnhandledFrame(e)}}),this._stompHandler.start()}_createWebSocket(){let e;if(this.webSocketFactory)e=this.webSocketFactory();else if(this.brokerURL)e=new WebSocket(this.brokerURL,this.stompVersions.protocolVersions());else throw Error("Either brokerURL or webSocketFactory must be provided");return e.binaryType="arraybuffer",e}_schedule_reconnect(){this.reconnectDelay>0&&(this.debug(`STOMP: scheduling reconnection in ${this.reconnectDelay}ms`),this._reconnector=setTimeout(()=>{this._connect()},this.reconnectDelay))}async deactivate(e={}){let t;let n=e.force||!1,o=this.active;if(this.state===i.INACTIVE)return this.debug("Already INACTIVE, nothing more to do"),Promise.resolve();if(this._changeState(i.DEACTIVATING),this._reconnector&&(clearTimeout(this._reconnector),this._reconnector=void 0),!this._stompHandler||this.webSocket.readyState===r.CLOSED)return this._changeState(i.INACTIVE),Promise.resolve();{let e=this._stompHandler.onWebSocketClose;t=new Promise((t,n)=>{this._stompHandler.onWebSocketClose=n=>{e(n),t()}})}return n?this._stompHandler?.discardWebsocket():o&&this._disposeStompHandler(),t}forceDisconnect(){this._stompHandler&&this._stompHandler.forceDisconnect()}_disposeStompHandler(){this._stompHandler&&this._stompHandler.dispose()}publish(e){this._checkConnection(),this._stompHandler.publish(e)}_checkConnection(){if(!this.connected)throw TypeError("There is no underlying STOMP connection")}watchForReceipt(e,t){this._checkConnection(),this._stompHandler.watchForReceipt(e,t)}subscribe(e,t,n={}){return this._checkConnection(),this._stompHandler.subscribe(e,t,n)}unsubscribe(e,t={}){this._checkConnection(),this._stompHandler.unsubscribe(e,t)}begin(e){return this._checkConnection(),this._stompHandler.begin(e)}commit(e){this._checkConnection(),this._stompHandler.commit(e)}abort(e){this._checkConnection(),this._stompHandler.abort(e)}ack(e,t,n={}){this._checkConnection(),this._stompHandler.ack(e,t,n)}nack(e,t,n={}){this._checkConnection(),this._stompHandler.nack(e,t,n)}}class p{constructor(e){this.client=e}get outgoing(){return this.client.heartbeatOutgoing}set outgoing(e){this.client.heartbeatOutgoing=e}get incoming(){return this.client.heartbeatIncoming}set incoming(e){this.client.heartbeatIncoming=e}}class f extends h{constructor(e){super(),this.maxWebSocketFrameSize=16384,this._heartbeatInfo=new p(this),this.reconnect_delay=0,this.webSocketFactory=e,this.debug=(...e)=>{console.log(...e)}}_parseConnect(...e){let t,n,r;let i={};if(e.length<2)throw Error("Connect requires at least 2 arguments");return"function"==typeof e[1]?[i,n,r,t]=e:6===e.length?[i.login,i.passcode,n,r,t,i.host]=e:[i.login,i.passcode,n,r,t]=e,[i,n,r,t]}connect(...e){let t=this._parseConnect(...e);t[0]&&(this.connectHeaders=t[0]),t[1]&&(this.onConnect=t[1]),t[2]&&(this.onStompError=t[2]),t[3]&&(this.onWebSocketClose=t[3]),super.activate()}disconnect(e,t={}){e&&(this.onDisconnect=e),this.disconnectHeaders=t,super.deactivate()}send(e,t={},n=""){let r=!1===(t=Object.assign({},t))["content-length"];r&&delete t["content-length"],this.publish({destination:e,headers:t,body:n,skipContentLengthHeader:r})}set reconnect_delay(e){this.reconnectDelay=e}get ws(){return this.webSocket}get version(){return this.connectedVersion}get onreceive(){return this.onUnhandledMessage}set onreceive(e){this.onUnhandledMessage=e}get onreceipt(){return this.onUnhandledReceipt}set onreceipt(e){this.onUnhandledReceipt=e}get heartbeat(){return this._heartbeatInfo}set heartbeat(e){this.heartbeatIncoming=e.incoming,this.heartbeatOutgoing=e.outgoing}}class m{static client(e,t){return null==t&&(t=a.default.protocolVersions()),new f(()=>new(m.WebSocketClass||WebSocket)(e,t))}static over(e){let t;return"function"==typeof e?t=e:(console.warn("Stomp.over did not receive a factory, auto reconnect will not work. Please see https://stomp-js.github.io/api-docs/latest/classes/Stomp.html#over"),t=()=>e),new f(t)}}m.WebSocketClass=null},8750:function(e){"use strict";e.exports=JSON.parse('["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302","stun.ekiga.net","stun.ideasip.com","stun.schlund.de","stun.stunprotocol.org:3478","stun.voiparound.com","stun.voipbuster.com","stun.voipstunt.com","stun.voxgratia.org"]')},6013:function(e){"use strict";e.exports=[]},6391:function(e){"use strict";e.exports=JSON.parse('{"author":"OpenVidu","dependencies":{"freeice":"2.2.2","hark":"1.2.3","jsnlog":"2.30.0","mime":"3.0.0","platform":"1.3.6","semver":"7.3.8","uuid":"9.0.0","wolfy87-eventemitter":"5.2.9","events":"3.3.0","inherits":"2.0.4"},"description":"OpenVidu Browser","devDependencies":{"@types/node":"18.11.9","@types/platform":"1.3.4","browserify":"17.0.0","grunt":"1.5.3","grunt-cli":"1.4.3","grunt-contrib-copy":"1.0.0","grunt-contrib-sass":"2.0.0","grunt-contrib-uglify":"5.2.2","grunt-contrib-watch":"1.1.0","grunt-postcss":"0.9.0","grunt-string-replace":"1.3.3","grunt-ts":"6.0.0-beta.22","terser":"5.15.1","tsify":"5.0.4","tslint":"6.1.3","typedoc":"0.23.21","typescript":"4.9.3"},"license":"Apache-2.0","main":"lib/index.js","name":"openvidu-browser","repository":{"type":"git","url":"git://github.com/OpenVidu/openvidu"},"scripts":{"browserify":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js Main.ts -p [ tsify ] --exclude kurento-browser-extensions --debug -o ../static/js/openvidu-browser-$VERSION.js -v","browserify-prod":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js --debug Main.ts -p [ tsify ] --exclude kurento-browser-extensions | ../node_modules/terser/bin/terser --source-map content=inline --output ../static/js/openvidu-browser-$VERSION.min.js","build":"cd src/OpenVidu && ./../../node_modules/typescript/bin/tsc && cd ../.. && ./node_modules/typescript/bin/tsc --declaration src/index.ts --outDir ./lib --sourceMap --target es5 --lib dom,es5,es2015.promise,scripthost && rm -rf ./ts4.4 && mkdir -p ./ts4.4/lib && cp -r ./lib ./ts4.4 && find ./ts4.4/lib -type f ! -iname \'*.d.ts\' -delete && ./config/replace_for_ts44.sh","docs":"./generate-docs.sh"},"types":"lib/index.d.ts","typesVersions":{"<4.4":{"*":["ts4.4/*"]}},"version":"2.29.1"}')}}]);