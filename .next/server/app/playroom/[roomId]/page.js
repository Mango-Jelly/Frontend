(()=>{var e={};e.id=488,e.ids=[488],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},15673:e=>{"use strict";e.exports=require("node:events")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},47261:e=>{"use strict";e.exports=require("node:util")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},79594:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GlobalError:()=>s.a,__next_app__:()=>h,originalPathname:()=>d,pages:()=>u,routeModule:()=>p,tree:()=>l});var r=n(50482),i=n(69108),o=n(62563),s=n.n(o),a=n(68300),c={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>a[e]);n.d(t,c);let l=["",{children:["playroom",{children:["[roomId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(n.bind(n,7927)),"C:\\Users\\SSAFY\\Desktop\\projects\\Frontend\\src\\app\\playroom\\[roomId]\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(n.bind(n,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],modal:["__DEFAULT__",{},{defaultPage:[()=>Promise.resolve().then(n.bind(n,85279)),"C:\\Users\\SSAFY\\Desktop\\projects\\Frontend\\src\\app\\@modal\\default.tsx"]}]},{layout:[()=>Promise.resolve().then(n.bind(n,19459)),"C:\\Users\\SSAFY\\Desktop\\projects\\Frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(n.bind(n,27976)),"C:\\Users\\SSAFY\\Desktop\\projects\\Frontend\\src\\app\\not-found.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(n.bind(n,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["C:\\Users\\SSAFY\\Desktop\\projects\\Frontend\\src\\app\\playroom\\[roomId]\\page.tsx"],d="/playroom/[roomId]/page",h={require:n,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/playroom/[roomId]/page",pathname:"/playroom/[roomId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},37324:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,2583,23)),Promise.resolve().then(n.t.bind(n,26840,23)),Promise.resolve().then(n.t.bind(n,38771,23)),Promise.resolve().then(n.t.bind(n,13225,23)),Promise.resolve().then(n.t.bind(n,9295,23)),Promise.resolve().then(n.t.bind(n,43982,23))},59132:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,31900,23)),Promise.resolve().then(n.t.bind(n,61476,23)),Promise.resolve().then(n.bind(n,84753)),Promise.resolve().then(n.bind(n,70941)),Promise.resolve().then(n.bind(n,56314))},95299:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,31900,23)),Promise.resolve().then(n.bind(n,41516))},47908:(e,t,n)=>{Promise.resolve().then(n.bind(n,7494))},35303:()=>{},40056:(e,t,n)=>{var r=n(57310).parse,i=n(82361),o=n(95687),s=n(13685),a=n(73837),c=["pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","secureProtocol","servername","checkServerIdentity"],l=[239,187,191],u=/^(cookie|authorization)$/i;function d(e,t){var n,i=d.CONNECTING,a=t&&t.headers,f=!1;Object.defineProperty(this,"readyState",{get:function(){return i}}),Object.defineProperty(this,"url",{get:function(){return e}});var m=this;function v(t){i!==d.CLOSED&&(i=d.CONNECTING,w("error",new h("error",{message:t})),S&&(e=S,S=null,f=!1),setTimeout(function(){i!==d.CONNECTING||m.connectionInProgress||(m.connectionInProgress=!0,_())},m.reconnectInterval))}m.reconnectInterval=1e3,m.connectionInProgress=!1;var g="";a&&a["Last-Event-ID"]&&(g=a["Last-Event-ID"],delete a["Last-Event-ID"]);var b=!1,E="",y="",S=null;function _(){var x=r(e),O="https:"===x.protocol;if(x.headers={"Cache-Control":"no-cache",Accept:"text/event-stream"},g&&(x.headers["Last-Event-ID"]=g),a){var C=f?function(e){var t={};for(var n in e)u.test(n)||(t[n]=e[n]);return t}(a):a;for(var I in C){var R=C[I];R&&(x.headers[I]=R)}}if(x.rejectUnauthorized=!(t&&!t.rejectUnauthorized),t&&void 0!==t.createConnection&&(x.createConnection=t.createConnection),t&&t.proxy){var k=r(t.proxy);O="https:"===k.protocol,x.protocol=O?"https:":"http:",x.path=e,x.headers.Host=x.host,x.hostname=k.hostname,x.host=k.host,x.port=k.port}if(t&&t.https){for(var N in t.https)if(-1!==c.indexOf(N)){var T=t.https[N];void 0!==T&&(x[N]=T)}}t&&void 0!==t.withCredentials&&(x.withCredentials=t.withCredentials),(n=(O?o:s).request(x,function(t){if(m.connectionInProgress=!1,500===t.statusCode||502===t.statusCode||503===t.statusCode||504===t.statusCode){w("error",new h("error",{status:t.statusCode,message:t.statusMessage})),v();return}if(301===t.statusCode||302===t.statusCode||307===t.statusCode){var n,r,o=t.headers.location;if(!o){w("error",new h("error",{status:t.statusCode,message:t.statusMessage}));return}f=new URL(e).origin!==new URL(o).origin,307===t.statusCode&&(S=e),e=o,process.nextTick(_);return}if(200!==t.statusCode)return w("error",new h("error",{status:t.statusCode,message:t.statusMessage})),m.close();i=d.OPEN,t.on("close",function(){t.removeAllListeners("close"),t.removeAllListeners("end"),v()}),t.on("end",function(){t.removeAllListeners("close"),t.removeAllListeners("end"),v()}),w("open",new h("open"));var s=0,a=-1,c=0,u=0;t.on("data",function(t){if(n)t.length>n.length-u&&((c=2*n.length+t.length)>262144&&(c=n.length+t.length+262144),r=Buffer.alloc(c),n.copy(r,0,0,u),n=r),t.copy(n,u),u+=t.length;else{var i;i=n=t,l.every(function(e,t){return i[t]===e})&&(n=n.slice(l.length)),u=n.length}for(var o=0,d=u;o<d;){b&&(10===n[o]&&++o,b=!1);for(var h,f=-1,v=a,S=s;f<0&&S<d;++S)58===(h=n[S])?v<0&&(v=S-o):13===h?(b=!0,f=S-o):10===h&&(f=S-o);if(f<0){s=d-o,a=v;break}s=0,a=-1,function(t,n,r,i){if(0===i){if(E.length>0){var o=y||"message";w(o,new p(o,{data:E.slice(0,-1),lastEventId:g,origin:new URL(e).origin})),E=""}y=void 0}else if(r>0){var s=r<0,a=0,c=t.slice(n,n+(s?i:r)).toString();a=s?i:32!==t[n+r+1]?r+1:r+2,n+=a;var l=i-a,u=t.slice(n,n+l).toString();if("data"===c)E+=u+"\n";else if("event"===c)y=u;else if("id"===c)g=u;else if("retry"===c){var d=parseInt(u,10);Number.isNaN(d)||(m.reconnectInterval=d)}}}(n,o,v,f),o+=f+1}o===d?(n=void 0,u=0):o>0&&(u=(n=n.slice(o,u)).length)})})).on("error",function(e){m.connectionInProgress=!1,v(e.message)}),n.setNoDelay&&n.setNoDelay(!0),n.end()}function w(){m.listeners(arguments[0]).length>0&&m.emit.apply(m,arguments)}_(),this._close=function(){i!==d.CLOSED&&(i=d.CLOSED,n.abort&&n.abort(),n.xhr&&n.xhr.abort&&n.xhr.abort())}}function h(e,t){if(Object.defineProperty(this,"type",{writable:!1,value:e,enumerable:!0}),t)for(var n in t)t.hasOwnProperty(n)&&Object.defineProperty(this,n,{writable:!1,value:t[n],enumerable:!0})}function p(e,t){for(var n in Object.defineProperty(this,"type",{writable:!1,value:e,enumerable:!0}),t)t.hasOwnProperty(n)&&Object.defineProperty(this,n,{writable:!1,value:t[n],enumerable:!0})}e.exports=d,a.inherits(d,i.EventEmitter),d.prototype.constructor=d,["open","error","message"].forEach(function(e){Object.defineProperty(d.prototype,"on"+e,{get:function(){var t=this.listeners(e)[0];return t?t._listener?t._listener:t:void 0},set:function(t){this.removeAllListeners(e),this.addEventListener(e,t)}})}),Object.defineProperty(d,"CONNECTING",{enumerable:!0,value:0}),Object.defineProperty(d,"OPEN",{enumerable:!0,value:1}),Object.defineProperty(d,"CLOSED",{enumerable:!0,value:2}),d.prototype.CONNECTING=0,d.prototype.OPEN=1,d.prototype.CLOSED=2,d.prototype.close=function(){this._close()},d.prototype.addEventListener=function(e,t){"function"==typeof t&&(t._listener=t,this.on(e,t))},d.prototype.dispatchEvent=function(e){if(!e.type)throw Error("UNSPECIFIED_EVENT_TYPE_ERR");this.emit(e.type,e.detail)},d.prototype.removeEventListener=function(e,t){"function"==typeof t&&(t._listener=void 0,this.removeListener(e,t))}},31633:(e,t,n)=>{"use strict";var r=n(12781).Stream,i=n(73837),o=n(16778),s=n(3355),a=n(50490),c=n(68435),l=n(31436),u=function(e,t,n){this.writable=!0,n=n||{},this._stream=t.socket,this._ping=n.ping||this.DEFAULT_PING,this._retry=n.retry||this.DEFAULT_RETRY;var r=o.isSecureRequest(e)?"https:":"http:";this.url=r+"//"+e.headers.host+e.url,this.lastEventId=e.headers["last-event-id"]||"",this.readyState=a.CONNECTING;var i=new s,c=this;if(n.headers)for(var l in n.headers)i.set(l,n.headers[l]);if(this._stream&&this._stream.writable){process.nextTick(function(){c._open()}),this._stream.setTimeout(0),this._stream.setNoDelay(!0);var u="HTTP/1.1 200 OK\r\nContent-Type: text/event-stream\r\nCache-Control: no-cache, no-store\r\nConnection: close\r\n"+i.toString()+"\r\nretry: "+Math.floor(1e3*this._retry)+"\r\n\r\n";this._write(u),this._stream.on("drain",function(){c.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){c.ping()},1e3*this._ping)),["error","end"].forEach(function(e){c._stream.on(e,function(){c.close()})})}};i.inherits(u,r),u.isEventSource=function(e){return"GET"===e.method&&(e.headers.accept||"").split(/\s*,\s*/).indexOf("text/event-stream")>=0};var d={DEFAULT_PING:10,DEFAULT_RETRY:5,_write:function(e){if(!this.writable)return!1;try{return this._stream.write(e,"utf8")}catch(e){return!1}},_open:function(){if(this.readyState===a.CONNECTING){this.readyState=a.OPEN;var e=new l("open");e.initEvent("open",!1,!1),this.dispatchEvent(e)}},write:function(e){return this.send(e)},end:function(e){void 0!==e&&this.write(e),this.close()},send:function(e,t){if(this.readyState>a.OPEN)return!1;e=String(e).replace(/(\r\n|\r|\n)/g,"$1data: ");var n="";return(t=t||{}).event&&(n+="event: "+t.event+"\r\n"),t.id&&(n+="id: "+t.id+"\r\n"),n+="data: "+e+"\r\n\r\n",this._write(n)},ping:function(){return this._write(":\r\n\r\n")},close:function(){if(this.readyState>a.OPEN)return!1;this.readyState=a.CLOSED,this.writable=!1,this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end();var e=new l("close");return e.initEvent("close",!1,!1),this.dispatchEvent(e),!0}};for(var h in d)u.prototype[h]=d[h];for(var p in c)u.prototype[p]=c[p];e.exports=u},81453:(e,t,n)=>{"use strict";var r=n(73837),i=n(16778),o=n(50490),s=function(e,t,n,r,s){s=s||{},this._stream=t,this._driver=i.http(e,{maxLength:s.maxLength,protocols:r});var a=this;if(this._stream&&this._stream.writable){if(!this._stream.readable)return this._stream.end();var c=function(){a._stream.removeListener("data",c)};this._stream.on("data",c),o.call(this,s),process.nextTick(function(){a._driver.start(),a._driver.io.write(n)})}};r.inherits(s,o),s.isWebSocket=function(e){return i.isWebSocket(e)},s.validateOptions=function(e,t){i.validateOptions(e,t)},s.WebSocket=s,s.Client=n(9131),s.EventSource=n(31633),e.exports=s},50490:(e,t,n)=>{"use strict";var r=n(12781).Stream,i=n(73837),o=n(16778),s=n(68435),a=n(31436),c=function(e){e=e||{},o.validateOptions(e,["headers","extensions","maxLength","ping","proxy","tls","ca"]),this.readable=this.writable=!0;var t=e.headers;if(t)for(var n in t)this._driver.setHeader(n,t[n]);var r=e.extensions;r&&[].concat(r).forEach(this._driver.addExtension,this._driver),this._ping=e.ping,this._pingId=0,this.readyState=c.CONNECTING,this.bufferedAmount=0,this.protocol="",this.url=this._driver.url,this.version=this._driver.version;var i=this;this._driver.on("open",function(e){i._open()}),this._driver.on("message",function(e){i._receiveMessage(e.data)}),this._driver.on("close",function(e){i._beginClose(e.reason,e.code)}),this._driver.on("error",function(e){i._emitError(e.message)}),this.on("error",function(){}),this._driver.messages.on("drain",function(){i.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){i._pingId+=1,i.ping(i._pingId.toString())},1e3*this._ping)),this._configureStream(),this._proxy||(this._stream.pipe(this._driver.io),this._driver.io.pipe(this._stream))};i.inherits(c,r),c.CONNECTING=0,c.OPEN=1,c.CLOSING=2,c.CLOSED=3,c.CLOSE_TIMEOUT=3e4;var l={write:function(e){return this.send(e)},end:function(e){void 0!==e&&this.send(e),this.close()},pause:function(){return this._driver.messages.pause()},resume:function(){return this._driver.messages.resume()},send:function(e){return!(this.readyState>c.OPEN)&&(e instanceof Buffer||(e=String(e)),this._driver.messages.write(e))},ping:function(e,t){return!(this.readyState>c.OPEN)&&this._driver.ping(e,t)},close:function(e,t){if(void 0===e&&(e=1e3),void 0===t&&(t=""),1e3!==e&&(e<3e3||e>4999))throw Error("Failed to execute 'close' on WebSocket: The code must be either 1000, or between 3000 and 4999. "+e+" is neither.");if(this.readyState<c.CLOSING){var n=this;this._closeTimer=setTimeout(function(){n._beginClose("",1006)},c.CLOSE_TIMEOUT)}this.readyState!==c.CLOSED&&(this.readyState=c.CLOSING),this._driver.close(t,e)},_configureStream:function(){var e=this;this._stream.setTimeout(0),this._stream.setNoDelay(!0),["close","end"].forEach(function(t){this._stream.on(t,function(){e._finalizeClose()})},this),this._stream.on("error",function(t){e._emitError("Network error: "+e.url+": "+t.message),e._finalizeClose()})},_open:function(){if(this.readyState===c.CONNECTING){this.readyState=c.OPEN,this.protocol=this._driver.protocol||"";var e=new a("open");e.initEvent("open",!1,!1),this.dispatchEvent(e)}},_receiveMessage:function(e){if(this.readyState>c.OPEN)return!1;this.readable&&this.emit("data",e);var t=new a("message",{data:e});t.initEvent("message",!1,!1),this.dispatchEvent(t)},_emitError:function(e){if(!(this.readyState>=c.CLOSING)){var t=new a("error",{message:e});t.initEvent("error",!1,!1),this.dispatchEvent(t)}},_beginClose:function(e,t){this.readyState!==c.CLOSED&&(this.readyState=c.CLOSING,this._closeParams=[e,t],this._stream&&(this._stream.destroy(),this._stream.readable||this._finalizeClose()))},_finalizeClose:function(){if(this.readyState!==c.CLOSED){this.readyState=c.CLOSED,this._closeTimer&&clearTimeout(this._closeTimer),this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end(),this.readable&&this.emit("end"),this.readable=this.writable=!1;var e=this._closeParams?this._closeParams[0]:"",t=new a("close",{code:this._closeParams?this._closeParams[1]:1006,reason:e});t.initEvent("close",!1,!1),this.dispatchEvent(t)}}};for(var u in l)c.prototype[u]=l[u];for(var d in s)c.prototype[d]=s[d];e.exports=c},31436:e=>{"use strict";var t=function(e,t){for(var n in this.type=e,t)this[n]=t[n]};t.prototype.initEvent=function(e,t,n){this.type=e,this.bubbles=t,this.cancelable=n},t.prototype.stopPropagation=function(){},t.prototype.preventDefault=function(){},t.CAPTURING_PHASE=1,t.AT_TARGET=2,t.BUBBLING_PHASE=3,e.exports=t},68435:(e,t,n)=>{"use strict";var r=n(31436);e.exports={onopen:null,onmessage:null,onerror:null,onclose:null,addEventListener:function(e,t,n){this.on(e,t)},removeEventListener:function(e,t,n){this.removeListener(e,t)},dispatchEvent:function(e){e.target=e.currentTarget=this,e.eventPhase=r.AT_TARGET,this["on"+e.type]&&this["on"+e.type](e),this.emit(e.type,e)}}},9131:(e,t,n)=>{"use strict";var r=n(73837),i=n(41808),o=n(24404),s=n(57310),a=n(16778),c=n(50490);n(31436);var l={"http:":80,"https:":443,"ws:":80,"wss:":443},u=["https:","wss:"],d=function(e,t,n){n=n||{},this.url=e,this._driver=a.client(this.url,{maxLength:n.maxLength,protocols:t}),["open","error"].forEach(function(e){this._driver.on(e,function(){b.headers=b._driver.headers,b.statusCode=b._driver.statusCode})},this);var r=n.proxy||{},d=s.parse(r.origin||this.url),h=d.port||l[d.protocol],p=u.indexOf(d.protocol)>=0,f=function(){b._onConnect()},m=n.net||{},v=n.tls||{},g=r.origin?r.tls||{}:v,b=this;m.host=g.host=d.hostname,m.port=g.port=h,v.ca=v.ca||n.ca,g.servername=g.servername||d.hostname,this._stream=p?o.connect(g,f):i.connect(m,f),r.origin&&this._configureProxy(r,v),c.call(this,n)};r.inherits(d,c),d.prototype._onConnect=function(){(this._proxy||this._driver).start()},d.prototype._configureProxy=function(e,t){var n,r=s.parse(this.url),i=u.indexOf(r.protocol)>=0,a=this;if(this._proxy=this._driver.proxy(e.origin),e.headers)for(n in e.headers)this._proxy.setHeader(n,e.headers[n]);this._proxy.pipe(this._stream,{end:!1}),this._stream.pipe(this._proxy),this._proxy.on("connect",function(){if(i){var e={socket:a._stream,servername:r.hostname};for(n in t)e[n]=t[n];a._stream=o.connect(e),a._configureStream()}a._driver.io.pipe(a._stream),a._stream.pipe(a._driver.io),a._driver.start()}),this._proxy.on("error",function(e){a._driver.emit("error",e)})},e.exports=d},5442:(e,t,n)=>{"use strict";var r=n(25817);e.exports=function(e){var t,i={stun:(e||{}).stun||n(47611),turn:(e||{}).turn||n(58217)},o=(e||{}).stunCount||2,s=(e||{}).turnCount||0;function a(e,t){for(var n,o=[],s=[].concat(i[e]);s.length&&o.length<t;)n=Math.random()*s.length|0,o=o.concat(s.splice(n,1));return o.map(function(t){return"string"==typeof t||t instanceof String?r(e+":"+t):t})}return t=[].concat(a("stun",o)),s&&(t=t.concat(a("turn",s))),t}},50062:(e,t,n)=>{var r,i=n(9280),o=null;e.exports=function(e,t){var n,s,a,c=new i;if(!r)return c;var t=t||{},l=t.smoothing||.1,u=t.interval||50,d=t.threshold,h=t.play,p=t.history||10,f=!0;(a=(o=t.audioContext||o||new r).createAnalyser()).fftSize=512,a.smoothingTimeConstant=l,s=new Float32Array(a.frequencyBinCount),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(n=o.createMediaElementSource(e),void 0===h&&(h=!0)):n=o.createMediaStreamSource(e),d=d||-50,n.connect(a),h&&a.connect(o.destination),c.speaking=!1,c.suspend=function(){return o.suspend()},c.resume=function(){return o.resume()},Object.defineProperty(c,"state",{get:function(){return o.state}}),o.onstatechange=function(){c.emit("state_change",o.state)},c.setThreshold=function(e){d=e},c.setInterval=function(e){u=e},c.stop=function(){f=!1,c.emit("volume_change",-100,d),c.speaking&&(c.speaking=!1,c.emit("stopped_speaking")),a.disconnect(),n.disconnect()},c.speakingHistory=[];for(var m=0;m<p;m++)c.speakingHistory.push(0);var v=function(){setTimeout(function(){if(f){var e=function(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var r=4,i=t.length;r<i;r++)t[r]>n&&t[r]<0&&(n=t[r]);return n}(a,s);c.emit("volume_change",e,d);var t=0;if(e>d&&!c.speaking){for(var n=c.speakingHistory.length-3;n<c.speakingHistory.length;n++)t+=c.speakingHistory[n];t>=2&&(c.speaking=!0,c.emit("speaking"))}else if(e<d&&c.speaking){for(var n=0;n<c.speakingHistory.length;n++)t+=c.speakingHistory[n];0==t&&(c.speaking=!1,c.emit("stopped_speaking"))}c.speakingHistory.shift(),c.speakingHistory.push(0+(e>d)),v()}},u)};return v(),c}},22735:(e,t,n)=>{var r=n(39491);function i(e){r.ok(e===i.REQUEST||e===i.RESPONSE||void 0===e),void 0===e||this.initialize(e),this.maxHeaderSize=i.maxHeaderSize}t.m=i,i.prototype.initialize=function(e,t){r.ok(e===i.REQUEST||e===i.RESPONSE),this.type=e,this.state=e+"_LINE",this.info={headers:[],upgrade:!1},this.trailers=[],this.line="",this.isChunked=!1,this.connection="",this.headerSize=0,this.body_bytes=null,this.isUserCall=!1,this.hadError=!1},i.encoding="ascii",i.maxHeaderSize=81920,i.REQUEST="REQUEST",i.RESPONSE="RESPONSE";var o=i.kOnHeaders=1,s=i.kOnHeadersComplete=2,a=i.kOnBody=3,c=i.kOnMessageComplete=4;i.prototype[o]=i.prototype[s]=i.prototype[a]=i.prototype[c]=function(){};var l=!0;Object.defineProperty(i,"kOnExecute",{get:function(){return l=!1,99}});var u=i.methods=["DELETE","GET","HEAD","POST","PUT","CONNECT","OPTIONS","TRACE","COPY","LOCK","MKCOL","MOVE","PROPFIND","PROPPATCH","SEARCH","UNLOCK","BIND","REBIND","UNBIND","ACL","REPORT","MKACTIVITY","CHECKOUT","MERGE","M-SEARCH","NOTIFY","SUBSCRIBE","UNSUBSCRIBE","PATCH","PURGE","MKCALENDAR","LINK","UNLINK","SOURCE"],d=u.indexOf("CONNECT");i.prototype.reinitialize=i,i.prototype.close=i.prototype.pause=i.prototype.resume=i.prototype.free=function(){},i.prototype._compatMode0_11=!1,i.prototype.getAsyncId=function(){return 0};var h={REQUEST_LINE:!0,RESPONSE_LINE:!0,HEADER:!0};i.prototype.execute=function(e,t,n){if(!(this instanceof i))throw TypeError("not a HTTPParser");t=t||0,n="number"==typeof n?n:e.length,this.chunk=e,this.offset=t;var r=this.end=t+n;try{for(;this.offset<r&&!this[this.state](););}catch(e){if(this.isUserCall)throw e;return this.hadError=!0,e}return(this.chunk=null,n=this.offset-t,h[this.state]&&(this.headerSize+=n,this.headerSize>(this.maxHeaderSize||i.maxHeaderSize)))?Error("max header size exceeded"):n};var p={REQUEST_LINE:!0,RESPONSE_LINE:!0,BODY_RAW:!0};i.prototype.finish=function(){if(!this.hadError){if(!p[this.state])return Error("invalid state for EOF");"BODY_RAW"===this.state&&this.userCall()(this[c]())}},i.prototype.consume=i.prototype.unconsume=i.prototype.getCurrentBuffer=function(){},i.prototype.userCall=function(){this.isUserCall=!0;var e=this;return function(t){return e.isUserCall=!1,t}},i.prototype.nextRequest=function(){this.userCall()(this[c]()),this.reinitialize(this.type)},i.prototype.consumeLine=function(){for(var e=this.end,t=this.chunk,n=this.offset;n<e;n++)if(10===t[n]){var r=this.line+t.toString(i.encoding,this.offset,n);return"\r"===r.charAt(r.length-1)&&(r=r.substr(0,r.length-1)),this.line="",this.offset=n+1,r}this.line+=t.toString(i.encoding,this.offset,this.end),this.offset=this.end};var f=/^([^: \t]+):[ \t]*((?:.*[^ \t])|)/,m=/^[ \t]+(.*[^ \t])/;i.prototype.parseHeader=function(e,t){if(-1!==e.indexOf("\r"))throw b("HPE_LF_EXPECTED");var n=f.exec(e),r=n&&n[1];if(r)t.push(r),t.push(n[2]);else{var i=m.exec(e);i&&t.length&&(t[t.length-1]&&(t[t.length-1]+=" "),t[t.length-1]+=i[1])}};var v=/^([A-Z-]+) ([^ ]+) HTTP\/(\d)\.(\d)$/;i.prototype.REQUEST_LINE=function(){var e=this.consumeLine();if(e){var t=v.exec(e);if(null===t)throw b("HPE_INVALID_CONSTANT");if(this.info.method=this._compatMode0_11?t[1]:u.indexOf(t[1]),-1===this.info.method)throw Error("invalid request method");this.info.url=t[2],this.info.versionMajor=+t[3],this.info.versionMinor=+t[4],this.body_bytes=0,this.state="HEADER"}};var g=/^HTTP\/(\d)\.(\d) (\d{3}) ?(.*)$/;function b(e){var t=Error("Parse Error");return t.code=e,t}i.prototype.RESPONSE_LINE=function(){var e=this.consumeLine();if(e){var t=g.exec(e);if(null===t)throw b("HPE_INVALID_CONSTANT");this.info.versionMajor=+t[1],this.info.versionMinor=+t[2];var n=this.info.statusCode=+t[3];this.info.statusMessage=t[4],((n/100|0)==1||204===n||304===n)&&(this.body_bytes=0),this.state="HEADER"}},i.prototype.shouldKeepAlive=function(){if(this.info.versionMajor>0&&this.info.versionMinor>0){if(-1!==this.connection.indexOf("close"))return!1}else if(-1===this.connection.indexOf("keep-alive"))return!1;return null!==this.body_bytes||!!this.isChunked},i.prototype.HEADER=function(){var e=this.consumeLine();if(void 0!==e){var t=this.info;if(e)this.parseHeader(e,t.headers);else{for(var n,r,o=t.headers,a=!1,c=!1,u=0;u<o.length;u+=2)switch(o[u].toLowerCase()){case"transfer-encoding":this.isChunked="chunked"===o[u+1].toLowerCase();break;case"content-length":if(n=+o[u+1],a){if(n!==this.body_bytes)throw b("HPE_UNEXPECTED_CONTENT_LENGTH")}else a=!0,this.body_bytes=n;break;case"connection":this.connection+=o[u+1].toLowerCase();break;case"upgrade":c=!0}if(this.isChunked&&a&&(a=!1,this.body_bytes=null),c&&-1!=this.connection.indexOf("upgrade")?t.upgrade=this.type===i.REQUEST||101===t.statusCode:t.upgrade=t.method===d,this.isChunked&&t.upgrade&&(this.isChunked=!1),t.shouldKeepAlive=this.shouldKeepAlive(),2===(r=l?this.userCall()(this[s](t)):this.userCall()(this[s](t.versionMajor,t.versionMinor,t.headers,t.method,t.url,t.statusCode,t.statusMessage,t.upgrade,t.shouldKeepAlive))))return this.nextRequest(),!0;if(this.isChunked&&!r)this.state="BODY_CHUNKHEAD";else{if(r||0===this.body_bytes)return this.nextRequest(),t.upgrade;null===this.body_bytes?this.state="BODY_RAW":this.state="BODY_SIZED"}}}},i.prototype.BODY_CHUNKHEAD=function(){var e=this.consumeLine();void 0!==e&&(this.body_bytes=parseInt(e,16),this.body_bytes?this.state="BODY_CHUNK":this.state="BODY_CHUNKTRAILERS")},i.prototype.BODY_CHUNK=function(){var e=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[a](this.chunk,this.offset,e)),this.offset+=e,this.body_bytes-=e,this.body_bytes||(this.state="BODY_CHUNKEMPTYLINE")},i.prototype.BODY_CHUNKEMPTYLINE=function(){var e=this.consumeLine();void 0!==e&&(r.equal(e,""),this.state="BODY_CHUNKHEAD")},i.prototype.BODY_CHUNKTRAILERS=function(){var e=this.consumeLine();void 0!==e&&(e?this.parseHeader(e,this.trailers):(this.trailers.length&&this.userCall()(this[o](this.trailers,"")),this.nextRequest()))},i.prototype.BODY_RAW=function(){var e=this.end-this.offset;this.userCall()(this[a](this.chunk,this.offset,e)),this.offset=this.end},i.prototype.BODY_SIZED=function(){var e=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[a](this.chunk,this.offset,e)),this.offset+=e,this.body_bytes-=e,this.body_bytes||this.nextRequest()},["Headers","HeadersComplete","Body","MessageComplete"].forEach(function(e){var t=i["kOn"+e];Object.defineProperty(i.prototype,"on"+e,{get:function(){return this[t]},set:function(e){return this._compatMode0_11=!0,d="CONNECT",this[t]=e}})})},58555:(e,t,n)=>{try{var r=n(73837);if("function"!=typeof r.inherits)throw"";e.exports=r.inherits}catch(t){e.exports=n(87759)}},87759:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},294:function(e,t){var n,r,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function o(e){if(!e)return o.__;Array.prototype.reduce||(Array.prototype.reduce=function(e,t){for(var n=t,r=0;r<this.length;r++)n=e(n,this[r],r,this);return n});var t="";return("."+e).split(".").reduce(function(e,n,r,i){t?t+="."+n:t=n;var s=e["__"+t];return void 0===s&&(o.Logger.prototype=e,s=new o.Logger(t),e["__"+t]=s),s},o.__)}(function(e){function t(e,t,n){if(void 0!==t[e]){if(null===t[e]){delete n[e];return}n[e]=t[e]}}function n(t){if(null!=e.enabled&&!e.enabled)return!1;try{if(t.userAgentRegex&&!new RegExp(t.userAgentRegex).test(navigator.userAgent))return!1}catch(e){}try{if(t.ipRegex&&e.clientIP&&!new RegExp(t.ipRegex).test(e.clientIP))return!1}catch(e){}return!0}function r(e,t){try{if(e.disallow&&new RegExp(e.disallow).test(t))return!1}catch(e){}return!0}function o(e){return"function"==typeof e?e instanceof RegExp?e.toString():e():e}e.requestId="",e.entryId=0,e._createXMLHttpRequest=function(){return new XMLHttpRequest},e._getTime=function(){return(new Date).getTime()},e._console=console,e._appenderNames=[];var s,a=function(e,t,n){this.msg=e,this.meta=t,this.finalString=n};function c(t){var n,r=o(t);switch(typeof r){case"string":return new a(r,null,r);case"number":case"boolean":return new a(n=r.toString(),null,n);case"undefined":return new a("undefined",null,"undefined");case"object":if(r instanceof RegExp||r instanceof String||r instanceof Number||r instanceof Boolean)return new a(n=r.toString(),null,n);return n="function"==typeof e.serialize?e.serialize.call(this,r):JSON.stringify(r),new a("",r,n);default:return new a("unknown",null,"unknown")}}function l(){return 1e3}function u(){return 2e3}function d(){return 3e3}function h(){return 4e3}function p(){return 5e3}function f(){return 6e3}e.setOptions=function(e){return t("enabled",e,this),t("maxMessages",e,this),t("defaultAjaxUrl",e,this),t("clientIP",e,this),t("requestId",e,this),t("defaultBeforeSend",e,this),t("serialize",e,this),this},e.getAllLevel=function(){return -2147483648},e.getTraceLevel=l,e.getDebugLevel=u,e.getInfoLevel=d,e.getWarnLevel=h,e.getErrorLevel=p,e.getFatalLevel=f,e.getOffLevel=function(){return 2147483647};var m=function(e,t){this.inner=t,this.name="JL.Exception",this.message=c(e).finalString};e.Exception=m,m.prototype=Error();var v=function(e,t,n,r,i){this.l=e,this.m=t,this.n=n,this.t=r,this.u=i};function g(t,n,r){return e.entryId++,new v(t,n,r,e._getTime(),e.entryId)}function b(e){e.id&&(clearTimeout(e.id),e.id=null)}function E(e,t,n){var r=this;e.id||(e.id=setTimeout(function(){n.call(r)},t))}e.LogItem=v;var y=function(){function i(t,n){this.appenderName=t,this.sendLogItems=n,this.level=e.getTraceLevel(),this.sendWithBufferLevel=2147483647,this.storeInBufferLevel=-2147483648,this.bufferSize=0,this.batchSize=1,this.maxBatchSize=20,this.batchTimeout=2147483647,this.sendTimeout=5e3,this.buffer=[],this.batchBuffer=[],this.batchTimeoutTimer={id:null},this.sendTimeoutTimer={id:null},this.nbrLogItemsSkipped=0,this.nbrLogItemsBeingSent=0;var r="Trying to create an appender without a name or with an empty name";if(void 0==t)throw r;if(-1!=e._appenderNames.indexOf(t)){if(!t)throw r;throw"Multiple appenders use the same name "+t}e._appenderNames.push(t)}return i.prototype.addLogItemsToBuffer=function(t){if(this.batchBuffer.length>=this.maxBatchSize){this.nbrLogItemsSkipped+=t.length;return}if(null!=e.maxMessages){if(e.maxMessages<1)return;e.maxMessages-=t.length}this.batchBuffer=this.batchBuffer.concat(t);var n=this;E(this.batchTimeoutTimer,this.batchTimeout,function(){n.sendBatch.call(n)})},i.prototype.batchBufferHasOverdueMessages=function(){for(var t=0;t<this.batchBuffer.length;t++)if(e._getTime()-this.batchBuffer[t].t>this.batchTimeout)return!0;return!1},i.prototype.batchBufferHasStrandedMessage=function(){return null!=e.maxMessages&&e.maxMessages<1&&this.batchBuffer.length>0},i.prototype.sendBatchIfComplete=function(){(this.batchBuffer.length>=this.batchSize||this.batchBufferHasOverdueMessages()||this.batchBufferHasStrandedMessage())&&this.sendBatch()},i.prototype.onSendingEnded=function(){b(this.sendTimeoutTimer),this.nbrLogItemsBeingSent=0,this.sendBatchIfComplete()},i.prototype.setOptions=function(n){if(t("level",n,this),t("ipRegex",n,this),t("userAgentRegex",n,this),t("disallow",n,this),t("sendWithBufferLevel",n,this),t("storeInBufferLevel",n,this),t("bufferSize",n,this),t("batchSize",n,this),t("maxBatchSize",n,this),t("batchTimeout",n,this),t("sendTimeout",n,this),this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize),this.maxBatchSize<this.batchSize)throw new e.Exception({message:"maxBatchSize cannot be smaller than batchSize",maxBatchSize:this.maxBatchSize,batchSize:this.batchSize});return this},i.prototype.log=function(e,t,i,o,s,a,c){var l;if(n(this)&&r(this,a)&&!(s<this.storeInBufferLevel)){if(l=g(s,a,c),s<this.level){this.bufferSize>0&&(this.buffer.push(l),this.buffer.length>this.bufferSize&&this.buffer.shift());return}this.addLogItemsToBuffer([l]),s>=this.sendWithBufferLevel&&this.buffer.length&&(this.addLogItemsToBuffer(this.buffer),this.buffer.length=0),this.sendBatchIfComplete()}},i.prototype.sendBatch=function(){if(!(this.nbrLogItemsBeingSent>0)&&(b(this.batchTimeoutTimer),0!=this.batchBuffer.length)){this.nbrLogItemsBeingSent=this.batchBuffer.length;var e=this;E(this.sendTimeoutTimer,this.sendTimeout,function(){e.onSendingEnded.call(e)}),this.sendLogItems(this.batchBuffer,function(){e.batchBuffer.splice(0,e.nbrLogItemsBeingSent),e.nbrLogItemsSkipped>0&&(e.batchBuffer.push(g(h(),"Lost "+e.nbrLogItemsSkipped+" messages. Either connection with the server was down or logging was disabled via the enabled option. Reduce lost messages by increasing the ajaxAppender option maxBatchSize.",e.appenderName)),e.nbrLogItemsSkipped=0),e.onSendingEnded.call(e)})}},i}();e.Appender=y;var S=function(r){function o(e){return r.call(this,e,o.prototype.sendLogItemsAjax)||this}return i(o,r),o.prototype.setOptions=function(e){return t("url",e,this),t("beforeSend",e,this),r.prototype.setOptions.call(this,e),this},o.prototype.sendLogItemsAjax=function(t,r){try{if(!n(this))return;this.xhr&&0!=this.xhr.readyState&&4!=this.xhr.readyState&&this.xhr.abort(),this.xhr=e._createXMLHttpRequest();var i="/jsnlog.logger";null!=e.defaultAjaxUrl&&(i=e.defaultAjaxUrl),this.url&&(i=this.url),this.xhr.open("POST",i),this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("JSNLog-RequestId",e.requestId);var o=this;this.xhr.onreadystatechange=function(){4==o.xhr.readyState&&o.xhr.status>=200&&o.xhr.status<300&&r()};var s={r:e.requestId,lg:t};"function"==typeof this.beforeSend?this.beforeSend.call(this,this.xhr,s):"function"==typeof e.defaultBeforeSend&&e.defaultBeforeSend.call(this,this.xhr,s);var a=JSON.stringify(s);this.xhr.send(a)}catch(e){}},o}(y);e.AjaxAppender=S;var _=function(t){function r(e){return t.call(this,e,r.prototype.sendLogItemsConsole)||this}return i(r,t),r.prototype.clog=function(t){e._console.log(t)},r.prototype.cerror=function(t){e._console.error?e._console.error(t):this.clog(t)},r.prototype.cwarn=function(t){e._console.warn?e._console.warn(t):this.clog(t)},r.prototype.cinfo=function(t){e._console.info?e._console.info(t):this.clog(t)},r.prototype.cdebug=function(t){e._console.debug?e._console.debug(t):this.cinfo(t)},r.prototype.sendLogItemsConsole=function(t,r){try{if(!n(this)||!e._console)return;for(i=0;i<t.length;++i){var i,o=t[i],s=o.n+": "+o.m;s=new Date(o.t)+" | "+s,o.l<=e.getDebugLevel()?this.cdebug(s):o.l<=e.getInfoLevel()?this.cinfo(s):o.l<=e.getWarnLevel()?this.cwarn(s):this.cerror(s)}}catch(e){}r()},r}(y);e.ConsoleAppender=_;var w=function(){function e(e){this.loggerName=e,this.seenRegexes=[]}return e.prototype.setOptions=function(e){return t("level",e,this),t("userAgentRegex",e,this),t("disallow",e,this),t("ipRegex",e,this),t("appenders",e,this),t("onceOnly",e,this),this.seenRegexes=[],this},e.prototype.buildExceptionObject=function(e){var t={};return e.stack?t.stack=e.stack:t.e=e,e.message&&(t.message=e.message),e.name&&(t.name=e.name),e.data&&(t.data=e.data),e.inner&&(t.inner=this.buildExceptionObject(e.inner)),t},e.prototype.log=function(e,t,i){var s,a,l=0;if(!this.appenders)return this;if(e>=this.level&&n(this)&&(i?(a=this.buildExceptionObject(i)).logData=o(t):a=t,r(this,(s=c(a)).finalString))){if(this.onceOnly)for(l=this.onceOnly.length-1;l>=0;){if(new RegExp(this.onceOnly[l]).test(s.finalString)){if(this.seenRegexes[l])return this;this.seenRegexes[l]=!0}l--}for(s.meta=s.meta||{},l=this.appenders.length-1;l>=0;)this.appenders[l].log(e<=1e3?"trace":e<=2e3?"debug":e<=3e3?"info":e<=4e3?"warn":e<=5e3?"error":"fatal",s.msg,s.meta,function(){},e,s.finalString,this.loggerName),l--}return this},e.prototype.trace=function(e){return this.log(l(),e)},e.prototype.debug=function(e){return this.log(u(),e)},e.prototype.info=function(e){return this.log(d(),e)},e.prototype.warn=function(e){return this.log(h(),e)},e.prototype.error=function(e){return this.log(p(),e)},e.prototype.fatal=function(e){return this.log(f(),e)},e.prototype.fatalException=function(e,t){return this.log(f(),e,t)},e}();e.Logger=w,e.createAjaxAppender=function(e){return new S(e)},e.createConsoleAppender=function(e){return new _(e)},s=new _(""),e.__=new e.Logger(""),e.__.setOptions({level:e.getDebugLevel(),appenders:[s]})})(o||(o={})),t.__esModule=!0,t.JL=o,"function"==typeof r&&r.amd&&r("jsnlog",[],function(){return o}),"function"==typeof __jsnlog_configure&&__jsnlog_configure(o)},48901:e=>{"use strict";function t(){this._types=Object.create(null),this._extensions=Object.create(null);for(let e=0;e<arguments.length;e++)this.define(arguments[e]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}t.prototype.define=function(e,t){for(let n in e){let r=e[n].map(function(e){return e.toLowerCase()});n=n.toLowerCase();for(let e=0;e<r.length;e++){let i=r[e];if("*"!==i[0]){if(!t&&i in this._types)throw Error('Attempt to change mapping for "'+i+'" extension from "'+this._types[i]+'" to "'+n+'". Pass `force=true` to allow this, otherwise remove "'+i+'" from the list of extensions for "'+n+'".');this._types[i]=n}}if(t||!this._extensions[n]){let e=r[0];this._extensions[n]="*"!==e[0]?e:e.substr(1)}}},t.prototype.getType=function(e){let t=(e=String(e)).replace(/^.*[/\\]/,"").toLowerCase(),n=t.replace(/^.*\./,"").toLowerCase(),r=t.length<e.length;return(n.length<t.length-1||!r)&&this._types[n]||null},t.prototype.getExtension=function(e){return(e=/^\s*([^;\s]*)/.test(e)&&RegExp.$1)&&this._extensions[e.toLowerCase()]||null},e.exports=t},3127:(e,t,n)=>{"use strict";let r=n(48901);e.exports=new r(n(98912))},98912:e=>{e.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}},37412:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{unstable_getImgProps:function(){return c},default:function(){return l}});let r=n(39694),i=n(83855),o=n(70837),s=n(31900),a=r._(n(74931)),c=e=>{(0,o.warnOnce)("Warning: unstable_getImgProps() is experimental and may change or be removed at any time. Use at your own risk.");let{props:t}=(0,i.getImgProps)(e,{defaultLoader:a.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,n]of Object.entries(t))void 0===n&&delete t[e];return{props:t}},l=s.Image},41223:(e,t,n)=>{e.exports=n(37412)},25817:e=>{var t=["stun:","turn:"];e.exports=function(e){var n,r,i=(e||{}).url||e,o={};return("string"==typeof i||i instanceof String)&&(i=i.trim(),n=t[t.indexOf(i.slice(0,5))])?(r=(i=i.slice(5)).split("@"),o.username=e.username,o.credential=e.credential,r.length>1&&(i=r[1],r=r[0].split(":"),o.username=r[0],o.credential=(e||{}).credential||r[1]||""),o.url=n+i,o.urls=[o.url],o):e}},97134:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalRecorderState=void 0,function(e){e.READY="READY",e.RECORDING="RECORDING",e.PAUSED="PAUSED",e.FINISHED="FINISHED"}(t.LocalRecorderState||(t.LocalRecorderState={}))},35019:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduError=t.OpenViduErrorName=void 0,function(e){e.BROWSER_NOT_SUPPORTED="BROWSER_NOT_SUPPORTED",e.DEVICE_ACCESS_DENIED="DEVICE_ACCESS_DENIED",e.DEVICE_ALREADY_IN_USE="DEVICE_ALREADY_IN_USE",e.SCREEN_CAPTURE_DENIED="SCREEN_CAPTURE_DENIED",e.SCREEN_SHARING_NOT_SUPPORTED="SCREEN_SHARING_NOT_SUPPORTED",e.SCREEN_EXTENSION_NOT_INSTALLED="SCREEN_EXTENSION_NOT_INSTALLED",e.SCREEN_EXTENSION_DISABLED="SCREEN_EXTENSION_DISABLED",e.INPUT_VIDEO_DEVICE_NOT_FOUND="INPUT_VIDEO_DEVICE_NOT_FOUND",e.INPUT_AUDIO_DEVICE_NOT_FOUND="INPUT_AUDIO_DEVICE_NOT_FOUND",e.INPUT_AUDIO_DEVICE_GENERIC_ERROR="INPUT_AUDIO_DEVICE_GENERIC_ERROR",e.NO_INPUT_SOURCE_SET="NO_INPUT_SOURCE_SET",e.PUBLISHER_PROPERTIES_ERROR="PUBLISHER_PROPERTIES_ERROR",e.OPENVIDU_PERMISSION_DENIED="OPENVIDU_PERMISSION_DENIED",e.OPENVIDU_NOT_CONNECTED="OPENVIDU_NOT_CONNECTED",e.VIRTUAL_BACKGROUND_ERROR="VIRTUAL_BACKGROUND_ERROR",e.GENERIC_ERROR="GENERIC_ERROR"}(t.OpenViduErrorName||(t.OpenViduErrorName={})),t.OpenViduError=function(e,t){this.name=e,this.message=t}},98752:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeOfVideo=void 0,function(e){e.CAMERA="CAMERA",e.SCREEN="SCREEN",e.CUSTOM="CUSTOM",e.IPCAM="IPCAM"}(t.TypeOfVideo||(t.TypeOfVideo={}))},64874:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VideoInsertMode=void 0,function(e){e.AFTER="AFTER",e.APPEND="APPEND",e.BEFORE="BEFORE",e.PREPEND="PREPEND",e.REPLACE="REPLACE"}(t.VideoInsertMode||(t.VideoInsertMode={}))},42345:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionEvent=void 0;var o=function(e){function t(t,n,r,i,o){var s=e.call(this,t,n,r)||this;return s.connection=i,s.reason=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(57434).Event);t.ConnectionEvent=o},51493:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionPropertyChangedEvent=void 0;var o=function(e){function t(t,n,r,i,o){var s=e.call(this,!1,t,"connectionPropertyChanged")||this;return s.connection=n,s.changedProperty=r,s.newValue=i,s.oldValue=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(57434).Event);t.ConnectionPropertyChangedEvent=o},57434:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var n=function(){function e(e,t,n){this.hasBeenPrevented=!1,this.cancelable=e,this.target=t,this.type=n}return e.prototype.isDefaultPrevented=function(){return this.hasBeenPrevented},e.prototype.preventDefault=function(){this.callDefaultBehavior=function(){},this.hasBeenPrevented=!0},e}();t.Event=n},69532:function(e,t,n){"use strict";var r,i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ExceptionEvent=t.ExceptionEventName=void 0;var s=n(57434);(r=t.ExceptionEventName||(t.ExceptionEventName={})).ICE_CANDIDATE_ERROR="ICE_CANDIDATE_ERROR",r.ICE_CONNECTION_FAILED="ICE_CONNECTION_FAILED",r.ICE_CONNECTION_DISCONNECTED="ICE_CONNECTION_DISCONNECTED",r.NO_STREAM_PLAYING_EVENT="NO_STREAM_PLAYING_EVENT",r.SPEECH_TO_TEXT_DISCONNECTED="SPEECH_TO_TEXT_DISCONNECTED";var a=function(e){function t(t,n,r,i,o){var s=e.call(this,!1,t,"exception")||this;return s.name=n,s.origin=r,s.message=i,s.data=o,s}return o(t,e),t.prototype.callDefaultBehavior=function(){},t}(s.Event);t.ExceptionEvent=a},65787:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.FilterEvent=void 0;var o=function(e){function t(t,n,r){var i=e.call(this,!1,t,n)||this;return i.data=r,i}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(57434).Event);t.FilterEvent=o},63337:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkQualityLevelChangedEvent=void 0;var o=function(e){function t(t,n,r,i){var o=e.call(this,!1,t,"networkQualityLevelChanged")||this;return o.newValue=n,o.oldValue=r,o.connection=i,o}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(57434).Event);t.NetworkQualityLevelChangedEvent=o},58407:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PublisherSpeakingEvent=void 0;var o=function(e){function t(t,n,r,i){var o=e.call(this,!1,t,n)||this;return o.type=n,o.connection=r,o.streamId=i,o}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(57434).Event);t.PublisherSpeakingEvent=o},50588:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.RecordingEvent=void 0;var o=function(e){function t(t,n,r,i,o){var s=e.call(this,!1,t,n)||this;return s.id=r,i!==r&&(s.name=i),s.reason=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(57434).Event);t.RecordingEvent=o},88133:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SessionDisconnectedEvent=void 0;var o=n(57434),s=n(77654).OpenViduLogger.getInstance(),a=function(e){function t(t,n){var r=e.call(this,!0,t,"sessionDisconnected")||this;return r.reason=n,r}return i(t,e),t.prototype.callDefaultBehavior=function(){s.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'");var e=this.target;e.remoteConnections.forEach(function(t){var n,r,i,o,s,a,c,l,u=t.connectionId;if(null===(n=e.remoteConnections.get(u))||void 0===n?void 0:n.stream){null===(r=e.remoteConnections.get(u))||void 0===r||r.stream.disposeWebRtcPeer(),null===(i=e.remoteConnections.get(u))||void 0===i||i.stream.disposeMediaStream(),(null===(o=e.remoteConnections.get(u))||void 0===o?void 0:o.stream.streamManager)&&(null===(s=e.remoteConnections.get(u))||void 0===s||s.stream.streamManager.removeAllVideos());var d=null===(c=null===(a=e.remoteConnections.get(u))||void 0===a?void 0:a.stream)||void 0===c?void 0:c.streamId;d&&e.remoteStreamsCreated.delete(d),null===(l=e.remoteConnections.get(u))||void 0===l||l.dispose()}e.remoteConnections.delete(u)})},t}(o.Event);t.SessionDisconnectedEvent=a},77547:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SignalEvent=void 0;var o=function(e){function t(t,n,r,i){var o=e.call(this,!1,t,"signal")||this;return n&&(o.type="signal:"+n),o.data=r,o.from=i,o}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(57434).Event);t.SignalEvent=o},80018:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SpeechToTextEvent=void 0;var o=function(e){function t(t,n,r,i,o,s){var a=e.call(this,!1,t,"speechToTextMessage")||this;return a.connection=n,a.text=r,a.reason=i,a.raw=o,a.lang=s,a}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(57434).Event);t.SpeechToTextEvent=o},79869:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.StreamEvent=void 0;var o=n(57434),s=n(26245),a=n(69767),c=n(77654).OpenViduLogger.getInstance(),l=function(e){function t(t,n,r,i,o){var s=e.call(this,t,n,r)||this;return s.stream=i,s.reason=o,s}return i(t,e),t.prototype.callDefaultBehavior=function(){if("streamDestroyed"===this.type){if(this.target instanceof a.Session)c.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'"),this.stream.disposeWebRtcPeer();else if(this.target instanceof s.Publisher){c.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Publisher'"),clearInterval(this.target.screenShareResizeInterval),this.stream.isLocalStreamReadyToPublish=!1;for(var e=this.target.openvidu.publishers,t=0;t<e.length;t++)if(e[t]===this.target){e.splice(t,1);break}}this.stream.disposeMediaStream(),this.stream.streamManager&&this.stream.streamManager.removeAllVideos(),this.stream.session.remoteStreamsCreated.delete(this.stream.streamId);var n=this.stream.session.remoteConnections.get(this.stream.connection.connectionId);if(n&&n.remoteOptions)for(var r=n.remoteOptions.streams,t=r.length-1;t>=0;--t)r[t].id===this.stream.streamId&&r.splice(t,1)}},t}(o.Event);t.StreamEvent=l},92967:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.StreamManagerEvent=void 0;var o=function(e){function t(t,n,r){var i=e.call(this,!1,t,n)||this;return i.value=r,i}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(57434).Event);t.StreamManagerEvent=o},19988:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.StreamPropertyChangedEvent=void 0;var o=function(e){function t(t,n,r,i,o,s){var a=e.call(this,!1,t,"streamPropertyChanged")||this;return a.stream=n,a.changedProperty=r,a.newValue=i,a.oldValue=o,a.reason=s,a}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(57434).Event);t.StreamPropertyChangedEvent=o},94648:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},72473:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.VideoElementEvent=void 0;var o=function(e){function t(t,n,r){var i=e.call(this,!1,n,r)||this;return i.element=t,i}return i(t,e),t.prototype.callDefaultBehavior=function(){},t}(n(57434).Event);t.VideoElementEvent=o},8489:e=>{function t(){var e={};this.forEach=function(t){for(var n in e){var r=e[n];for(var i in r)t(r[i])}},this.get=function(t,n){var r=e[n];if(void 0!=r)return r[t]},this.remove=function(t,n){var r=e[n];if(void 0!=r){for(var i in delete r[t],r)return!1;delete e[n]}},this.set=function(t,n,r){if(void 0==t)return this.remove(n,r);var i=e[r];void 0==i&&(e[r]=i={}),i[n]=t}}t.prototype.pop=function(e,t){var n=this.get(e,t);if(void 0!=n)return this.remove(e,t),n},e.exports=t},29757:(e,t,n)=>{var r=n(63162);t.JsonRpcClient=r},63162:(e,t,n)=>{var r=n(44749),i=n(97676),o=n(77654).OpenViduLogger;Date.now=Date.now||function(){return+new Date};var s="RECONNECTING",a="CONNECTED",c="DISCONNECTED",l=o.getInstance();e.exports=function(e){var t,n=this,o=e.ws,u=-1,d=0,h=!0,p=!1,f=c,m=o.onreconnecting,v=o.onreconnected,g=o.onconnected,b=o.onerror;e.rpc.pull=function(e,t){t.reply(null,"push")},o.onreconnecting=function(){if(l.debug("--------- ONRECONNECTING -----------"),f===s){l.error("Websocket already in RECONNECTING state when receiving a new ONRECONNECTING message. Ignoring it");return}O(),f=s,m&&m()},o.onreconnected=function(){if(l.debug("--------- ONRECONNECTED -----------"),f===a){l.error("Websocket already in CONNECTED state when receiving a new ONRECONNECTED message. Ignoring it");return}f=a,_(),v&&v()},o.onconnected=function(){if(l.debug("--------- ONCONNECTED -----------"),f===a){l.error("Websocket already in CONNECTED state when receiving a new ONCONNECTED message. Ignoring it");return}f=a,h=!0,x(),g&&g()},o.onerror=function(e){l.debug("--------- ONERROR -----------"),f=c,O(),b&&b(e)};var E=new i(o);l.debug("Connecting websocket to URI: "+o.uri);var y={request_timeout:e.rpc.requestTimeout,ping_request_timeout:e.rpc.heartbeatRequestTimeout},S=new r(r.packers.JsonRPC,y,E,function(t){l.debug("Received request: "+JSON.stringify(t));try{var n=e.rpc[t.method];void 0===n?l.error("Method "+t.method+" not registered in client"):n(t.params,t)}catch(e){l.error("Exception processing request: "+JSON.stringify(t)),l.error(e)}});function _(){l.debug("notReconnectIfNumLessThan = "+d+" (old="+u+")"),u=d}function w(){if(h){var t,r=null;(0==d||d==u)&&(r={interval:e.heartbeat||5e3}),d++,n.send("ping",r,(t=d,function(e,n){e&&(l.debug("Error in ping request #"+t+" ("+e.message+")"),t>u&&(h=!1,_(),l.debug("Server did not respond to ping message #"+t+". Reconnecting... "),E.reconnectWs()))}))}else l.debug("Trying to send ping, but ping is not enabled")}function x(){p||(l.debug("Starting ping (if configured)"),p=!0,void 0!=e.heartbeat&&(t=setInterval(w,e.heartbeat),w()))}function O(){clearInterval(t),p=!1,h=!1,d=-1,S.cancel()}this.send=function(e,t,n){var r=Date.now();S.encode(e,t,function(i,o){if(i){try{l.error("ERROR:"+i.message+" in Request: method:"+e+" params:"+JSON.stringify(t)+" request:"+i.request),i.data&&l.error("ERROR DATA:"+JSON.stringify(i.data))}catch(e){}i.requestTime=r}n&&(void 0!=o&&"pong"!==o.value&&l.debug("Response: "+JSON.stringify(o)),n(i,o))})},this.close=function(e,n){l.debug("Closing  with code: "+e+" because: "+n),void 0!=t&&(l.debug("Clearing ping interval"),clearInterval(t)),p=!1,h=!1,E.close(e,n)},this.reconnect=function(){E.reconnectWs()},this.resetPing=function(){h=!0,d=0,x()},this.getReadyState=function(){return E.getReadyState()}}},20801:(e,t,n)=>{var r=n(97676);t.WebSocketWithReconnection=r},97676:(e,t,n)=>{"use strict";var r=n(77654).OpenViduLogger.getInstance();e.exports=function(e){var t,n=!1,i=e.uri,o=!1,s=new WebSocket(i);s.onopen=function(){r.debug("WebSocket connected to "+i),e.onconnected&&e.onconnected()},s.onerror=function(t){r.error("Could not connect to "+i+" (invoking onerror if defined)",t),e.onerror&&e.onerror(t)};var a=function(){3===s.readyState?n?r.debug("Connection closed by user"):e.ismasternodecrashed()?r.error("Master Node has crashed. Stopping reconnection process"):(r.debug("Connection closed unexpectedly. Reconnecting..."),c(2e3,1)):r.debug("Close callback from previous websocket. Ignoring it")};function c(n,l){var u,d;if(r.debug("reconnect (attempt #"+l+", max="+n+")"),1===l){if(o){r.warn("Trying to reconnect when already reconnecting... Ignoring this reconnection.");return}o=!0,e.onreconnecting&&e.onreconnecting()}r.debug("Reconnection attempt #"+l),s.close(4104,"Connection closed for reconnection"),u=i,(d=new URLSearchParams(new URL(u).search)).has("reconnect")||(u=Array.from(d).length>0?u+"&reconnect=true":u+"?reconnect=true"),i=u,(s=new WebSocket(i)).onopen=function(){r.debug("Reconnected to "+i+" after "+l+" attempts..."),o=!1,t(),e.onreconnected&&e.onreconnected(),s.onclose=a},s.onerror=function(t){r.warn("Reconnection error: ",t),l===n?e.ondisconnect&&e.ondisconnect():setTimeout(function(){c(n,l+1)},3e3)}}s.onclose=a,this.close=function(e,t){n=!0,s.close(e,t)},this.reconnectWs=function(){r.debug("reconnectWs"),c(2e3,1)},this.send=function(e){s.send(e)},this.addEventListener=function(e,n){(t=function(){s.addEventListener(e,n)})()},this.getReadyState=function(){return s.readyState}}},44749:(e,t,n)=>{var r=!1;if(Object.defineProperty)try{Object.defineProperty({},"x",{})}catch(e){r=!0}Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i});var i=n(82361).EventEmitter,o=n(58555),s=n(82189),a=n(8489);function c(e){if(e){if(e instanceof Function)return{send:e};if(e.send instanceof Function)return e;if(e.postMessage instanceof Function)return e.send=e.postMessage,e;if(e.write instanceof Function)return e.send=e.write,e;if(void 0===e.onmessage&&!(e.pause instanceof Function))throw SyntaxError("Transport is not a function nor a valid object")}}function l(e,t){r?(this.method=e,this.params=t):(Object.defineProperty(this,"method",{value:e,enumerable:!0}),Object.defineProperty(this,"params",{value:t,enumerable:!0}))}function u(e,t,n,s){var u=this;if(!e)throw SyntaxError("Packer is not defined");if(!e.pack||!e.unpack)throw SyntaxError("Packer is invalid");var d=function(e){if(!e)return{};for(var t in e){var n=e[t];"string"==typeof n&&(e[t]={response:n})}return e}(e.responseMethods);if(t instanceof Function){if(void 0!=n)throw SyntaxError("There can't be parameters after onRequest");s=t,n=void 0,t=void 0}if(t&&t.send instanceof Function){if(n&&!(n instanceof Function))throw SyntaxError("Only a function can be after transport");s=n,n=t,t=void 0}if(n instanceof Function){if(void 0!=s)throw SyntaxError("There can't be parameters after onRequest");s=n,n=void 0}if(n&&n.send instanceof Function&&s&&!(s instanceof Function))throw SyntaxError("Only a function can be after transport");t=t||{},i.call(this),s&&this.on("request",s),r?this.peerID=t.peerID:Object.defineProperty(this,"peerID",{value:t.peerID});var h=t.max_retries||0;function p(e){u.decode(e.data||e)}this.getTransport=function(){return n},this.setTransport=function(e){n&&(n.removeEventListener?n.removeEventListener("message",p):n.removeListener&&n.removeListener("data",p)),e&&(e.addEventListener?e.addEventListener("message",p):e.addListener&&e.addListener("data",p)),n=c(e)},r||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)}),this.setTransport(n);var f=t.request_timeout||5e3,m=t.ping_request_timeout||f,v=t.response_timeout||5e3,g=t.duplicates_timeout||5e3,b=0,E=new a,y=new a,S=new a,_={};function w(e,t){var n=setTimeout(function(){S.remove(e,t)},g);S.set(n,e,t)}function x(t,n,i,o,s){l.call(this,t,n),this.getTransport=function(){return s},this.setTransport=function(e){s=c(e)},r||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)});var a=y.get(i,o);s||u.getTransport()||(r?this.duplicated=!!a:Object.defineProperty(this,"duplicated",{value:!!a}));var h=d[t];this.pack=e.pack.bind(e,this,i),this.reply=function(t,n,r){var s,l;if(t instanceof Function||t&&t.send instanceof Function){if(void 0!=n)throw SyntaxError("There can't be parameters after callback");r=t,n=null,t=void 0}else if(n instanceof Function||n&&n.send instanceof Function){if(void 0!=r)throw SyntaxError("There can't be parameters after callback");r=n,n=null}return(r=c(r),a&&clearTimeout(a.timeout),void 0!=o&&(t&&(t.dest=o),n&&(n.dest=o)),t||void 0!=n)?(void 0!=u.peerID&&(t?t.from=u.peerID:n.from=u.peerID),s=h?void 0==h.error&&t?{error:t}:{method:t?h.error:h.response,params:t||n}:{error:t,result:n},s=e.pack(s,i)):s=a?a.message:e.pack({result:null},i),(l={message:s,timeout:setTimeout(function(){y.remove(i,o)},v)},y.set(l,i,o),r=r||this.getTransport()||u.getTransport())?r.send(s):s}}function O(e){var t=_[e];if(t){delete _[e];var n=E.pop(t.id,t.dest);n&&(clearTimeout(n.timeout),w(t.id,t.dest))}}o(x,l),this.cancel=function(e){if(e)return O(e);for(var e in _)O(e)},this.close=function(){var e=this.getTransport();e&&e.close&&e.close(4003,"Cancel request"),this.cancel(),S.forEach(clearTimeout),y.forEach(function(e){clearTimeout(e.timeout)})},this.encode=function(t,n,r,i,o){if(n instanceof Function){if(void 0!=r)throw SyntaxError("There can't be parameters after callback");o=n,i=void 0,r=void 0,n=void 0}else if(r instanceof Function){if(void 0!=i)throw SyntaxError("There can't be parameters after callback");o=r,i=void 0,r=void 0}else if(i instanceof Function){if(void 0!=o)throw SyntaxError("There can't be parameters after callback");o=i,i=void 0}void 0!=u.peerID&&((n=n||{}).from=u.peerID),void 0!=r&&((n=n||{}).dest=r);var s={method:t,params:n};if(o){var a=b++,l=0;function p(e,t){u.cancel(s),o(e,t)}var v={message:s=e.pack(s,a),callback:p,responseMethods:d[t]||{}},g=c(i);function y(e){var n="ping"===t?m:f;return(v.timeout=setTimeout(x,n*Math.pow(2,l++)),_[s]={id:a,dest:r},E.set(v,a,r),e=e||g||u.getTransport())?e.send(s):s}function w(e){return e=c(e),console.warn(l+" retry for request message:",s),clearTimeout(S.pop(a,r)),y(e)}function x(){if(l<h)return w(i);var e=Error("Request has timed out");e.request=s,e.retry=w,p(e)}return y(i)}return(s=e.pack(s),i=i||this.getTransport())?i.send(s):s},this.decode=function(t,n){if(!t)throw TypeError("Message is not defined");try{t=e.unpack(t)}catch(e){return console.debug(e,t)}var r=t.id,i=t.ack,o=t.method,s=t.params||{},a=s.from,d=s.dest;if(void 0==u.peerID||a!=u.peerID){if(void 0==r&&void 0==i){var h=new l(o,s);if(u.emit("request",h))return;return h}if(o){if(void 0==d||d==u.peerID){var p=E.get(i,a);if(p){var f=p.responseMethods;return o==f.error?_(p,s):o==f.response?_(p,null,s):b()}var m=S.get(i,a);if(m)return O(m)}return b()}var v=t.error,g=t.result;if((!v||!v.dest||v.dest==u.peerID)&&(!g||!g.dest||g.dest==u.peerID)){var p=E.get(i,a);if(!p){var m=S.get(i,a);return m?O(m):console.warn("No callback was defined for this message",t)}_(p,v,g)}}function b(){if(n=c(n)||u.getTransport()){var e=y.get(r,a);if(e)return n.send(e.message)}var t=new x(o,s,void 0!=r?r:i,a,n);if(!u.emit("request",t))return t}function _(e,t,n){e.callback(t,n)}function O(e){console.warn("Response already processed",t),clearTimeout(e),w(i,a)}}}o(u,i),u.RpcNotification=l,e.exports=u;var d=n(29757),h=n(20801);u.clients=d,u.clients.transports=h,u.packers=s},70172:(e,t)=>{t.pack=function(e,t){var n={jsonrpc:"2.0"};if(e.method)n.method=e.method,e.params&&(n.params=e.params),void 0!=t&&(n.id=t);else if(void 0!=t){if(e.error){if(void 0!==e.result)throw TypeError("Both result and error are defined");n.error=e.error}else if(void 0!==e.result)n.result=e.result;else throw TypeError("No result or error is defined");n.id=t}return JSON.stringify(n)},t.unpack=function(e){var t=e;("string"==typeof e||e instanceof String)&&(t=JSON.parse(e));var n=t.jsonrpc;if("2.0"!==n)throw TypeError("Invalid JsonRPC version '"+n+"': "+e);if(void 0==t.method){if(void 0==t.id)throw TypeError("Invalid message: "+e);var r=void 0!==t.result,i=void 0!==t.error;if(r&&i)throw TypeError("Both result and error are defined: "+e);if(!r&&!i)throw TypeError("No result or error is defined: "+e);t.ack=t.id,delete t.id}return t}},67964:(e,t)=>{t.pack=function(e){throw TypeError("Not yet implemented")},t.unpack=function(e){throw TypeError("Not yet implemented")}},82189:(e,t,n)=>{var r=n(70172),i=n(67964);t.JsonRPC=r,t.XmlRPC=i},74578:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleLogger=void 0,t.ConsoleLogger=function(e){this.logger=e,this.log=e.log,this.info=e.info,this.debug=e.debug,this.warn=e.warn,this.error=e.error}},77654:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduLogger=void 0;var r=n(294),i=n(74578),o=n(36424),s=function(){function e(){this.JSNLOG_URL="/openvidu/elk/openvidu-browser-logs",this.MAX_JSNLOG_BATCH_LOG_MESSAGES=100,this.MAX_MSECONDS_BATCH_MESSAGES=5e3,this.MAX_LENGTH_STRING_JSON=1e3,this.defaultConsoleLogger=new i.ConsoleLogger(globalThis.console),this.isProdMode=!1,this.isJSNLogSetup=!1}return e.configureJSNLog=function(e,t){var n=this;try{if(globalThis.LOG_JSNLOG_RESULTS||this.instance&&e.isAtLeastPro&&this.instance.isOpenViduBrowserLogsDebugActive(e)&&this.instance.canConfigureJSNLog(e,this.instance)){e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug_app&&this.instance.replaceWindowConsole(),this.instance.isJSNLogSetup=!1,this.instance.info("Configuring JSNLogs.");var i=e.finalUserId,s=e.session.sessionId;this.instance.currentAppender=r.JL.createAjaxAppender("appender-".concat(i,"-").concat(s)),this.instance.currentAppender.setOptions({beforeSend:function(e){var r=e.onreadystatechange;e.onreadystatechange=function(){n.isInvalidResponse(e)&&(Object.defineProperty(e,"readyState",{value:4}),Object.defineProperty(e,"status",{value:200}),n.instance.disableLogger()),r()},e.setRequestHeader("Authorization","Basic "+btoa("".concat(i,"%/%").concat(s)+":"+t)),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.setRequestHeader("OV-Final-User-Id",i),e.setRequestHeader("OV-Session-Id",s),e.setRequestHeader("OV-Token",t)},maxBatchSize:1e3,batchSize:this.instance.MAX_JSNLOG_BATCH_LOG_MESSAGES,batchTimeout:this.instance.MAX_MSECONDS_BATCH_MESSAGES}),r.JL.setOptions({defaultAjaxUrl:e.httpUri+this.instance.JSNLOG_URL,serialize:function(e){var t,r=JSON.stringify(e,(t=new WeakSet,function(e,n){if("object"==typeof n&&null!=n){if(t.has(n)||globalThis.HTMLElement&&n instanceof HTMLElement)return;t.add(n)}return n}));return r.length>n.instance.MAX_LENGTH_STRING_JSON&&(r="".concat(r.substring(0,n.instance.MAX_LENGTH_STRING_JSON),"...")),globalThis.LOG_JSNLOG_RESULTS&&console.log(r),r},enabled:!0}),(0,r.JL)().setOptions({appenders:[this.instance.currentAppender]}),this.instance.isJSNLogSetup=!0,this.instance.loggingSessionId=s,this.instance.info("JSNLog configured.")}}catch(e){console.error("Error configuring JSNLog: "),console.error(e),this.instance.disableLogger()}},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.isInvalidResponse=function(e){return 401==e.status||403==e.status||404==e.status||0==e.status},e.prototype.canConfigureJSNLog=function(e,t){return e.session.sessionId!=t.loggingSessionId},e.prototype.isOpenViduBrowserLogsDebugActive=function(e){return e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug||e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug_app},e.prototype.getConsoleWithJSNLog=function(){var e;return e=this,{log:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.log.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().info(arguments)},info:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.info.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().info(arguments)},debug:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.debug.apply(e.defaultConsoleLogger.logger,arguments)},warn:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.warn.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().warn(arguments)},error:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.error.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().error(arguments)}}},e.prototype.replaceWindowConsole=function(){globalThis.console=this.defaultConsoleLogger.logger,globalThis.console.log=this.getConsoleWithJSNLog().log,globalThis.console.info=this.getConsoleWithJSNLog().info,globalThis.console.debug=this.getConsoleWithJSNLog().debug,globalThis.console.warn=this.getConsoleWithJSNLog().warn,globalThis.console.error=this.getConsoleWithJSNLog().error},e.prototype.disableLogger=function(){r.JL.setOptions({enabled:!1}),this.isJSNLogSetup=!1,this.loggingSessionId=void 0,this.currentAppender=void 0,globalThis.console=this.defaultConsoleLogger.logger,globalThis.console.log=this.defaultConsoleLogger.log,globalThis.console.info=this.defaultConsoleLogger.info,globalThis.console.debug=this.defaultConsoleLogger.debug,globalThis.console.warn=this.defaultConsoleLogger.warn,globalThis.console.error=this.defaultConsoleLogger.error},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.log.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().info(arguments)},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.debug.apply(this.defaultConsoleLogger.logger,arguments)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.info.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().info(arguments)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.defaultConsoleLogger.warn.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().warn(arguments)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.defaultConsoleLogger.error.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().error(arguments)},e.prototype.flush=function(){this.isJSNLogSetup&&null!=this.currentAppender&&this.currentAppender.sendBatch()},e.prototype.enableProdMode=function(){this.isProdMode=!0},e}();t.OpenViduLogger=s},36424:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduLoggerConfiguration=void 0,function(e){e.disabled="disabled",e.debug="debug",e.debug_app="debug_app"}(t.OpenViduLoggerConfiguration||(t.OpenViduLoggerConfiguration={}))},20741:(e,t)=>{var n;function r(e,t,n){var r={audio:!1,video:{mandatory:{chromeMediaSource:e?"screen":"desktop",maxWidth:globalThis.screen.width>1920?globalThis.screen.width:1920,maxHeight:globalThis.screen.height>1080?globalThis.screen.height:1080},optional:[]}};return n&&(r.audio={mandatory:{chromeMediaSource:e?"screen":"desktop"},optional:[]}),t&&(r.video.mandatory.chromeMediaSourceId=t,r.audio&&r.audio.mandatory&&(r.audio.mandatory.chromeMediaSourceId=t)),r}function i(e){if(!n){o(function(){i(e)});return}if(!n.isLoaded){setTimeout(function(){i(e)},100);return}e?e.forEach?n.contentWindow.postMessage({captureCustomSourceId:e},"*"):n.contentWindow.postMessage({captureSourceIdWithAudio:!0},"*"):n.contentWindow.postMessage({captureSourceId:!0},"*")}function o(e){if(n){e();return}(n=document.createElement("iframe")).onload=function(){n.isLoaded=!0,e()},n.src="https://openvidu.github.io/openvidu-screen-sharing-chrome-extension/",n.style.display="none",(document.body||document.documentElement).appendChild(n)}function s(){if(!n){o(s);return}if(!n.isLoaded){setTimeout(s,100);return}n.contentWindow.postMessage({getChromeExtensionStatus:!0},"*")}globalThis.getScreenId=function(e,t,n){if(-1!==navigator.userAgent.indexOf("Edge")&&(navigator.msSaveOrOpenBlob||navigator.msSaveBlob)){t({video:!0});return}if(navigator.mozGetUserMedia){t(null,"firefox",{video:{mozMediaSource:e,mediaSource:e}});return}globalThis.addEventListener("message",function e(n){n.data&&(n.data.chromeMediaSourceId&&("PermissionDeniedError"===n.data.chromeMediaSourceId?t("permission-denied"):t(null,n.data.chromeMediaSourceId,r(null,n.data.chromeMediaSourceId,n.data.canRequestAudioTrack)),globalThis.removeEventListener("message",e)),n.data.chromeExtensionStatus&&(t(n.data.chromeExtensionStatus,null,r(n.data.chromeExtensionStatus)),globalThis.removeEventListener("message",e)))}),n?setTimeout(function(){i(n)},100):setTimeout(i,100)},globalThis.getScreenConstraints=function(e){o(function(){getScreenId(function(t,n,r){r||(r={video:!0}),e(t,r.video)})})},globalThis.getChromeExtensionStatus=function(e){if(navigator.mozGetUserMedia){e("installed-enabled");return}globalThis.addEventListener("message",function t(n){n.data&&n.data.chromeExtensionStatus&&(e(n.data.chromeExtensionStatus),globalThis.removeEventListener("message",t))}),setTimeout(s,100)},t.getScreenId=globalThis.getScreenId},29969:(e,t)=>{var n,r,i="screen";function o(e){if(!e)throw'"callback" parameter is mandatory.';if(n)return e(n);window.postMessage("get-sourceId","*")}function s(e,t){if(n="",r)return e(null,{mozMediaSource:"window",mediaSource:"window"});var s={mandatory:{chromeMediaSource:i,maxWidth:screen.width>1920?screen.width:1920,maxHeight:screen.height>1080?screen.height:1080},optional:[]};if("desktop"==i&&!n){t?function(e){if(!e)throw'"callback" parameter is mandatory.';if(n)return e(n);window.postMessage("audio-plus-tab","*")}(function(t,n){s.mandatory.chromeMediaSourceId=t,n&&(s.canRequestAudioTrack=!0),e("PermissionDeniedError"==t?t:null,s)}):o(function(t){s.mandatory.chromeMediaSourceId=t,e("PermissionDeniedError"==t?t:null,s)});return}"desktop"==i&&(s.mandatory.chromeMediaSourceId=n),e(null,s)}t.getScreenConstraints=s,t.getScreenConstraintsWithAudio=function(e){s(e,!0)},t.isChromeExtensionAvailable=function(e){if(e){if("desktop"==i)return e(!0);window.postMessage("are-you-there","*"),setTimeout(function(){"screen"==i?e(!1):e(!0)},2e3)}},t.getChromeExtensionStatus=function(e,t){if(r)return t("not-chrome");2!=arguments.length&&(t=e,e="lfcgfepafnobdloecchnfaclibenjold");var n=document.createElement("img");n.src="chrome-extension://"+e+"/icon.png",n.onload=function(){i="screen",window.postMessage("are-you-there","*"),setTimeout(function(){"screen"==i?t("installed-disabled"):t("installed-enabled")},2e3)},n.onerror=function(){t("not-installed")}},t.getSourceId=o},34957:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformUtils=void 0;var r=n(80041),i=function(){function e(){}return e.getInstance=function(){return this.instance||(this.instance=new e),e.instance},e.prototype.isChromeBrowser=function(){return"Chrome"===r.name},e.prototype.isSafariBrowser=function(){return"Safari"===r.name},e.prototype.isChromeMobileBrowser=function(){return"Chrome Mobile"===r.name},e.prototype.isFirefoxBrowser=function(){return"Firefox"===r.name},e.prototype.isFirefoxMobileBrowser=function(){return"Firefox Mobile"===r.name||"Firefox for iOS"===r.name},e.prototype.isOperaBrowser=function(){return"Opera"===r.name},e.prototype.isOperaMobileBrowser=function(){return"Opera Mobile"===r.name},e.prototype.isEdgeBrowser=function(){var e=(null==r?void 0:r.version)?parseFloat(r.version):-1;return"Microsoft Edge"===r.name&&e>=80},e.prototype.isEdgeMobileBrowser=function(){var e,t,n=(null==r?void 0:r.version)?parseFloat(r.version):-1;return"Microsoft Edge"===r.name&&((null===(e=r.os)||void 0===e?void 0:e.family)==="Android"||(null===(t=r.os)||void 0===t?void 0:t.family)==="iOS")&&n>45},e.prototype.isAndroidBrowser=function(){return"Android Browser"===r.name},e.prototype.isElectron=function(){return"Electron"===r.name},e.prototype.isNodeJs=function(){return"Node.js"===r.name},e.prototype.isSamsungBrowser=function(){return"Samsung Internet Mobile"===r.name||"Samsung Internet"===r.name},e.prototype.isMotorolaEdgeDevice=function(){var e;return(null===(e=r.product)||void 0===e?void 0:e.toLowerCase().includes("motorola edge"))||!1},e.prototype.isIPhoneOrIPad=function(){var e=r.ua?r.ua:navigator.userAgent,t="ontouchend"in document,n=/\b(\w*Macintosh\w*)\b/.test(e)&&t,i=/\b(\w*iPhone\w*)\b/.test(e)&&/\b(\w*Mobile\w*)\b/.test(e)&&t;return n||i},e.prototype.isIOSWithSafari=function(){var e=r.ua?r.ua:navigator.userAgent;return this.isIPhoneOrIPad()&&/\b(\w*Apple\w*)\b/.test(navigator.vendor)&&/\b(\w*Safari\w*)\b/.test(e)&&!/\b(\w*CriOS\w*)\b/.test(e)&&!/\b(\w*FxiOS\w*)\b/.test(e)},e.prototype.isIonicIos=function(){return this.isIPhoneOrIPad()&&-1===r.ua.indexOf("Safari")},e.prototype.isIonicAndroid=function(){return"Android"===r.os.family&&"Android Browser"==r.name},e.prototype.isMobileDevice=function(){return"iOS"===r.os.family||"Android"===r.os.family},e.prototype.isReactNative=function(){return!1},e.prototype.isChromium=function(){return this.isChromeBrowser()||this.isChromeMobileBrowser()||this.isOperaBrowser()||this.isOperaMobileBrowser()||this.isEdgeBrowser()||this.isEdgeMobileBrowser()||this.isSamsungBrowser()||this.isIonicAndroid()||this.isIonicIos()||this.isElectron()||this.isMotorolaEdgeDevice()},e.prototype.canScreenShare=function(){var e=(null==r?void 0:r.version)?parseFloat(r.version):-1;return!this.isMobileDevice()&&(this.isChromeBrowser()||this.isFirefoxBrowser()||this.isOperaBrowser()||this.isElectron()||this.isEdgeBrowser()||this.isSafariBrowser()&&e>=13)},e.prototype.getName=function(){return r.name||""},e.prototype.getVersion=function(){return r.version||""},e.prototype.getFamily=function(){return r.os.family||""},e.prototype.getDescription=function(){return r.description||""},e}();t.PlatformUtils=i},11645:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRtcPeerSendrecv=t.WebRtcPeerSendonly=t.WebRtcPeerRecvonly=t.WebRtcPeer=void 0;var c=n(5442),l=n(88996),u=n(69532),d=n(77654),h=n(34957),p=d.OpenViduLogger.getInstance(),f=function(){function e(e){var t=this;this.remoteCandidatesQueue=[],this.localCandidatesQueue=[],this.iceCandidateList=[],h.PlatformUtils.getInstance(),this.configuration=o(o({},e),{iceServers:e.iceServers&&e.iceServers.length>0?e.iceServers:c(),mediaStream:void 0!==e.mediaStream?e.mediaStream:null,mode:e.mode?e.mode:"sendrecv",id:e.id?e.id:this.generateUniqueId()}),p.debug("[WebRtcPeer] configuration:\n".concat(JSON.stringify(this.configuration,null,2))),this.pc=new RTCPeerConnection({iceServers:this.configuration.iceServers}),this.pc.addEventListener("icecandidate",function(e){if(null!==e.candidate){var n=e.candidate,r=new RTCIceCandidate(n);t.configuration.onIceCandidate(r),""!==r.candidate&&t.localCandidatesQueue.push(r)}}),this.pc.addEventListener("signalingstatechange",function(){return s(t,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:if("stable"!==this.pc.signalingState)return[3,6];n.label=1;case 1:if(!(this.iceCandidateList.length>0))return[3,6];e=this.iceCandidateList.shift(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this.pc.addIceCandidate(e)];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),p.error("Error when calling RTCPeerConnection#addIceCandidate for RTCPeerConnection "+this.getId(),t),[3,5];case 5:return[3,1];case 6:return[2]}})})})}return e.prototype.getId=function(){return this.configuration.id},e.prototype.dispose=function(){p.debug("Disposing WebRtcPeer"),this.pc&&"closed"!==this.pc.signalingState&&(this.pc.close(),this.remoteCandidatesQueue=[],this.localCandidatesQueue=[])},e.prototype.createOfferLegacy=function(){this.configuration.mediaStream&&this.deprecatedPeerConnectionTrackApi();var e=this.configuration.mediaConstraints.audio,t=this.configuration.mediaConstraints.video,n={offerToReceiveAudio:"sendonly"!==this.configuration.mode&&e,offerToReceiveVideo:"sendonly"!==this.configuration.mode&&t};return p.debug("[createOfferLegacy] RTCPeerConnection.createOffer() options:",JSON.stringify(n)),this.pc.createOffer(n)},e.prototype.createOffer=function(){var e,t,n,r,i,o,c,l;return s(this,void 0,void 0,function(){var s,u,d,h,f,m,v,g,b,E,y,S,_,w,x,O,C,I,R,k,N,T,A;return a(this,function(a){switch(a.label){case 0:if(!("addTransceiver"in this.pc))return p.warn("[createOffer] Method RTCPeerConnection.addTransceiver() is NOT available; using LEGACY offerToReceive{Audio,Video}"),[2,this.createOfferLegacy()];if(p.debug("[createOffer] Method RTCPeerConnection.addTransceiver() is available; using it"),!("recvonly"!==this.configuration.mode))return[3,7];if(!this.configuration.mediaStream)throw Error("[WebRtcPeer.createOffer] Direction is '".concat(this.configuration.mode,"', but no stream was configured to be sent"));s=0,u=this.configuration.mediaStream.getTracks(),a.label=1;case 1:if(!(s<u.length))return[3,6];if(d=u[s],h={direction:this.configuration.mode,streams:[this.configuration.mediaStream]},"video"===d.kind&&this.configuration.simulcast)for(f=d.getSettings(),m=d.getConstraints(),v=null!==(n=null!==(t=null!==(e=f.width)&&void 0!==e?e:m.width.ideal)&&void 0!==t?t:m.width)&&void 0!==n?n:0,g=null!==(o=null!==(i=null!==(r=f.height)&&void 0!==r?r:m.height.ideal)&&void 0!==i?i:m.height)&&void 0!==o?o:0,p.info("[createOffer] Video track dimensions: ".concat(v,"x").concat(g)),E=0,E=(b=v*g)>=518400?3:b>=129600?2:1,h.sendEncodings=[],y=0;y<E;y++)_={rid:"rdiv"+(S=Math.pow(2,E-y-1)).toString(),scalabilityMode:"L1T1"},["detail","text"].includes(d.contentHint)?(_.scaleResolutionDownBy=1,_.maxFramerate=Math.floor(30/S)):_.scaleResolutionDownBy=S,h.sendEncodings.push(_);if(w=this.pc.addTransceiver(d,h),"video"!==d.kind||(x=w.sender.getParameters(),O=!1,(null===(c=x.degradationPreference)||void 0===c?void 0:c.length)||(["detail","text"].includes(d.contentHint)?x.degradationPreference="maintain-resolution":x.degradationPreference="balanced",p.info("[createOffer] Video sender Degradation Preference set: ".concat(x.degradationPreference)),O=!0),this.configuration.simulcast&&(null===(l=x.encodings)||void 0===l?void 0:l.length)!==h.sendEncodings.length&&(x.encodings=h.sendEncodings,O=!0),!O))return[3,5];p.debug("[createOffer] Setting new RTCRtpSendParameters to video sender"),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,w.sender.setParameters(x)];case 3:return a.sent(),[3,5];case 4:throw C=a.sent(),I="[WebRtcPeer.createOffer] Cannot set RTCRtpSendParameters to video sender",C instanceof Error&&(I+=": ".concat(C.message)),Error(I);case 5:return s++,[3,1];case 6:return[3,8];case 7:for(R=0,k=["audio","video"];R<k.length;R++)N=k[R],this.configuration.mediaConstraints[N]&&(this.configuration.mediaStream=new MediaStream,this.pc.addTransceiver(N,{direction:this.configuration.mode,streams:[this.configuration.mediaStream]}));a.label=8;case 8:return a.trys.push([8,10,,11]),[4,this.pc.createOffer()];case 9:return T=a.sent(),[3,11];case 10:throw A=a.sent(),I="[WebRtcPeer.createOffer] Browser failed creating an SDP Offer",A instanceof Error&&(I+=": ".concat(A.message)),Error(I);case 11:return[2,T]}})})},e.prototype.deprecatedPeerConnectionTrackApi=function(){for(var e=0,t=this.configuration.mediaStream.getTracks();e<t.length;e++){var n=t[e];this.pc.addTrack(n,this.configuration.mediaStream)}},e.prototype.createAnswer=function(){var e=this;return new Promise(function(t,n){if("getTransceivers"in e.pc){p.debug("[createAnswer] Method RTCPeerConnection.getTransceivers() is available; using it");for(var r=function(t){if(!e.configuration.mediaConstraints[t])return"continue";var r=e.pc.getTransceivers().find(function(e){return e.receiver.track.kind===t});if(!r)return{value:n(Error("".concat(t," requested, but no transceiver was created from remote description")))};r.direction=e.configuration.mode},i=0,o=["audio","video"];i<o.length;i++){var s=r(o[i]);if("object"==typeof s)return s.value}e.pc.createAnswer().then(function(e){return t(e)}).catch(function(e){return n(e)})}else{var a=void 0;if(e.configuration.mediaConstraints){var c={offerToReceiveAudio:"boolean"!=typeof e.configuration.mediaConstraints.audio||e.configuration.mediaConstraints.audio,offerToReceiveVideo:"boolean"!=typeof e.configuration.mediaConstraints.video||e.configuration.mediaConstraints.video};e.pc.createAnswer(c).then(function(e){return t(e)}).catch(function(e){return n(e)})}}})},e.prototype.processLocalOffer=function(e){var t=this;return new Promise(function(n,r){t.pc.setLocalDescription(e).then(function(){var e=t.pc.localDescription;return e?(p.debug("Local description set",e.sdp),n()):r("Local description is not defined")}).catch(function(e){return r(e)})})},e.prototype.processRemoteOffer=function(e){var t=this;return new Promise(function(n,r){var i={type:"offer",sdp:e};if(p.debug("SDP offer received, setting remote description",i),"closed"===t.pc.signalingState)return r("RTCPeerConnection is closed when trying to set remote description");t.setRemoteDescription(i).then(function(){return n()}).catch(function(e){return r(e)})})},e.prototype.processLocalAnswer=function(e){var t=this;return new Promise(function(n,r){if(p.debug("SDP answer created, setting local description"),"closed"===t.pc.signalingState)return r("RTCPeerConnection is closed when trying to set local description");t.pc.setLocalDescription(e).then(function(){return n()}).catch(function(e){return r(e)})})},e.prototype.processRemoteAnswer=function(e){var t=this;return new Promise(function(n,r){if(p.debug("SDP answer received, setting remote description"),"closed"===t.pc.signalingState)return r("RTCPeerConnection is closed when trying to set remote description");t.setRemoteDescription({type:"answer",sdp:e}).then(function(){n()}).catch(function(e){return r(e)})})},e.prototype.setRemoteDescription=function(e){return s(this,void 0,void 0,function(){return a(this,function(t){return[2,this.pc.setRemoteDescription(e)]})})},e.prototype.addIceCandidate=function(e){var t=this;return new Promise(function(n,r){switch(p.debug("Remote ICE candidate received",e),t.remoteCandidatesQueue.push(e),t.pc.signalingState){case"closed":r(Error("PeerConnection object is closed"));break;case"stable":t.pc.remoteDescription?t.pc.addIceCandidate(e).then(function(){return n()}).catch(function(e){return r(e)}):(t.iceCandidateList.push(e),n());break;default:t.iceCandidateList.push(e),n()}})},e.prototype.addIceConnectionStateChangeListener=function(e){var t=this;this.pc.addEventListener("iceconnectionstatechange",function(){switch(t.pc.iceConnectionState){case"disconnected":var n="IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "disconnected". Possible network disconnection';p.warn(n),t.configuration.onIceConnectionStateException(u.ExceptionEventName.ICE_CONNECTION_DISCONNECTED,n);break;case"failed":var r="IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') to "failed"';p.error(r),t.configuration.onIceConnectionStateException(u.ExceptionEventName.ICE_CONNECTION_FAILED,r);break;case"closed":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "closed"');break;case"new":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "new"');break;case"checking":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "checking"');break;case"connected":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "connected"');break;case"completed":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "completed"')}})},e.prototype.generateUniqueId=function(){return(0,l.v4)()},e}();t.WebRtcPeer=f;var m=function(e){function t(t){return t.mode="recvonly",e.call(this,t)||this}return i(t,e),t}(f);t.WebRtcPeerRecvonly=m;var v=function(e){function t(t){return t.mode="sendonly",e.call(this,t)||this}return i(t,e),t}(f);t.WebRtcPeerSendonly=v;var g=function(e){function t(t){return t.mode="sendrecv",e.call(this,t)||this}return i(t,e),t}(f);t.WebRtcPeerSendrecv=g},46749:function(e,t,n){"use strict";var r,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRtcStats=void 0;var s=n(77654),a=n(34957),c=s.OpenViduLogger.getInstance(),l=function(){function e(e){this.stream=e,this.STATS_ITEM_NAME="webrtc-stats-config",this.webRtcStatsEnabled=!1,this.statsInterval=1,r=a.PlatformUtils.getInstance()}return e.prototype.isEnabled=function(){return this.webRtcStatsEnabled},e.prototype.initWebRtcStats=function(){var e,t=this;try{e=localStorage.getItem(this.STATS_ITEM_NAME)}catch(e){}if(e){this.webRtcStatsEnabled=!0;var n=JSON.parse(e);c.warn("WebRtc stats enabled for stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId),c.warn("localStorage item: "+JSON.stringify(n)),this.POST_URL=n.httpEndpoint,this.statsInterval=n.interval,this.webRtcStatsIntervalId=setInterval(function(){return i(t,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.sendStatsToHttpEndpoint()];case 1:return e.sent(),[2]}})})},1e3*this.statsInterval)}else c.debug("WebRtc stats not enabled")},e.prototype.getSelectedIceCandidateInfo=function(){var e=this;return new Promise(function(t,n){return i(e,void 0,void 0,function(){var e,n,i,s,a,c,l,u,d,h,p,f,m,v,g,b,E,y,S,_,w;return o(this,function(o){switch(o.label){case 0:return[4,this.stream.getRTCPeerConnection().getStats()];case 1:if(e=o.sent(),i=new Map,s=new Map,a=new Map,e.forEach(function(e){switch("transport"===e.type&&(r.isChromium()||r.isSafariBrowser()||r.isReactNative())&&(n=e),e.type){case"candidate-pair":i.set(e.id,e);break;case"local-candidate":s.set(e.id,e);break;case"remote-candidate":a.set(e.id,e)}}),null!=n)l=n.selectedCandidatePairId,c=i.get(l);else for(h=0,u=i.size,d=i.values();h<u;h++)if((p=d.next().value).selected){c=p;break}if(f=c.localCandidateId,m=c.remoteCandidateId,v=s.get(f))for(b=0,g=this.stream.getLocalIceCandidateList().filter(function(e){return!!e.candidate&&(e.candidate.indexOf(v.ip)>=0||e.candidate.indexOf(v.address)>=0)&&e.candidate.indexOf(v.port)>=0}),v.raw=[],E=g;b<E.length;b++)y=E[b],v.raw.push(y.candidate);else v="ERROR: No active local ICE candidate. Probably ICE-TCP is being used";if(S=a.get(m))for(_=0,g=this.stream.getRemoteIceCandidateList().filter(function(e){return!!e.candidate&&(e.candidate.indexOf(S.ip)>=0||e.candidate.indexOf(S.address)>=0)&&e.candidate.indexOf(S.port)>=0}),S.raw=[],w=g;_<w.length;_++)y=w[_],S.raw.push(y.candidate);else S="ERROR: No active remote ICE candidate. Probably ICE-TCP is being used";return[2,t({localCandidate:v,remoteCandidate:S})]}})})})},e.prototype.stopWebRtcStats=function(){this.webRtcStatsEnabled&&(clearInterval(this.webRtcStatsIntervalId),c.warn("WebRtc stats stopped for disposed stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId))},e.prototype.sendStats=function(e,t){return i(this,void 0,void 0,function(){var n,r;return o(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),n={headers:{"Content-type":"application/json"},body:JSON.stringify(t),method:"POST"},[4,fetch(e,n)];case 1:return i.sent(),[3,3];case 2:return r=i.sent(),c.error("sendStats error: ".concat(JSON.stringify(r))),[3,3];case 3:return[2]}})})},e.prototype.sendStatsToHttpEndpoint=function(){return i(this,void 0,void 0,function(){var e,t,n;return o(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this.getCommonStats()];case 1:return e=r.sent(),t=this.generateJSONStatsResponse(e),[4,this.sendStats(this.POST_URL,t)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),c.log(n),[3,4];case 4:return[2]}})})},e.prototype.getCommonStats=function(){return i(this,void 0,void 0,function(){var e=this;return o(this,function(t){return[2,new Promise(function(t,n){return i(e,void 0,void 0,function(){var e,r,i,s,a,l=this;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.stream.getRTCPeerConnection().getStats()];case 1:return e=o.sent(),r=this.getWebRtcStatsResponseOutline(),i=["framesReceived","framesDropped","framesSent","frameHeight","frameWidth"],s=["availableOutgoingBitrate","currentRoundTripTime"],e.forEach(function(e){var t=null!=e.mediaType?e.mediaType:e.kind,n=function(n,o){null!=e[o]&&null!=r[n]&&(!t&&i.indexOf(o)>-1&&(t="video"),null!=n&&null!=t&&null!=o&&null!=r[n][t]?r[n][t][o]=Number(e[o]):null!=n&&null!=o&&s.includes(o)&&(r[n][o]=Number(e[o])))};switch(e.type){case"outbound-rtp":n("outbound","bytesSent"),n("outbound","packetsSent"),n("outbound","framesEncoded"),n("outbound","nackCount"),n("outbound","firCount"),n("outbound","pliCount"),n("outbound","qpSum");break;case"inbound-rtp":n("inbound","bytesReceived"),n("inbound","packetsReceived"),n("inbound","packetsLost"),n("inbound","jitter"),n("inbound","framesDecoded"),n("inbound","nackCount"),n("inbound","firCount"),n("inbound","pliCount");break;case"track":n("inbound","jitterBufferDelay"),n("inbound","framesReceived"),n("outbound","framesDropped"),n("outbound","framesSent"),n(l.stream.isLocal()?"outbound":"inbound","frameHeight"),n(l.stream.isLocal()?"outbound":"inbound","frameWidth");break;case"candidate-pair":n("candidatepair","currentRoundTripTime"),n("candidatepair","availableOutgoingBitrate")}}),(null==r?void 0:r.candidatepair)&&0!==Object.keys(r.candidatepair).length||delete r.candidatepair,[2,t(r)];case 2:return a=o.sent(),c.error("Error getting common stats: ",a),[2,n(a)];case 3:return[2]}})})})]})})},e.prototype.generateJSONStatsResponse=function(e){return{"@timestamp":new Date().toISOString(),participant_id:this.stream.connection.data,session_id:this.stream.session.sessionId,platform:r.getName(),platform_description:r.getDescription(),stream:"webRTC",webrtc_stats:e}},e.prototype.getWebRtcStatsResponseOutline=function(){return this.stream.isLocal()?{outbound:{audio:{},video:{}},candidatepair:{}}:{inbound:{audio:{},video:{}}}},e}();t.WebRtcStats=l},16714:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=void 0;var r=n(67883),i=n(77654),o=n(69532),s=i.OpenViduLogger.getInstance(),a=function(){function e(e,t){this.session=e,this.disposed=!1;var n="'Connection' created ";t.role?(this.localOptions=t,this.connectionId=this.localOptions.id,this.creationTime=this.localOptions.createdAt,this.data=this.localOptions.metadata,this.rpcSessionId=this.localOptions.sessionId,this.role=this.localOptions.role,this.record=this.localOptions.record,n+="(local)"):(this.remoteOptions=t,this.connectionId=this.remoteOptions.id,this.creationTime=this.remoteOptions.createdAt,this.remoteOptions.metadata&&(this.data=this.remoteOptions.metadata),this.remoteOptions.streams&&this.initRemoteStreams(this.remoteOptions.streams),n+="(remote) with 'connectionId' ["+this.remoteOptions.id+"]"),s.info(n)}return e.prototype.sendIceCandidate=function(e){var t=this;this.disposed?s.warn("Connection ".concat(this.connectionId," disposed when trying to send an ICE candidate. ICE candidate not sent")):(s.debug((this.stream.outboundStreamOpts?"Local":"Remote")+"candidate for"+this.connectionId,e),this.session.openvidu.sendRequest("onIceCandidate",{endpointName:this.connectionId,candidate:e.candidate,sdpMid:e.sdpMid,sdpMLineIndex:e.sdpMLineIndex},function(e,n){e&&(s.error("Error sending ICE candidate: "+JSON.stringify(e)),t.session.emitEvent("exception",[new o.ExceptionEvent(t.session,o.ExceptionEventName.ICE_CANDIDATE_ERROR,t.session,"There was an unexpected error on the server-side processing an ICE candidate generated and sent by the client-side",e)]))}))},e.prototype.initRemoteStreams=function(e){var t=this;e.forEach(function(e){var n={id:e.id,createdAt:e.createdAt,connection:t,hasAudio:e.hasAudio,hasVideo:e.hasVideo,audioActive:e.audioActive,videoActive:e.videoActive,typeOfVideo:e.typeOfVideo,frameRate:e.frameRate,videoDimensions:e.videoDimensions?JSON.parse(e.videoDimensions):void 0,filter:e.filter?e.filter:void 0},i=new r.Stream(t.session,n);t.addStream(i)}),s.info("Remote 'Connection' with 'connectionId' ["+this.connectionId+"] is now configured for receiving Streams with options: ",this.stream.inboundStreamOpts)},e.prototype.addStream=function(e){e.connection=this,this.stream=e},e.prototype.removeStream=function(){delete this.stream},e.prototype.dispose=function(){this.disposed=!0,this.removeStream()},e}();t.Connection=a},97897:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventDispatcher=void 0;var r=n(77654),i=n(51594),o=r.OpenViduLogger.getInstance(),s=function(){function e(){this.userHandlerArrowHandler=new WeakMap,this.ee=new i}return e.prototype.onAux=function(e,t,n){var r=function(e){e?o.debug(t,e):o.debug(t),n(e)};return this.userHandlerArrowHandler.set(n,r),this.ee.on(e,r),this},e.prototype.onceAux=function(e,t,n){var r=this,i=function(e){e?o.debug(t,e):o.debug(t),n(e),r.userHandlerArrowHandler.delete(n)};return this.userHandlerArrowHandler.set(n,i),this.ee.once(e,i),this},e.prototype.offAux=function(e,t){if(t){var n=this.userHandlerArrowHandler.get(t);n&&this.ee.off(e,n),this.userHandlerArrowHandler.delete(t)}else this.ee.removeAllListeners(e);return this},e}();t.EventDispatcher=s},23364:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Filter=void 0;var r=n(19988),i=n(35019),o=n(77654).OpenViduLogger.getInstance(),s=function(){function e(e,t){this.handlers=new Map,this.type=e,this.options=t}return e.prototype.execMethod=function(e,t){var n=this;return new Promise(function(s,a){o.info("Executing filter method to stream "+n.stream.streamId);var c,l,u=function(t){o.info("Filter method successfully executed on Stream "+n.stream.streamId);var i=Object.assign({},n.stream.filter);return n.stream.filter.lastExecMethod={method:e,params:l},t&&(n.stream.session.emitEvent("streamPropertyChanged",[new r.StreamPropertyChangedEvent(n.stream.session,n.stream,"filter",n.stream.filter,i,"execFilterMethod")]),n.stream.streamManager.emitEvent("streamPropertyChanged",[new r.StreamPropertyChangedEvent(n.stream.streamManager,n.stream,"filter",n.stream.filter,i,"execFilterMethod")])),s()};if(n.type.startsWith("VB:")){if("string"==typeof t)try{t=JSON.parse(t)}catch(e){return a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"Wrong params syntax: "+e))}if(l=t,"update"!==e)return a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,'Unknown Virtual Background method "'.concat(e,'"')));if(!(null===(c=n.stream.virtualBackgroundSinkElements)||void 0===c?void 0:c.VB))return a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"There is no Virtual Background filter applied"));n.stream.virtualBackgroundSinkElements.VB.updateValues(t).then(function(){return u(!1)}).catch(function(e){return e.name===i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR?a(new i.OpenViduError(e.name,e.message)):a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"Error updating values on Virtual Background filter: "+e))})}else{var d=void 0;if("string"!=typeof t)try{d=JSON.stringify(t)}catch(e){var h="'params' property must be a JSON formatted object";return o.error(h),a(h)}else d=t;l=d,n.stream.session.openvidu.sendRequest("execFilterMethod",{streamId:n.stream.streamId,method:e,params:d},function(e,t){return e?(o.error("Error executing filter method for Stream "+n.stream.streamId,e),401===e.code)?a(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to execute a filter method")):a(e):u(!0)})}})},e.prototype.addEventListener=function(e,t){var n=this;return new Promise(function(r,s){o.info("Adding filter event listener to event "+e+" to stream "+n.stream.streamId),n.stream.session.openvidu.sendRequest("addFilterEventListener",{streamId:n.stream.streamId,eventType:e},function(a,c){return a?(o.error("Error adding filter event listener to event "+e+"for Stream "+n.stream.streamId,a),401===a.code)?s(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):s(a):(n.handlers.set(e,t),o.info("Filter event listener to event "+e+" successfully applied on Stream "+n.stream.streamId),r())})})},e.prototype.removeEventListener=function(e){var t=this;return new Promise(function(n,r){o.info("Removing filter event listener to event "+e+" to stream "+t.stream.streamId),t.stream.session.openvidu.sendRequest("removeFilterEventListener",{streamId:t.stream.streamId,eventType:e},function(s,a){return s?(o.error("Error removing filter event listener to event "+e+"for Stream "+t.stream.streamId,s),401===s.code)?r(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):r(s):(t.handlers.delete(e),o.info("Filter event listener to event "+e+" successfully removed on Stream "+t.stream.streamId),n())})})},e}();t.Filter=s},63154:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalRecorder=void 0;var r,i=n(97134),o=n(77654),s=n(34957),a=n(3127),c=o.OpenViduLogger.getInstance(),l=function(){function e(e){this.stream=e,this.chunks=[],r=s.PlatformUtils.getInstance(),this.connectionId=this.stream.connection?this.stream.connection.connectionId:"default-connection",this.id=this.stream.streamId+"_"+this.connectionId+"_localrecord",this.state=i.LocalRecorderState.READY}return e.prototype.record=function(e){var t=this;return new Promise(function(n,r){try{if("string"==typeof e||e instanceof String)return r("When calling LocalRecorder.record(options) parameter 'options' cannot be a string. Must be an object like { mimeType: \"".concat(e,'" }'));if("undefined"==typeof MediaRecorder)throw c.error("MediaRecorder not supported on your device. See compatibility in https://caniuse.com/#search=MediaRecorder"),Error("MediaRecorder not supported on your device. See compatibility in https://caniuse.com/#search=MediaRecorder");if(t.state!==i.LocalRecorderState.READY)throw Error("'LocalRecord.record()' needs 'LocalRecord.state' to be 'READY' (current value: '"+t.state+"'). Call 'LocalRecorder.clean()' or init a new LocalRecorder before");c.log("Starting local recording of stream '"+t.stream.streamId+"' of connection '"+t.connectionId+"'"),e?e.mimeType||(e.mimeType="video/webm"):e={mimeType:"video/webm"},t.mediaRecorder=new MediaRecorder(t.stream.getMediaStream(),e),t.mediaRecorder.start()}catch(e){return r(e)}return t.mediaRecorder.ondataavailable=function(e){e.data.size>0&&t.chunks.push(e.data)},t.mediaRecorder.onerror=function(e){c.error("MediaRecorder error: ",e)},t.mediaRecorder.onstart=function(){c.log("MediaRecorder started (state="+t.mediaRecorder.state+")")},t.mediaRecorder.onstop=function(){t.onStopDefault()},t.mediaRecorder.onpause=function(){c.log("MediaRecorder paused (state="+t.mediaRecorder.state+")")},t.mediaRecorder.onresume=function(){c.log("MediaRecorder resumed (state="+t.mediaRecorder.state+")")},t.state=i.LocalRecorderState.RECORDING,n()})},e.prototype.stop=function(){var e=this;return new Promise(function(t,n){try{if(e.state===i.LocalRecorderState.READY||e.state===i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.stop()' needs 'LocalRecord.state' to be 'RECORDING' or 'PAUSED' (current value: '"+e.state+"'). Call 'LocalRecorder.start()' before");e.mediaRecorder.onstop=function(){return e.onStopDefault(),t()},e.mediaRecorder.stop()}catch(e){return n(e)}})},e.prototype.pause=function(){var e=this;return new Promise(function(t,n){try{if(e.state!==i.LocalRecorderState.RECORDING)return n(Error("'LocalRecord.pause()' needs 'LocalRecord.state' to be 'RECORDING' (current value: '"+e.state+"'). Call 'LocalRecorder.start()' or 'LocalRecorder.resume()' before"));return e.mediaRecorder.pause(),e.state=i.LocalRecorderState.PAUSED,t()}catch(e){return n(e)}})},e.prototype.resume=function(){var e=this;return new Promise(function(t,n){try{if(e.state!==i.LocalRecorderState.PAUSED)throw Error("'LocalRecord.resume()' needs 'LocalRecord.state' to be 'PAUSED' (current value: '"+e.state+"'). Call 'LocalRecorder.pause()' before");return e.mediaRecorder.resume(),e.state=i.LocalRecorderState.RECORDING,t()}catch(e){return n(e)}})},e.prototype.preview=function(e){if(this.state!==i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.preview()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");if(this.videoPreview=document.createElement("video"),this.videoPreview.id=this.id,this.videoPreview.autoplay=!0,r.isSafariBrowser()&&(this.videoPreview.playsInline=!0),"string"==typeof e){var t=document.getElementById(e);t&&(this.videoPreview=t.appendChild(this.videoPreview))}else this.videoPreview=e.appendChild(this.videoPreview);return this.videoPreview.src=this.videoPreviewSrc,this.videoPreview},e.prototype.clean=function(){var e=this,t=function(){delete e.blob,e.chunks=[],e.state=i.LocalRecorderState.READY};this.state===i.LocalRecorderState.RECORDING||this.state===i.LocalRecorderState.PAUSED?this.stop().then(function(){return t()}).catch(function(){return t()}):t()},e.prototype.download=function(){if(this.state!==i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.download()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");var e=document.createElement("a");e.style.display="none",document.body.appendChild(e);var t=globalThis.URL.createObjectURL(this.blob);e.href=t,e.download=this.id+"."+a.getExtension(this.blob.type),e.click(),globalThis.URL.revokeObjectURL(t),document.body.removeChild(e)},e.prototype.getBlob=function(){if(this.state===i.LocalRecorderState.FINISHED)return this.blob;throw Error("Call 'LocalRecord.stop()' before getting Blob file")},e.prototype.uploadAsBinary=function(e,t){var n=this;return new Promise(function(r,o){if(n.state!==i.LocalRecorderState.FINISHED)return o(Error("'LocalRecord.uploadAsBinary()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+n.state+"'). Call 'LocalRecorder.stop()' before"));var s=new XMLHttpRequest;if(s.open("POST",e,!0),"object"==typeof t)for(var a=0,c=Object.keys(t);a<c.length;a++){var l=c[a];s.setRequestHeader(l,t[l])}s.onreadystatechange=function(){if(4===s.readyState)return"2"===s.status.toString().charAt(0)?r(s.responseText):o(s.status)},s.send(n.blob)})},e.prototype.uploadAsMultipartfile=function(e,t){var n=this;return new Promise(function(r,o){if(n.state!==i.LocalRecorderState.FINISHED)return o(Error("'LocalRecord.uploadAsMultipartfile()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+n.state+"'). Call 'LocalRecorder.stop()' before"));var s=new XMLHttpRequest;if(s.open("POST",e,!0),"object"==typeof t)for(var c=0,l=Object.keys(t);c<l.length;c++){var u=l[c];s.setRequestHeader(u,t[u])}var d=new FormData;d.append("file",n.blob,n.id+"."+a.getExtension(n.blob.type)),s.onreadystatechange=function(){if(4===s.readyState)return"2"===s.status.toString().charAt(0)?r(s.responseText):o(s.status)},s.send(d)})},e.prototype.onStopDefault=function(){c.log("MediaRecorder stopped  (state="+this.mediaRecorder.state+")"),this.blob=new Blob(this.chunks,{type:this.mediaRecorder.mimeType}),this.chunks=[],this.videoPreviewSrc=globalThis.URL.createObjectURL(this.blob),this.state=i.LocalRecorderState.FINISHED},e}();t.LocalRecorder=l},23462:function(e,t,n){"use strict";var r,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.OpenVidu=void 0;var s=n(63154),a=n(26245),c=n(69767),l=n(88133),u=n(19988),d=n(35019),h=n(64874),p=n(77654),f=n(34957),m=n(20741),v=n(29969),g=n(36424),b=n(51594),E=n(44749),y=n(48942),S=p.OpenViduLogger.getInstance(),_=function(){function e(){var e=this;this.masterNodeHasCrashed=!1,this.publishers=[],this.secret="",this.recorder=!1,this.stt=!1,this.life=-1,this.advancedConfiguration={},this.webrtcStatsInterval=-1,this.sendBrowserLogs=g.OpenViduLoggerConfiguration.disabled,this.isAtLeastPro=!1,this.isEnterprise=!1,this.ee=new b,r=f.PlatformUtils.getInstance(),this.libraryVersion=y.version,S.info("OpenVidu initialized"),S.info("Platform detected: "+r.getDescription()),S.info("openvidu-browser version: "+this.libraryVersion),(r.isMobileDevice()||r.isReactNative())&&this.onOrientationChanged(function(){e.publishers.forEach(function(t){t.stream.isLocalStreamPublished&&t.stream&&t.stream.hasVideo&&e.sendNewVideoDimensionsIfRequired(t,"deviceRotated",75,10)})})}return e.prototype.initSession=function(){return this.session=new c.Session(this),this.session},e.prototype.initPublisher=function(e,t,n){r=t&&"function"!=typeof t?{audioSource:void 0!==(r=t).audioSource?r.audioSource:void 0,frameRate:"undefined"!=typeof MediaStreamTrack&&r.videoSource instanceof MediaStreamTrack?void 0:void 0!==r.frameRate?r.frameRate:void 0,insertMode:void 0!==r.insertMode?"string"==typeof r.insertMode?h.VideoInsertMode[r.insertMode]:r.insertMode:h.VideoInsertMode.APPEND,mirror:void 0===r.mirror||r.mirror,publishAudio:void 0===r.publishAudio||r.publishAudio,publishVideo:void 0===r.publishVideo||r.publishVideo,resolution:"undefined"!=typeof MediaStreamTrack&&r.videoSource instanceof MediaStreamTrack?void 0:void 0!==r.resolution?r.resolution:"640x480",videoSource:void 0!==r.videoSource?r.videoSource:void 0,videoSimulcast:r.videoSimulcast,filter:r.filter}:{insertMode:h.VideoInsertMode.APPEND,mirror:!0,publishAudio:!0,publishVideo:!0,resolution:"640x480"};var r,i,o=new a.Publisher(e,r,this);return t&&"function"==typeof t?i=t:n&&(i=n),o.initialize().then(function(){void 0!==i&&i(void 0),o.emitEvent("accessAllowed",[])}).catch(function(e){void 0!==i&&i(e),o.emitEvent("accessDenied",[e])}),this.publishers.push(o),o},e.prototype.initPublisherAsync=function(e,t){var n=this;return new Promise(function(r,i){var o,s=function(e){return e?i(e):r(o)};o=t?n.initPublisher(e,t,s):n.initPublisher(e,s)})},e.prototype.initLocalRecorder=function(e){return new s.LocalRecorder(e)},e.prototype.checkSystemRequirements=function(){return r.isIPhoneOrIPad()?r.isIOSWithSafari()||r.isChromeMobileBrowser()||r.isFirefoxMobileBrowser()||r.isOperaMobileBrowser()||r.isEdgeMobileBrowser()||r.isIonicIos():r.isChromeBrowser()||r.isChromeMobileBrowser()||r.isFirefoxBrowser()||r.isFirefoxMobileBrowser()||r.isOperaBrowser()||r.isOperaMobileBrowser()||r.isEdgeBrowser()||r.isEdgeMobileBrowser()||r.isSamsungBrowser()||r.isSafariBrowser()||r.isAndroidBrowser()||r.isElectron()||r.isNodeJs()||r.isMotorolaEdgeDevice()},e.prototype.checkScreenSharingCapabilities=function(){return r.canScreenShare()},e.prototype.getDevices=function(){return new Promise(function(e,t){navigator.mediaDevices.enumerateDevices().then(function(t){var n,i=[];if(!r.isIonicAndroid()||"undefined"==typeof cordova||null===(n=null==cordova?void 0:cordova.plugins)||void 0===n||!n.EnumerateDevicesPlugin)return t.forEach(function(e){("audioinput"===e.kind||"videoinput"===e.kind)&&i.push({kind:e.kind,deviceId:e.deviceId,label:e.label})}),e(i);cordova.plugins.EnumerateDevicesPlugin.getEnumerateDevices().then(function(n){var r=[],o=[],s=[];return r=n.filter(function(e){return"audioinput"===e.kind}),o=t.filter(function(e){return"videoinput"===e.kind}),s=t.filter(function(e){return"audioinput"===e.kind}),o.forEach(function(e,t){if(e.label)i.push({kind:e.kind,deviceId:e.deviceId,label:e.label});else{var n="";n=0===t?"Front Camera":1===t?"Back Camera":"Unknown Camera",i.push({kind:e.kind,deviceId:e.deviceId,label:n})}}),s.forEach(function(e,t){if(e.label)i.push({kind:e.kind,deviceId:e.deviceId,label:e.label});else{var n="";switch(t){case 0:n="Default";break;case 1:var o=r.filter(function(e){return e.label.includes("Built")})[0];n=o?o.label:"Built-in Microphone";break;case 2:var s=r.filter(function(e){return e.label.includes("Wired")})[0];n=s?s.label:"Headset earpiece";break;case 3:var a=r.filter(function(e){return e.label.includes("Bluetooth")})[0];n=a?a.label:"Wireless";break;default:n="Unknown Microphone"}i.push({kind:e.kind,deviceId:e.deviceId,label:n})}}),e(i)})}).catch(function(e){return S.error("Error getting devices",e),t(e)})})},e.prototype.getUserMedia=function(e){var t,n;return i(this,void 0,void 0,function(){var s,a,c,l,u,h,p,f,m,v=this;return o(this,function(g){switch(g.label){case 0:s=function(e,t){return i(v,void 0,void 0,function(){var n,r,i;return o(this,function(o){switch(o.label){case 0:n={audio:void 0===t.audio||t.audio,video:!1},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(n)];case 2:return r=o.sent(),e.addTrack(r.getAudioTracks()[0]),[2,e];case 3:throw i=o.sent(),e.getAudioTracks().forEach(function(e){e.stop()}),e.getVideoTracks().forEach(function(e){e.stop()}),this.generateAudioDeviceError(i,n);case 4:return[2]}})})},g.label=1;case 1:return g.trys.push([1,20,,21]),[4,this.generateMediaConstraints(e)];case 2:if(!((a=g.sent()).videoTrack&&a.audioTrack||a.audioTrack&&(null===(t=a.constraints)||void 0===t?void 0:t.video)===!1||a.videoTrack&&(null===(n=a.constraints)||void 0===n?void 0:n.audio)===!1))return[3,3];return[2,this.addAlreadyProvidedTracks(a,new MediaStream)];case 3:if(a.videoTrack&&delete a.constraints.video,a.audioTrack&&delete a.constraints.audio,c=!1,"string"!=typeof e.videoSource||!("screen"===e.videoSource||"window"===e.videoSource||r.isElectron()&&e.videoSource.startsWith("screen:")))return[3,12];if(c=!a.audioTrack&&null!==e.audioSource&&!1!==e.audioSource,!(navigator.mediaDevices.getDisplayMedia&&!r.isElectron()))return[3,11];g.label=4;case 4:return g.trys.push([4,9,,10]),[4,navigator.mediaDevices.getDisplayMedia({video:!0,audio:"screen"===e.audioSource})];case 5:if(l=g.sent(),this.addAlreadyProvidedTracks(a,l),!c)return[3,7];return[4,s(l,a.constraints)];case 6:return[2,g.sent()];case 7:return[2,l];case 8:return[3,10];case 9:throw u=g.sent(),h=d.OpenViduErrorName.SCREEN_CAPTURE_DENIED,p=u.toString(),new d.OpenViduError(h,p);case 10:return[3,11];case 11:return[3,12];case 12:f=c?{video:a.constraints.video}:a.constraints,g.label=13;case 13:return g.trys.push([13,18,,19]),[4,navigator.mediaDevices.getUserMedia(f)];case 14:if(l=g.sent(),this.addAlreadyProvidedTracks(a,l),!c)return[3,16];return[4,s(l,a.constraints)];case 15:return[2,g.sent()];case 16:return[2,l];case 17:return[3,19];case 18:throw m=g.sent(),h=void 0,p=m.toString(),h="screen"!==e.videoSource?d.OpenViduErrorName.DEVICE_ACCESS_DENIED:d.OpenViduErrorName.SCREEN_CAPTURE_DENIED,new d.OpenViduError(h,p);case 19:return[3,21];case 20:throw g.sent();case 21:return[2]}})})},e.prototype.enableProdMode=function(){S.enableProdMode()},e.prototype.setAdvancedConfiguration=function(e){this.advancedConfiguration=e},e.prototype.onOrientationChanged=function(e){globalThis.addEventListener("orientationchange",e)},e.prototype.sendNewVideoDimensionsIfRequired=function(e,t,n,r){var i,o,s,a,c=this,l=0,u=(null===(o=null===(i=null==e?void 0:e.stream)||void 0===i?void 0:i.videoDimensions)||void 0===o?void 0:o.width)||0,d=(null===(a=null===(s=null==e?void 0:e.stream)||void 0===s?void 0:s.videoDimensions)||void 0===a?void 0:a.height)||0,h=setInterval(function(){++l>r&&clearTimeout(h),e.getVideoDimensions().then(function(n){(n.width!==u||n.height!==d)&&(clearTimeout(h),c.sendVideoDimensionsChangedEvent(e,t,u,d,n.width,n.height))})},n)},e.prototype.sendVideoDimensionsChangedEvent=function(e,t,n,r,i,o){var s=this;e.stream.videoDimensions={width:i||0,height:o||0},this.sendRequest("streamPropertyChanged",{streamId:e.stream.streamId,property:"videoDimensions",newValue:JSON.stringify(e.stream.videoDimensions),reason:t},function(i,o){i?S.error("Error sending 'streamPropertyChanged' event",i):(s.session.emitEvent("streamPropertyChanged",[new u.StreamPropertyChangedEvent(s.session,e.stream,"videoDimensions",e.stream.videoDimensions,{width:n,height:r},t)]),e.emitEvent("streamPropertyChanged",[new u.StreamPropertyChangedEvent(e,e.stream,"videoDimensions",e.stream.videoDimensions,{width:n,height:r},t)]),s.session.sendVideoData(e))})},e.prototype.sendTrackChangedEvent=function(e,t,n,r){var i=this,o={label:t},s={label:n},a="trackReplaced";e.stream.isLocalStreamPublished?this.sendRequest("streamPropertyChanged",{streamId:e.stream.streamId,property:r,newValue:s,reason:a},function(t,n){t?S.error("Error sending 'streamPropertyChanged' event",t):(i.session.emitEvent("streamPropertyChanged",[new u.StreamPropertyChangedEvent(i.session,e.stream,r,s,o,a)]),e.emitEvent("streamPropertyChanged",[new u.StreamPropertyChangedEvent(e,e.stream,r,s,o,a)]))}):(this.session.emitEvent("streamPropertyChanged",[new u.StreamPropertyChangedEvent(this.session,e.stream,r,s,o,a)]),e.emitEvent("streamPropertyChanged",[new u.StreamPropertyChangedEvent(e,e.stream,r,s,o,a)]))},e.prototype.generateMediaConstraints=function(e){var t=this;return new Promise(function(n,r){var i={audioTrack:void 0,videoTrack:void 0,constraints:{audio:void 0,video:void 0}},o=e.audioSource,s=e.videoSource;if((null===o||!1===o)&&(i.constraints.audio=!1),(null===s||!1===s)&&(i.constraints.video=!1),!1===i.constraints.audio&&!1===i.constraints.video)return r(new d.OpenViduError(d.OpenViduErrorName.NO_INPUT_SOURCE_SET,"Properties 'audioSource' and 'videoSource' cannot be set to false or null at the same time"));if("undefined"!=typeof MediaStreamTrack&&o instanceof MediaStreamTrack&&(i.audioTrack=o),"undefined"!=typeof MediaStreamTrack&&s instanceof MediaStreamTrack&&(i.videoTrack=s),void 0===o&&(i.constraints.audio=!0),void 0===s&&(i.constraints.video={width:{ideal:640},height:{ideal:480}}),null!==s&&!1!==s){if(e.resolution){var a=e.resolution.toLowerCase().split("x"),c=Number(a[0]),l=Number(a[1]);i.constraints.video={width:{ideal:c},height:{ideal:l}}}e.frameRate&&(i.constraints.video.frameRate={ideal:e.frameRate})}return t.configureDeviceIdOrScreensharing(i,e,n,r),n(i)})},e.prototype.startWs=function(e){var t={heartbeat:5e3,ws:{uri:this.wsUri+"?sessionId="+this.session.sessionId,onconnected:e,ondisconnect:this.disconnectCallback.bind(this),onreconnecting:this.reconnectingCallback.bind(this),onreconnected:this.reconnectedCallback.bind(this),ismasternodecrashed:this.isMasterNodeCrashed.bind(this)},rpc:{requestTimeout:1e4,heartbeatRequestTimeout:5e3,participantJoined:this.session.onParticipantJoined.bind(this.session),participantPublished:this.session.onParticipantPublished.bind(this.session),participantUnpublished:this.session.onParticipantUnpublished.bind(this.session),participantLeft:this.session.onParticipantLeft.bind(this.session),participantEvicted:this.session.onParticipantEvicted.bind(this.session),recordingStarted:this.session.onRecordingStarted.bind(this.session),recordingStopped:this.session.onRecordingStopped.bind(this.session),broadcastStarted:this.session.onBroadcastStarted.bind(this.session),broadcastStopped:this.session.onBroadcastStopped.bind(this.session),sendMessage:this.session.onNewMessage.bind(this.session),streamPropertyChanged:this.session.onStreamPropertyChanged.bind(this.session),connectionPropertyChanged:this.session.onConnectionPropertyChanged.bind(this.session),networkQualityLevelChanged:this.session.onNetworkQualityLevelChangedChanged.bind(this.session),filterEventDispatched:this.session.onFilterEventDispatched.bind(this.session),iceCandidate:this.session.recvIceCandidate.bind(this.session),mediaError:this.session.onMediaError.bind(this.session),masterNodeCrashedNotification:this.onMasterNodeCrashedNotification.bind(this),forciblyReconnectSubscriber:this.session.onForciblyReconnectSubscriber.bind(this.session),speechToTextMessage:this.session.onSpeechToTextMessage.bind(this.session),speechToTextDisconnected:this.session.onSpeechToTextDisconnected.bind(this.session)}};this.jsonRpcClient=new E.clients.JsonRpcClient(t)},e.prototype.onMasterNodeCrashedNotification=function(e){console.error("Master Node has crashed"),this.masterNodeHasCrashed=!0,this.session.onLostConnection("nodeCrashed"),this.jsonRpcClient.close(4103,"Master Node has crashed")},e.prototype.getWsReadyState=function(){return this.jsonRpcClient.getReadyState()},e.prototype.closeWs=function(){this.jsonRpcClient.close(4102,"Connection closed by client")},e.prototype.sendRequest=function(e,t,n){var r;t&&t instanceof Function&&(n=t,t={}),S.debug('Sending request: {method:"'+e+'", params: '+JSON.stringify(t)+"}"),null===(r=this.jsonRpcClient)||void 0===r||r.send(e,t,n)},e.prototype.getWsUri=function(){return this.wsUri},e.prototype.getSecret=function(){return this.secret},e.prototype.getRecorder=function(){return this.recorder},e.prototype.getStt=function(){return this.stt},e.prototype.generateAudioDeviceError=function(e,t){var n,r;switch("Error"===e.name&&(e.name=e.constructor.name),e.name.toLowerCase()){case"notfounderror":return n=d.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r=e.toString(),new d.OpenViduError(n,r);case"notallowederror":return n=d.OpenViduErrorName.DEVICE_ACCESS_DENIED,r=e.toString(),new d.OpenViduError(n,r);case"overconstrainederror":return"deviceid"===e.constraint.toLowerCase()?(n=d.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r="Audio input device with deviceId '"+t.audio.deviceId.exact+"' not found"):(n=d.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,r="Audio input device doesn't support the value passed for constraint '"+e.constraint+"'"),new d.OpenViduError(n,r);case"notreadableerror":return n=d.OpenViduErrorName.DEVICE_ALREADY_IN_USE,r=e.toString(),new d.OpenViduError(n,r);default:return new d.OpenViduError(d.OpenViduErrorName.INPUT_AUDIO_DEVICE_GENERIC_ERROR,e.toString())}},e.prototype.addAlreadyProvidedTracks=function(e,t,n){return e.videoTrack&&(t.addTrack(e.videoTrack),n&&(e.constraints.video?n.lastVideoTrackConstraints=e.constraints.video:n.lastVideoTrackConstraints=e.videoTrack.getConstraints())),e.audioTrack&&t.addTrack(e.audioTrack),t},e.prototype.configureDeviceIdOrScreensharing=function(e,t,n,i){var o=this,s=t.audioSource,a=t.videoSource;if("string"==typeof s&&"screen"!==s&&(e.constraints.audio={deviceId:{exact:s}}),"string"==typeof a){if(this.isScreenShare(a)){if(this.checkScreenSharingCapabilities()){if(r.isElectron()){var c="screen:",l=a.substr(a.indexOf(c)+c.length);return e.constraints.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:l}},n(e)}if(!this.advancedConfiguration.screenShareChromeExtension||r.isFirefoxBrowser()||r.isFirefoxMobileBrowser()||navigator.mediaDevices.getDisplayMedia){if(navigator.mediaDevices.getDisplayMedia)return n(e);var u=r.isFirefoxBrowser()||r.isFirefoxMobileBrowser()?t.videoSource:void 0;return void m.getScreenId(u,function(t,r,s){if(!t)return e.constraints.video=s.video,n(e);if("not-installed"===t){var a=o.advancedConfiguration.screenShareChromeExtension?o.advancedConfiguration.screenShareChromeExtension:"https://chrome.google.com/webstore/detail/openvidu-screensharing/lfcgfepafnobdloecchnfaclibenjold",c=new d.OpenViduError(d.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,a);return S.error(c),i(c)}if("installed-disabled"===t){var c=new d.OpenViduError(d.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");return S.error(c),i(c)}if("permission-denied"===t){var c=new d.OpenViduError(d.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");return S.error(c),i(c)}var c=new d.OpenViduError(d.OpenViduErrorName.GENERIC_ERROR,"Unknown error when accessing screen share");return S.error(c),S.error(t),i(c)})}return void v.getScreenConstraints(function(t,r){if(!t&&(!r.mandatory||"screen"!==r.mandatory.chromeMediaSource))return e.constraints.video=r,n(e);if("permission-denied"===t||"PermissionDeniedError"===t){var s=new d.OpenViduError(d.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");return S.error(s),i(s)}var a=o.advancedConfiguration.screenShareChromeExtension.split("/").pop().trim();v.getChromeExtensionStatus(a,function(e){if("installed-disabled"===e){var t=new d.OpenViduError(d.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");return S.error(t),i(t)}if("not-installed"===e){var n=new d.OpenViduError(d.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,o.advancedConfiguration.screenShareChromeExtension);return S.error(n),i(n)}})})}var h=new d.OpenViduError(d.OpenViduErrorName.SCREEN_SHARING_NOT_SUPPORTED,"You can only screen share in desktop Chrome, Firefox, Opera, Safari (>=13.0), Edge (>= 80) or Electron. Detected client: "+r.getName()+" "+r.getVersion());return S.error(h),i(h)}this.setVideoSource(e,a),"screen"===s&&(S.warn('Parameter "audioSource" is set to "screen", which means rquesting audio from screen sharing source. But "videoSource" is not set to "screen". No audio source will be requested'),e.constraints.audio=!1)}},e.prototype.setVideoSource=function(e,t){e.constraints.video||(e.constraints.video={}),e.constraints.video.deviceId={exact:t}},e.prototype.disconnectCallback=function(){S.warn("Websocket connection lost"),this.isRoomAvailable()?this.session.onLostConnection("networkDisconnect"):alert("Connection error. Please reload page.")},e.prototype.reconnectingCallback=function(){S.warn("Websocket connection lost (reconnecting)"),this.isRoomAvailable()?this.session.emitEvent("reconnecting",[]):alert("Connection error. Please reload page.")},e.prototype.reconnectWebsocketThroughRpcConnectMethod=function(e){var t=this;this.sendRequest("connect",{sessionId:e,reconnect:!0},function(e,n){if(e){if(t.isMasterNodeCrashed())S.warn("Master Node has crashed!");else{S.error(e);var r=function(e,n){S.warn(n),t.session.onLostConnection(e),t.jsonRpcClient.close(4101,"Reconnection fault: "+n)};40007===e.code&&"reconnection error"===e.message&&console.error("Invalid RPC sessionId. Client network disconnection or Master Node crash"),-1===t.life?r("networkDisconnect","WS successfully reconnected but the user was already evicted due to timeout"):t.sendRequest("sessionStatus",{sessionId:t.session.sessionId},function(e,n){null!=e?console.error("Error checking session status",e):t.life===n.life?r("networkDisconnect","WS successfully reconnected but the user was already evicted due to timeout"):r("nodeCrashed","WS successfully reconnected to OpenVidu Server but your Master Node crashed")})}}else t.jsonRpcClient.resetPing(),t.session.onRecoveredConnection()})},e.prototype.reconnectedCallback=function(){if(S.warn("Websocket reconnected"),this.isRoomAvailable()){if(this.session.connection)this.reconnectWebsocketThroughRpcConnectMethod(this.session.connection.rpcSessionId);else{S.warn("There was no previous connection when running reconnection callback");var e=new l.SessionDisconnectedEvent(this.session,"networkDisconnect");this.session.ee.emitEvent("sessionDisconnected",[e]),e.callDefaultBehavior()}}else alert("Connection error. Please reload page.")},e.prototype.isMasterNodeCrashed=function(){return this.masterNodeHasCrashed},e.prototype.isRoomAvailable=function(){return void 0!==this.session&&this.session instanceof c.Session||(S.warn("Session instance not found"),!1)},e.prototype.isScreenShare=function(e){return"screen"===e||"window"===e||r.isElectron()&&e.startsWith("screen:")},e}();t.OpenVidu=_},26245:function(e,t,n){"use strict";var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Publisher=void 0;var c=n(69767),l=n(67883),u=n(71813),d=n(79869),h=n(19988),p=n(35019),f=n(77654),m=n(34957),v=n(98752),g=f.OpenViduLogger.getInstance(),b=function(e){function t(t,n,r){var o=e.call(this,new l.Stream(r.session?r.session:new c.Session(r),{publisherProperties:n,mediaConstraints:{}}),t)||this;return o.accessAllowed=!1,o.isSubscribedToRemote=!1,o.accessDenied=!1,i=m.PlatformUtils.getInstance(),o.properties=n,o.openvidu=r,o.stream.ee.on("local-stream-destroyed",function(e){o.stream.isLocalStreamPublished=!1;var t=new d.StreamEvent(!0,o,"streamDestroyed",o.stream,e);o.emitEvent("streamDestroyed",[t]),t.callDefaultBehavior()}),o}return o(t,e),t.prototype.publishAudio=function(e){var t=this;this.stream.audioActive!==e&&((this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream()).getAudioTracks().forEach(function(t){t.enabled=e}),this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"audioActive",newValue:e,reason:"publishAudio"},function(n,r){n?g.error("Error sending 'streamPropertyChanged' event",n):(t.session.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(t.session,t.stream,"audioActive",e,!e,"publishAudio")]),t.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(t,t.stream,"audioActive",e,!e,"publishAudio")]),t.session.sendVideoData(t.stream.streamManager))}),this.stream.audioActive=e,g.info("'Publisher' has "+(e?"published":"unpublished")+" its audio stream"))},t.prototype.publishVideo=function(e,t){var n=this;return new Promise(function(r,i){return s(n,void 0,void 0,function(){var n,o,c,l,u,d=this;return a(this,function(p){switch(p.label){case 0:if(!(this.stream.videoActive!==e))return[3,9];if(n=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream(),o=!1,n.getVideoTracks().forEach(function(n){n.enabled=e,e||!0!==t?e&&"ended"===n.readyState&&(o=!0):n.stop()}),!(!e&&!0===t&&this.stream.filter&&this.stream.filter.type.startsWith("VB:")))return[3,2];return this.stream.lastVBFilter=this.stream.filter,[4,this.stream.removeFilterAux(!0)];case 1:p.sent(),p.label=2;case 2:if(!o)return[3,8];if(c=n.getVideoTracks()[0],n.removeTrack(c),l=function(e){return s(d,void 0,void 0,function(){var t=this;return a(this,function(r){switch(r.label){case 0:if(n.addTrack(e),!this.stream.isLocalStreamPublished)return[3,2];return[4,this.replaceTrackInRtcRtpSender(e)];case 1:r.sent(),r.label=2;case 2:return this.stream.lastVBFilter&&setTimeout(function(){return s(t,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:return e=this.stream.lastVBFilter.options,(t=this.stream.lastVBFilter.lastExecMethod)&&"update"===t.method&&(e=Object.assign({},e,t.params)),[4,this.stream.applyFilter(this.stream.lastVBFilter.type,e)];case 1:return n.sent(),delete this.stream.lastVBFilter,[2]}})})},1),[2]}})})},!(t&&t instanceof MediaStreamTrack))return[3,4];return[4,l(t)];case 3:case 6:return p.sent(),[3,8];case 4:return p.trys.push([4,7,,8]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:this.stream.lastVideoTrackConstraints})];case 5:return u=p.sent(),[4,l(u.getVideoTracks()[0])];case 7:return[2,i(p.sent())];case 8:return this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"videoActive",newValue:e,reason:"publishVideo"},function(t,n){t?g.error("Error sending 'streamPropertyChanged' event",t):(d.session.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(d.session,d.stream,"videoActive",e,!e,"publishVideo")]),d.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(d,d.stream,"videoActive",e,!e,"publishVideo")]),d.session.sendVideoData(d.stream.streamManager))}),this.stream.videoActive=e,g.info("'Publisher' has "+(e?"published":"unpublished")+" its video stream"),[2,r()];case 9:return[2]}})})})},t.prototype.subscribeToRemote=function(e){e=void 0===e||e,this.isSubscribedToRemote=e,this.stream.subscribeToMyRemote(e)},t.prototype.on=function(t,n){var r=this;return e.prototype.on.call(this,t,n),"streamCreated"===t&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new d.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.on("stream-created-by-publisher",function(){r.emitEvent("streamCreated",[new d.StreamEvent(!1,r,"streamCreated",r.stream,"")])})),"accessAllowed"===t&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),"accessDenied"===t&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},t.prototype.once=function(t,n){var r=this;return e.prototype.once.call(this,t,n),"streamCreated"===t&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new d.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.once("stream-created-by-publisher",function(){r.emitEvent("streamCreated",[new d.StreamEvent(!1,r,"streamCreated",r.stream,"")])})),"accessAllowed"===t&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),"accessDenied"===t&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},t.prototype.off=function(t,n){return e.prototype.off.call(this,t,n),this},t.prototype.replaceTrack=function(e){return s(this,void 0,void 0,function(){return a(this,function(t){return[2,this.replaceTrackAux(e,!0)]})})},t.prototype.initialize=function(){var e=this;return new Promise(function(t,n){return s(e,void 0,void 0,function(){var e,r,o,c,l,u,d,h,f,m,b,E,y,S,_,w,x=this;return a(this,function(O){switch(O.label){case 0:e={},r={},o=2e3,l=function(e){return x.accessDenied=!0,x.accessAllowed=!1,g.error("Publisher initialization failed. ".concat(e.name,": ").concat(e.message)),n(e)},u=function(e){var n,r;if(x.accessAllowed=!0,x.accessDenied=!1,"undefined"!=typeof MediaStreamTrack&&x.properties.audioSource instanceof MediaStreamTrack&&(e.removeTrack(e.getAudioTracks()[0]),e.addTrack(x.properties.audioSource)),"undefined"!=typeof MediaStreamTrack&&x.properties.videoSource instanceof MediaStreamTrack&&(e.removeTrack(e.getVideoTracks()[0]),e.addTrack(x.properties.videoSource)),e.getAudioTracks()[0]){var i=void 0!==x.stream.audioActive&&null!==x.stream.audioActive?x.stream.audioActive:!!x.stream.outboundStreamOpts.publisherProperties.publishAudio;e.getAudioTracks()[0].enabled=i}if(e.getVideoTracks()[0]){var i=void 0!==x.stream.videoActive&&null!==x.stream.videoActive?x.stream.videoActive:!!x.stream.outboundStreamOpts.publisherProperties.publishVideo;e.getVideoTracks()[0].enabled=i}for(var o=0,s=e.getAudioTracks();o<s.length;o++){var a=s[o];(null===(n=a.contentHint)||void 0===n?void 0:n.length)||(a.contentHint="",g.info("Audio track Content Hint set: '".concat(a.contentHint,"'")))}for(var c=0,l=e.getVideoTracks();c<l.length;c++){var a=l[c];if(!(null===(r=a.contentHint)||void 0===r?void 0:r.length)){switch(x.stream.typeOfVideo){case v.TypeOfVideo.SCREEN:a.contentHint="detail";break;case v.TypeOfVideo.CUSTOM:g.warn("CUSTOM type video track was provided without Content Hint!"),a.contentHint="motion";break;case v.TypeOfVideo.CAMERA:case v.TypeOfVideo.IPCAM:default:a.contentHint="motion"}g.info("Video track Content Hint set: '".concat(a.contentHint,"'"))}}return x.initializeVideoReference(e),x.stream.displayMyRemote()||x.stream.updateMediaStreamInVideos(),delete x.firstVideoElement,x.stream.isSendVideo()?x.getVideoDimensions().then(function(t){x.stream.videoDimensions={width:t.width,height:t.height},x.stream.isSendScreen()&&(x.stream.isSendAudio()&&0===e.getAudioTracks().length&&(x.stream.audioActive=!1,x.stream.hasAudio=!1,x.stream.outboundStreamOpts.publisherProperties.publishAudio=!1,x.stream.outboundStreamOpts.publisherProperties.audioSource=!1),x.screenShareResizeInterval=setInterval(function(){var t=e.getVideoTracks()[0].getSettings(),n=t.width,r=t.height,i=null!=n&&n!==x.stream.videoDimensions.width,o=null!=r&&r!==x.stream.videoDimensions.height;x.stream.isLocalStreamPublished&&(i||o)&&x.openvidu.sendVideoDimensionsChangedEvent(x,"screenResized",x.stream.videoDimensions.width,x.stream.videoDimensions.height,n||0,r||0)},650)),x.stream.isLocalStreamReadyToPublish=!0,x.stream.ee.emitEvent("stream-ready-to-publish",[])}):(x.stream.isLocalStreamReadyToPublish=!0,x.stream.ee.emitEvent("stream-ready-to-publish",[])),t()},d=function(t,n){return s(x,void 0,void 0,function(){var i,s;return a(this,function(a){switch(a.label){case 0:if(this.clearPermissionDialogTimer(c,o),!(this.stream.isSendScreen()&&"screen"!==this.properties.audioSource&&this.stream.isSendAudio()))return[3,5];r.audio=n,r.video=!1,c=Date.now(),this.setPermissionDialogTimer(o),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(r)];case 2:return i=a.sent(),this.clearPermissionDialogTimer(c,o),t.addTrack(i.getAudioTracks()[0]),u(t),[3,4];case 3:return s=a.sent(),this.clearPermissionDialogTimer(c,o),t.getAudioTracks().forEach(function(e){e.stop()}),t.getVideoTracks().forEach(function(e){e.stop()}),l(this.openvidu.generateAudioDeviceError(s,e)),[2];case 4:return[3,6];case 5:u(t),a.label=6;case 6:return[2]}})})},h=function(t){return s(x,void 0,void 0,function(){var n,r,i,s;return a(this,function(a){switch(a.label){case 0:switch(g.error("getMediaError: ".concat(t.toString())),this.clearPermissionDialogTimer(c,o),"Error"===t.name&&(t.name=t.constructor.name),t.name.toLowerCase()){case"notfounderror":return[3,1];case"notallowederror":return[3,5];case"overconstrainederror":return[3,6];case"aborterror":case"notreadableerror":return[3,10]}return[3,11];case 1:return a.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:e.video})];case 2:return a.sent().getVideoTracks().forEach(function(e){e.stop()}),n=p.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r=t.toString(),l(new p.OpenViduError(n,r)),[3,4];case 3:return i=a.sent(),n=p.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,r=i.toString(),l(new p.OpenViduError(n,r)),[3,4];case 4:case 9:return[3,12];case 5:return n=this.stream.isSendScreen()?p.OpenViduErrorName.SCREEN_CAPTURE_DENIED:p.OpenViduErrorName.DEVICE_ACCESS_DENIED,r=t.toString(),l(new p.OpenViduError(n,r)),[3,12];case 6:return a.trys.push([6,8,,9]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:e.video})];case 7:return a.sent().getVideoTracks().forEach(function(e){e.stop()}),"deviceid"===t.constraint.toLowerCase()?(n=p.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r="Audio input device with deviceId '"+e.audio.deviceId.exact+"' not found"):(n=p.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,r="Audio input device doesn't support the value passed for constraint '"+t.constraint+"'"),l(new p.OpenViduError(n,r)),[3,9];case 8:return"deviceid"===(s=a.sent()).constraint.toLowerCase()?(n=p.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,r="Video input device with deviceId '"+e.video.deviceId.exact+"' not found"):(n=p.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,r="Video input device doesn't support the value passed for constraint '"+s.constraint+"'"),l(new p.OpenViduError(n,r)),[3,9];case 10:return n=p.OpenViduErrorName.DEVICE_ALREADY_IN_USE,r=t.toString(),l(new p.OpenViduError(n,r)),[3,12];case 11:return n=p.OpenViduErrorName.GENERIC_ERROR,r=t.toString(),l(new p.OpenViduError(n,r)),[3,12];case 12:return[2]}})})},O.label=1;case 1:return O.trys.push([1,14,,15]),[4,this.openvidu.generateMediaConstraints(this.properties)];case 2:if(!((f=O.sent()).videoTrack&&f.audioTrack||f.audioTrack&&(null===(_=f.constraints)||void 0===_?void 0:_.video)===!1||f.videoTrack&&(null===(w=f.constraints)||void 0===w?void 0:w.audio)===!1))return[3,3];return u(this.openvidu.addAlreadyProvidedTracks(f,new MediaStream,this.stream)),[3,13];case 3:m={mediaConstraints:e=f.constraints,publisherProperties:this.properties},this.stream.setOutboundStreamOptions(m),b=void 0===e.audio||e.audio,r.audio=!this.stream.isSendScreen()&&b,r.video=e.video,c=Date.now(),this.setPermissionDialogTimer(o),O.label=4;case 4:if(O.trys.push([4,11,,13]),!(this.stream.isSendScreen()&&navigator.mediaDevices.getDisplayMedia&&!i.isElectron()))return[3,7];return[4,navigator.mediaDevices.getDisplayMedia({video:!0,audio:"screen"===this.properties.audioSource})];case 5:return E=O.sent(),this.openvidu.addAlreadyProvidedTracks(f,E),[4,d(E,b)];case 6:return O.sent(),[3,10];case 7:return this.stream.lastVideoTrackConstraints=r.video,[4,navigator.mediaDevices.getUserMedia(r)];case 8:return E=O.sent(),this.openvidu.addAlreadyProvidedTracks(f,E,this.stream),[4,d(E,b)];case 9:O.sent(),O.label=10;case 10:return[3,13];case 11:return y=O.sent(),[4,h(y)];case 12:return O.sent(),[3,13];case 13:return[3,15];case 14:return S=O.sent(),l(S),[3,15];case 15:return[2]}})})})},t.prototype.replaceTrackAux=function(e,t){return s(this,void 0,void 0,function(){var n,r;return a(this,function(i){switch(i.label){case 0:n=e.enabled,"video"===e.kind?e.enabled=this.stream.videoActive:"audio"===e.kind&&(e.enabled=this.stream.audioActive),i.label=1;case 1:if(i.trys.push([1,5,,6]),!this.stream.isLocalStreamPublished)return[3,3];return this.replaceTrackInMediaStream(e,t),[4,this.replaceTrackInRtcRtpSender(e)];case 2:return[2,i.sent()];case 3:return[2,this.replaceTrackInMediaStream(e,t)];case 4:return[3,6];case 5:throw r=i.sent(),e.enabled=n,r;case 6:return[2]}})})},t.prototype.getVideoDimensions=function(){var e=this;return new Promise(function(t,n){var r,o=(i.isIonicIos()||i.isIOSWithSafari())&&e.videoReference.readyState<1,s=function(){if("function"==typeof e.stream.getMediaStream().getVideoTracks()[0].getSettings){var n,s,a=e.stream.getMediaStream().getVideoTracks()[0].getSettings();n=a.width||e.videoReference.videoWidth,s=a.height||e.videoReference.videoHeight}else g.warn("MediaStreamTrack does not have getSettings method on "+i.getDescription()),n=e.videoReference.videoWidth,s=e.videoReference.videoHeight;return null!=r&&e.videoReference.removeEventListener("loadedmetadata",r),o&&document.body.removeChild(e.videoReference),t({width:n,height:s})};e.videoReference.readyState>=1?s():(r=function(){if(e.videoReference.videoWidth)s();else var t=setInterval(function(){e.videoReference.videoWidth&&(clearInterval(t),s())},40)},e.videoReference.addEventListener("loadedmetadata",r),o&&document.body.appendChild(e.videoReference))})},t.prototype.reestablishStreamPlayingEvent=function(){this.ee.getListeners("streamPlaying").length>0&&this.addPlayEventToFirstVideo()},t.prototype.initializeVideoReference=function(e){this.videoReference=document.createElement("video"),this.videoReference.style.display="none",this.videoReference.muted=!0,this.videoReference.autoplay=!0,this.videoReference.controls=!1,(i.isSafariBrowser()||i.isIPhoneOrIPad()&&(i.isChromeMobileBrowser()||i.isEdgeMobileBrowser()||i.isOperaMobileBrowser()||i.isFirefoxMobileBrowser()))&&(this.videoReference.playsInline=!0),this.stream.setMediaStream(e),this.firstVideoElement&&this.createVideoElement(this.firstVideoElement.targetElement,this.properties.insertMode),this.videoReference.srcObject=this.stream.getMediaStream()},t.prototype.replaceTrackInMediaStream=function(e,t){var n,r=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream();"video"===e.kind?(n=r.getVideoTracks()[0],t&&(this.stream.lastVideoTrackConstraints=e.getConstraints())):n=r.getAudioTracks()[0],n.enabled=!1,n.stop(),r.removeTrack(n),r.addTrack(e);var i={oldLabel:(null==n?void 0:n.label)||"",newLabel:(null==e?void 0:e.label)||""};"video"===e.kind&&t?(this.openvidu.sendNewVideoDimensionsIfRequired(this,"trackReplaced",50,30),this.openvidu.sendTrackChangedEvent(this,i.oldLabel,i.newLabel,"videoTrack"),this.stream.isLocalStreamPublished&&this.session.sendVideoData(this.stream.streamManager,5,!0,5)):"audio"===e.kind&&t&&this.openvidu.sendTrackChangedEvent(this,i.oldLabel,i.newLabel,"audioTrack"),"audio"===e.kind&&(this.stream.disableHarkSpeakingEvent(!1),this.stream.disableHarkStoppedSpeakingEvent(!1),this.stream.disableHarkVolumeChangeEvent(!1),this.stream.initHarkEvents())},t.prototype.setPermissionDialogTimer=function(e){var t=this;this.permissionDialogTimeout=setTimeout(function(){t.emitEvent("accessDialogOpened",[])},e)},t.prototype.clearPermissionDialogTimer=function(e,t){clearTimeout(this.permissionDialogTimeout),Date.now()-e>t&&this.emitEvent("accessDialogClosed",[])},t.prototype.replaceTrackInRtcRtpSender=function(e){return s(this,void 0,void 0,function(){var t,n;return a(this,function(r){switch(r.label){case 0:if(t=this.stream.getRTCPeerConnection().getSenders(),"video"===e.kind){if(!(n=t.find(function(e){return!!e.track&&"video"===e.track.kind})))throw Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object")}else if("audio"===e.kind){if(!(n=t.find(function(e){return!!e.track&&"audio"===e.track.kind})))throw Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object")}else throw Error("Unknown track kind "+e.kind);return[4,n.replaceTrack(e)];case 1:return r.sent(),[2]}})})},t}(u.StreamManager);t.Publisher=b},69767:function(e,t,n){"use strict";var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Session=void 0;var c=n(16714),l=n(23364),u=n(5187),d=n(97897),h=n(42345),p=n(65787),f=n(50588),m=n(88133),v=n(77547),g=n(80018),b=n(79869),E=n(19988),y=n(51493),S=n(63337),_=n(35019),w=n(64874),x=n(77654),O=n(34957),C=n(2642),I=n(73280),R=n(69532),k=x.OpenViduLogger.getInstance(),N=function(e){function t(t){var n=e.call(this)||this;return n.streamManagers=[],n.remoteStreamsCreated=new Map,n.remoteConnections=new Map,i=O.PlatformUtils.getInstance(),n.openvidu=t,n}return o(t,e),t.prototype.connect=function(e,t){var n=this;return new Promise(function(r,o){if(n.processToken(e),!n.openvidu.checkSystemRequirements())return o(new _.OpenViduError(_.OpenViduErrorName.BROWSER_NOT_SUPPORTED,"Browser "+i.getName()+" (version "+i.getVersion()+") for "+i.getFamily()+" is not supported in OpenVidu"));n.options={sessionId:n.sessionId,participantId:e,metadata:t?n.stringClientMetadata(t):""},n.connectAux(e).then(function(){return r()}).catch(function(e){return o(e)})})},t.prototype.disconnect=function(){this.leave(!1,"disconnect")},t.prototype.subscribe=function(e,t,n,r){var i={};i=n&&"function"!=typeof n?{insertMode:void 0!==n.insertMode?"string"==typeof n.insertMode?w.VideoInsertMode[n.insertMode]:i.insertMode:w.VideoInsertMode.APPEND,subscribeToAudio:void 0===n.subscribeToAudio||n.subscribeToAudio,subscribeToVideo:void 0===n.subscribeToVideo||n.subscribeToVideo}:{insertMode:w.VideoInsertMode.APPEND,subscribeToAudio:!0,subscribeToVideo:!0};var o=void 0;if(n&&"function"==typeof n?o=n:r&&(o=r),!this.sessionConnected())throw void 0!==o&&o(this.notConnectedError()),this.notConnectedError();k.info("Subscribing to "+e.connection.connectionId),e.subscribe().then(function(){k.info("Subscribed correctly to "+e.connection.connectionId),void 0!==o&&o(void 0)}).catch(function(e){void 0!==o&&o(e)});var s=new u.Subscriber(e,t,i);return s.targetElement&&e.streamManager.createVideoElement(s.targetElement,i.insertMode),s},t.prototype.subscribeAsync=function(e,t,n){var r=this;return new Promise(function(i,o){if(!r.sessionConnected())return o(r.notConnectedError());var s,a=function(e){return e?o(e):i(s)};s=n?r.subscribe(e,t,n,a):r.subscribe(e,t,a)})},t.prototype.unsubscribe=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());var i=e.stream.connection.connectionId;k.info("Unsubscribing from "+i),t.openvidu.sendRequest("unsubscribeFromVideo",{sender:e.stream.connection.connectionId},function(t,o){return t?(k.error("Error unsubscribing from "+i),r(t)):(k.info("Unsubscribed correctly from "+i),e.stream.streamManager.removeAllVideos(),e.stream.disposeWebRtcPeer(),e.stream.disposeMediaStream(),n())})})},t.prototype.publish=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());e.session=t,e.stream.session=t,e.stream.publishedOnce?e.initialize().then(function(){t.connection.addStream(e.stream),e.reestablishStreamPlayingEvent(),e.stream.publish().then(function(){return t.sendVideoData(e,8,!0,5),n()}).catch(function(e){return r(e)})}).catch(function(e){return r(e)}):(t.connection.addStream(e.stream),e.stream.publish().then(function(){return t.sendVideoData(e,8,!0,5),n()}).catch(function(e){return r(e)}))})},t.prototype.unpublish=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())throw t.notConnectedError();var i=e.stream;return i.connection?i.connection!==t.connection?r(Error("The associated Connection object of this Publisher is not your local Connection.  Only moderators can force unpublish on remote Streams via 'forceUnpublish' method")):void(k.info("Unpublishing local media ("+i.connection.connectionId+")"),t.openvidu.sendRequest("unpublishVideo",function(t,o){if(t)return r(t);k.info("Media unpublished correctly"),i.disposeWebRtcPeer(),i.connection.stream==i&&delete i.connection.stream;var s=new b.StreamEvent(!0,e,"streamDestroyed",e.stream,"unpublish");return e.emitEvent("streamDestroyed",[s]),s.callDefaultBehavior(),n()})):r(Error("The associated Connection object of this Publisher is null"))})},t.prototype.forceDisconnect=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());k.info("Forcing disconnect for connection "+e.connectionId),t.openvidu.sendRequest("forceDisconnect",{connectionId:e.connectionId},function(t,i){return t?(k.error("Error forcing disconnect for Connection "+e.connectionId,t),401===t.code)?r(new _.OpenViduError(_.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force a disconnection")):r(t):(k.info("Forcing disconnect correctly for Connection "+e.connectionId),n())})})},t.prototype.forceUnpublish=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());k.info("Forcing unpublish for stream "+e.streamId),t.openvidu.sendRequest("forceUnpublish",{streamId:e.streamId},function(t,i){return t?(k.error("Error forcing unpublish for Stream "+e.streamId,t),401===t.code)?r(new _.OpenViduError(_.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force an unpublishing")):r(t):(k.info("Forcing unpublish correctly for Stream "+e.streamId),n())})})},t.prototype.signal=function(e){var t=this;return new Promise(function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());var i={};if(e.to&&e.to.length>0){var o=[];e.to.forEach(function(e){e.connectionId&&o.push(e.connectionId)}),i.to=o}else i.to=[];i.data=e.data?e.data:"";var s=e.type?e.type:"signal";s&&"signal:"!==s.substring(0,7)&&(s="signal:"+s),i.type=s,t.openvidu.sendRequest("sendMessage",{message:JSON.stringify(i)},function(e,t){return e?r(e):n()})})},t.prototype.subscribeToSpeechToText=function(e,t){var n=this;return new Promise(function(r,i){n.openvidu.sendRequest("subscribeToSpeechToText",{connectionId:e.connection.connectionId,lang:t},function(e,t){return e?i(e):r()})})},t.prototype.unsubscribeFromSpeechToText=function(e){var t=this;return new Promise(function(n,r){t.openvidu.sendRequest("unsubscribeFromSpeechToText",{connectionId:e.connection.connectionId},function(e,t){return e?r(e):n()})})},t.prototype.on=function(t,n){var r,i,o,s;return e.prototype.onAux.call(this,t,"Event '"+t+"' triggered by 'Session'",n),"publisherStartSpeaking"===t&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableHarkSpeakingEvent()}),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.hasAudio)&&this.connection.stream.enableHarkSpeakingEvent()),"publisherStopSpeaking"===t&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableHarkStoppedSpeakingEvent()}),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.hasAudio)&&this.connection.stream.enableHarkStoppedSpeakingEvent()),this},t.prototype.once=function(t,n){var r,i,o,s;return e.prototype.onceAux.call(this,t,"Event '"+t+"' triggered once by 'Session'",n),"publisherStartSpeaking"===t&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableOnceHarkSpeakingEvent()}),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.hasAudio)&&this.connection.stream.enableOnceHarkSpeakingEvent()),"publisherStopSpeaking"===t&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableOnceHarkStoppedSpeakingEvent()}),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.hasAudio)&&this.connection.stream.enableOnceHarkStoppedSpeakingEvent()),this},t.prototype.off=function(t,n){var r,i,o,s,a=this;return e.prototype.offAux.call(this,t,n),"publisherStartSpeaking"===t&&!this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1)&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.streamManager)&&!a.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,e.stream.streamManager)&&e.stream.disableHarkSpeakingEvent(!1)}),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.streamManager)&&!this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.connection.stream.streamManager)&&this.connection.stream.disableHarkSpeakingEvent(!1)),"publisherStopSpeaking"===t&&!this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1)&&(this.remoteConnections.forEach(function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.streamManager)&&!a.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,e.stream.streamManager)&&e.stream.disableHarkStoppedSpeakingEvent(!1)}),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.streamManager)&&!this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.connection.stream.streamManager)&&this.connection.stream.disableHarkStoppedSpeakingEvent(!1)),this},t.prototype.onParticipantJoined=function(e){var t=this;this.getConnection(e.id,"").then(function(e){k.warn("Connection "+e.connectionId+" already exists in connections list")}).catch(function(n){var r=new c.Connection(t,e);t.remoteConnections.set(e.id,r),t.ee.emitEvent("connectionCreated",[new h.ConnectionEvent(!1,t,"connectionCreated",r,"")])})},t.prototype.onParticipantLeft=function(e){var t=this;this.getRemoteConnection(e.connectionId,"onParticipantLeft").then(function(n){if(n.stream){var r=n.stream,i=new b.StreamEvent(!0,t,"streamDestroyed",r,e.reason);t.ee.emitEvent("streamDestroyed",[i]),i.callDefaultBehavior(),t.remoteStreamsCreated.delete(r.streamId)}n.dispose(),t.remoteConnections.delete(n.connectionId),t.ee.emitEvent("connectionDestroyed",[new h.ConnectionEvent(!1,t,"connectionDestroyed",n,e.reason)])}).catch(function(e){k.error(e)})},t.prototype.onParticipantPublished=function(e){var t,n=this,r=function(e){n.remoteConnections.set(e.connectionId,e),n.remoteStreamsCreated.get(e.stream.streamId)||n.ee.emitEvent("streamCreated",[new b.StreamEvent(!1,n,"streamCreated",e.stream,"")]),n.remoteStreamsCreated.set(e.stream.streamId,!0)};this.getRemoteConnection(e.id,"onParticipantPublished").then(function(n){t=n,e.metadata=n.data,t.remoteOptions=e,t.initRemoteStreams(e.streams),r(t)}).catch(function(i){r(t=new c.Connection(n,e))})},t.prototype.onParticipantUnpublished=function(e){var t=this;e.connectionId===this.connection.connectionId?this.stopPublisherStream(e.reason):this.getRemoteConnection(e.connectionId,"onParticipantUnpublished").then(function(n){var r=new b.StreamEvent(!0,t,"streamDestroyed",n.stream,e.reason);if(t.ee.emitEvent("streamDestroyed",[r]),r.callDefaultBehavior(),null!=n.stream){var i=n.stream.streamId;t.remoteStreamsCreated.delete(i),n.removeStream()}}).catch(function(e){k.error(e)})},t.prototype.onParticipantEvicted=function(e){e.connectionId===this.connection.connectionId&&this.sessionId&&!this.connection.disposed&&this.leave(!0,e.reason)},t.prototype.onNewMessage=function(e){var t=this;k.info("New signal: "+JSON.stringify(e));var n=e.type?e.type.replace(/^(signal:)/,""):void 0;e.from?this.getConnection(e.from,"Connection '"+e.from+"' unknown when 'onNewMessage'. Existing remote connections: "+JSON.stringify(this.remoteConnections.keys())+". Existing local connection: "+this.connection.connectionId).then(function(r){t.ee.emitEvent("signal",[new v.SignalEvent(t,n,e.data,r)]),e.type&&"signal"!==e.type&&t.ee.emitEvent(e.type,[new v.SignalEvent(t,n,e.data,r)])}).catch(function(e){k.error(e)}):(this.ee.emitEvent("signal",[new v.SignalEvent(this,n,e.data,void 0)]),e.type&&"signal"!==e.type&&this.ee.emitEvent(e.type,[new v.SignalEvent(this,n,e.data,void 0)]))},t.prototype.onStreamPropertyChanged=function(e){var t=this,n=function(n){var r,i;if(n.stream&&n.stream.streamId===e.streamId){var o=n.stream,s=void 0;switch(e.property){case"audioActive":s=o.audioActive,e.newValue="true"===e.newValue,o.audioActive=e.newValue;break;case"videoActive":s=o.videoActive,e.newValue="true"===e.newValue,o.videoActive=e.newValue;var a=null===(i=null===(r=null==o?void 0:o.getMediaStream())||void 0===r?void 0:r.getVideoTracks())||void 0===i?void 0:i[0];a&&!a.enabled&&o.videoActive&&(a.enabled=!0);break;case"videoTrack":case"audioTrack":e.newValue=JSON.parse(e.newValue);break;case"videoDimensions":s=o.videoDimensions,e.newValue=JSON.parse(JSON.parse(e.newValue)),o.videoDimensions=e.newValue;break;case"filter":s=o.filter,e.newValue=Object.keys(e.newValue).length>0?e.newValue:void 0,void 0!==e.newValue?(o.filter=new l.Filter(e.newValue.type,e.newValue.options),o.filter.stream=o,e.newValue.lastExecMethod&&(o.filter.lastExecMethod=e.newValue.lastExecMethod)):delete o.filter,e.newValue=o.filter}t.ee.emitEvent("streamPropertyChanged",[new E.StreamPropertyChangedEvent(t,o,e.property,e.newValue,s,e.reason)]),o.streamManager&&o.streamManager.emitEvent("streamPropertyChanged",[new E.StreamPropertyChangedEvent(o.streamManager,o,e.property,e.newValue,s,e.reason)])}else k.error("No stream with streamId '"+e.streamId+"' found for connection '"+e.connectionId+"' on 'streamPropertyChanged' event")};e.connectionId===this.connection.connectionId?n(this.connection):this.getRemoteConnection(e.connectionId,"onStreamPropertyChanged").then(function(e){n(e)}).catch(function(e){k.error(e)})},t.prototype.onConnectionPropertyChanged=function(e){var t;switch(e.property){case"role":t=this.connection.role.slice(),this.connection.role=e.newValue,this.connection.localOptions.role=e.newValue;break;case"record":t=this.connection.record,e.newValue="true"===e.newValue,this.connection.record=e.newValue,this.connection.localOptions.record=e.newValue}this.ee.emitEvent("connectionPropertyChanged",[new y.ConnectionPropertyChangedEvent(this,this.connection,e.property,e.newValue,t)])},t.prototype.onNetworkQualityLevelChangedChanged=function(e){var t=this;e.connectionId===this.connection.connectionId?this.ee.emitEvent("networkQualityLevelChanged",[new S.NetworkQualityLevelChangedEvent(this,e.newValue,e.oldValue,this.connection)]):this.getConnection(e.connectionId,"Connection not found for connectionId "+e.connectionId).then(function(n){t.ee.emitEvent("networkQualityLevelChanged",[new S.NetworkQualityLevelChangedEvent(t,e.newValue,e.oldValue,n)])}).catch(function(e){k.error(e)})},t.prototype.recvIceCandidate=function(e){var t={candidate:e.candidate,sdpMLineIndex:e.sdpMLineIndex,sdpMid:e.sdpMid},n=new RTCIceCandidate(t);this.getConnection(e.senderConnectionId,"Connection not found for connectionId "+e.senderConnectionId+" owning endpoint "+e.endpointName+". Ice candidate will be ignored: "+n).then(function(t){var r=t.stream;r.getWebRtcPeer().addIceCandidate(n).catch(function(t){k.error("Error adding candidate for "+r.streamId+" stream of endpoint "+e.endpointName+": "+t)})}).catch(function(e){k.error(e)})},t.prototype.onSessionClosed=function(e){k.info("Session closed: "+JSON.stringify(e));var t=e.sessionId;void 0!==t?this.ee.emitEvent("session-closed",[{session:t}]):k.warn("Session undefined on session closed",e)},t.prototype.onLostConnection=function(e){k.warn("Lost connection in Session "+this.sessionId),this.sessionId&&this.connection&&!this.connection.disposed&&this.leave(!0,e)},t.prototype.onRecoveredConnection=function(){k.info("Recovered connection in Session "+this.sessionId),this.reconnectBrokenStreams(),this.ee.emitEvent("reconnected",[])},t.prototype.onMediaError=function(e){k.error("Media error: "+JSON.stringify(e));var t=e.error;t?this.ee.emitEvent("error-media",[{error:t}]):k.warn("Received undefined media error:",e)},t.prototype.onRecordingStarted=function(e){this.ee.emitEvent("recordingStarted",[new f.RecordingEvent(this,"recordingStarted",e.id,e.name)])},t.prototype.onRecordingStopped=function(e){this.ee.emitEvent("recordingStopped",[new f.RecordingEvent(this,"recordingStopped",e.id,e.name,e.reason)])},t.prototype.onBroadcastStarted=function(){this.ee.emitEvent("broadcastStarted",[])},t.prototype.onBroadcastStopped=function(){this.ee.emitEvent("broadcastStopped",[])},t.prototype.onFilterEventDispatched=function(e){var t=this,n=e.connectionId;this.getConnection(n,"No connection found for connectionId "+n).then(function(n){k.info('Filter event of type "'.concat(e.eventType,'" dispatched'));var r=n.stream;if(!r||!r.filter)return k.error('Filter event of type "'.concat(e.eventType,'" dispatched for stream ').concat(r.streamId," but there is no ").concat(r?"filter":"stream"," defined"));var i=r.filter.handlers.get(e.eventType);if(i&&"function"==typeof i)i.call(t,new p.FilterEvent(r.filter,e.eventType,e.data));else{var o=Array.from(r.filter.handlers.keys());return k.error('Filter event of type "'.concat(e.eventType,'" not handled or not a function! Active filter events: ').concat(o.join(",")))}})},t.prototype.onForciblyReconnectSubscriber=function(e){var t=this;return new Promise(function(n,r){t.getRemoteConnection(e.connectionId,"onForciblyReconnectSubscriber").then(function(i){if(i.stream&&i.stream.streamId===e.streamId){var o=i.stream;if(o.setupReconnectionEventEmitter(n,r)){if(null!=o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent)return o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=e,r("Ongoing forced subscriber reconnection");o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent=e;var s=function(){var e=o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent;delete o.reconnectionEventEmitter.onForciblyReconnectSubscriberLastEvent,t.onForciblyReconnectSubscriber(e)};return o.reconnectionEventEmitter.once("success",function(){s()}),void o.reconnectionEventEmitter.once("error",function(){s()})}o.completeWebRtcPeerReceive(!0,!0,e.sdpOffer).then(function(){return o.finalResolveForSubscription(!0,n)}).catch(function(t){return o.finalRejectForSubscription(!0,"Error while forcibly reconnecting remote stream ".concat(e.streamId,": ").concat(t.toString()),r)})}else{var a="No stream with streamId '"+e.streamId+"' found for connection '"+e.connectionId+"' on 'streamPropertyChanged' event";return k.error(a),r(a)}}).catch(function(e){return k.error(e),r(e)})})},t.prototype.reconnectBrokenStreams=function(){k.info("Re-establishing media connections...");var e=!1;this.connection.stream&&this.connection.stream.streamIceConnectionStateBroken()&&(k.warn("Re-establishing Publisher "+this.connection.stream.streamId),this.connection.stream.initWebRtcPeerSend(!0),e=!0),this.remoteConnections.forEach(function(t){t.stream&&t.stream.streamIceConnectionStateBroken()&&(k.warn("Re-establishing Subscriber "+t.stream.streamId),t.stream.initWebRtcPeerReceive(!0),e=!0)}),e||k.info("There were no media streams in need of a reconnection")},t.prototype.onSpeechToTextMessage=function(e){return s(this,void 0,void 0,function(){var t,n;return a(this,function(r){switch(r.label){case 0:return[4,this.getConnection(e.connectionId,"No connection found for connectionId "+e.connectionId)];case 1:return t=r.sent(),n=new g.SpeechToTextEvent(this,t,e.text,e.reason.toLowerCase(),e.raw,e.lang),this.ee.emitEvent("speechToTextMessage",[n]),[2]}})})},t.prototype.onSpeechToTextDisconnected=function(e){return s(this,void 0,void 0,function(){return a(this,function(t){return this.emitEvent("exception",[new R.ExceptionEvent(this,R.ExceptionEventName.SPEECH_TO_TEXT_DISCONNECTED,this,e.message)]),[2]})})},t.prototype.emitEvent=function(e,t){this.ee.emitEvent(e,t)},t.prototype.leave=function(e,t){var n=this;if(e=!!e,k.info("Leaving Session (forced="+e+")"),this.stopVideoDataIntervals(),this.connection){if(this.connection.disposed||e?this.openvidu.closeWs():this.openvidu.sendRequest("leaveRoom",function(e,t){e&&k.error("leaveRoom error: ".concat(JSON.stringify(e))),n.openvidu.closeWs()}),this.stopPublisherStream(t),!this.connection.disposed){var r=new m.SessionDisconnectedEvent(this,t);this.ee.emitEvent("sessionDisconnected",[r]),r.callDefaultBehavior()}}else k.warn("You were not connected to the session "+this.sessionId);k.flush()},t.prototype.initializeParams=function(e){return{token:e||"",session:this.sessionId,platform:i.getDescription()?i.getDescription():"unknown",sdkVersion:this.openvidu.libraryVersion,metadata:this.options.metadata?this.options.metadata:"",secret:this.openvidu.getSecret(),recorder:this.openvidu.getRecorder(),stt:this.openvidu.getStt()}},t.prototype.sendVideoData=function(e,t,n,r){var o,c,l=this;if(void 0===t&&(t=1),void 0===n&&(n=!1),void 0===r&&(r=1),i.isChromeBrowser()||i.isChromeMobileBrowser()||i.isOperaBrowser()||i.isOperaMobileBrowser()||i.isEdgeBrowser()||i.isEdgeMobileBrowser()||i.isElectron()||i.isSafariBrowser()&&!i.isIonicIos()||i.isAndroidBrowser()||i.isSamsungBrowser()||i.isIonicAndroid()||i.isIOSWithSafari()){var u=function(){return s(l,void 0,void 0,function(){var t,n,r;return a(this,function(i){switch(i.label){case 0:if("connected"!==(t=e.stream.getRTCPeerConnection()).connectionState)return[3,2];return[4,t.getStats()];case 1:n=i.sent(),r=[],n.forEach(function(e){"frameWidth"in e&&"frameHeight"in e&&0===r.length&&r.push(e)}),r.length>0&&this.openvidu.sendRequest("videoData",{height:r[0].frameHeight,width:r[0].frameWidth,videoActive:null!=e.stream.videoActive&&e.stream.videoActive,audioActive:null!=e.stream.audioActive&&e.stream.audioActive},function(e,t){e&&k.error("Error sending 'videoData' event",e)}),i.label=2;case 2:return[2]}})})};if(n){var d=1;this.videoDataInterval=setInterval(function(){d<r?(d++,u()):clearInterval(l.videoDataInterval)},1e3*t)}else this.videoDataTimeout=setTimeout(u,1e3*t)}else i.isFirefoxBrowser()||i.isFirefoxMobileBrowser()||i.isIonicIos()||i.isReactNative()?this.openvidu.sendRequest("videoData",{height:(null===(o=e.stream.videoDimensions)||void 0===o?void 0:o.height)||0,width:(null===(c=e.stream.videoDimensions)||void 0===c?void 0:c.width)||0,videoActive:null!=e.stream.videoActive&&e.stream.videoActive,audioActive:null!=e.stream.audioActive&&e.stream.audioActive},function(e,t){e&&k.error("Error sending 'videoData' event",e)}):k.error("Browser "+i.getName()+" (version "+i.getVersion()+") for "+i.getFamily()+" is not supported in OpenVidu for Network Quality")},t.prototype.sessionConnected=function(){return null!=this.connection},t.prototype.notConnectedError=function(){return new _.OpenViduError(_.OpenViduErrorName.OPENVIDU_NOT_CONNECTED,"There is no connection to the session. Method 'Session.connect' must be successfully completed first")},t.prototype.anySpeechEventListenerEnabled=function(e,t,n){var r=this.ee.getListeners(e);if(t&&(r=r.filter(function(e){return e.once})),r.length>0)return!0;var i=0;if(n){var o=n.ee.getListeners(e);t&&(o=o.filter(function(e){return e.once})),i=o.length}return i>0},t.prototype.getTokenParams=function(e){var t=e.match(/^(wss?)\:\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);if(t){var n={protocol:t[1],host:t[2],hostname:t[3],port:t[4],pathname:t[5],search:t[6],hash:t[7]},r=decodeURI(e.split("?")[1]).split("&").map(function(e){return e.split("=")}).reduce(function(e,t){var n=t[0],r=t[1];return e[n]=r,e},{});return{sessionId:r.sessionId,secret:r.secret,recorder:r.recorder,stt:r.stt,webrtcStatsInterval:r.webrtcStatsInterval,sendBrowserLogs:r.sendBrowserLogs,edition:r.edition,wsUri:n.protocol+"://"+n.host+"/openvidu",httpUri:"https://"+n.host}}throw Error('Token not valid: "'.concat(e,'"'))},t.prototype.connectAux=function(e){var t=this;return new Promise(function(n,r){t.openvidu.startWs(function(i){if(i)return r(i);var o=t.initializeParams(e);t.openvidu.sendRequest("joinRoom",o,function(i,o){if(i)return r(i);t.processJoinRoomResponse(o,e),t.connection=new c.Connection(t,o);var s={connections:[],streams:[]};return o.value.forEach(function(e){var n=new c.Connection(t,e);t.remoteConnections.set(n.connectionId,n),s.connections.push(n),n.stream&&(t.remoteStreamsCreated.set(n.stream.streamId,!0),s.streams.push(n.stream))}),t.ee.emitEvent("connectionCreated",[new h.ConnectionEvent(!1,t,"connectionCreated",t.connection,"")]),s.connections.forEach(function(e){t.ee.emitEvent("connectionCreated",[new h.ConnectionEvent(!1,t,"connectionCreated",e,"")])}),s.streams.forEach(function(e){t.ee.emitEvent("streamCreated",[new b.StreamEvent(!1,t,"streamCreated",e,"")])}),o.recordingId&&o.recordingName&&t.ee.emitEvent("recordingStarted",[new f.RecordingEvent(t,"recordingStarted",o.recordingId,o.recordingName)]),n()})})})},t.prototype.stopPublisherStream=function(e){this.connection.stream&&(this.connection.stream.disposeWebRtcPeer(),this.connection.stream.isLocalStreamPublished&&this.connection.stream.ee.emitEvent("local-stream-destroyed",[e]))},t.prototype.stopVideoDataIntervals=function(){clearInterval(this.videoDataInterval),clearTimeout(this.videoDataTimeout)},t.prototype.stringClientMetadata=function(e){return"string"!=typeof e?JSON.stringify(e):e},t.prototype.getConnection=function(e,t){var n=this;return new Promise(function(r,i){var o=n.remoteConnections.get(e);return o?r(o):n.connection.connectionId===e?r(n.connection):i(new _.OpenViduError(_.OpenViduErrorName.GENERIC_ERROR,t))})},t.prototype.getRemoteConnection=function(e,t){var n=this;return new Promise(function(r,i){var o=n.remoteConnections.get(e);if(o)return r(o);var s="Remote connection "+e+" unknown when '"+t+"'. Existing remote connections: "+JSON.stringify(n.remoteConnections.keys());return i(new _.OpenViduError(_.OpenViduErrorName.GENERIC_ERROR,s))})},t.prototype.processToken=function(e){var t=this.getTokenParams(e);this.sessionId=t.sessionId,t.secret&&(this.openvidu.secret=t.secret),t.recorder&&(this.openvidu.recorder=!0),t.stt&&(this.openvidu.stt=!0),t.webrtcStatsInterval&&(this.openvidu.webrtcStatsInterval=t.webrtcStatsInterval),t.sendBrowserLogs&&(this.openvidu.sendBrowserLogs=t.sendBrowserLogs),this.openvidu.isAtLeastPro="pro"===t.edition||"enterprise"===t.edition,this.openvidu.isEnterprise="enterprise"===t.edition,this.openvidu.wsUri=t.wsUri,this.openvidu.httpUri=t.httpUri},t.prototype.processJoinRoomResponse=function(e,t){if(this.sessionId=e.session,null!=e.customIceServers&&e.customIceServers.length>0){this.openvidu.iceServers=[];for(var n=0,r=e.customIceServers;n<r.length;n++){var i=r[n],o={urls:[i.url]};k.log("STUN/TURN server IP: "+i.url),null!=i.username&&null!=i.credential&&(o.username=i.username,o.credential=i.credential,k.log("TURN credentials ["+i.username+":"+i.credential+"]")),this.openvidu.iceServers.push(o)}}this.openvidu.role=e.role,this.openvidu.finalUserId=e.finalUserId,this.openvidu.mediaServer=e.mediaServer,this.openvidu.videoSimulcast=e.videoSimulcast,this.capabilities={subscribe:!0,publish:"SUBSCRIBER"!==this.openvidu.role,forceUnpublish:"MODERATOR"===this.openvidu.role,forceDisconnect:"MODERATOR"===this.openvidu.role},k.info("openvidu-server version: "+e.version),null!=e.life&&(this.openvidu.life=e.life);var s=I(e.version)-I(this.openvidu.libraryVersion);C(e.version)===C(this.openvidu.libraryVersion)&&(0==s||1==s)?1==s&&k.warn("openvidu-browser version ".concat(this.openvidu.libraryVersion," does not match openvidu-server version ").concat(e.version,". ")+"These versions are still compatible with each other, but openvidu-browser version must be updated as soon as possible to ".concat(C(e.version),".").concat(I(e.version),".x. ")+"This client using openvidu-browser ".concat(this.openvidu.libraryVersion," will become incompatible with the next release of openvidu-server")):k.error("openvidu-browser (".concat(this.openvidu.libraryVersion,") and openvidu-server (").concat(e.version,") versions are incompatible. ")+"Errors are likely to occur. openvidu-browser SDK is only compatible with the same version or the immediately following minor version of an OpenVidu deployment"),x.OpenViduLogger.configureJSNLog(this.openvidu,t),this.token=t},t}(d.EventDispatcher);t.Session=N},67883:function(e,t,n){"use strict";var r,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Stream=void 0;var s=n(23364),a=n(5187),c=n(11645),l=n(46749),u=n(69532),d=n(58407),h=n(92967),p=n(19988),f=n(35019),m=n(98752),v=n(77654),g=n(34957),b=n(88996),E=n(50062),y=n(51594),S=v.OpenViduLogger.getInstance(),_=function(){function e(e,t){var n=this;this.isSubscribeToRemote=!1,this.isLocalStreamReadyToPublish=!1,this.isLocalStreamPublished=!1,this.publishedOnce=!1,this.harkSpeakingEnabled=!1,this.harkSpeakingEnabledOnce=!1,this.harkStoppedSpeakingEnabled=!1,this.harkStoppedSpeakingEnabledOnce=!1,this.harkVolumeChangeEnabled=!1,this.harkVolumeChangeEnabledOnce=!1,this.ee=new y,r=g.PlatformUtils.getInstance(),this.session=e,t.hasOwnProperty("id")?(this.inboundStreamOpts=t,this.streamId=this.inboundStreamOpts.id,this.creationTime=this.inboundStreamOpts.createdAt,this.hasAudio=this.inboundStreamOpts.hasAudio,this.hasVideo=this.inboundStreamOpts.hasVideo,this.hasAudio&&(this.audioActive=this.inboundStreamOpts.audioActive),this.hasVideo&&(this.videoActive=this.inboundStreamOpts.videoActive,this.typeOfVideo=this.inboundStreamOpts.typeOfVideo?this.inboundStreamOpts.typeOfVideo:void 0,this.frameRate=-1===this.inboundStreamOpts.frameRate?void 0:this.inboundStreamOpts.frameRate,this.videoDimensions=this.inboundStreamOpts.videoDimensions),this.inboundStreamOpts.filter&&Object.keys(this.inboundStreamOpts.filter).length>0&&(this.inboundStreamOpts.filter.lastExecMethod&&0===Object.keys(this.inboundStreamOpts.filter.lastExecMethod).length&&delete this.inboundStreamOpts.filter.lastExecMethod,this.filter=this.inboundStreamOpts.filter)):(this.outboundStreamOpts=t,this.hasAudio=this.isSendAudio(),this.hasVideo=this.isSendVideo(),this.hasAudio&&(this.audioActive=!!this.outboundStreamOpts.publisherProperties.publishAudio),this.hasVideo&&(this.videoActive=!!this.outboundStreamOpts.publisherProperties.publishVideo,this.frameRate=this.outboundStreamOpts.publisherProperties.frameRate,"undefined"!=typeof MediaStreamTrack&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?this.typeOfVideo=m.TypeOfVideo.CUSTOM:this.typeOfVideo=this.isSendScreen()?m.TypeOfVideo.SCREEN:m.TypeOfVideo.CAMERA),this.outboundStreamOpts.publisherProperties.filter&&(this.filter=this.outboundStreamOpts.publisherProperties.filter)),this.ee.on("mediastream-updated",function(){var e;n.streamManager.updateMediaStream(n.mediaStream),S.debug("Video srcObject ["+(null===(e=n.mediaStream)||void 0===e?void 0:e.id)+"] updated in stream ["+n.streamId+"]")})}return e.prototype.reconnect=function(){return this.reconnectStream("API")},e.prototype.applyFilter=function(e,t){var n=this;return new Promise(function(r,a){return i(n,void 0,void 0,function(){var n,c,l,u,d,h,m=this;return o(this,function(v){if(this.filter)return[2,a(new f.OpenViduError(f.OpenViduErrorName.GENERIC_ERROR,"There is already a filter applied to Stream "+this.streamId))];if(n=function(n,i){if(n)return(S.error("Error applying filter for Stream "+m.streamId,n),401===n.code)?a(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to apply a filter")):a(n);S.info("Filter successfully applied on Stream "+m.streamId);var o=m.filter;return m.filter=new s.Filter(e,t),m.filter.stream=m,i&&(m.session.emitEvent("streamPropertyChanged",[new p.StreamPropertyChangedEvent(m.session,m,"filter",m.filter,o,"applyFilter")]),m.streamManager.emitEvent("streamPropertyChanged",[new p.StreamPropertyChangedEvent(m.streamManager,m,"filter",m.filter,o,"applyFilter")])),r(m.filter)},e.startsWith("VB:")){if(!this.hasVideo)return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"The Virtual Background filter requires a video track to be applied"))];if(!this.mediaStream||0===this.streamManager.videos.length)return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"The StreamManager requires some video element to be attached to it in order to apply a Virtual Background filter"))];if(!(c=this.session.token?this.session.token:t.token))return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,'Virtual Background requires the client to be connected to a Session or to have a "token" property available in "options" parameter with a valid OpenVidu token'))];if("pro"!==(l=this.session.getTokenParams(c)).edition&&"enterprise"!==l.edition)return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"OpenVidu Virtual Background API is available from OpenVidu Pro edition onwards"))];c=encodeURIComponent(btoa(c)),S.info("Applying Virtual Background to stream "+this.streamId),u=function(){return i(m,void 0,void 0,function(){var r,i,s,a,u,d;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,8,,9]),r=this.streamId+"_"+(0,b.v4)(),i=this.mediaStream.clone(),(s=this.streamManager.videos[0].video.cloneNode(!1)).id=VirtualBackground.VirtualBackground.SOURCE_VIDEO_PREFIX+r,s.srcObject=i,s.muted=!0,this.virtualBackgroundSourceElements={videoClone:s,mediaStreamClone:i},VirtualBackground.VirtualBackground.hideHtmlElement(s,!1),VirtualBackground.VirtualBackground.appendHtmlElementToHiddenContainer(s,r),[4,s.play()];case 1:switch(o.sent(),a=new VirtualBackground.VirtualBackground({id:r,openviduServerUrl:new URL(l.httpUri),openviduToken:c,inputVideo:s,inputResolution:"160x96",outputFramerate:24}),u=void 0,e){case"VB:blur":return[3,2];case"VB:image":return[3,4]}return[3,6];case 2:return[4,a.backgroundBlur(t)];case 3:case 5:return u=o.sent(),[3,7];case 4:return[4,a.backgroundImage(t)];case 6:throw Error("Unknown Virtual Background filter: "+e);case 7:return this.virtualBackgroundSinkElements={VB:a,video:u},s.style.display="none",this.streamManager.remote?this.streamManager.replaceTrackInMediaStream(this.virtualBackgroundSinkElements.video.srcObject.getVideoTracks()[0],!1):this.streamManager.replaceTrackAux(this.virtualBackgroundSinkElements.video.srcObject.getVideoTracks()[0],!1),n(void 0,!1),[3,9];case 8:return(d=o.sent()).name===f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR?n(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,d.message),!1):n(d,!1),[3,9];case 9:return[2]}})})},"undefined"==typeof VirtualBackground?((d=document.createElement("script")).type="text/javascript",d.src=l.httpUri+"/openvidu/virtual-background/openvidu-virtual-background.js?token="+c,d.onload=function(){return i(m,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,u()];case 1:return n.sent(),r(new s.Filter(e,t)),[3,3];case 2:return a(n.sent()),[3,3];case 3:return[2]}})})},document.body.appendChild(d)):u().then(function(){return r(new s.Filter(e,t))}).catch(function(e){return a(e)})}else{if(!this.session.sessionConnected())return[2,a(this.session.notConnectedError())];S.info("Applying server filter to stream "+this.streamId),"string"!=typeof(h=t=null!=t?t:{})&&(h=JSON.stringify(h)),this.session.openvidu.sendRequest("applyFilter",{streamId:this.streamId,type:e,options:h},function(e,t){n(e,!0)})}return[2]})})})},e.prototype.removeFilter=function(){return i(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.removeFilterAux(!1)];case 1:return[2,e.sent()]}})})},e.prototype.getRTCPeerConnection=function(){return this.webRtcPeer.pc},e.prototype.getMediaStream=function(){return this.mediaStream},e.prototype.removeFilterAux=function(e){var t=this;return new Promise(function(n,r){return i(t,void 0,void 0,function(){var t,i,s,a,c=this;return o(this,function(o){switch(o.label){case 0:if(t=function(e,t){if(e)return(delete c.filter,S.error("Error removing filter for Stream "+c.streamId,e),401===e.code)?r(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to remove a filter")):r(e);S.info("Filter successfully removed from Stream "+c.streamId);var i=c.filter;return delete c.filter,t&&(c.session.emitEvent("streamPropertyChanged",[new p.StreamPropertyChangedEvent(c.session,c,"filter",c.filter,i,"applyFilter")]),c.streamManager.emitEvent("streamPropertyChanged",[new p.StreamPropertyChangedEvent(c.streamManager,c,"filter",c.filter,i,"applyFilter")])),n()},!this.filter)return[3,11];if(!(null===(a=this.filter)||void 0===a?void 0:a.type.startsWith("VB:")))return[3,9];o.label=1;case 1:if(o.trys.push([1,7,,8]),i=this.virtualBackgroundSourceElements.mediaStreamClone,e)return[3,5];if(!this.streamManager.remote)return[3,2];return this.streamManager.replaceTrackInMediaStream(i.getVideoTracks()[0],!1),[3,4];case 2:return[4,this.streamManager.replaceTrackAux(i.getVideoTracks()[0],!1)];case 3:o.sent(),o.label=4;case 4:return[3,6];case 5:i.getTracks().forEach(function(e){return e.stop()}),o.label=6;case 6:return this.virtualBackgroundSinkElements.VB.cleanUp(),delete this.virtualBackgroundSinkElements,delete this.virtualBackgroundSourceElements,[2,t(void 0,!1)];case 7:return s=o.sent(),[2,t(s,!1)];case 8:return[3,10];case 9:if(!this.session.sessionConnected())return[2,r(this.session.notConnectedError())];S.info("Removing filter of stream "+this.streamId),this.session.openvidu.sendRequest("removeFilter",{streamId:this.streamId},function(e,n){return t(e,!0)}),o.label=10;case 10:return[3,12];case 11:return[2,r(new f.OpenViduError(f.OpenViduErrorName.GENERIC_ERROR,"Stream "+this.streamId+" has no filter applied"))];case 12:return[2]}})})})},e.prototype.setMediaStream=function(e){this.mediaStream=e},e.prototype.updateMediaStreamInVideos=function(){this.ee.emitEvent("mediastream-updated",[])},e.prototype.getWebRtcPeer=function(){return this.webRtcPeer},e.prototype.subscribeToMyRemote=function(e){this.isSubscribeToRemote=e},e.prototype.setOutboundStreamOptions=function(e){this.outboundStreamOpts=e},e.prototype.subscribe=function(){var e=this;return new Promise(function(t,n){e.initWebRtcPeerReceive(!1).then(function(){return t()}).catch(function(e){return n(e)})})},e.prototype.publish=function(){var e=this;return new Promise(function(t,n){e.isLocalStreamReadyToPublish?e.initWebRtcPeerSend(!1).then(function(){return t()}).catch(function(e){return n(e)}):e.ee.once("stream-ready-to-publish",function(){e.publish().then(function(){return t()}).catch(function(e){return n(e)})})})},e.prototype.disposeWebRtcPeer=function(){var e;this.webRtcPeer&&(this.webRtcPeer.dispose(),e=this.webRtcPeer.getId()),this.stopWebRtcStats(),S.info((this.outboundStreamOpts?"Outbound ":"Inbound ")+"RTCPeerConnection with id ["+e+"] from 'Stream' with id ["+this.streamId+"] is now closed")},e.prototype.disposeMediaStream=function(){return i(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:if(!(this.filter&&this.filter.type.startsWith("VB:")))return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.removeFilterAux(!0)];case 2:return t.sent(),console.debug("Success removing Virtual Background filter for stream ".concat(this.streamId)),[3,4];case 3:return e=t.sent(),console.error("Error removing Virtual Background filter for stream ".concat(this.streamId),e),[3,4];case 4:return this.mediaStream&&(this.mediaStream.getAudioTracks().forEach(function(e){e.stop()}),this.mediaStream.getVideoTracks().forEach(function(e){e.stop()}),delete this.mediaStream),this.localMediaStreamWhenSubscribedToRemote&&(this.localMediaStreamWhenSubscribedToRemote.getAudioTracks().forEach(function(e){e.stop()}),this.localMediaStreamWhenSubscribedToRemote.getVideoTracks().forEach(function(e){e.stop()}),delete this.localMediaStreamWhenSubscribedToRemote),this.speechEvent&&(this.speechEvent.stop&&this.speechEvent.stop(),delete this.speechEvent),S.info((this.outboundStreamOpts?"Local ":"Remote ")+"MediaStream from 'Stream' with id ["+this.streamId+"] is now disposed"),[2]}})})},e.prototype.displayMyRemote=function(){return this.isSubscribeToRemote},e.prototype.isSendAudio=function(){return!!this.outboundStreamOpts&&null!==this.outboundStreamOpts.publisherProperties.audioSource&&!1!==this.outboundStreamOpts.publisherProperties.audioSource},e.prototype.isSendVideo=function(){return!!this.outboundStreamOpts&&null!==this.outboundStreamOpts.publisherProperties.videoSource&&!1!==this.outboundStreamOpts.publisherProperties.videoSource},e.prototype.isSendScreen=function(){var e=!1;if("undefined"!=typeof MediaStreamTrack&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack){var t=this.outboundStreamOpts.publisherProperties.videoSource.getSettings();t.displaySurface&&(e=["monitor","window","browser"].includes(t.displaySurface))}return!e&&r.isElectron()&&(e="string"==typeof this.outboundStreamOpts.publisherProperties.videoSource&&this.outboundStreamOpts.publisherProperties.videoSource.startsWith("screen:")),e||(e="screen"===this.outboundStreamOpts.publisherProperties.videoSource),!!this.outboundStreamOpts&&e},e.prototype.enableHarkSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkSpeakingEnabled&&this.speechEvent&&(this.harkSpeakingEnabled=!0,this.speechEvent.on("speaking",function(){e.session.emitEvent("publisherStartSpeaking",[new d.PublisherSpeakingEvent(e.session,"publisherStartSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStartSpeaking",[new d.PublisherSpeakingEvent(e.streamManager,"publisherStartSpeaking",e.connection,e.streamId)]),e.harkSpeakingEnabledOnce=!1}))},e.prototype.enableOnceHarkSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkSpeakingEnabledOnce&&this.speechEvent&&(this.harkSpeakingEnabledOnce=!0,this.speechEvent.once("speaking",function(){e.harkSpeakingEnabledOnce&&(e.session.emitEvent("publisherStartSpeaking",[new d.PublisherSpeakingEvent(e.session,"publisherStartSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStartSpeaking",[new d.PublisherSpeakingEvent(e.streamManager,"publisherStartSpeaking",e.connection,e.streamId)])),e.disableHarkSpeakingEvent(!0)}))},e.prototype.disableHarkSpeakingEvent=function(e){if(this.speechEvent){if(this.harkSpeakingEnabledOnce=!1,e){if(this.harkSpeakingEnabled)return}else this.harkSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.enableHarkStoppedSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkStoppedSpeakingEnabled&&this.speechEvent&&(this.harkStoppedSpeakingEnabled=!0,this.speechEvent.on("stopped_speaking",function(){e.session.emitEvent("publisherStopSpeaking",[new d.PublisherSpeakingEvent(e.session,"publisherStopSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStopSpeaking",[new d.PublisherSpeakingEvent(e.streamManager,"publisherStopSpeaking",e.connection,e.streamId)]),e.harkStoppedSpeakingEnabledOnce=!1}))},e.prototype.enableOnceHarkStoppedSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkStoppedSpeakingEnabledOnce&&this.speechEvent&&(this.harkStoppedSpeakingEnabledOnce=!0,this.speechEvent.once("stopped_speaking",function(){e.harkStoppedSpeakingEnabledOnce&&(e.session.emitEvent("publisherStopSpeaking",[new d.PublisherSpeakingEvent(e.session,"publisherStopSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStopSpeaking",[new d.PublisherSpeakingEvent(e.streamManager,"publisherStopSpeaking",e.connection,e.streamId)])),e.disableHarkStoppedSpeakingEvent(!0)}))},e.prototype.disableHarkStoppedSpeakingEvent=function(e){if(this.speechEvent){if(this.harkStoppedSpeakingEnabledOnce=!1,e){if(this.harkStoppedSpeakingEnabled)return}else this.harkStoppedSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce?this.speechEvent.off("stopped_speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.enableHarkVolumeChangeEvent=function(e){var t=this;this.setHarkListenerIfNotExists()?(!this.harkVolumeChangeEnabled||e)&&(this.harkVolumeChangeEnabled=!0,this.speechEvent.on("volume_change",function(e){var n=t.speechEvent.oldVolumeValue;t.speechEvent.oldVolumeValue=e,t.streamManager.emitEvent("streamAudioVolumeChange",[new h.StreamManagerEvent(t.streamManager,"streamAudioVolumeChange",{newValue:e,oldValue:n})])})):this.harkVolumeChangeEnabled=!0},e.prototype.enableOnceHarkVolumeChangeEvent=function(e){var t=this;this.setHarkListenerIfNotExists()?(!this.harkVolumeChangeEnabledOnce||e)&&(this.harkVolumeChangeEnabledOnce=!0,this.speechEvent.once("volume_change",function(e){var n=t.speechEvent.oldVolumeValue;t.speechEvent.oldVolumeValue=e,t.disableHarkVolumeChangeEvent(!0),t.streamManager.emitEvent("streamAudioVolumeChange",[new h.StreamManagerEvent(t.streamManager,"streamAudioVolumeChange",{newValue:e,oldValue:n})])})):this.harkVolumeChangeEnabledOnce=!0},e.prototype.disableHarkVolumeChangeEvent=function(e){if(this.speechEvent){if(this.harkVolumeChangeEnabledOnce=!1,e){if(this.harkVolumeChangeEnabled)return}else this.harkVolumeChangeEnabled=!1;this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("volume_change"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.isLocal=function(){return!this.inboundStreamOpts&&!!this.outboundStreamOpts},e.prototype.getSelectedIceCandidate=function(){var e=this;return new Promise(function(t,n){e.webRtcStats.getSelectedIceCandidateInfo().then(function(e){return t(e)}).catch(function(e){return n(e)})})},e.prototype.getRemoteIceCandidateList=function(){return this.webRtcPeer.remoteCandidatesQueue},e.prototype.getLocalIceCandidateList=function(){return this.webRtcPeer.localCandidatesQueue},e.prototype.streamIceConnectionStateBroken=function(){if(!this.getWebRtcPeer()||!this.getRTCPeerConnection())return!1;if(this.session.openvidu.advancedConfiguration.forceMediaReconnectionAfterNetworkDrop)return S.warn('OpenVidu Browser advanced configuration option "forceMediaReconnectionAfterNetworkDrop" is enabled. Stream '.concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") will force a reconnection")),!0;var e=this.getRTCPeerConnection().iceConnectionState;return"connected"!==e&&"completed"!==e},e.prototype.setHarkListenerIfNotExists=function(){if(this.mediaStream){if(!this.speechEvent){var e=this.harkOptions?this.harkOptions:this.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{};e.interval="number"==typeof e.interval?e.interval:100,e.threshold="number"==typeof e.threshold?e.threshold:-50,this.speechEvent=E(this.mediaStream,e)}return!0}return!1},e.prototype.setupReconnectionEventEmitter=function(e,t){return void 0==this.reconnectionEventEmitter?(this.reconnectionEventEmitter=new y,!1):(console.warn("Trying to reconnect stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") but an ongoing reconnection process is active. Waiting for response...")),this.reconnectionEventEmitter.once("success",function(){return e()}),this.reconnectionEventEmitter.once("error",function(e){return t(e)}),!0)},e.prototype.initWebRtcPeerSend=function(e){var t=this;return new Promise(function(n,r){if(e){if(t.setupReconnectionEventEmitter(n,r))return}else t.initHarkEvents();var i,o=function(){var r;return e&&(null===(r=t.reconnectionEventEmitter)||void 0===r||r.emitEvent("success"),delete t.reconnectionEventEmitter),n()},s=function(n){var i;return e&&(null===(i=t.reconnectionEventEmitter)||void 0===i||i.emitEvent("error",[n]),delete t.reconnectionEventEmitter),r(n)},a=function(n){var r;if(S.debug("Sending SDP offer to publish as "+t.streamId,n),e)r={stream:t.streamId,sdpString:n};else{var i=void 0;t.isSendVideo()&&(i="undefined"!=typeof MediaStreamTrack&&t.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?m.TypeOfVideo.CUSTOM:t.isSendScreen()?m.TypeOfVideo.SCREEN:m.TypeOfVideo.CAMERA),r={doLoopback:t.displayMyRemote()||!1,hasAudio:t.isSendAudio(),hasVideo:t.isSendVideo(),audioActive:t.audioActive,videoActive:t.videoActive,typeOfVideo:i,frameRate:t.frameRate?t.frameRate:-1,videoDimensions:JSON.stringify(t.videoDimensions),filter:t.outboundStreamOpts.publisherProperties.filter,sdpOffer:n}}t.session.openvidu.sendRequest(e?"reconnectStream":"publishVideo",r,function(n,r){n?401===n.code?s(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to publish")):s("Error on publishVideo: "+JSON.stringify(n)):t.webRtcPeer.processRemoteAnswer(r.sdpAnswer).then(function(){t.streamId=r.id,t.creationTime=r.createdAt,t.isLocalStreamPublished=!0,t.publishedOnce=!0,t.displayMyRemote()&&(t.localMediaStreamWhenSubscribedToRemote=t.mediaStream,t.remotePeerSuccessfullyEstablished(e)),e?t.ee.emitEvent("stream-reconnected-by-publisher",[]):t.ee.emitEvent("stream-created-by-publisher",[]),t.initWebRtcStats(),S.info("'Publisher' ("+t.streamId+") successfully "+(e?"reconnected":"published")+" to session"),o()}).catch(function(e){s(e)})})},l={mediaConstraints:{audio:t.hasAudio,video:t.hasVideo},simulcast:null!==(i=t.outboundStreamOpts.publisherProperties.videoSimulcast)&&void 0!==i?i:t.session.openvidu.videoSimulcast,onIceCandidate:t.connection.sendIceCandidate.bind(t.connection),onIceConnectionStateException:t.onIceConnectionStateExceptionHandler.bind(t),iceServers:t.getIceServersConf(),mediaStream:t.mediaStream,mediaServer:t.session.openvidu.mediaServer,typeOfVideo:t.typeOfVideo?m.TypeOfVideo[t.typeOfVideo]:void 0};"mediasoup"!==t.session.openvidu.mediaServer&&(l.simulcast=!1),e&&t.disposeWebRtcPeer(),t.displayMyRemote()?t.webRtcPeer=new c.WebRtcPeerSendrecv(l):t.webRtcPeer=new c.WebRtcPeerSendonly(l),t.webRtcPeer.addIceConnectionStateChangeListener("publisher of "+t.connection.connectionId),t.webRtcPeer.createOffer().then(function(e){t.webRtcPeer.processLocalOffer(e).then(function(){a(e.sdp)}).catch(function(e){s(Error("(publish) SDP process local offer error: "+JSON.stringify(e)))})}).catch(function(e){s(Error("(publish) SDP create offer error: "+JSON.stringify(e)))})})},e.prototype.finalResolveForSubscription=function(e,t){var n;return S.info("'Subscriber' ("+this.streamId+") successfully "+(e?"reconnected":"subscribed")),this.remotePeerSuccessfullyEstablished(e),this.initWebRtcStats(),e&&(null===(n=this.reconnectionEventEmitter)||void 0===n||n.emitEvent("success"),delete this.reconnectionEventEmitter),t()},e.prototype.finalRejectForSubscription=function(e,t,n){var r;return S.error("Error for 'Subscriber' ("+this.streamId+") while trying to "+(e?"reconnect":"subscribe")+": "+t.toString()),e&&(null===(r=this.reconnectionEventEmitter)||void 0===r||r.emitEvent("error",[t]),delete this.reconnectionEventEmitter),n(t)},e.prototype.initWebRtcPeerReceive=function(e){var t=this;return new Promise(function(n,r){e&&t.setupReconnectionEventEmitter(n,r)||("mediasoup"===t.session.openvidu.mediaServer?t.initWebRtcPeerReceiveFromServer(e).then(function(){return t.finalResolveForSubscription(e,n)}).catch(function(n){return t.finalRejectForSubscription(e,n,r)}):t.initWebRtcPeerReceiveFromClient(e).then(function(){return t.finalResolveForSubscription(e,n)}).catch(function(n){return t.finalRejectForSubscription(e,n,r)}))})},e.prototype.initWebRtcPeerReceiveFromClient=function(e){var t=this;return new Promise(function(n,r){t.completeWebRtcPeerReceive(e,!1).then(function(e){t.webRtcPeer.processRemoteAnswer(e.sdpAnswer).then(function(){return n()}).catch(function(e){return r(e)})}).catch(function(e){return r(e)})})},e.prototype.initWebRtcPeerReceiveFromServer=function(e){var t=this;return new Promise(function(n,r){t.session.openvidu.sendRequest("prepareReceiveVideoFrom",{sender:t.streamId,reconnect:e},function(i,o){if(i)return r(Error("Error on prepareReceiveVideoFrom: "+JSON.stringify(i)));t.completeWebRtcPeerReceive(e,!1,o.sdpOffer).then(function(){return n()}).catch(function(e){return r(e)})})})},e.prototype.completeWebRtcPeerReceive=function(e,t,n){var r=this;return new Promise(function(i,o){S.debug("'Session.subscribe(Stream)' called");var s=function(s){S.debug("Sending local SDP ".concat(n?"answer":"offer"," to subscribe to ").concat(r.streamId),s);var a=e?"reconnectStream":"receiveVideoFrom",c={};c[e?"stream":"sender"]=r.streamId,n?c[e?"sdpString":"sdpAnswer"]=s:c.sdpOffer=s,e&&(c.forciblyReconnect=t),r.session.openvidu.sendRequest(a,c,function(e,t){return e?o(Error("Error on "+a+" : "+JSON.stringify(e))):i(t)})},a={mediaConstraints:{audio:r.hasAudio,video:r.hasVideo},simulcast:!1,onIceCandidate:r.connection.sendIceCandidate.bind(r.connection),onIceConnectionStateException:r.onIceConnectionStateExceptionHandler.bind(r),iceServers:r.getIceServersConf(),mediaServer:r.session.openvidu.mediaServer,typeOfVideo:r.typeOfVideo?m.TypeOfVideo[r.typeOfVideo]:void 0};e&&r.disposeWebRtcPeer(),r.webRtcPeer=new c.WebRtcPeerRecvonly(a),r.webRtcPeer.addIceConnectionStateChangeListener(r.streamId),n?r.webRtcPeer.processRemoteOffer(n).then(function(){r.webRtcPeer.createAnswer().then(function(e){r.webRtcPeer.processLocalAnswer(e).then(function(){s(e.sdp)}).catch(function(e){return o(Error("(subscribe) SDP process local answer error: "+JSON.stringify(e)))})}).catch(function(e){return o(Error("(subscribe) SDP create answer error: "+JSON.stringify(e)))})}).catch(function(e){return o(Error("(subscribe) SDP process remote offer error: "+JSON.stringify(e)))}):r.webRtcPeer.createOffer().then(function(e){r.webRtcPeer.processLocalOffer(e).then(function(){s(e.sdp)}).catch(function(e){return o(Error("(subscribe) SDP process local offer error: "+JSON.stringify(e)))})}).catch(function(e){return o(Error("(subscribe) SDP create offer error: "+JSON.stringify(e)))})})},e.prototype.remotePeerSuccessfullyEstablished=function(e){e&&null!=this.mediaStream&&this.disposeMediaStream(),this.mediaStream=new MediaStream;for(var t,n=0,r=this.webRtcPeer.pc.getReceivers();n<r.length;n++)(t=r[n]).track&&this.mediaStream.addTrack(t.track);if(S.debug("Peer remote stream",this.mediaStream),this.mediaStream){if(this.streamManager instanceof a.Subscriber){if(this.mediaStream.getAudioTracks()[0]){var i=e?this.audioActive:!!this.streamManager.properties.subscribeToAudio;this.mediaStream.getAudioTracks()[0].enabled=i}if(this.mediaStream.getVideoTracks()[0]){var i=e?this.videoActive:!!this.videoActive&&!!this.streamManager.properties.subscribeToVideo;this.mediaStream.getVideoTracks()[0].enabled=i}}this.updateMediaStreamInVideos(),this.initHarkEvents()}},e.prototype.initHarkEvents=function(){this.mediaStream.getAudioTracks()[0]&&(this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!0,this.streamManager)&&this.enableOnceHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.streamManager)&&this.enableHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!0,this.streamManager)&&this.enableOnceHarkStoppedSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.streamManager)&&this.enableHarkStoppedSpeakingEvent(),this.harkVolumeChangeEnabledOnce&&this.enableOnceHarkVolumeChangeEvent(!0),this.harkVolumeChangeEnabled&&this.enableHarkVolumeChangeEvent(!0))},e.prototype.onIceConnectionStateExceptionHandler=function(e,t,n){switch(e){case u.ExceptionEventName.ICE_CONNECTION_FAILED:this.onIceConnectionFailed();break;case u.ExceptionEventName.ICE_CONNECTION_DISCONNECTED:this.onIceConnectionDisconnected()}this.session.emitEvent("exception",[new u.ExceptionEvent(this.session,e,this,t,n)])},e.prototype.onIceConnectionFailed=function(){S.log("[ICE_CONNECTION_FAILED] Handling ICE_CONNECTION_FAILED event. Reconnecting stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",")")),this.reconnectStreamAndLogResultingIceConnectionState(u.ExceptionEventName.ICE_CONNECTION_FAILED)},e.prototype.onIceConnectionDisconnected=function(){var e=this;S.log("[ICE_CONNECTION_DISCONNECTED] Handling ICE_CONNECTION_DISCONNECTED event. Waiting for ICE to be restored and reconnect stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") if not possible"));var t=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3;this.awaitWebRtcPeerConnectionState(t).then(function(n){switch(n){case"failed":S.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(e.streamId," (").concat(e.isLocal()?"Publisher":"Subscriber",") is now failed after ICE_CONNECTION_DISCONNECTED"));break;case"connected":case"completed":S.log("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(e.streamId," (").concat(e.isLocal()?"Publisher":"Subscriber",") automatically restored after ICE_CONNECTION_DISCONNECTED. Current ICE connection state: ").concat(n));break;case"closed":case"checking":case"new":case"disconnected":S.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(e.streamId," (").concat(e.isLocal()?"Publisher":"Subscriber",") couldn't be restored after ICE_CONNECTION_DISCONNECTED event. Current ICE connection state after ").concat(t," ms: ").concat(n)),e.reconnectStreamAndLogResultingIceConnectionState(u.ExceptionEventName.ICE_CONNECTION_DISCONNECTED)}})},e.prototype.reconnectStreamAndLogResultingIceConnectionState=function(e){return i(this,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.reconnectStreamAndReturnIceConnectionState(e)];case 1:switch(t=r.sent()){case"connected":case"completed":S.log("[".concat(e,"] Stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") successfully reconnected after ").concat(e,". Current ICE connection state: ").concat(t));break;default:S.error("[".concat(e,"] Stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") failed to reconnect after ").concat(e,". Current ICE connection state: ").concat(t))}return[3,3];case 2:return n=r.sent(),S.error("[".concat(e,"] Error reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") after ").concat(e,": ").concat(n)),[3,3];case 3:return[2]}})})},e.prototype.reconnectStreamAndReturnIceConnectionState=function(e){return i(this,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:S.log("[".concat(e,"] Reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") after event ").concat(e)),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.reconnectStream(e)];case 2:return r.sent(),t=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3,[2,this.awaitWebRtcPeerConnectionState(t)];case 3:return n=r.sent(),S.warn("[".concat(e,"] Error reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber","). Reason: ").concat(n)),[2,this.awaitWebRtcPeerConnectionState(1)];case 4:return[2]}})})},e.prototype.awaitWebRtcPeerConnectionState=function(e){return i(this,void 0,void 0,function(){var t,n,r,i;return o(this,function(o){switch(o.label){case 0:t=this.getRTCPeerConnection().iceConnectionState,r=Math.ceil(e/(n=150)),i=0,o.label=1;case 1:if(!(i<r)||"connected"===(t=this.getRTCPeerConnection().iceConnectionState)||"completed"===t)return[3,4];return[4,new Promise(function(e){return setTimeout(e,n)})];case 2:o.sent(),o.label=3;case 3:return i++,[3,1];case 4:return[2,t]}})})},e.prototype.reconnectStream=function(e){return i(this,void 0,void 0,function(){var t;return o(this,function(n){switch(n.label){case 0:return[4,this.isWebsocketConnected(e,3e3)];case 1:if(n.sent()){if(S.log("[".concat(e,"] Trying to reconnect stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") and the websocket is opened")),this.isLocal())return[2,this.initWebRtcPeerSend(!0)];return[2,this.initWebRtcPeerReceive(!0)]}throw t="[".concat(e,"] Trying to reconnect stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") but the websocket wasn't opened"),S.error(t),Error(t)}})})},e.prototype.isWebsocketConnected=function(e,t){var n=this;return new Promise(function(r,i){var o=n.session.openvidu.getWsReadyState();if(1!==o)return console.warn("[".concat(e,"] Websocket readyState is ").concat(o)),r(!1);var s=setTimeout(function(){return console.warn("[".concat(e,"] Websocket timeout of ").concat(t,"ms")),r(!1)},t);n.session.openvidu.sendRequest("echo",{},function(t,n){return(clearTimeout(s),t)?(console.warn("[".concat(e,"] Websocket 'echo' returned error: ").concat(t)),r(!1)):r(!0)})})},e.prototype.initWebRtcStats=function(){this.webRtcStats=new l.WebRtcStats(this),this.webRtcStats.initWebRtcStats()},e.prototype.stopWebRtcStats=function(){this.webRtcStats&&this.webRtcStats.isEnabled()&&this.webRtcStats.stopWebRtcStats()},e.prototype.getIceServersConf=function(){return this.session.openvidu.advancedConfiguration.iceServers?"freeice"===this.session.openvidu.advancedConfiguration.iceServers?void 0:this.session.openvidu.advancedConfiguration.iceServers:this.session.openvidu.iceServers?this.session.openvidu.iceServers:void 0},e.prototype.gatherStatsForPeer=function(){var e=this;return new Promise(function(t,n){e.isLocal()?e.getRTCPeerConnection().getSenders().forEach(function(t){return t.getStats().then(function(t){t.forEach(function(t){if(e.isReportWanted(t)){var n={};n.type=t.type,n.timestamp=t.timestamp,n.id=t.id,"outbound-rtp"===t.type&&(n.ssrc=t.ssrc,n.firCount=t.firCount,n.pliCount=t.pliCount,n.nackCount=t.nackCount,n.qpSum=t.qpSum,t.kind?n.mediaType=t.kind:t.mediaType?n.mediaType=t.mediaType:n.mediaType=-1!==t.id.indexOf("VideoStream")?"video":"audio","video"===n.mediaType&&(n.framesEncoded=t.framesEncoded),n.packetsSent=t.packetsSent,n.bytesSent=t.bytesSent),"candidate-pair"===t.type&&void 0!==t.totalRoundTripTime&&(n.availableOutgoingBitrate=t.availableOutgoingBitrate,n.rtt=t.currentRoundTripTime,n.averageRtt=t.totalRoundTripTime/t.responsesReceived),"remote-inbound-rtp"===t.type||t.type,S.log(n)}})})}):e.getRTCPeerConnection().getReceivers().forEach(function(t){return t.getStats().then(function(t){t.forEach(function(t){if(e.isReportWanted(t)){var n={};n.type=t.type,n.timestamp=t.timestamp,n.id=t.id,"inbound-rtp"===t.type&&(n.ssrc=t.ssrc,n.firCount=t.firCount,n.pliCount=t.pliCount,n.nackCount=t.nackCount,n.qpSum=t.qpSum,t.kind?n.mediaType=t.kind:t.mediaType?n.mediaType=t.mediaType:n.mediaType=-1!==t.id.indexOf("VideoStream")?"video":"audio","video"===n.mediaType&&(n.framesDecoded=t.framesDecoded),n.packetsReceived=t.packetsReceived,n.packetsLost=t.packetsLost,n.jitter=t.jitter,n.bytesReceived=t.bytesReceived),"candidate-pair"===t.type&&void 0!==t.totalRoundTripTime&&(n.availableIncomingBitrate=t.availableIncomingBitrate,n.rtt=t.currentRoundTripTime,n.averageRtt=t.totalRoundTripTime/t.responsesReceived),"remote-inbound-rtp"===t.type||t.type,S.log(n)}})})})})},e.prototype.isReportWanted=function(e){return"inbound-rtp"===e.type&&!this.isLocal()||"outbound-rtp"===e.type&&this.isLocal()||"candidate-pair"===e.type&&e.nominated&&e.bytesSent>0},e}();t.Stream=_},71813:function(e,t,n){"use strict";var r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.StreamManager=void 0;var s=n(97897),a=n(92967),c=n(72473),l=n(69532),u=n(64874),d=n(77654),h=n(34957),p=d.OpenViduLogger.getInstance(),f=function(e){function t(t,n){var r=e.call(this)||this;if(r.videos=[],r.lazyLaunchVideoElementCreatedEvent=!1,i=h.PlatformUtils.getInstance(),r.stream=t,r.stream.streamManager=r,r.remote=!r.stream.isLocal(),n){var o=void 0;"string"==typeof n?o=document.getElementById(n):n instanceof HTMLElement&&(o=n),o&&(r.firstVideoElement={targetElement:o,video:document.createElement("video"),id:"",canplayListenerAdded:!1},(i.isSafariBrowser()||i.isIPhoneOrIPad()&&(i.isChromeMobileBrowser()||i.isEdgeMobileBrowser()||i.isOperaMobileBrowser()||i.isFirefoxMobileBrowser()))&&(r.firstVideoElement.video.playsInline=!0),r.targetElement=o,r.element=o)}return r.canPlayListener=function(){r.deactivateStreamPlayingEventExceptionTimeout(),r.ee.emitEvent("streamPlaying",[new a.StreamManagerEvent(r,"streamPlaying",void 0)])},r}return o(t,e),t.prototype.on=function(t,n){return e.prototype.onAux.call(this,t,"Event '"+t+"' triggered by '"+(this.remote?"Subscriber":"Publisher")+"'",n),"videoElementCreated"===t&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&(this.ee.emitEvent("videoElementCreated",[new c.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!1),"streamPlaying"===t&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&this.ee.emitEvent("streamPlaying",[new a.StreamManagerEvent(this,"streamPlaying",void 0)]),this.stream.hasAudio&&("publisherStartSpeaking"===t&&this.stream.enableHarkSpeakingEvent(),"publisherStopSpeaking"===t&&this.stream.enableHarkStoppedSpeakingEvent(),"streamAudioVolumeChange"===t&&this.stream.enableHarkVolumeChangeEvent(!1)),this},t.prototype.once=function(t,n){return e.prototype.onceAux.call(this,t,"Event '"+t+"' triggered once by '"+(this.remote?"Subscriber":"Publisher")+"'",n),"videoElementCreated"===t&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&this.ee.emitEvent("videoElementCreated",[new c.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),"streamPlaying"===t&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&this.ee.emitEvent("streamPlaying",[new a.StreamManagerEvent(this,"streamPlaying",void 0)]),this.stream.hasAudio&&("publisherStartSpeaking"===t&&this.stream.enableOnceHarkSpeakingEvent(),"publisherStopSpeaking"===t&&this.stream.enableOnceHarkStoppedSpeakingEvent(),"streamAudioVolumeChange"===t&&this.stream.enableOnceHarkVolumeChangeEvent(!1)),this},t.prototype.off=function(t,n){return e.prototype.offAux.call(this,t,n),"publisherStartSpeaking"===t&&0===this.ee.getListeners(t).length+this.stream.session.ee.getListeners(t).length&&this.stream.disableHarkSpeakingEvent(!1),"publisherStopSpeaking"===t&&0===this.ee.getListeners(t).length+this.stream.session.ee.getListeners(t).length&&this.stream.disableHarkStoppedSpeakingEvent(!1),"streamAudioVolumeChange"===t&&0===this.ee.getListeners(t).length&&this.stream.disableHarkVolumeChangeEvent(!1),this},t.prototype.addVideoElement=function(e){this.initializeVideoProperties(e),!this.remote&&this.stream.displayMyRemote()&&e.srcObject!==this.stream.getMediaStream()&&(e.srcObject=this.stream.getMediaStream());for(var t=0,n=this.videos;t<n.length;t++)if(n[t].video===e)return 0;for(var r=1,i=0,o=this.stream.session.streamManagers;i<o.length;i++)if(o[i].disassociateVideo(e)){r=-1;break}return this.stream.session.streamManagers.forEach(function(t){t.disassociateVideo(e)}),this.pushNewStreamManagerVideo({video:e,id:e.id,canplayListenerAdded:!1}),p.info("New video element associated to ",this),r},t.prototype.createVideoElement=function(e,t){if("string"==typeof e){if(!(n=document.getElementById(e)))throw Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+e)}else if(e instanceof HTMLElement)n=e;else throw Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+e);var n,r=this.createVideo();this.initializeVideoProperties(r);var i=t||u.VideoInsertMode.APPEND;switch(i){case u.VideoInsertMode.AFTER:n.parentNode.insertBefore(r,n.nextSibling);break;case u.VideoInsertMode.APPEND:n.appendChild(r);break;case u.VideoInsertMode.BEFORE:n.parentNode.insertBefore(r,n);break;case u.VideoInsertMode.PREPEND:n.insertBefore(r,n.childNodes[0]);break;case u.VideoInsertMode.REPLACE:n.parentNode.replaceChild(r,n);break;default:i=u.VideoInsertMode.APPEND,n.appendChild(r)}var o={targetElement:n,video:r,insertMode:i,id:r.id,canplayListenerAdded:!1};return this.pushNewStreamManagerVideo(o),this.ee.emitEvent("videoElementCreated",[new c.VideoElementEvent(o.video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!!this.firstVideoElement,r},t.prototype.updatePublisherSpeakingEventsOptions=function(e){var t=this.stream.harkOptions?this.stream.harkOptions:this.stream.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{},n="number"==typeof e.interval?e.interval:"number"==typeof t.interval?t.interval:100,r="number"==typeof e.threshold?e.threshold:"number"==typeof t.threshold?t.threshold:-50;this.stream.harkOptions={interval:n,threshold:r},this.stream.speechEvent&&(this.stream.speechEvent.setInterval(n),this.stream.speechEvent.setThreshold(r))},t.prototype.initializeVideoProperties=function(e){!this.remote&&this.stream.displayMyRemote()||e.srcObject===this.stream.getMediaStream()||(e.srcObject=this.stream.getMediaStream()),e.autoplay=!0,e.controls=!1,(i.isSafariBrowser()||i.isIPhoneOrIPad()&&(i.isChromeMobileBrowser()||i.isEdgeMobileBrowser()||i.isOperaMobileBrowser()||i.isFirefoxMobileBrowser()))&&(e.playsInline=!0),e.id||(e.id=(this.remote?"remote-":"local-")+"video-"+this.stream.streamId,this.id||!this.targetElement||(this.id=e.id)),this.remote&&this.isMirroredVideo(e)?this.removeMirrorVideo(e):this.remote||this.stream.displayMyRemote()||(e.muted=!0,this.isMirroredVideo(e)&&!this.stream.outboundStreamOpts.publisherProperties.mirror?this.removeMirrorVideo(e):this.stream.outboundStreamOpts.publisherProperties.mirror&&!this.stream.isSendScreen()&&this.mirrorVideo(e))},t.prototype.removeAllVideos=function(){for(var e=this,t=this.stream.session.streamManagers.length-1;t>=0;--t)this.stream.session.streamManagers[t]===this&&this.stream.session.streamManagers.splice(t,1);this.videos.forEach(function(t){t.video&&t.video.removeEventListener&&t.video.removeEventListener("canplay",e.canPlayListener),t.canplayListenerAdded=!1,t.targetElement&&(t.video.parentNode.removeChild(t.video),e.ee.emitEvent("videoElementDestroyed",[new c.VideoElementEvent(t.video,e,"videoElementDestroyed")])),e.removeSrcObject(t),e.videos.filter(function(e){return!e.targetElement})})},t.prototype.disassociateVideo=function(e){for(var t=!1,n=0;n<this.videos.length;n++)if(this.videos[n].video===e){this.videos[n].video.removeEventListener("canplay",this.canPlayListener),this.videos.splice(n,1),t=!0,p.info("Video element disassociated from ",this);break}return t},t.prototype.addPlayEventToFirstVideo=function(){this.videos[0]&&this.videos[0].video&&!this.videos[0].canplayListenerAdded&&(this.activateStreamPlayingEventExceptionTimeout(),this.videos[0].video.addEventListener("canplay",this.canPlayListener),this.videos[0].canplayListenerAdded=!0)},t.prototype.updateMediaStream=function(e){this.videos.forEach(function(t){if(t.video.srcObject=e,i.isIonicIos()){var n=t.video.parentElement,r=t.video;n.replaceChild(r,t.video),t.video=r}})},t.prototype.emitEvent=function(e,t){this.ee.emitEvent(e,t)},t.prototype.createVideo=function(){return document.createElement("video")},t.prototype.removeSrcObject=function(e){e.video.srcObject=null,this.deactivateStreamPlayingEventExceptionTimeout()},t.prototype.pushNewStreamManagerVideo=function(e){this.videos.push(e),this.addPlayEventToFirstVideo(),-1===this.stream.session.streamManagers.indexOf(this)&&this.stream.session.streamManagers.push(this)},t.prototype.mirrorVideo=function(e){i.isIonicIos()||(e.style.transform="rotateY(180deg)",e.style.webkitTransform="rotateY(180deg)")},t.prototype.removeMirrorVideo=function(e){e.style.transform="unset",e.style.webkitTransform="unset"},t.prototype.isMirroredVideo=function(e){return"rotateY(180deg)"===e.style.transform||"rotateY(180deg)"===e.style.webkitTransform},t.prototype.activateStreamPlayingEventExceptionTimeout=function(){var e=this;if(this.remote&&null==this.streamPlayingEventExceptionTimeout){var t=this.stream.session.openvidu.advancedConfiguration.noStreamPlayingEventExceptionTimeout||4e3;this.streamPlayingEventExceptionTimeout=setTimeout(function(){var n="StreamManager of Stream "+e.stream.streamId+" ("+(e.remote?"Subscriber":"Publisher")+') did not trigger "streamPlaying" event in '+t+" ms";p.warn(n),e.stream.session.emitEvent("exception",[new l.ExceptionEvent(e.stream.session,l.ExceptionEventName.NO_STREAM_PLAYING_EVENT,e,n)]),delete e.streamPlayingEventExceptionTimeout},t)}},t.prototype.deactivateStreamPlayingEventExceptionTimeout=function(){clearTimeout(this.streamPlayingEventExceptionTimeout),delete this.streamPlayingEventExceptionTimeout},t}(s.EventDispatcher);t.StreamManager=f},5187:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Subscriber=void 0;var o=n(71813),s=n(77654).OpenViduLogger.getInstance(),a=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.element=i.targetElement,i.stream=t,i.properties=r,i}return i(t,e),t.prototype.subscribeToAudio=function(e){return this.stream.getMediaStream().getAudioTracks().forEach(function(t){t.enabled=e}),this.stream.audioActive=e,s.info("'Subscriber' has "+(e?"subscribed to":"unsubscribed from")+" its audio stream"),this},t.prototype.subscribeToVideo=function(e){return this.stream.getMediaStream().getVideoTracks().forEach(function(t){t.enabled=e}),this.stream.videoActive=e,s.info("'Subscriber' has "+(e?"subscribed to":"unsubscribed from")+" its video stream"),this},t.prototype.replaceTrackInMediaStream=function(e,t){var n,r=this.stream.getMediaStream();"video"===e.kind?(n=r.getVideoTracks()[0],t&&(this.stream.lastVideoTrackConstraints=e.getConstraints())):n=r.getAudioTracks()[0],r.removeTrack(n),n.stop(),r.addTrack(e)},t}(o.StreamManager);t.Subscriber=a},71705:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.EventDispatcher=t.ExceptionEventName=t.ExceptionEvent=t.SpeechToTextEvent=t.NetworkQualityLevelChangedEvent=t.FilterEvent=t.ConnectionPropertyChangedEvent=t.StreamPropertyChangedEvent=t.VideoElementEvent=t.StreamManagerEvent=t.StreamEvent=t.SignalEvent=t.SessionDisconnectedEvent=t.RecordingEvent=t.PublisherSpeakingEvent=t.ConnectionEvent=t.Event=t.VideoInsertMode=t.TypeOfVideo=t.OpenViduErrorName=t.OpenViduError=t.LocalRecorderState=t.Filter=t.LocalRecorder=t.Connection=t.Stream=t.StreamManager=t.Subscriber=t.Publisher=t.Session=t.OpenVidu=void 0;var o=n(294),s=n(23462);Object.defineProperty(t,"OpenVidu",{enumerable:!0,get:function(){return s.OpenVidu}});var a=n(69767);Object.defineProperty(t,"Session",{enumerable:!0,get:function(){return a.Session}});var c=n(26245);Object.defineProperty(t,"Publisher",{enumerable:!0,get:function(){return c.Publisher}});var l=n(5187);Object.defineProperty(t,"Subscriber",{enumerable:!0,get:function(){return l.Subscriber}});var u=n(71813);Object.defineProperty(t,"StreamManager",{enumerable:!0,get:function(){return u.StreamManager}});var d=n(67883);Object.defineProperty(t,"Stream",{enumerable:!0,get:function(){return d.Stream}});var h=n(16714);Object.defineProperty(t,"Connection",{enumerable:!0,get:function(){return h.Connection}});var p=n(63154);Object.defineProperty(t,"LocalRecorder",{enumerable:!0,get:function(){return p.LocalRecorder}});var f=n(23364);Object.defineProperty(t,"Filter",{enumerable:!0,get:function(){return f.Filter}});var m=n(97134);Object.defineProperty(t,"LocalRecorderState",{enumerable:!0,get:function(){return m.LocalRecorderState}});var v=n(35019);Object.defineProperty(t,"OpenViduError",{enumerable:!0,get:function(){return v.OpenViduError}}),Object.defineProperty(t,"OpenViduErrorName",{enumerable:!0,get:function(){return v.OpenViduErrorName}});var g=n(98752);Object.defineProperty(t,"TypeOfVideo",{enumerable:!0,get:function(){return g.TypeOfVideo}});var b=n(64874);Object.defineProperty(t,"VideoInsertMode",{enumerable:!0,get:function(){return b.VideoInsertMode}});var E=n(57434);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return E.Event}});var y=n(42345);Object.defineProperty(t,"ConnectionEvent",{enumerable:!0,get:function(){return y.ConnectionEvent}});var S=n(58407);Object.defineProperty(t,"PublisherSpeakingEvent",{enumerable:!0,get:function(){return S.PublisherSpeakingEvent}});var _=n(50588);Object.defineProperty(t,"RecordingEvent",{enumerable:!0,get:function(){return _.RecordingEvent}});var w=n(88133);Object.defineProperty(t,"SessionDisconnectedEvent",{enumerable:!0,get:function(){return w.SessionDisconnectedEvent}});var x=n(77547);Object.defineProperty(t,"SignalEvent",{enumerable:!0,get:function(){return x.SignalEvent}});var O=n(79869);Object.defineProperty(t,"StreamEvent",{enumerable:!0,get:function(){return O.StreamEvent}});var C=n(92967);Object.defineProperty(t,"StreamManagerEvent",{enumerable:!0,get:function(){return C.StreamManagerEvent}});var I=n(72473);Object.defineProperty(t,"VideoElementEvent",{enumerable:!0,get:function(){return I.VideoElementEvent}});var R=n(19988);Object.defineProperty(t,"StreamPropertyChangedEvent",{enumerable:!0,get:function(){return R.StreamPropertyChangedEvent}});var k=n(51493);Object.defineProperty(t,"ConnectionPropertyChangedEvent",{enumerable:!0,get:function(){return k.ConnectionPropertyChangedEvent}});var N=n(65787);Object.defineProperty(t,"FilterEvent",{enumerable:!0,get:function(){return N.FilterEvent}});var T=n(63337);Object.defineProperty(t,"NetworkQualityLevelChangedEvent",{enumerable:!0,get:function(){return T.NetworkQualityLevelChangedEvent}});var A=n(80018);Object.defineProperty(t,"SpeechToTextEvent",{enumerable:!0,get:function(){return A.SpeechToTextEvent}});var P=n(69532);Object.defineProperty(t,"ExceptionEvent",{enumerable:!0,get:function(){return P.ExceptionEvent}}),Object.defineProperty(t,"ExceptionEventName",{enumerable:!0,get:function(){return P.ExceptionEventName}});var L=n(97897);Object.defineProperty(t,"EventDispatcher",{enumerable:!0,get:function(){return L.EventDispatcher}}),i(n(94648),t),o.JL.setOptions({enabled:!1})},33810:(e,t,n)=>{let r=n(16046),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(50144),{re:s,t:a}=n(28237),c=n(62186),{compareIdentifiers:l}=n(20464);class u{constructor(e,t){if(t=c(t),e instanceof u){if(!!t.loose===e.loose&&!!t.includePrerelease===e.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw TypeError(`Invalid Version: ${e}`);if(e.length>i)throw TypeError(`version is longer than ${i} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!n)throw TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){let t=+e;if(t>=0&&t<o)return t}return e}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof u)){if("string"==typeof e&&e===this.version)return 0;e=new u(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof u||(e=new u(e,this.options)),l(this.major,e.major)||l(this.minor,e.minor)||l(this.patch,e.patch)}comparePre(e){if(e instanceof u||(e=new u(e,this.options)),this.prerelease.length&&!e.prerelease.length)return -1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return -1;if(n===i)continue;else return l(n,i)}while(++t)}compareBuild(e){e instanceof u||(e=new u(e,this.options));let t=0;do{let n=this.build[t],i=e.build[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return -1;if(n===i)continue;else return l(n,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(0===l(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=u},2642:(e,t,n)=>{let r=n(33810);e.exports=(e,t)=>new r(e,t).major},73280:(e,t,n)=>{let r=n(33810);e.exports=(e,t)=>new r(e,t).minor},50144:e=>{let t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:t,MAX_SAFE_COMPONENT_LENGTH:16}},16046:e=>{let t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},20464:e=>{let t=/^[0-9]+$/,n=(e,n)=>{let r=t.test(e),i=t.test(n);return r&&i&&(e=+e,n=+n),e===n?0:r&&!i?-1:i&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},62186:e=>{let t=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:t.filter(t=>e[t]).reduce((e,t)=>(e[t]=!0,e),{}):{}},28237:(e,t,n)=>{let{MAX_SAFE_COMPONENT_LENGTH:r}=n(50144),i=n(16046),o=(t=e.exports={}).re=[],s=t.src=[],a=t.t={},c=0,l=(e,t,n)=>{let r=c++;i(e,r,t),a[e]=r,s[r]=t,o[r]=new RegExp(t,n?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION",`(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})`),l("MAINVERSIONLOOSE",`(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})`),l("PRERELEASEIDENTIFIER",`(?:${s[a.NUMERICIDENTIFIER]}|${s[a.NONNUMERICIDENTIFIER]})`),l("PRERELEASEIDENTIFIERLOOSE",`(?:${s[a.NUMERICIDENTIFIERLOOSE]}|${s[a.NONNUMERICIDENTIFIER]})`),l("PRERELEASE",`(?:-(${s[a.PRERELEASEIDENTIFIER]}(?:\\.${s[a.PRERELEASEIDENTIFIER]})*))`),l("PRERELEASELOOSE",`(?:-?(${s[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[a.PRERELEASEIDENTIFIERLOOSE]})*))`),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD",`(?:\\+(${s[a.BUILDIDENTIFIER]}(?:\\.${s[a.BUILDIDENTIFIER]})*))`),l("FULLPLAIN",`v?${s[a.MAINVERSION]}${s[a.PRERELEASE]}?${s[a.BUILD]}?`),l("FULL",`^${s[a.FULLPLAIN]}$`),l("LOOSEPLAIN",`[v=\\s]*${s[a.MAINVERSIONLOOSE]}${s[a.PRERELEASELOOSE]}?${s[a.BUILD]}?`),l("LOOSE",`^${s[a.LOOSEPLAIN]}$`),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE",`${s[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),l("XRANGEIDENTIFIER",`${s[a.NUMERICIDENTIFIER]}|x|X|\\*`),l("XRANGEPLAIN",`[v=\\s]*(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:${s[a.PRERELEASE]})?${s[a.BUILD]}?)?)?`),l("XRANGEPLAINLOOSE",`[v=\\s]*(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:${s[a.PRERELEASELOOSE]})?${s[a.BUILD]}?)?)?`),l("XRANGE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAIN]}$`),l("XRANGELOOSE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAINLOOSE]}$`),l("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),l("COERCERTL",s[a.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM",`(\\s*)${s[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",l("TILDE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAIN]}$`),l("TILDELOOSE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAINLOOSE]}$`),l("LONECARET","(?:\\^)"),l("CARETTRIM",`(\\s*)${s[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",l("CARET",`^${s[a.LONECARET]}${s[a.XRANGEPLAIN]}$`),l("CARETLOOSE",`^${s[a.LONECARET]}${s[a.XRANGEPLAINLOOSE]}$`),l("COMPARATORLOOSE",`^${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]})$|^$`),l("COMPARATOR",`^${s[a.GTLT]}\\s*(${s[a.FULLPLAIN]})$|^$`),l("COMPARATORTRIM",`(\\s*)${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]}|${s[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE",`^\\s*(${s[a.XRANGEPLAIN]})\\s+-\\s+(${s[a.XRANGEPLAIN]})\\s*$`),l("HYPHENRANGELOOSE",`^\\s*(${s[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[a.XRANGEPLAINLOOSE]})\\s*$`),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},80041:function(e,t,n){var r;e=n.nmd(e),(function(){"use strict";var i={function:!0,object:!0},o=i.undefined&&window||this,s=i[typeof t]&&t,a=i.object&&e&&!e.nodeType&&e,c=s&&a&&"object"==typeof global&&global;c&&(c.global===c||c.window===c||c.self===c)&&(o=c);var l=/\bOpera/,u=Object.prototype,d=u.hasOwnProperty,h=u.toString;function p(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function f(e){return e=E(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:p(e)}function m(e,t){for(var n in e)d.call(e,n)&&t(e[n],n,e)}function v(e){return null==e?p(e):h.call(e).slice(8,-1)}function g(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function b(e,t){var n=null;return function(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r&&r>-1&&r<=9007199254740991)for(;++n<r;)t(e[n],n,e);else m(e,t)}(e,function(r,i){n=t(n,r,i,e)}),n}function E(e){return String(e).replace(/^ +| +$/g,"")}var y=function e(t){var n,r,i,s,a,c=o,u=t&&"object"==typeof t&&"String"!=v(t);u&&(c=t,t=null);var d=c.navigator||{},p=d.userAgent||"";t||(t=p);var y=u?!!d.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(h.toString()),S="Object",_=u&&c.java?"JavaPackage":v(c.java),w=/\bJava/.test(_)&&c.java,x=w&&v(c.environment)==(u?S:"Environment"),O=c.document||{},C=c.operamini||c.opera,I=l.test(I=u&&C?C["[[Class]]"]:v(C))?I:C=null,R=t,k=[],N=null,T=t==p,A=T&&C&&"function"==typeof C.version&&C.version(),P=b([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(e,n){return e||RegExp("\\b"+(n.pattern||g(n))+"\\b","i").exec(t)&&(n.label||n)}),L=b(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],function(e,n){return e||RegExp("\\b"+(n.pattern||g(n))+"\\b","i").exec(t)&&(n.label||n)}),D=V([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),M=b({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}},function(e,n,r){return e||(n[D]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(D)]||RegExp("\\b"+g(r)+"(?:\\b|\\w*\\d)","i").exec(t))&&r}),j=b(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],function(e,n){var r,i,o,s=n.pattern||g(n);return!e&&(e=RegExp("\\b"+s+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(r=e,i=n.label||n,o={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"},s&&i&&/^Win/i.test(r)&&!/^Windows Phone /i.test(r)&&(o=o[/[\d.]+$/.exec(r)])&&(r="Windows "+o),r=String(r),s&&i&&(r=r.replace(RegExp(s,"i"),i)),e=r=f(r.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])),e});function V(e){return b(e,function(e,n){var r=n.pattern||g(n);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=f(e[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e})}function B(e){return b(e,function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null})}if(P&&(P=[P]),/\bAndroid\b/.test(j)&&!D&&(s=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(D=E(s[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),M&&!D?D=V([M]):M&&D&&(D=D.replace(RegExp("^("+g(M)+")[-_.\\s]","i"),M+" ").replace(RegExp("^("+g(M)+")[-_.]?(\\w)","i"),M+" $2")),(s=/\bGoogle TV\b/.exec(D))&&(D=s[0]),/\bSimulator\b/i.test(t)&&(D=(D?D+" ":"")+"Simulator"),"Opera Mini"==L&&/\bOPiOS\b/.test(t)&&k.push("running in Turbo/Uncompressed mode"),"IE"==L&&/\blike iPhone OS\b/.test(t)?(M=(s=e(t.replace(/like iPhone OS/,""))).manufacturer,D=s.product):/^iP/.test(D)?(L||(L="Safari"),j="iOS"+((s=/ OS ([\d_]+)/i.exec(t))?" "+s[1].replace(/_/g,"."):"")):"Konqueror"==L&&/^Linux\b/i.test(j)?j="Kubuntu":M&&"Google"!=M&&(/Chrome/.test(L)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(D))||/\bAndroid\b/.test(j)&&/^Chrome/.test(L)&&/\bVersion\//i.test(t)?(L="Android Browser",j=/\bAndroid\b/.test(j)?j:"Android"):"Silk"==L?(/\bMobi/i.test(t)||(j="Android",k.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&k.unshift("accelerated")):"UC Browser"==L&&/\bUCWEB\b/.test(t)?k.push("speed mode"):"PaleMoon"==L&&(s=/\bFirefox\/([\d.]+)\b/.exec(t))?k.push("identifying as Firefox "+s[1]):"Firefox"==L&&(s=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(j||(j="Firefox OS"),D||(D=s[1])):!L||(s=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(L))?(L&&!D&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(s+"/")+8))&&(L=null),(s=D||M||j)&&(D||M||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(j))&&(L=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(j)?j:s)+" Browser")):"Electron"==L&&(s=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&k.push("Chromium "+s),A||(A=B(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",g(L),"(?:Firefox|Minefield|NetFront)"])),(s="iCab"==P&&parseFloat(A)>3&&"WebKit"||/\bOpera\b/.test(L)&&(/\bOPR\b/.test(t)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(P)&&"WebKit"||!P&&/\bMSIE\b/i.test(t)&&("Mac OS"==j?"Tasman":"Trident")||"WebKit"==P&&/\bPlayStation\b(?! Vita\b)/i.test(L)&&"NetFront")&&(P=[s]),"IE"==L&&(s=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(L+=" Mobile",j="Windows Phone "+(/\+$/.test(s)?s:s+".x"),k.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(L="IE Mobile",j="Windows Phone 8.x",k.unshift("desktop mode"),A||(A=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=L&&"Trident"==P&&(s=/\brv:([\d.]+)/.exec(t))&&(L&&k.push("identifying as "+L+(A?" "+A:"")),L="IE",A=s[1]),T){if(r="global",i=null!=(n=c)?typeof n[r]:"number",/^(?:boolean|number|string|undefined)$/.test(i)||"object"==i&&!n[r])v(s=c.runtime)==(u?S:"ScriptBridgingProxyObject")?(L="Adobe AIR",j=s.flash.system.Capabilities.os):v(s=c.phantom)==(u?S:"RuntimeObject")?(L="PhantomJS",A=(s=s.version||null)&&s.major+"."+s.minor+"."+s.patch):"number"==typeof O.documentMode&&(s=/\bTrident\/(\d+)/i.exec(t))?(A=[A,O.documentMode],(s=+s[1]+4)!=A[1]&&(k.push("IE "+A[1]+" mode"),P&&(P[1]=""),A[1]=s),A="IE"==L?String(A[1].toFixed(1)):A[0]):"number"==typeof O.documentMode&&/^(?:Chrome|Firefox)\b/.test(L)&&(k.push("masking as "+L+" "+A),L="IE",A="11.0",P=["Trident"],j="Windows");else if(w&&(R=(s=w.lang.System).getProperty("os.arch"),j=j||s.getProperty("os.name")+" "+s.getProperty("os.version")),x){try{A=c.require("ringo/engine").version.join("."),L="RingoJS"}catch(e){(s=c.system)&&s.global.system==c.system&&(L="Narwhal",j||(j=s[0].os||null))}L||(L="Rhino")}else"object"==typeof c.process&&!c.process.browser&&(s=c.process)&&("object"==typeof s.versions&&("string"==typeof s.versions.electron?(k.push("Node "+s.versions.node),L="Electron",A=s.versions.electron):"string"==typeof s.versions.nw&&(k.push("Chromium "+A,"Node "+s.versions.node),L="NW.js",A=s.versions.nw)),L||(L="Node.js",R=s.arch,j=s.platform,A=(A=/[\d.]+/.exec(s.version))?A[0]:null));j=j&&f(j)}if(A&&(s=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(A)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(T&&d.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(N=/b/i.test(s)?"beta":"alpha",A=A.replace(RegExp(s+"\\+?$"),"")+("beta"==N?w?"b":"β":w?"a":"α")+(/\d+\+?/.exec(s)||"")),"Fennec"==L||"Firefox"==L&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(j))L="Firefox Mobile";else if("Maxthon"==L&&A)A=A.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(D))"Xbox 360"==D&&(j=null),"Xbox 360"==D&&/\bIEMobile\b/.test(t)&&k.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(L)||L&&!D&&!/Browser|Mobi/.test(L))&&("Windows CE"==j||/Mobi/i.test(t)))L+=" Mobile";else if("IE"==L&&T)try{null===c.external&&k.unshift("platform preview")}catch(e){k.unshift("embedded")}else(/\bBlackBerry\b/.test(D)||/\bBB10\b/.test(t))&&(s=(RegExp(D.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||A)?(j=((s=[s,/BB10/.test(t)])[1]?(D=null,M="BlackBerry"):"Device Software")+" "+s[0],A=null):this!=m&&"Wii"!=D&&(T&&C||/Opera/.test(L)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==L&&/\bOS X (?:\d+\.){2,}/.test(j)||"IE"==L&&(j&&!/^Win/.test(j)&&A>5.5||/\bWindows XP\b/.test(j)&&A>8||8==A&&!/\bTrident\b/.test(t)))&&!l.test(s=e.call(m,t.replace(l,"")+";"))&&s.name&&(s="ing as "+s.name+((s=s.version)?" "+s:""),l.test(L)?(/\bIE\b/.test(s)&&"Mac OS"==j&&(j=null),s="identify"+s):(s="mask"+s,L=I?f(I.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(s)&&(j=null),T||(A=null)),P=["Presto"],k.push(s));(s=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(s=[parseFloat(s.replace(/\.(\d)$/,".0$1")),s],"Safari"==L&&"+"==s[1].slice(-1)?(L="WebKit Nightly",N="alpha",A=s[1].slice(0,-1)):(A==s[1]||A==(s[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1]))&&(A=null),s[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==s[0]&&537.36==s[2]&&parseFloat(s[1])>=28&&"WebKit"==P&&(P=["Blink"]),T&&(y||s[1])?(P&&(P[1]="like Chrome"),s=s[1]||((s=s[0])<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?"13+":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?"21+":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:"Blink"!=P?"27":"28")):(P&&(P[1]="like Safari"),s=(s=s[0])<400?1:s<500?2:s<526?3:s<533?4:s<534?"4+":s<535?5:s<537?6:s<538?7:s<601?8:s<602?9:s<604?10:s<606?11:s<608?12:"12"),P&&(P[1]+=" "+(s+="number"==typeof s?".x":/[.+]/.test(s)?"":"+")),"Safari"==L&&(!A||parseInt(A)>45)?A=s:"Chrome"==L&&/\bHeadlessChrome/i.test(t)&&k.unshift("headless")),"Opera"==L&&(s=/\bzbov|zvav$/.exec(j))?(L+=" ",k.unshift("desktop mode"),"zvav"==s?(L+="Mini",A=null):L+="Mobile",j=j.replace(RegExp(" *"+s+"$"),"")):"Safari"==L&&/\bChrome\b/.exec(P&&P[1])?(k.unshift("desktop mode"),L="Chrome Mobile",A=null,/\bOS X\b/.test(j)?(M="Apple",j="iOS 4.3+"):j=null):/\bSRWare Iron\b/.test(L)&&!A&&(A=B("Chrome")),A&&0==A.indexOf(s=/[\d.]+$/.exec(j))&&t.indexOf("/"+s+"-")>-1&&(j=E(j.replace(s,""))),j&&-1!=j.indexOf(L)&&!RegExp(L+" OS").test(j)&&(j=j.replace(RegExp(" *"+g(L)+" *"),"")),P&&!/\b(?:Avant|Nook)\b/.test(L)&&(/Browser|Lunascape|Maxthon/.test(L)||"Safari"!=L&&/^iOS/.test(j)&&/\bSafari\b/.test(P[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(L)&&P[1])&&(s=P[P.length-1])&&k.push(s),k.length&&(k=["("+k.join("; ")+")"]),M&&D&&0>D.indexOf(M)&&k.push("on "+M),D&&k.push((/^on /.test(k[k.length-1])?"":"on ")+D),j&&(a=(s=/ ([\d.+]+)$/.exec(j))&&"/"==j.charAt(j.length-s[0].length-1),j={architecture:32,family:s&&!a?j.replace(s[0],""):j,version:s?s[1]:null,toString:function(){var e=this.version;return this.family+(e&&!a?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(s=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(R))&&!/\bi686\b/i.test(R)?(j&&(j.architecture=64,j.family=j.family.replace(RegExp(" *"+s),"")),L&&(/\bWOW64\b/i.test(t)||T&&/\w(?:86|32)$/.test(d.cpuClass||d.platform)&&!/\bWin64; x64\b/i.test(t))&&k.unshift("32-bit")):j&&/^OS X/.test(j.family)&&"Chrome"==L&&parseFloat(A)>=39&&(j.architecture=64),t||(t=null);var U={};return U.description=t,U.layout=P&&P[0],U.manufacturer=M,U.name=L,U.prerelease=N,U.product=D,U.ua=t,U.version=L&&A,U.os=j||{architecture:null,family:null,version:null,toString:function(){return"null"}},U.parse=e,U.toString=function(){return this.description||""},U.version&&k.unshift(A),U.name&&k.unshift(L),j&&L&&!(j==String(j).split(" ")[0]&&(j==L.split(" ")[0]||D))&&k.push(D?"("+j+")":"on "+j),k.length&&(U.description=k.join(" ")),U}();o.platform=y,void 0!==(r=(function(){return y}).call(t,n,t,e))&&(e.exports=r)}).call(this)},66994:(e,t)=>{"use strict";var n,r=Object.prototype.hasOwnProperty;function i(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function o(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){var i,s,a=[];for(s in"string"!=typeof(t=t||"")&&(t="?"),e)if(r.call(e,s)){if(!(i=e[s])&&(null===i||i===n||isNaN(i))&&(i=""),s=o(s),i=o(i),null===s||null===i)continue;a.push(s+"="+i)}return a.length?t+a.join("&"):""},t.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,r={};t=n.exec(e);){var o=i(t[1]),s=i(t[2]);null===o||null===s||o in r||(r[o]=s)}return r}},94607:e=>{"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},5299:(e,t,n)=>{/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var r=n(14300),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(e,t,n){if("number"==typeof e)throw TypeError("Argument must not be a number");return i(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return r.SlowBuffer(e)}},4015:(e,t,n)=>{"use strict";var r=n(57299);e.exports=n(13550)(r),"_sockjs_onload"in global&&setTimeout(global._sockjs_onload,1)},84220:(e,t,n)=>{"use strict";var r=n(58555),i=n(32338);function o(){i.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}r(o,i),e.exports=o},32338:e=>{"use strict";function t(e){this.type=e}t.prototype.initEvent=function(e,t,n){return this.type=e,this.bubbles=t,this.cancelable=n,this.timeStamp=+new Date,this},t.prototype.stopPropagation=function(){},t.prototype.preventDefault=function(){},t.CAPTURING_PHASE=1,t.AT_TARGET=2,t.BUBBLING_PHASE=3,e.exports=t},64666:e=>{"use strict";function t(){this._listeners={}}t.prototype.addEventListener=function(e,t){e in this._listeners||(this._listeners[e]=[]);var n=this._listeners[e];-1===n.indexOf(t)&&(n=n.concat([t])),this._listeners[e]=n},t.prototype.removeEventListener=function(e,t){var n=this._listeners[e];if(n){var r=n.indexOf(t);if(-1!==r){n.length>1?this._listeners[e]=n.slice(0,r).concat(n.slice(r+1)):delete this._listeners[e];return}}},t.prototype.dispatchEvent=function(){var e=arguments[0],t=e.type,n=1==arguments.length?[e]:Array.apply(null,arguments);if(this["on"+t]&&this["on"+t].apply(this,n),t in this._listeners)for(var r=this._listeners[t],i=0;i<r.length;i++)r[i].apply(this,n)},e.exports=t},54777:(e,t,n)=>{"use strict";var r=n(58555),i=n(32338);function o(e){i.call(this),this.initEvent("message",!1,!1),this.data=e}r(o,i),e.exports=o},16433:(e,t,n)=>{"use strict";var r=n(29526);function i(e){this._transport=e,e.on("message",this._transportMessage.bind(this)),e.on("close",this._transportClose.bind(this))}i.prototype._transportClose=function(e,t){r.postMessage("c",JSON.stringify([e,t]))},i.prototype._transportMessage=function(e){r.postMessage("t",e)},i.prototype._send=function(e){this._transport.send(e)},i.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},e.exports=i},94705:(e,t,n)=>{"use strict";var r=n(61666),i=n(16252),o=n(16433),s=n(99749),a=n(29526),c=n(37943),l=function(){};e.exports=function(e,t){var n,u={};t.forEach(function(e){e.facadeTransport&&(u[e.facadeTransport.transportName]=e.facadeTransport)}),u[s.transportName]=s,e.bootstrap_iframe=function(){var t;a.currentWindowId=c.hash.slice(1),i.attachEvent("message",function(i){if(i.source===parent&&(void 0===n&&(n=i.origin),i.origin===n)){try{s=JSON.parse(i.data)}catch(e){l("bad json",i.data);return}if(s.windowId===a.currentWindowId)switch(s.type){case"s":try{d=JSON.parse(s.data)}catch(e){l("bad json",s.data);break}var s,d,h=d[0],p=d[1],f=d[2],m=d[3];if(l(h,p,f,m),h!==e.version)throw Error('Incompatible SockJS! Main site uses: "'+h+'", the iframe: "'+e.version+'".');if(!r.isOriginEqual(f,c.href)||!r.isOriginEqual(m,c.href))throw Error("Can't connect to different domain from within an iframe. ("+c.href+", "+f+", "+m+")");t=new o(new u[p](f,m));break;case"m":t._send(s.data);break;case"c":t&&t._close(),t=null}}}),a.postMessage("s")}}},73046:(e,t,n)=>{"use strict";var r=n(82361).EventEmitter,i=n(58555),o=n(71729),s=function(){};function a(e,t){r.call(this);var n=this,i=+new Date;this.xo=new t("GET",e),this.xo.once("finish",function(e,t){var r,a;if(200===e){if(a=+new Date-i,t)try{r=JSON.parse(t)}catch(e){s("bad json",t)}o.isObject(r)||(r={})}n.emit("finish",r,a),n.removeAllListeners()})}i(a,r),a.prototype.close=function(){this.removeAllListeners(),this.xo.close()},e.exports=a},99749:(e,t,n)=>{"use strict";var r=n(58555),i=n(82361).EventEmitter,o=n(62145),s=n(73046);function a(e){var t=this;i.call(this),this.ir=new s(e,o),this.ir.once("finish",function(e,n){t.ir=null,t.emit("message",JSON.stringify([e,n]))})}r(a,i),a.transportName="iframe-info-receiver",a.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},e.exports=a},89309:(e,t,n)=>{"use strict";var r=n(82361).EventEmitter,i=n(58555),o=n(16252),s=n(37264),a=n(99749),c=function(){};function l(e,t){var n=this;r.call(this);var i=function(){var r=n.ifr=new s(a.transportName,t,e);r.once("message",function(e){if(e){try{t=JSON.parse(e)}catch(t){c("bad json",e),n.emit("finish"),n.close();return}var t,r=t[0],i=t[1];n.emit("finish",r,i)}n.close()}),r.once("close",function(){n.emit("finish"),n.close()})};global.document.body?i():o.attachEvent("load",i)}i(l,r),l.enabled=function(){return s.enabled()},l.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},e.exports=l},79588:(e,t,n)=>{"use strict";var r=n(82361).EventEmitter,i=n(58555),o=n(61666),s=n(86706),a=n(29965),c=n(62145),l=n(92103),u=n(89309),d=n(73046),h=function(){};function p(e,t){h(e);var n=this;r.call(this),setTimeout(function(){n.doXhr(e,t)},0)}i(p,r),p._getReceiver=function(e,t,n){return n.sameOrigin?new d(t,c):a.enabled?new d(t,a):s.enabled&&n.sameScheme?new d(t,s):u.enabled()?new u(e,t):new d(t,l)},p.prototype.doXhr=function(e,t){var n=this,r=o.addPath(e,"/info");h("doXhr",r),this.xo=p._getReceiver(e,r,t),this.timeoutRef=setTimeout(function(){h("timeout"),n._cleanup(!1),n.emit("finish")},p.timeout),this.xo.once("finish",function(e,t){h("finish",e,t),n._cleanup(!0),n.emit("finish",e,t)})},p.prototype._cleanup=function(e){h("_cleanup"),clearTimeout(this.timeoutRef),this.timeoutRef=null,!e&&this.xo&&this.xo.close(),this.xo=null},p.prototype.close=function(){h("close"),this.removeAllListeners(),this._cleanup(!1)},p.timeout=8e3,e.exports=p},37943:e=>{"use strict";e.exports=global.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}},13550:(e,t,n)=>{"use strict";n(80796);var r,i=n(97110),o=n(58555),s=n(51130),a=n(9798),c=n(61666),l=n(16252),u=n(7703),d=n(71729),h=n(67734),p=n(20837),f=n(32338),m=n(64666),v=n(37943),g=n(84220),b=n(54777),E=n(79588),y=function(){};function S(e,t,n){if(!(this instanceof S))return new S(e,t,n);if(arguments.length<1)throw TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");m.call(this),this.readyState=S.CONNECTING,this.extensions="",this.protocol="",(n=n||{}).protocols_whitelist&&p.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=n.transports,this._transportOptions=n.transportOptions||{},this._timeout=n.timeout||0;var r=n.sessionId||8;if("function"==typeof r)this._generateSessionId=r;else if("number"==typeof r)this._generateSessionId=function(){return s.string(r)};else throw TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._server=n.server||s.numberString(1e3);var o=new i(e);if(o.host&&o.protocol){if(o.hash)throw SyntaxError("The URL must not contain a fragment");if("http:"!==o.protocol&&"https:"!==o.protocol)throw SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+o.protocol+"' is not allowed.")}else throw SyntaxError("The URL '"+e+"' is invalid");var a="https:"===o.protocol;if("https:"===v.protocol&&!a&&!c.isLoopbackAddr(o.hostname))throw Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");t?Array.isArray(t)||(t=[t]):t=[];var l=t.sort();l.forEach(function(e,t){if(!e)throw SyntaxError("The protocols entry '"+e+"' is invalid.");if(t<l.length-1&&e===l[t+1])throw SyntaxError("The protocols entry '"+e+"' is duplicated.")});var u=c.getOrigin(v.href);this._origin=u?u.toLowerCase():null,o.set("pathname",o.pathname.replace(/\/+$/,"")),this.url=o.href,y("using url",this.url),this._urlInfo={nullOrigin:!h.hasDomain(),sameOrigin:c.isOriginEqual(this.url,v.href),sameScheme:c.isSchemeEqual(this.url,v.href)},this._ir=new E(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}function _(e){return 1e3===e||e>=3e3&&e<=4999}o(S,m),S.prototype.close=function(e,t){if(e&&!_(e))throw Error("InvalidAccessError: Invalid code");if(t&&t.length>123)throw SyntaxError("reason argument has an invalid length");this.readyState!==S.CLOSING&&this.readyState!==S.CLOSED&&this._close(e||1e3,t||"Normal closure",!0)},S.prototype.send=function(e){if("string"!=typeof e&&(e=""+e),this.readyState===S.CONNECTING)throw Error("InvalidStateError: The connection has not been established yet");this.readyState===S.OPEN&&this._transport.send(a.quote(e))},S.version=n(21365),S.CONNECTING=0,S.OPEN=1,S.CLOSING=2,S.CLOSED=3,S.prototype._receiveInfo=function(e,t){if(y("_receiveInfo",t),this._ir=null,!e){this._close(1002,"Cannot connect to server");return}this._rto=this.countRTO(t),this._transUrl=e.base_url?e.base_url:this.url,y("info",e=d.extend(e,this._urlInfo));var n=r.filterToEnabled(this._transportsWhitelist,e);this._transports=n.main,y(this._transports.length+" enabled transports"),this._connect()},S.prototype._connect=function(){for(var e=this._transports.shift();e;e=this._transports.shift()){if(y("attempt",e.transportName),e.needBody&&(!global.document.body||void 0!==global.document.readyState&&"complete"!==global.document.readyState&&"interactive"!==global.document.readyState)){y("waiting for body"),this._transports.unshift(e),l.attachEvent("load",this._connect.bind(this));return}var t=Math.max(this._timeout,this._rto*e.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),t),y("using timeout",t);var n=c.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),r=this._transportOptions[e.transportName];y("transport url",n);var i=new e(n,this._transUrl,r);i.on("message",this._transportMessage.bind(this)),i.once("close",this._transportClose.bind(this)),i.transportName=e.transportName,this._transport=i;return}this._close(2e3,"All transports failed",!1)},S.prototype._transportTimeout=function(){y("_transportTimeout"),this.readyState===S.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))},S.prototype._transportMessage=function(e){y("_transportMessage",e);var t,n=this,r=e.slice(0,1),i=e.slice(1);switch(r){case"o":this._open();return;case"h":this.dispatchEvent(new f("heartbeat")),y("heartbeat",this.transport);return}if(i)try{t=JSON.parse(i)}catch(e){y("bad json",i)}if(void 0===t){y("empty payload",i);return}switch(r){case"a":Array.isArray(t)&&t.forEach(function(e){y("message",n.transport,e),n.dispatchEvent(new b(e))});break;case"m":y("message",this.transport,t),this.dispatchEvent(new b(t));break;case"c":Array.isArray(t)&&2===t.length&&this._close(t[0],t[1],!0)}},S.prototype._transportClose=function(e,t){if(y("_transportClose",this.transport,e,t),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),!_(e)&&2e3!==e&&this.readyState===S.CONNECTING){this._connect();return}this._close(e,t)},S.prototype._open=function(){y("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===S.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=S.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new f("open")),y("connected",this.transport)):this._close(1006,"Server lost session")},S.prototype._close=function(e,t,n){y("_close",this.transport,e,t,n,this.readyState);var r=!1;if(this._ir&&(r=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===S.CLOSED)throw Error("InvalidStateError: SockJS has already been closed");this.readyState=S.CLOSING,setTimeout((function(){this.readyState=S.CLOSED,r&&this.dispatchEvent(new f("error"));var i=new g("close");i.wasClean=n||!1,i.code=e||1e3,i.reason=t,this.dispatchEvent(i),this.onmessage=this.onclose=this.onerror=null,y("disconnected")}).bind(this),0)},S.prototype.countRTO=function(e){return e>100?4*e:300+e},e.exports=function(e){return r=u(e),n(94705)(S,e),S}},80796:()=>{"use strict";var e,t=Array.prototype,n=Object.prototype,r=Function.prototype,i=String.prototype,o=t.slice,s=n.toString,a=function(e){return"[object Function]"===n.toString.call(e)},c=function(e){return"[object String]"===s.call(e)};e=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}()?function(e,t,n,r){!r&&t in e||Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:n})}:function(e,t,n,r){!r&&t in e||(e[t]=n)};var l=function(t,r,i){for(var o in r)n.hasOwnProperty.call(r,o)&&e(t,o,r[o],i)},u=function(e){if(null==e)throw TypeError("can't convert "+e+" to object");return Object(e)};function d(){}l(r,{bind:function(e){var t=this;if(!a(t))throw TypeError("Function.prototype.bind called on incompatible "+t);for(var n=o.call(arguments,1),r=Math.max(0,t.length-n.length),i=[],s=0;s<r;s++)i.push("$"+s);var c=Function("binder","return function ("+i.join(",")+"){ return binder.apply(this, arguments); }")(function(){if(!(this instanceof c))return t.apply(e,n.concat(o.call(arguments)));var r=t.apply(this,n.concat(o.call(arguments)));return Object(r)===r?r:this});return t.prototype&&(d.prototype=t.prototype,c.prototype=new d,d.prototype=null),c}}),l(Array,{isArray:function(e){return"[object Array]"===s.call(e)}});var h=Object("a"),p="a"!==h[0]||!(0 in h);l(t,{forEach:function(e){var t=u(this),n=p&&c(this)?this.split(""):t,r=arguments[1],i=-1,o=n.length>>>0;if(!a(e))throw TypeError();for(;++i<o;)i in n&&e.call(r,n[i],i,t)}},!function(e){var t=!0,n=!0;return e&&(e.call("foo",function(e,n,r){"object"!=typeof r&&(t=!1)}),e.call([1],function(){n="string"==typeof this},"x")),!!e&&t&&n}(t.forEach)),l(t,{indexOf:function(e){var t,n,r=p&&c(this)?this.split(""):u(this),i=r.length>>>0;if(!i)return -1;var o=0;for(arguments.length>1&&(t=arguments[1],(n=+t)!=n?n=0:0!==n&&n!==1/0&&n!==-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n))),o=n),o=o>=0?o:Math.max(0,i+o);o<i;o++)if(o in r&&r[o]===e)return o;return -1}},Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2));var f=i.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?function(){var e=void 0===/()??/.exec("")[1];i.split=function(n,r){var i=this;if(void 0===n&&0===r)return[];if("[object RegExp]"!==s.call(n))return f.call(this,n,r);var o,a,c,l,u=[],d=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.extended?"x":"")+(n.sticky?"y":""),h=0;for(n=RegExp(n.source,d+"g"),i+="",e||(o=RegExp("^"+n.source+"$(?!\\s)",d)),r=void 0===r?4294967295:r>>>0;(a=n.exec(i))&&(!((c=a.index+a[0].length)>h)||(u.push(i.slice(h,a.index)),!e&&a.length>1&&a[0].replace(o,function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(a[e]=void 0)}),a.length>1&&a.index<i.length&&t.push.apply(u,a.slice(1)),l=a[0].length,h=c,!(u.length>=r)));)n.lastIndex===a.index&&n.lastIndex++;return h===i.length?(l||!n.test(""))&&u.push(""):u.push(i.slice(h)),u.length>r?u.slice(0,r):u}}():"0".split(void 0,0).length&&(i.split=function(e,t){return void 0===e&&0===t?[]:f.call(this,e,t)});var m=i.substr;l(i,{substr:function(e,t){return m.call(this,e<0&&(e=this.length+e)<0?0:e,t)}},"".substr&&"b"!=="0b".substr(-1))},57299:(e,t,n)=>{"use strict";e.exports=[n(39501),n(31709),n(29933),n(94428),n(8932)(n(94428)),n(50831),n(8932)(n(50831)),n(63103),n(72204),n(8932)(n(63103)),n(68621)]},82782:(e,t,n)=>{e.exports=n(81453).Client},81278:(e,t,n)=>{"use strict";var r=n(82361).EventEmitter,i=n(58555),o=n(13685),s=n(95687),a=n(97110),c=function(){};function l(e,t,n,i){c(e,t,n);var l=this;r.call(this);var u=new a(t),d={method:e,hostname:u.hostname.replace(/\[|\]/g,""),port:u.port,path:u.pathname+(u.query||""),headers:i&&i.headers},h="https:"===u.protocol?s:o;this.req=h.request(d,function(e){e.setEncoding("utf8");var t="";e.on("data",function(e){c("data",e),t+=e,l.emit("chunk",200,t)}),e.once("end",function(){c("end"),l.emit("finish",e.statusCode,t),l.req=null})}),this.req.on("error",function(e){c("error",e),l.emit("finish",0,e.message)}),n&&this.req.write(n),this.req.end()}i(l,r),l.prototype.close=function(){c("close"),this.removeAllListeners(),this.req&&(this.req.abort(),this.req=null)},l.enabled=!0,l.supportsCORS=!0,e.exports=l},94428:(e,t,n)=>{"use strict";var r=n(58555),i=n(42409),o=n(20506),s=n(29965),a=n(40056);function c(e){if(!c.enabled())throw Error("Transport created when disabled");i.call(this,e,"/eventsource",o,s)}r(c,i),c.enabled=function(){return!!a},c.transportName="eventsource",c.roundTrips=2,e.exports=c},50831:(e,t,n)=>{"use strict";var r=n(58555),i=n(63233),o=n(62145),s=n(42409);function a(e){if(!i.enabled)throw Error("Transport created when disabled");s.call(this,e,"/htmlfile",i,o)}r(a,s),a.enabled=function(e){return i.enabled&&e.sameOrigin},a.transportName="htmlfile",a.roundTrips=2,e.exports=a},37264:(e,t,n)=>{"use strict";var r=n(58555),i=n(82361).EventEmitter,o=n(21365),s=n(61666),a=n(29526),c=n(16252),l=n(51130),u=function(){};function d(e,t,n){if(!d.enabled())throw Error("Transport created when disabled");i.call(this);var r=this;this.origin=s.getOrigin(n),this.baseUrl=n,this.transUrl=t,this.transport=e,this.windowId=l.string(8);var o=s.addPath(n,"/iframe.html")+"#"+this.windowId;u(e,t,o),this.iframeObj=a.createIframe(o,function(e){u("err callback"),r.emit("close",1006,"Unable to load an iframe ("+e+")"),r.close()}),this.onmessageCallback=this._message.bind(this),c.attachEvent("message",this.onmessageCallback)}r(d,i),d.prototype.close=function(){if(u("close"),this.removeAllListeners(),this.iframeObj){c.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch(e){}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},d.prototype._message=function(e){var t,n;if(u("message",e.data),!s.isOriginEqual(e.origin,this.origin)){u("not same origin",e.origin,this.origin);return}try{t=JSON.parse(e.data)}catch(t){u("bad json",e.data);return}if(t.windowId!==this.windowId){u("mismatched window id",t.windowId,this.windowId);return}switch(t.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([o,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",t.data);break;case"c":try{n=JSON.parse(t.data)}catch(e){u("bad json",t.data);return}this.emit("close",n[0],n[1]),this.close()}},d.prototype.postMessage=function(e,t){u("postMessage",e,t),this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:e,data:t||""}),this.origin)},d.prototype.send=function(e){u("send",e),this.postMessage("m",e)},d.enabled=function(){return a.iframeEnabled},d.transportName="iframe",d.roundTrips=2,e.exports=d},68621:(e,t,n)=>{"use strict";var r=n(58555),i=n(54609),o=n(26518),s=n(35241);function a(e){if(!a.enabled())throw Error("Transport created when disabled");i.call(this,e,"/jsonp",s,o)}r(a,i),a.enabled=function(){return!!global.document},a.transportName="jsonp-polling",a.roundTrips=1,a.needBody=!0,e.exports=a},42409:(e,t,n)=>{"use strict";var r=n(58555),i=n(61666),o=n(54609),s=function(){};function a(e,t,n,r){o.call(this,e,t,function(e,t,n){s("create ajax sender",e,t);var o={};"string"==typeof t&&(o.headers={"Content-type":"text/plain"});var a=new r("POST",i.addPath(e,"/xhr_send"),t,o);return a.once("finish",function(e){if(s("finish",e),a=null,200!==e&&204!==e)return n(Error("http status "+e));n()}),function(){s("abort"),a.close(),a=null;var e=Error("Aborted");e.code=1e3,n(e)}},n,r)}r(a,o),e.exports=a},74752:(e,t,n)=>{"use strict";var r=n(58555),i=n(82361).EventEmitter,o=function(){};function s(e,t){o(e),i.call(this),this.sendBuffer=[],this.sender=t,this.url=e}r(s,i),s.prototype.send=function(e){o("send",e),this.sendBuffer.push(e),this.sendStop||this.sendSchedule()},s.prototype.sendScheduleWait=function(){o("sendScheduleWait");var e,t=this;this.sendStop=function(){o("sendStop"),t.sendStop=null,clearTimeout(e)},e=setTimeout(function(){o("timeout"),t.sendStop=null,t.sendSchedule()},25)},s.prototype.sendSchedule=function(){o("sendSchedule",this.sendBuffer.length);var e=this;if(this.sendBuffer.length>0){var t="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,t,function(t){e.sendStop=null,t?(o("error",t),e.emit("close",t.code||1006,"Sending error: "+t),e.close()):e.sendScheduleWait()}),this.sendBuffer=[]}},s.prototype._cleanup=function(){o("_cleanup"),this.removeAllListeners()},s.prototype.close=function(){o("close"),this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)},e.exports=s},8932:(e,t,n)=>{"use strict";var r=n(58555),i=n(37264),o=n(71729);e.exports=function(e){function t(t,n){i.call(this,e.transportName,t,n)}return r(t,i),t.enabled=function(t,n){if(!global.document)return!1;var r=o.extend({},n);return r.sameOrigin=!0,e.enabled(r)&&i.enabled()},t.transportName="iframe-"+e.transportName,t.needBody=!0,t.roundTrips=i.roundTrips+e.roundTrips-1,t.facadeTransport=e,t}},58721:(e,t,n)=>{"use strict";var r=n(58555),i=n(82361).EventEmitter,o=function(){};function s(e,t,n){o(t),i.call(this),this.Receiver=e,this.receiveUrl=t,this.AjaxObject=n,this._scheduleReceiver()}r(s,i),s.prototype._scheduleReceiver=function(){o("_scheduleReceiver");var e=this,t=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);t.on("message",function(t){o("message",t),e.emit("message",t)}),t.once("close",function(n,r){o("close",n,r,e.pollIsClosing),e.poll=t=null,e.pollIsClosing||("network"===r?e._scheduleReceiver():(e.emit("close",n||1006,r),e.removeAllListeners()))})},s.prototype.abort=function(){o("abort"),this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},e.exports=s},54609:(e,t,n)=>{"use strict";var r=n(58555),i=n(61666),o=n(74752),s=n(58721),a=function(){};function c(e,t,n,r,c){var l=i.addPath(e,t);a(l);var u=this;o.call(this,e,n),this.poll=new s(r,l,c),this.poll.on("message",function(e){a("poll message",e),u.emit("message",e)}),this.poll.once("close",function(e,t){a("poll close",e,t),u.poll=null,u.emit("close",e,t),u.close()})}r(c,o),c.prototype.close=function(){o.prototype.close.call(this),a("close"),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)},e.exports=c},20506:(e,t,n)=>{"use strict";var r=n(58555),i=n(82361).EventEmitter,o=n(40056),s=function(){};function a(e){s(e),i.call(this);var t=this,n=this.es=new o(e);n.onmessage=function(e){s("message",e.data),t.emit("message",decodeURI(e.data))},n.onerror=function(e){s("error",n.readyState,e);var r=2!==n.readyState?"network":"permanent";t._cleanup(),t._close(r)}}r(a,i),a.prototype.abort=function(){s("abort"),this._cleanup(),this._close("user")},a.prototype._cleanup=function(){s("cleanup");var e=this.es;e&&(e.onmessage=e.onerror=null,e.close(),this.es=null)},a.prototype._close=function(e){s("close",e);var t=this;setTimeout(function(){t.emit("close",null,e),t.removeAllListeners()},200)},e.exports=a},63233:(e,t,n)=>{"use strict";var r=n(58555),i=n(29526),o=n(61666),s=n(82361).EventEmitter,a=n(51130),c=function(){};function l(e){c(e),s.call(this);var t=this;i.polluteGlobalNamespace(),this.id="a"+a.string(6),e=o.addQuery(e,"c="+decodeURIComponent(i.WPrefix+"."+this.id)),c("using htmlfile",l.htmlfileEnabled);var n=l.htmlfileEnabled?i.createHtmlfile:i.createIframe;global[i.WPrefix][this.id]={start:function(){c("start"),t.iframeObj.loaded()},message:function(e){c("message",e),t.emit("message",e)},stop:function(){c("stop"),t._cleanup(),t._close("network")}},this.iframeObj=n(e,function(){c("callback"),t._cleanup(),t._close("permanent")})}r(l,s),l.prototype.abort=function(){c("abort"),this._cleanup(),this._close("user")},l.prototype._cleanup=function(){c("_cleanup"),this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete global[i.WPrefix][this.id]},l.prototype._close=function(e){c("_close",e),this.emit("close",null,e),this.removeAllListeners()},l.htmlfileEnabled=!1;var u=["Active"].concat("Object").join("X");if(u in global)try{l.htmlfileEnabled=(new global[u]("htmlfile"),!0)}catch(e){}l.enabled=l.htmlfileEnabled||i.iframeEnabled,e.exports=l},26518:(e,t,n)=>{"use strict";var r=n(29526),i=n(51130),o=n(67734),s=n(61666),a=n(58555),c=n(82361).EventEmitter,l=function(){};function u(e){l(e);var t=this;c.call(this),r.polluteGlobalNamespace(),this.id="a"+i.string(6);var n=s.addQuery(e,"c="+encodeURIComponent(r.WPrefix+"."+this.id));global[r.WPrefix][this.id]=this._callback.bind(this),this._createScript(n),this.timeoutId=setTimeout(function(){l("timeout"),t._abort(Error("JSONP script loaded abnormally (timeout)"))},u.timeout)}a(u,c),u.prototype.abort=function(){if(l("abort"),global[r.WPrefix][this.id]){var e=Error("JSONP user aborted read");e.code=1e3,this._abort(e)}},u.timeout=35e3,u.scriptErrorTimeout=1e3,u.prototype._callback=function(e){l("_callback",e),this._cleanup(),this.aborting||(e&&(l("message",e),this.emit("message",e)),this.emit("close",null,"network"),this.removeAllListeners())},u.prototype._abort=function(e){l("_abort",e),this._cleanup(),this.aborting=!0,this.emit("close",e.code,e.message),this.removeAllListeners()},u.prototype._cleanup=function(){if(l("_cleanup"),clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var e=this.script;e.parentNode.removeChild(e),e.onreadystatechange=e.onerror=e.onload=e.onclick=null,this.script=null}delete global[r.WPrefix][this.id]},u.prototype._scriptError=function(){l("_scriptError");var e=this;this.errorTimer||(this.errorTimer=setTimeout(function(){e.loadedOkay||e._abort(Error("JSONP script loaded abnormally (onerror)"))},u.scriptErrorTimeout))},u.prototype._createScript=function(e){l("_createScript",e);var t,n=this,r=this.script=global.document.createElement("script");if(r.id="a"+i.string(8),r.src=e,r.type="text/javascript",r.charset="UTF-8",r.onerror=this._scriptError.bind(this),r.onload=function(){l("onload"),n._abort(Error("JSONP script loaded abnormally (onload)"))},r.onreadystatechange=function(){if(l("onreadystatechange",r.readyState),/loaded|closed/.test(r.readyState)){if(r&&r.htmlFor&&r.onclick){n.loadedOkay=!0;try{r.onclick()}catch(e){}}r&&n._abort(Error("JSONP script loaded abnormally (onreadystatechange)"))}},void 0===r.async&&global.document.attachEvent){if(o.isOpera())(t=this.script2=global.document.createElement("script")).text="try{var a = document.getElementById('"+r.id+"'); if(a)a.onerror();}catch(x){};",r.async=t.async=!1;else{try{r.htmlFor=r.id,r.event="onclick"}catch(e){}r.async=!0}}void 0!==r.async&&(r.async=!0);var s=global.document.getElementsByTagName("head")[0];s.insertBefore(r,s.firstChild),t&&s.insertBefore(t,s.firstChild)},e.exports=u},92499:(e,t,n)=>{"use strict";var r=n(58555),i=n(82361).EventEmitter,o=function(){};function s(e,t){o(e),i.call(this);var n=this;this.bufferPosition=0,this.xo=new t("POST",e,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(e,t){o("finish",e,t),n._chunkHandler(e,t),n.xo=null;var r=200===e?"network":"permanent";o("close",r),n.emit("close",null,r),n._cleanup()})}r(s,i),s.prototype._chunkHandler=function(e,t){if(o("_chunkHandler",e),200===e&&t)for(var n=-1;;this.bufferPosition+=n+1){var r=t.slice(this.bufferPosition);if(-1===(n=r.indexOf("\n")))break;var i=r.slice(0,n);i&&(o("message",i),this.emit("message",i))}},s.prototype._cleanup=function(){o("_cleanup"),this.removeAllListeners()},s.prototype.abort=function(){o("abort"),this.xo&&(this.xo.close(),o("close"),this.emit("close",null,"user"),this.xo=null),this._cleanup()},e.exports=s},35241:(e,t,n)=>{"use strict";var r,i,o=n(51130),s=n(61666),a=function(){};e.exports=function(e,t,n){a(e,t),r||(a("createForm"),(r=global.document.createElement("form")).style.display="none",r.style.position="absolute",r.method="POST",r.enctype="application/x-www-form-urlencoded",r.acceptCharset="UTF-8",(i=global.document.createElement("textarea")).name="d",r.appendChild(i),global.document.body.appendChild(r));var c="a"+o.string(8);r.target=c,r.action=s.addQuery(s.addPath(e,"/jsonp_send"),"i="+c);var l=function(e){a("createIframe",e);try{return global.document.createElement('<iframe name="'+e+'">')}catch(n){var t=global.document.createElement("iframe");return t.name=e,t}}(c);l.id=c,l.style.display="none",r.appendChild(l);try{i.value=t}catch(e){}r.submit();var u=function(e){a("completed",c,e),l.onerror&&(l.onreadystatechange=l.onerror=l.onload=null,setTimeout(function(){a("cleaning up",c),l.parentNode.removeChild(l),l=null},500),i.value="",n(e))};return l.onerror=function(){a("onerror",c),u()},l.onload=function(){a("onload",c),u()},l.onreadystatechange=function(e){a("onreadystatechange",c,l.readyState,e),"complete"===l.readyState&&u()},function(){a("aborted",c),u(Error("Aborted"))}}},86706:(e,t,n)=>{"use strict";var r=n(82361).EventEmitter,i=n(58555),o=n(16252),s=n(67734),a=n(61666),c=function(){};function l(e,t,n){c(e,t);var i=this;r.call(this),setTimeout(function(){i._start(e,t,n)},0)}i(l,r),l.prototype._start=function(e,t,n){c("_start");var r=this,i=new global.XDomainRequest;t=a.addQuery(t,"t="+ +new Date),i.onerror=function(){c("onerror"),r._error()},i.ontimeout=function(){c("ontimeout"),r._error()},i.onprogress=function(){c("progress",i.responseText),r.emit("chunk",200,i.responseText)},i.onload=function(){c("load"),r.emit("finish",200,i.responseText),r._cleanup(!1)},this.xdr=i,this.unloadRef=o.unloadAdd(function(){r._cleanup(!0)});try{this.xdr.open(e,t),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(n)}catch(e){this._error()}},l.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},l.prototype._cleanup=function(e){if(c("cleanup",e),this.xdr){if(this.removeAllListeners(),o.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,e)try{this.xdr.abort()}catch(e){}this.unloadRef=this.xdr=null}},l.prototype.close=function(){c("close"),this._cleanup(!0)},l.enabled=!!(global.XDomainRequest&&s.hasDomain()),e.exports=l},29965:(e,t,n)=>{"use strict";var r=n(58555),i=n(81278);function o(e,t,n,r){i.call(this,e,t,n,r)}r(o,i),o.enabled=i.enabled&&i.supportsCORS,e.exports=o},92103:(e,t,n)=>{"use strict";var r=n(82361).EventEmitter;function i(){var e=this;r.call(this),this.to=setTimeout(function(){e.emit("finish",200,"{}")},i.timeout)}n(58555)(i,r),i.prototype.close=function(){clearTimeout(this.to)},i.timeout=2e3,e.exports=i},62145:(e,t,n)=>{"use strict";var r=n(58555),i=n(81278);function o(e,t,n){i.call(this,e,t,n,{noCredentials:!0})}r(o,i),o.enabled=i.enabled,e.exports=o},39501:(e,t,n)=>{"use strict";var r=n(16252),i=n(61666),o=n(58555),s=n(82361).EventEmitter,a=n(82782),c=function(){};function l(e,t,n){if(!l.enabled())throw Error("Transport created when disabled");s.call(this),c("constructor",e);var o=this,u=i.addPath(e,"/websocket");u="https"===u.slice(0,5)?"wss"+u.slice(5):"ws"+u.slice(4),this.url=u,this.ws=new a(this.url,[],n),this.ws.onmessage=function(e){c("message event",e.data),o.emit("message",e.data)},this.unloadRef=r.unloadAdd(function(){c("unload"),o.ws.close()}),this.ws.onclose=function(e){c("close event",e.code,e.reason),o.emit("close",e.code,e.reason),o._cleanup()},this.ws.onerror=function(e){c("error event",e),o.emit("close",1006,"WebSocket connection broken"),o._cleanup()}}o(l,s),l.prototype.send=function(e){var t="["+e+"]";c("send",t),this.ws.send(t)},l.prototype.close=function(){c("close");var e=this.ws;this._cleanup(),e&&e.close()},l.prototype._cleanup=function(){c("_cleanup");var e=this.ws;e&&(e.onmessage=e.onclose=e.onerror=null),r.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},l.enabled=function(){return c("enabled"),!!a},l.transportName="websocket",l.roundTrips=2,e.exports=l},72204:(e,t,n)=>{"use strict";var r=n(58555),i=n(42409),o=n(29933),s=n(92499),a=n(86706);function c(e){if(!a.enabled)throw Error("Transport created when disabled");i.call(this,e,"/xhr",s,a)}r(c,i),c.enabled=o.enabled,c.transportName="xdr-polling",c.roundTrips=2,e.exports=c},29933:(e,t,n)=>{"use strict";var r=n(58555),i=n(42409),o=n(92499),s=n(86706);function a(e){if(!s.enabled)throw Error("Transport created when disabled");i.call(this,e,"/xhr_streaming",o,s)}r(a,i),a.enabled=function(e){return!e.cookie_needed&&!e.nullOrigin&&s.enabled&&e.sameScheme},a.transportName="xdr-streaming",a.roundTrips=2,e.exports=a},63103:(e,t,n)=>{"use strict";var r=n(58555),i=n(42409),o=n(92499),s=n(29965),a=n(62145);function c(e){if(!a.enabled&&!s.enabled)throw Error("Transport created when disabled");i.call(this,e,"/xhr",o,s)}r(c,i),c.enabled=function(e){return!e.nullOrigin&&(!!a.enabled&&!!e.sameOrigin||s.enabled)},c.transportName="xhr-polling",c.roundTrips=2,e.exports=c},31709:(e,t,n)=>{"use strict";var r=n(58555),i=n(42409),o=n(92499),s=n(29965),a=n(62145),c=n(67734);function l(e){if(!a.enabled&&!s.enabled)throw Error("Transport created when disabled");i.call(this,e,"/xhr_streaming",o,s)}r(l,i),l.enabled=function(e){return!(e.nullOrigin||c.isOpera())&&s.enabled},l.transportName="xhr-streaming",l.roundTrips=2,l.needBody=!!global.document,e.exports=l},67734:e=>{"use strict";e.exports={isOpera:function(){return global.navigator&&/opera/i.test(global.navigator.userAgent)},isKonqueror:function(){return global.navigator&&/konqueror/i.test(global.navigator.userAgent)},hasDomain:function(){if(!global.document)return!0;try{return!!global.document.domain}catch(e){return!1}}}},9798:e=>{"use strict";var t,n=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,r=function(e){var t,n={},r=[];for(t=0;t<65536;t++)r.push(String.fromCharCode(t));return e.lastIndex=0,r.join("").replace(e,function(e){return n[e]="\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4),""}),e.lastIndex=0,n};e.exports={quote:function(e){var i=JSON.stringify(e);return(n.lastIndex=0,n.test(i))?(t||(t=r(n)),i.replace(n,function(e){return t[e]})):i}}},16252:(e,t,n)=>{"use strict";var r=n(51130),i={},o=!1,s=global.chrome&&global.chrome.app&&global.chrome.app.runtime;e.exports={attachEvent:function(e,t){void 0!==global.addEventListener?global.addEventListener(e,t,!1):global.document&&global.attachEvent&&(global.document.attachEvent("on"+e,t),global.attachEvent("on"+e,t))},detachEvent:function(e,t){void 0!==global.addEventListener?global.removeEventListener(e,t,!1):global.document&&global.detachEvent&&(global.document.detachEvent("on"+e,t),global.detachEvent("on"+e,t))},unloadAdd:function(e){if(s)return null;var t=r.string(8);return i[t]=e,o&&setTimeout(this.triggerUnloadCallbacks,0),t},unloadDel:function(e){e in i&&delete i[e]},triggerUnloadCallbacks:function(){for(var e in i)i[e](),delete i[e]}},s||e.exports.attachEvent("unload",function(){o||(o=!0,e.exports.triggerUnloadCallbacks())})},29526:(e,t,n)=>{"use strict";var r=n(16252),i=n(67734),o=function(){};e.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){e.exports.WPrefix in global||(global[e.exports.WPrefix]={})},postMessage:function(t,n){global.parent!==global?global.parent.postMessage(JSON.stringify({windowId:e.exports.currentWindowId,type:t,data:n||""}),"*"):o("Cannot postMessage, no parent window.",t,n)},createIframe:function(e,t){var n,i,s=global.document.createElement("iframe"),a=function(){o("unattach"),clearTimeout(n);try{s.onload=null}catch(e){}s.onerror=null},c=function(){o("cleanup"),s&&(a(),setTimeout(function(){s&&s.parentNode.removeChild(s),s=null},0),r.unloadDel(i))},l=function(e){o("onerror",e),s&&(c(),t(e))};return s.src=e,s.style.display="none",s.style.position="absolute",s.onerror=function(){l("onerror")},s.onload=function(){o("onload"),clearTimeout(n),n=setTimeout(function(){l("onload timeout")},2e3)},global.document.body.appendChild(s),n=setTimeout(function(){l("timeout")},15e3),i=r.unloadAdd(c),{post:function(e,t){o("post",e,t),setTimeout(function(){try{s&&s.contentWindow&&s.contentWindow.postMessage(e,t)}catch(e){}},0)},cleanup:c,loaded:a}},createHtmlfile:function(t,n){var i,s,a,c=["Active"].concat("Object").join("X"),l=new global[c]("htmlfile"),u=function(){clearTimeout(i),a.onerror=null},d=function(){l&&(u(),r.unloadDel(s),a.parentNode.removeChild(a),a=l=null,CollectGarbage())},h=function(e){o("onerror",e),l&&(d(),n(e))};l.open(),l.write('<html><script>document.domain="'+global.document.domain+'";</script></html>'),l.close(),l.parentWindow[e.exports.WPrefix]=global[e.exports.WPrefix];var p=l.createElement("div");return l.body.appendChild(p),a=l.createElement("iframe"),p.appendChild(a),a.src=t,a.onerror=function(){h("onerror")},i=setTimeout(function(){h("timeout")},15e3),s=r.unloadAdd(d),{post:function(e,t){try{setTimeout(function(){a&&a.contentWindow&&a.contentWindow.postMessage(e,t)},0)}catch(e){}},cleanup:d,loaded:u}}},e.exports.iframeEnabled=!1,global.document&&(e.exports.iframeEnabled=("function"==typeof global.postMessage||"object"==typeof global.postMessage)&&!i.isKonqueror())},20837:e=>{"use strict";var t={};["log","debug","warn"].forEach(function(e){var n;try{n=global.console&&global.console[e]&&global.console[e].apply}catch(e){}t[e]=n?function(){return global.console[e].apply(global.console,arguments)}:"log"===e?function(){}:t.log}),e.exports=t},71729:e=>{"use strict";e.exports={isObject:function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},extend:function(e){if(!this.isObject(e))return e;for(var t,n,r=1,i=arguments.length;r<i;r++)for(n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}}},51130:(e,t,n)=>{"use strict";var r=n(6113),i="abcdefghijklmnopqrstuvwxyz012345";e.exports={string:function(e){for(var t=i.length,n=r.randomBytes(e),o=[],s=0;s<e;s++)o.push(i.substr(n[s]%t,1));return o.join("")},number:function(e){return Math.floor(Math.random()*e)},numberString:function(e){var t=(""+(e-1)).length;return(Array(t+1).join("0")+this.number(e)).slice(-t)}}},7703:e=>{"use strict";var t=function(){};e.exports=function(e){return{filterToEnabled:function(n,r){var i={main:[],facade:[]};return n?"string"==typeof n&&(n=[n]):n=[],e.forEach(function(e){if(e){if("websocket"===e.transportName&&!1===r.websocket){t("disabled from server","websocket");return}if(n.length&&-1===n.indexOf(e.transportName)){t("not in whitelist",e.transportName);return}e.enabled(r)?(t("enabled",e.transportName),i.main.push(e),e.facadeTransport&&i.facade.push(e.facadeTransport)):t("disabled",e.transportName)}}),i}}}},61666:(e,t,n)=>{"use strict";var r=n(97110),i=function(){};e.exports={getOrigin:function(e){if(!e)return null;var t=new r(e);if("file:"===t.protocol)return null;var n=t.port;return n||(n="https:"===t.protocol?"443":"80"),t.protocol+"//"+t.hostname+":"+n},isOriginEqual:function(e,t){var n=this.getOrigin(e)===this.getOrigin(t);return i("same",e,t,n),n},isSchemeEqual:function(e,t){return e.split(":")[0]===t.split(":")[0]},addPath:function(e,t){var n=e.split("?");return n[0]+t+(n[1]?"?"+n[1]:"")},addQuery:function(e,t){return e+(-1===e.indexOf("?")?"?"+t:"&"+t)},isLoopbackAddr:function(e){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^\[::1\]$/.test(e)}}},21365:e=>{e.exports="1.6.1"},97110:(e,t,n)=>{"use strict";var r=n(94607),i=n(66994),o=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,s=/[\n\r\t]/g,a=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,c=/:\d+$/,l=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,u=/^[a-zA-Z]:/;function d(e){return(e||"").toString().replace(o,"")}var h=[["#","hash"],["?","query"],function(e,t){return m(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],p={hash:1,query:1};function f(e){var t,n=("undefined"!=typeof global?global:"undefined"!=typeof self?self:{}).location||{},r={},i=typeof(e=e||n);if("blob:"===e.protocol)r=new g(unescape(e.pathname),{});else if("string"===i)for(t in r=new g(e,{}),p)delete r[t];else if("object"===i){for(t in e)t in p||(r[t]=e[t]);void 0===r.slashes&&(r.slashes=a.test(e.href))}return r}function m(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function v(e,t){e=(e=d(e)).replace(s,""),t=t||{};var n,r=l.exec(e),i=r[1]?r[1].toLowerCase():"",o=!!r[2],a=!!r[3],c=0;return o?a?(n=r[2]+r[3]+r[4],c=r[2].length+r[3].length):(n=r[2]+r[4],c=r[2].length):a?(n=r[3]+r[4],c=r[3].length):n=r[4],"file:"===i?c>=2&&(n=n.slice(2)):m(i)?n=r[4]:i?o&&(n=n.slice(2)):c>=2&&m(t.protocol)&&(n=r[4]),{protocol:i,slashes:o||m(i),slashesCount:c,rest:n}}function g(e,t,n){if(e=(e=d(e)).replace(s,""),!(this instanceof g))return new g(e,t,n);var o,a,c,l,p,b,E=h.slice(),y=typeof t,S=0;for("object"!==y&&"string"!==y&&(n=t,t=null),n&&"function"!=typeof n&&(n=i.parse),o=!(a=v(e||"",t=f(t))).protocol&&!a.slashes,this.slashes=a.slashes||o&&t.slashes,this.protocol=a.protocol||t.protocol||"",e=a.rest,("file:"===a.protocol&&(2!==a.slashesCount||u.test(e))||!a.slashes&&(a.protocol||a.slashesCount<2||!m(this.protocol)))&&(E[3]=[/(.*)/,"pathname"]);S<E.length;S++){if("function"==typeof(l=E[S])){e=l(e,this);continue}c=l[0],b=l[1],c!=c?this[b]=e:"string"==typeof c?~(p="@"===c?e.lastIndexOf(c):e.indexOf(c))&&("number"==typeof l[2]?(this[b]=e.slice(0,p),e=e.slice(p+l[2])):(this[b]=e.slice(p),e=e.slice(0,p))):(p=c.exec(e))&&(this[b]=p[1],e=e.slice(0,p.index)),this[b]=this[b]||o&&l[3]&&t[b]||"",l[4]&&(this[b]=this[b].toLowerCase())}n&&(this.query=n(this.query)),o&&t.slashes&&"/"!==this.pathname.charAt(0)&&(""!==this.pathname||""!==t.pathname)&&(this.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,i=n[r-1],o=!1,s=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),s++):s&&(0===r&&(o=!0),n.splice(r,1),s--);return o&&n.unshift(""),("."===i||".."===i)&&n.push(""),n.join("/")}(this.pathname,t.pathname)),"/"!==this.pathname.charAt(0)&&m(this.protocol)&&(this.pathname="/"+this.pathname),r(this.port,this.protocol)||(this.host=this.hostname,this.port=""),this.username=this.password="",this.auth&&(~(p=this.auth.indexOf(":"))?(this.username=this.auth.slice(0,p),this.username=encodeURIComponent(decodeURIComponent(this.username)),this.password=this.auth.slice(p+1),this.password=encodeURIComponent(decodeURIComponent(this.password))):this.username=encodeURIComponent(decodeURIComponent(this.auth)),this.auth=this.password?this.username+":"+this.password:this.username),this.origin="file:"!==this.protocol&&m(this.protocol)&&this.host?this.protocol+"//"+this.host:"null",this.href=this.toString()}g.prototype={set:function(e,t,n){switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||i.parse)(t)),this[e]=t;break;case"port":this[e]=t,r(t,this.protocol)?t&&(this.host=this.hostname+":"+t):(this.host=this.hostname,this[e]="");break;case"hostname":this[e]=t,this.port&&(t+=":"+this.port),this.host=t;break;case"host":this[e]=t,c.test(t)?(t=t.split(":"),this.port=t.pop(),this.hostname=t.join(":")):(this.hostname=t,this.port="");break;case"protocol":this.protocol=t.toLowerCase(),this.slashes=!n;break;case"pathname":case"hash":if(t){var o="pathname"===e?"/":"#";this[e]=t.charAt(0)!==o?o+t:t}else this[e]=t;break;case"username":case"password":this[e]=encodeURIComponent(t);break;case"auth":var s=t.indexOf(":");~s?(this.username=t.slice(0,s),this.username=encodeURIComponent(decodeURIComponent(this.username)),this.password=t.slice(s+1),this.password=encodeURIComponent(decodeURIComponent(this.password))):this.username=encodeURIComponent(decodeURIComponent(t))}for(var a=0;a<h.length;a++){var l=h[a];l[4]&&(this[l[1]]=this[l[1]].toLowerCase())}return this.auth=this.password?this.username+":"+this.password:this.username,this.origin="file:"!==this.protocol&&m(this.protocol)&&this.host?this.protocol+"//"+this.host:"null",this.href=this.toString(),this},toString:function(e){e&&"function"==typeof e||(e=i.stringify);var t,n=this.host,r=this.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var o=r+(this.protocol&&this.slashes||m(this.protocol)?"//":"");return this.username?(o+=this.username,this.password&&(o+=":"+this.password),o+="@"):this.password?o+=":"+this.password+"@":"file:"!==this.protocol&&m(this.protocol)&&!n&&"/"!==this.pathname&&(o+="@"),(":"===n[n.length-1]||c.test(this.hostname)&&!this.port)&&(n+=":"),o+=n+this.pathname,(t="object"==typeof this.query?e(this.query):this.query)&&(o+="?"!==t.charAt(0)?"?"+t:t),this.hash&&(o+=this.hash),o}},g.extractProtocol=v,g.location=f,g.trimLeft=d,g.qs=i,e.exports=g},88996:(e,t,n)=>{"use strict";let r,i;n.r(t),n.d(t,{NIL:()=>x,parse:()=>b,stringify:()=>f,v1:()=>g,v3:()=>y,v4:()=>_,v5:()=>w,validate:()=>d,version:()=>O});var o=n(6113),s=n.n(o);let a=new Uint8Array(256),c=a.length;function l(){return c>a.length-16&&(s().randomFillSync(a),c=0),a.slice(c,c+=16)}let u=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,d=function(e){return"string"==typeof e&&u.test(e)},h=[];for(let e=0;e<256;++e)h.push((e+256).toString(16).slice(1));function p(e,t=0){return(h[e[t+0]]+h[e[t+1]]+h[e[t+2]]+h[e[t+3]]+"-"+h[e[t+4]]+h[e[t+5]]+"-"+h[e[t+6]]+h[e[t+7]]+"-"+h[e[t+8]]+h[e[t+9]]+"-"+h[e[t+10]]+h[e[t+11]]+h[e[t+12]]+h[e[t+13]]+h[e[t+14]]+h[e[t+15]]).toLowerCase()}let f=function(e,t=0){let n=p(e,t);if(!d(n))throw TypeError("Stringified UUID is invalid");return n},m=0,v=0,g=function(e,t,n){let o=t&&n||0,s=t||Array(16),a=(e=e||{}).node||r,c=void 0!==e.clockseq?e.clockseq:i;if(null==a||null==c){let t=e.random||(e.rng||l)();null==a&&(a=r=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==c&&(c=i=(t[6]<<8|t[7])&16383)}let u=void 0!==e.msecs?e.msecs:Date.now(),d=void 0!==e.nsecs?e.nsecs:v+1,h=u-m+(d-v)/1e4;if(h<0&&void 0===e.clockseq&&(c=c+1&16383),(h<0||u>m)&&void 0===e.nsecs&&(d=0),d>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");m=u,v=d,i=c;let f=((268435455&(u+=122192928e5))*1e4+d)%4294967296;s[o++]=f>>>24&255,s[o++]=f>>>16&255,s[o++]=f>>>8&255,s[o++]=255&f;let g=u/4294967296*1e4&268435455;s[o++]=g>>>8&255,s[o++]=255&g,s[o++]=g>>>24&15|16,s[o++]=g>>>16&255,s[o++]=c>>>8|128,s[o++]=255&c;for(let e=0;e<6;++e)s[o+e]=a[e];return t||p(s)},b=function(e){let t;if(!d(e))throw TypeError("Invalid UUID");let n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n};function E(e,t,n){function r(e,r,i,o){var s;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));let t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=b(r)),(null===(s=r)||void 0===s?void 0:s.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+e.length);if(a.set(r),a.set(e,r.length),(a=n(a))[6]=15&a[6]|t,a[8]=63&a[8]|128,i){o=o||0;for(let e=0;e<16;++e)i[o+e]=a[e];return i}return p(a)}try{r.name=e}catch(e){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}let y=E("v3",48,function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),s().createHash("md5").update(e).digest()}),S={randomUUID:s().randomUUID},_=function(e,t,n){if(S.randomUUID&&!t&&!e)return S.randomUUID();let r=(e=e||{}).random||(e.rng||l)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return p(r)},w=E("v5",80,function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),s().createHash("sha1").update(e).digest()}),x="00000000-0000-0000-0000-000000000000",O=function(e){if(!d(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},16778:(e,t,n)=>{"use strict";var r=n(30533),i=n(75409),o=n(69588);e.exports={client:function(e,t){return void 0===(t=t||{}).masking&&(t.masking=!0),new i(e,t)},server:function(e){return void 0===(e=e||{}).requireMasking&&(e.requireMasking=!0),new o(e)},http:function(){return o.http.apply(o,arguments)},isSecureRequest:function(e){return o.isSecureRequest(e)},isWebSocket:function(e){return r.isWebSocket(e)},validateOptions:function(e,t){r.validateOptions(e,t)}}},30533:(e,t,n)=>{"use strict";var r=n(5299).Buffer,i=n(82361).EventEmitter,o=n(73837),s=n(85340),a=n(3355),c=n(31162),l=function(e,t,n){i.call(this),l.validateOptions(n||{},["maxLength","masking","requireMasking","protocols"]),this._request=e,this._reader=new c,this._options=n||{},this._maxLength=this._options.maxLength||this.MAX_LENGTH,this._headers=new a,this.__queue=[],this.readyState=0,this.url=t,this.io=new s.IO(this),this.messages=new s.Messages(this),this._bindEventListeners()};o.inherits(l,i),l.isWebSocket=function(e){var t=e.headers.connection||"",n=e.headers.upgrade||"";return"GET"===e.method&&t.toLowerCase().split(/ *, */).indexOf("upgrade")>=0&&"websocket"===n.toLowerCase()},l.validateOptions=function(e,t){for(var n in e)if(0>t.indexOf(n))throw Error("Unrecognized option: "+n)};var u={MAX_LENGTH:67108863,STATES:["connecting","open","closing","closed"],_bindEventListeners:function(){var e=this;this.messages.on("error",function(){}),this.on("message",function(t){var n=e.messages;n.readable&&n.emit("data",t.data)}),this.on("error",function(t){var n=e.messages;n.readable&&n.emit("error",t)}),this.on("close",function(){var t=e.messages;t.readable&&(t.readable=t.writable=!1,t.emit("end"))})},getState:function(){return this.STATES[this.readyState]||null},addExtension:function(e){return!1},setHeader:function(e,t){return!(this.readyState>0)&&(this._headers.set(e,t),!0)},start:function(){var e;if(0!==this.readyState)return!1;if(!l.isWebSocket(this._request))return this._failHandshake(Error("Not a WebSocket request"));try{e=this._handshakeResponse()}catch(e){return this._failHandshake(e)}return this._write(e),-1!==this._stage&&this._open(),!0},_failHandshake:function(e){var t=new a;return t.set("Content-Type","text/plain"),t.set("Content-Length",r.byteLength(e.message,"utf8")),t=["HTTP/1.1 400 Bad Request",t.toString(),e.message],this._write(r.from(t.join("\r\n"),"utf8")),this._fail("protocol_error",e.message),!1},text:function(e){return this.frame(e)},binary:function(e){return!1},ping:function(){return!1},pong:function(){return!1},close:function(e,t){return 1===this.readyState&&(this.readyState=3,this.emit("close",new l.CloseEvent(null,null)),!0)},_open:function(){this.readyState=1,this.__queue.forEach(function(e){this.frame.apply(this,e)},this),this.__queue=[],this.emit("open",new l.OpenEvent)},_queue:function(e){return this.__queue.push(e),!0},_write:function(e){var t=this.io;t.readable&&t.emit("data",e)},_fail:function(e,t){this.readyState=2,this.emit("error",Error(t)),this.close()}};for(var d in u)l.prototype[d]=u[d];l.ConnectEvent=function(){},l.OpenEvent=function(){},l.CloseEvent=function(e,t){this.code=e,this.reason=t},l.MessageEvent=function(e){this.data=e},l.PingEvent=function(e){this.data=e},l.PongEvent=function(e){this.data=e},e.exports=l},75409:(e,t,n)=>{"use strict";var r=n(5299).Buffer,i=n(6113),o=n(57310),s=n(73837),a=n(3515),c=n(30533),l=n(28388),u=n(74887),d=function(e,t){this.version="hybi-"+l.VERSION,l.call(this,null,e,t),this.readyState=-1,this._key=d.generateKey(),this._accept=l.generateAccept(this._key),this._http=new a("response");var n=o.parse(this.url),i=n.auth&&r.from(n.auth,"utf8").toString("base64");if(0>this.VALID_PROTOCOLS.indexOf(n.protocol))throw Error(this.url+" is not a valid WebSocket URL");this._pathname=(n.pathname||"/")+(n.search||""),this._headers.set("Host",n.host),this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Key",this._key),this._headers.set("Sec-WebSocket-Version",l.VERSION),this._protocols.length>0&&this._headers.set("Sec-WebSocket-Protocol",this._protocols.join(", ")),i&&this._headers.set("Authorization","Basic "+i)};s.inherits(d,l),d.generateKey=function(){return i.randomBytes(16).toString("base64")};var h={VALID_PROTOCOLS:["ws:","wss:"],proxy:function(e,t){return new u(this,e,t)},start:function(){return -1===this.readyState&&(this._write(this._handshakeRequest()),this.readyState=0,!0)},parse:function(e){if(3!==this.readyState){if(this.readyState>0)return l.prototype.parse.call(this,e);this._http.parse(e),this._http.isComplete()&&(this._validateHandshake(),3!==this.readyState&&(this._open(),this.parse(this._http.body)))}},_handshakeRequest:function(){var e=this._extensions.generateOffer();e&&this._headers.set("Sec-WebSocket-Extensions",e);var t=["GET "+this._pathname+" HTTP/1.1",this._headers.toString(),""];return r.from(t.join("\r\n"),"utf8")},_failHandshake:function(e){e="Error during WebSocket handshake: "+e,this.readyState=3,this.emit("error",Error(e)),this.emit("close",new c.CloseEvent(this.ERRORS.protocol_error,e))},_validateHandshake:function(){if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,this._http.error)return this._failHandshake(this._http.error.message);if(101!==this._http.statusCode)return this._failHandshake("Unexpected response code: "+this._http.statusCode);var e=this._http.headers,t=e.upgrade||"",n=e.connection||"",r=e["sec-websocket-accept"]||"",i=e["sec-websocket-protocol"]||"";if(""===t)return this._failHandshake("'Upgrade' header is missing");if("websocket"!==t.toLowerCase())return this._failHandshake("'Upgrade' header value is not 'WebSocket'");if(""===n)return this._failHandshake("'Connection' header is missing");if("upgrade"!==n.toLowerCase())return this._failHandshake("'Connection' header value is not 'Upgrade'");if(r!==this._accept)return this._failHandshake("Sec-WebSocket-Accept mismatch");if(this.protocol=null,""!==i){if(0>this._protocols.indexOf(i))return this._failHandshake("Sec-WebSocket-Protocol mismatch");this.protocol=i}try{this._extensions.activate(this.headers["sec-websocket-extensions"])}catch(e){return this._failHandshake(e.message)}}};for(var p in h)d.prototype[p]=h[p];e.exports=d},55131:(e,t,n)=>{"use strict";var r=n(5299).Buffer,i=n(30533),o=n(73837),s=function(e,t,n){i.apply(this,arguments),this._stage=0,this.version="hixie-75",this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("WebSocket-Origin",this._request.headers.origin),this._headers.set("WebSocket-Location",this.url)};o.inherits(s,i);var a={close:function(){return 3!==this.readyState&&(this.readyState=3,this.emit("close",new i.CloseEvent(null,null)),!0)},parse:function(e){this.readyState>1||(this._reader.put(e),this._reader.eachByte(function(e){var t;switch(this._stage){case -1:this._body.push(e),this._sendHandshakeBody();break;case 0:this._parseLeadingByte(e);break;case 1:if(this._length=(127&e)+128*this._length,this._closing&&0===this._length)return this.close();(128&e)!=128&&(0===this._length?this._stage=0:(this._skipped=0,this._stage=2));break;case 2:if(255===e)this._stage=0,t=r.from(this._buffer).toString("utf8",0,this._buffer.length),this.emit("message",new i.MessageEvent(t));else if(this._length)this._skipped+=1,this._skipped===this._length&&(this._stage=0);else if(this._buffer.push(e),this._buffer.length>this._maxLength)return this.close()}},this))},frame:function(e){if(0===this.readyState)return this._queue([e]);if(this.readyState>1)return!1;"string"!=typeof e&&(e=e.toString());var t=r.byteLength(e),n=r.allocUnsafe(t+2);return n[0]=0,n.write(e,1),n[n.length-1]=255,this._write(n),!0},_handshakeResponse:function(){var e=["HTTP/1.1 101 Web Socket Protocol Handshake",this._headers.toString(),""];return r.from(e.join("\r\n"),"utf8")},_parseLeadingByte:function(e){(128&e)==128?(this._length=0,this._stage=1):(delete this._length,delete this._skipped,this._buffer=[],this._stage=2)}};for(var c in a)s.prototype[c]=a[c];e.exports=s},25377:(e,t,n)=>{"use strict";var r=n(5299).Buffer,i=n(30533),o=n(55131),s=n(6113),a=n(73837),c=function(e){return parseInt((e.match(/[0-9]/g)||[]).join(""),10)},l=function(e){return(e.match(/ /g)||[]).length},u=function(e,t,n){o.apply(this,arguments),this._stage=-1,this._body=[],this.version="hixie-76",this._headers.clear(),this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Origin",this._request.headers.origin),this._headers.set("Sec-WebSocket-Location",this.url)};a.inherits(u,o);var d={BODY_SIZE:8,start:function(){return!!o.prototype.start.call(this)&&(this._started=!0,this._sendHandshakeBody(),!0)},close:function(){return 3!==this.readyState&&(1===this.readyState&&this._write(r.from([255,0])),this.readyState=3,this.emit("close",new i.CloseEvent(null,null)),!0)},_handshakeResponse:function(){var e=this._request.headers,t=e["sec-websocket-key1"],n=e["sec-websocket-key2"];if(!t)throw Error("Missing required header: Sec-WebSocket-Key1");if(!n)throw Error("Missing required header: Sec-WebSocket-Key2");var i=c(t),o=l(t),s=c(n),a=l(n);if(i%o!=0||s%a!=0)throw Error("Client sent invalid Sec-WebSocket-Key headers");this._keyValues=[i/o,s/a];var e=["HTTP/1.1 101 WebSocket Protocol Handshake",this._headers.toString(),""];return r.from(e.join("\r\n"),"binary")},_handshakeSignature:function(){if(this._body.length<this.BODY_SIZE)return null;var e=s.createHash("md5"),t=r.allocUnsafe(8+this.BODY_SIZE);return t.writeUInt32BE(this._keyValues[0],0),t.writeUInt32BE(this._keyValues[1],4),r.from(this._body).copy(t,8,0,this.BODY_SIZE),e.update(t),r.from(e.digest("binary"),"binary")},_sendHandshakeBody:function(){if(this._started){var e=this._handshakeSignature();e&&(this._write(e),this._stage=0,this._open(),this._body.length>this.BODY_SIZE&&this.parse(this._body.slice(this.BODY_SIZE)))}},_parseLeadingByte:function(e){if(255!==e)return o.prototype._parseLeadingByte.call(this,e);this._closing=!0,this._length=0,this._stage=1}};for(var h in d)u.prototype[h]=d[h];e.exports=u},3355:e=>{"use strict";var t=function(){this.clear()};t.prototype.ALLOWED_DUPLICATES=["set-cookie","set-cookie2","warning","www-authenticate"],t.prototype.clear=function(){this._sent={},this._lines=[]},t.prototype.set=function(e,t){if(void 0!==t){e=this._strip(e),t=this._strip(t);var n=e.toLowerCase();(!this._sent.hasOwnProperty(n)||this.ALLOWED_DUPLICATES.indexOf(n)>=0)&&(this._sent[n]=!0,this._lines.push(e+": "+t+"\r\n"))}},t.prototype.toString=function(){return this._lines.join("")},t.prototype._strip=function(e){return e.toString().replace(/^ */,"").replace(/ *$/,"")},e.exports=t},28388:(e,t,n)=>{"use strict";var r=n(5299).Buffer,i=n(6113),o=n(73837),s=n(27999),a=n(30533),c=n(84643),l=n(61357),u=function(e,t,n){if(a.apply(this,arguments),this._extensions=new s,this._stage=0,this._masking=this._options.masking,this._protocols=this._options.protocols||[],this._requireMasking=this._options.requireMasking,this._pingCallbacks={},"string"==typeof this._protocols&&(this._protocols=this._protocols.split(/ *, */)),this._request){var r=this._request.headers["sec-websocket-protocol"],i=this._protocols;void 0!==r&&("string"==typeof r&&(r=r.split(/ *, */)),this.protocol=r.filter(function(e){return i.indexOf(e)>=0})[0]),this.version="hybi-"+u.VERSION}};o.inherits(u,a),u.VERSION="13",u.mask=function(e,t,n){if(!t||0===t.length)return e;n=n||0;for(var r=0,i=e.length-n;r<i;r++)e[n+r]=e[n+r]^t[r%4];return e},u.generateAccept=function(e){var t=i.createHash("sha1");return t.update(e+u.GUID),t.digest("base64")},u.GUID="258EAFA5-E914-47DA-95CA-C5AB0DC85B11";var d={FIN:128,MASK:128,RSV1:64,RSV2:32,RSV3:16,OPCODE:15,LENGTH:127,OPCODES:{continuation:0,text:1,binary:2,close:8,ping:9,pong:10},OPCODE_CODES:[0,1,2,8,9,10],MESSAGE_OPCODES:[0,1,2],OPENING_OPCODES:[1,2],ERRORS:{normal_closure:1e3,going_away:1001,protocol_error:1002,unacceptable:1003,encoding_error:1007,policy_violation:1008,too_large:1009,extension_error:1010,unexpected_condition:1011},ERROR_CODES:[1e3,1001,1002,1003,1007,1008,1009,1010,1011],DEFAULT_ERROR_CODE:1e3,MIN_RESERVED_ERROR:3e3,MAX_RESERVED_ERROR:4999,UTF8_MATCH:/^([\x00-\x7F]|[\xC2-\xDF][\x80-\xBF]|\xE0[\xA0-\xBF][\x80-\xBF]|[\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}|\xED[\x80-\x9F][\x80-\xBF]|\xF0[\x90-\xBF][\x80-\xBF]{2}|[\xF1-\xF3][\x80-\xBF]{3}|\xF4[\x80-\x8F][\x80-\xBF]{2})*$/,addExtension:function(e){return this._extensions.add(e),!0},parse:function(e){this._reader.put(e);for(var t=!0;t;)switch(this._stage){case 0:(t=this._reader.read(1))&&this._parseOpcode(t[0]);break;case 1:(t=this._reader.read(1))&&this._parseLength(t[0]);break;case 2:(t=this._reader.read(this._frame.lengthBytes))&&this._parseExtendedLength(t);break;case 3:(t=this._reader.read(4))&&(this._stage=4,this._frame.maskingKey=t);break;case 4:(t=this._reader.read(this._frame.length))&&(this._stage=0,this._emitFrame(t));break;default:t=null}},text:function(e){return!(this.readyState>1)&&this.frame(e,"text")},binary:function(e){return!(this.readyState>1)&&this.frame(e,"binary")},ping:function(e,t){return!(this.readyState>1)&&(e=e||"",t&&(this._pingCallbacks[e]=t),this.frame(e,"ping"))},pong:function(e){return!(this.readyState>1)&&(e=e||"",this.frame(e,"pong"))},close:function(e,t){return(e=e||"",t=t||this.ERRORS.normal_closure,this.readyState<=0)?(this.readyState=3,this.emit("close",new a.CloseEvent(t,e)),!0):1===this.readyState&&(this.readyState=2,this._extensions.close(function(){this.frame(e,"close",t)},this),!0)},frame:function(e,t,n){if(this.readyState<=0)return this._queue([e,t,n]);if(this.readyState>2)return!1;e instanceof Array&&(e=r.from(e)),"number"==typeof e&&(e=e.toString());var o,s,a=new l,u="string"==typeof e;a.rsv1=a.rsv2=a.rsv3=!1,a.opcode=this.OPCODES[t||(u?"text":"binary")],o=u?r.from(e,"utf8"):e,n&&(s=o,(o=r.allocUnsafe(2+s.length)).writeUInt16BE(n,0),s.copy(o,2)),a.data=o;var d=function(e){var t=new c;t.final=!0,t.rsv1=e.rsv1,t.rsv2=e.rsv2,t.rsv3=e.rsv3,t.opcode=e.opcode,t.masked=!!this._masking,t.length=e.data.length,t.payload=e.data,t.masked&&(t.maskingKey=i.randomBytes(4)),this._sendFrame(t)};return this.MESSAGE_OPCODES.indexOf(a.opcode)>=0?this._extensions.processOutgoingMessage(a,function(e,t){if(e)return this._fail("extension_error",e.message);d.call(this,t)},this):d.call(this,a),!0},_sendFrame:function(e){var t=e.length,n=t<=125?2:t<=65535?4:10,i=n+(e.masked?4:0),o=r.allocUnsafe(i+t),s=e.masked?this.MASK:0;o[0]=(e.final?this.FIN:0)|(e.rsv1?this.RSV1:0)|(e.rsv2?this.RSV2:0)|(e.rsv3?this.RSV3:0)|e.opcode,t<=125?o[1]=s|t:t<=65535?(o[1]=126|s,o.writeUInt16BE(t,2)):(o[1]=127|s,o.writeUInt32BE(Math.floor(t/4294967296),2),o.writeUInt32BE(t%4294967296,6)),e.payload.copy(o,i),e.masked&&(e.maskingKey.copy(o,n),u.mask(o,e.maskingKey,i)),this._write(o)},_handshakeResponse:function(){var e=this._request.headers["sec-websocket-key"],t=this._request.headers["sec-websocket-version"];if(t!==u.VERSION)throw Error("Unsupported WebSocket version: "+t);if("string"!=typeof e)throw Error("Missing handshake request header: Sec-WebSocket-Key");this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Accept",u.generateAccept(e)),this.protocol&&this._headers.set("Sec-WebSocket-Protocol",this.protocol);var n=this._extensions.generateResponse(this._request.headers["sec-websocket-extensions"]);n&&this._headers.set("Sec-WebSocket-Extensions",n);var i=["HTTP/1.1 101 Switching Protocols",this._headers.toString(),""];return r.from(i.join("\r\n"),"utf8")},_shutdown:function(e,t,n){delete this._frame,delete this._message,this._stage=5;var r=1===this.readyState;this.readyState=2,this._extensions.close(function(){r&&this.frame(t,"close",e),this.readyState=3,n&&this.emit("error",Error(t)),this.emit("close",new a.CloseEvent(e,t))},this)},_fail:function(e,t){this.readyState>1||this._shutdown(this.ERRORS[e],t,!0)},_parseOpcode:function(e){var t=[this.RSV1,this.RSV2,this.RSV3].map(function(t){return(e&t)===t}),n=this._frame=new c;return(n.final=(e&this.FIN)===this.FIN,n.rsv1=t[0],n.rsv2=t[1],n.rsv3=t[2],n.opcode=e&this.OPCODE,this._stage=1,this._extensions.validFrameRsv(n))?0>this.OPCODE_CODES.indexOf(n.opcode)?this._fail("protocol_error","Unrecognized frame opcode: "+n.opcode):0>this.MESSAGE_OPCODES.indexOf(n.opcode)&&!n.final?this._fail("protocol_error","Received fragmented control frame: opcode = "+n.opcode):this._message&&this.OPENING_OPCODES.indexOf(n.opcode)>=0?this._fail("protocol_error","Received new data frame but previous continuous frame is unfinished"):void 0:this._fail("protocol_error","One or more reserved bits are on: reserved1 = "+(n.rsv1?1:0)+", reserved2 = "+(n.rsv2?1:0)+", reserved3 = "+(n.rsv3?1:0))},_parseLength:function(e){var t=this._frame;if(t.masked=(e&this.MASK)===this.MASK,t.length=e&this.LENGTH,t.length>=0&&t.length<=125){if(this._stage=t.masked?3:4,!this._checkFrameLength())return}else this._stage=2,t.lengthBytes=126===t.length?2:8;if(this._requireMasking&&!t.masked)return this._fail("unacceptable","Received unmasked frame but masking is required")},_parseExtendedLength:function(e){var t=this._frame;if(t.length=this._readUInt(e),this._stage=t.masked?3:4,0>this.MESSAGE_OPCODES.indexOf(t.opcode)&&t.length>125)return this._fail("protocol_error","Received control frame having too long payload: "+t.length);if(!this._checkFrameLength())return},_checkFrameLength:function(){return!((this._message?this._message.length:0)+this._frame.length>this._maxLength)||(this._fail("too_large","WebSocket frame length too large"),!1)},_emitFrame:function(e){var t,n,r,i,o,s=this._frame,c=s.payload=u.mask(e,s.maskingKey),d=s.opcode;if(delete this._frame,d===this.OPCODES.continuation){if(!this._message)return this._fail("protocol_error","Received unexpected continuation frame");this._message.pushFrame(s)}if((d===this.OPCODES.text||d===this.OPCODES.binary)&&(this._message=new l,this._message.pushFrame(s)),s.final&&this.MESSAGE_OPCODES.indexOf(d)>=0)return this._emitMessage(this._message);d===this.OPCODES.close&&(n=c.length>=2?c.readUInt16BE(0):null,r=c.length>2?this._encode(c.slice(2)):null,0!==c.length&&!(null!==n&&n>=this.MIN_RESERVED_ERROR&&n<=this.MAX_RESERVED_ERROR)&&0>this.ERROR_CODES.indexOf(n)&&(n=this.ERRORS.protocol_error),(c.length>125||c.length>2&&!r)&&(n=this.ERRORS.protocol_error),this._shutdown(n||this.DEFAULT_ERROR_CODE,r||"")),d===this.OPCODES.ping&&(this.frame(c,"pong"),this.emit("ping",new a.PingEvent(c.toString()))),d===this.OPCODES.pong&&(o=(i=this._pingCallbacks)[t=this._encode(c)],delete i[t],o&&o(),this.emit("pong",new a.PongEvent(c.toString())))},_emitMessage:function(e){var e=this._message;e.read(),delete this._message,this._extensions.processIncomingMessage(e,function(e,t){if(e)return this._fail("extension_error",e.message);var n=t.data;if(t.opcode===this.OPCODES.text&&(n=this._encode(n)),null===n)return this._fail("encoding_error","Could not decode a text frame as UTF-8");this.emit("message",new a.MessageEvent(n))},this)},_encode:function(e){try{var t=e.toString("binary",0,e.length);if(!this.UTF8_MATCH.test(t))return null}catch(e){}return e.toString("utf8",0,e.length)},_readUInt:function(e){return 2===e.length?e.readUInt16BE(0):4294967296*e.readUInt32BE(0)+e.readUInt32BE(4)}};for(var h in d)u.prototype[h]=d[h];e.exports=u},84643:e=>{"use strict";var t=function(){},n={final:!1,rsv1:!1,rsv2:!1,rsv3:!1,opcode:null,masked:!1,maskingKey:null,lengthBytes:1,length:0,payload:null};for(var r in n)t.prototype[r]=n[r];e.exports=t},61357:(e,t,n)=>{"use strict";var r=n(5299).Buffer,i=function(){this.rsv1=!1,this.rsv2=!1,this.rsv3=!1,this.opcode=null,this.length=0,this._chunks=[]},o={read:function(){return this.data=this.data||r.concat(this._chunks,this.length)},pushFrame:function(e){this.rsv1=this.rsv1||e.rsv1,this.rsv2=this.rsv2||e.rsv2,this.rsv3=this.rsv3||e.rsv3,null===this.opcode&&(this.opcode=e.opcode),this._chunks.push(e.payload),this.length+=e.length}};for(var s in o)i.prototype[s]=o[s];e.exports=i},74887:(e,t,n)=>{"use strict";var r=n(5299).Buffer,i=n(12781).Stream,o=n(57310),s=n(73837),a=n(30533),c=n(3355),l=n(3515),u={"ws:":80,"wss:":443},d=function(e,t,n){this._client=e,this._http=new l("response"),this._origin="object"==typeof e.url?e.url:o.parse(e.url),this._url="object"==typeof t?t:o.parse(t),this._options=n||{},this._state=0,this.readable=this.writable=!0,this._paused=!1,this._headers=new c,this._headers.set("Host",this._origin.host),this._headers.set("Connection","keep-alive"),this._headers.set("Proxy-Connection","keep-alive");var i=this._url.auth&&r.from(this._url.auth,"utf8").toString("base64");i&&this._headers.set("Proxy-Authorization","Basic "+i)};s.inherits(d,i);var h={setHeader:function(e,t){return 0===this._state&&(this._headers.set(e,t),!0)},start:function(){if(0!==this._state)return!1;this._state=1;var e=this._origin,t=e.port||u[e.protocol],n=["CONNECT "+e.hostname+":"+t+" HTTP/1.1",this._headers.toString(),""];return this.emit("data",r.from(n.join("\r\n"),"utf8")),!0},pause:function(){this._paused=!0},resume:function(){this._paused=!1,this.emit("drain")},write:function(e){if(!this.writable)return!1;if(this._http.parse(e),!this._http.isComplete())return!this._paused;if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,200===this.statusCode)this.emit("connect",new a.ConnectEvent);else{var t="Can't establish a connection to the server at "+this._origin.href;this.emit("error",Error(t))}return this.end(),!this._paused},end:function(e){this.writable&&(void 0!==e&&this.write(e),this.readable=this.writable=!1,this.emit("close"),this.emit("end"))},destroy:function(){this.end()}};for(var p in h)d.prototype[p]=h[p];e.exports=d},69588:(e,t,n)=>{"use strict";var r=n(73837),i=n(3515),o=n(30533),s=n(55131),a=n(25377),c=n(28388),l=function(e){o.call(this,null,null,e),this._http=new i("request")};r.inherits(l,o);var u={EVENTS:["open","message","error","close","ping","pong"],_bindEventListeners:function(){this.messages.on("error",function(){}),this.on("error",function(){})},parse:function(e){if(this._delegate)return this._delegate.parse(e);if(this._http.parse(e),this._http.isComplete()){this.method=this._http.method,this.url=this._http.url,this.headers=this._http.headers,this.body=this._http.body;var t=this;this._delegate=l.http(this,this._options),this._delegate.messages=this.messages,this._delegate.io=this.io,this._open(),this.EVENTS.forEach(function(e){this._delegate.on(e,function(n){t.emit(e,n)})},this),this.protocol=this._delegate.protocol,this.version=this._delegate.version,this.parse(this._http.body),this.emit("connect",new o.ConnectEvent)}},_open:function(){this.__queue.forEach(function(e){this._delegate[e[0]].apply(this._delegate,e[1])},this),this.__queue=[]}};for(var d in["addExtension","setHeader","start","frame","text","binary","ping","close"].forEach(function(e){u[e]=function(){return this._delegate?this._delegate[e].apply(this._delegate,arguments):(this.__queue.push([e,arguments]),!0)}}),u)l.prototype[d]=u[d];l.isSecureRequest=function(e){if(e.connection&&void 0!==e.connection.authorized||e.socket&&e.socket.secure)return!0;var t=e.headers;return!!t&&("on"===t.https||"on"===t["x-forwarded-ssl"]||"https"===t["x-forwarded-scheme"]||"https"===t["x-forwarded-proto"])},l.determineUrl=function(e){return(this.isSecureRequest(e)?"wss:":"ws:")+"//"+e.headers.host+e.url},l.http=function(e,t){void 0===(t=t||{}).requireMasking&&(t.requireMasking=!0);var n=e.headers,r=n["sec-websocket-version"],i=n["sec-websocket-key"],o=n["sec-websocket-key1"],l=n["sec-websocket-key2"],u=this.determineUrl(e);return r||i?new c(e,u,t):o||l?new a(e,u,t):new s(e,u,t)},e.exports=l},31162:(e,t,n)=>{"use strict";var r=n(5299).Buffer,i=function(){this._queue=[],this._queueSize=0,this._offset=0};i.prototype.put=function(e){e&&0!==e.length&&(r.isBuffer(e)||(e=r.from(e)),this._queue.push(e),this._queueSize+=e.length)},i.prototype.read=function(e){if(e>this._queueSize)return null;if(0===e)return r.alloc(0);this._queueSize-=e;var t,n,i=this._queue,o=e,s=i[0];if(s.length>=e)return s.length===e?i.shift():(n=s.slice(0,e),i[0]=s.slice(e),n);for(var a=0,c=i.length;a<c&&!(o<i[a].length);a++)o-=i[a].length;return t=i.splice(0,a),o>0&&i.length>0&&(t.push(i[0].slice(0,o)),i[0]=i[0].slice(o)),r.concat(t,e)},i.prototype.eachByte=function(e,t){for(var n,r,i;this._queue.length>0;){for(r=(n=this._queue[0]).length;this._offset<r;)i=this._offset,this._offset+=1,e.call(t,n[i]);this._offset=0,this._queue.shift()}},e.exports=i},3515:(e,t,n)=>{"use strict";var r=n(22735).m,i=n(5299).Buffer,o={request:r.REQUEST||"request",response:r.RESPONSE||"response"},s=function(e){this._type=e,this._parser=new r(o[e]),this._complete=!1,this.headers={};var t=null,n=this;this._parser.onHeaderField=function(e,n,r){t=e.toString("utf8",n,n+r).toLowerCase()},this._parser.onHeaderValue=function(e,r,i){var o=e.toString("utf8",r,r+i);n.headers.hasOwnProperty(t)?n.headers[t]+=", "+o:n.headers[t]=o},this._parser.onHeadersComplete=this._parser[r.kOnHeadersComplete]=function(e,t,r,i,o,a){var c=arguments[0];if("object"==typeof c&&(i=c.method,o=c.url,a=c.statusCode,r=c.headers),n.method="number"==typeof i?s.METHODS[i]:i,n.statusCode=a,n.url=o,r){for(var l,u,d=0,h=r.length;d<h;d+=2)l=r[d].toLowerCase(),u=r[d+1],n.headers.hasOwnProperty(l)?n.headers[l]+=", "+u:n.headers[l]=u;n._complete=!0}}};s.METHODS={0:"DELETE",1:"GET",2:"HEAD",3:"POST",4:"PUT",5:"CONNECT",6:"OPTIONS",7:"TRACE",8:"COPY",9:"LOCK",10:"MKCOL",11:"MOVE",12:"PROPFIND",13:"PROPPATCH",14:"SEARCH",15:"UNLOCK",16:"BIND",17:"REBIND",18:"UNBIND",19:"ACL",20:"REPORT",21:"MKACTIVITY",22:"CHECKOUT",23:"MERGE",24:"M-SEARCH",25:"NOTIFY",26:"SUBSCRIBE",27:"UNSUBSCRIBE",28:"PATCH",29:"PURGE",30:"MKCALENDAR",31:"LINK",32:"UNLINK"};var a=process.version?process.version.match(/[0-9]+/g).map(function(e){return parseInt(e,10)}):[];0===a[0]&&12===a[1]&&(s.METHODS[16]="REPORT",s.METHODS[17]="MKACTIVITY",s.METHODS[18]="CHECKOUT",s.METHODS[19]="MERGE",s.METHODS[20]="M-SEARCH",s.METHODS[21]="NOTIFY",s.METHODS[22]="SUBSCRIBE",s.METHODS[23]="UNSUBSCRIBE",s.METHODS[24]="PATCH",s.METHODS[25]="PURGE"),s.prototype.isComplete=function(){return this._complete},s.prototype.parse=function(e){var t=this._parser.execute(e,0,e.length);if("number"!=typeof t){this.error=t,this._complete=!0;return}this._complete&&(this.body=t<e.length?e.slice(t):i.alloc(0))},e.exports=s},85340:(e,t,n)=>{"use strict";var r=n(12781).Stream,i=n(73837),o=function(e){this.readable=this.writable=!0,this._paused=!1,this._driver=e};i.inherits(o,r),o.prototype.pause=function(){this._paused=!0,this._driver.messages._paused=!0},o.prototype.resume=function(){this._paused=!1,this.emit("drain");var e=this._driver.messages;e._paused=!1,e.emit("drain")},o.prototype.write=function(e){return!!this.writable&&(this._driver.parse(e),!this._paused)},o.prototype.end=function(e){if(this.writable){void 0!==e&&this.write(e),this.writable=!1;var t=this._driver.messages;t.readable&&(t.readable=t.writable=!1,t.emit("end"))}},o.prototype.destroy=function(){this.end()};var s=function(e){this.readable=this.writable=!0,this._paused=!1,this._driver=e};i.inherits(s,r),s.prototype.pause=function(){this._driver.io._paused=!0},s.prototype.resume=function(){this._driver.io._paused=!1,this._driver.io.emit("drain")},s.prototype.write=function(e){return!!this.writable&&("string"==typeof e?this._driver.text(e):this._driver.binary(e),!this._paused)},s.prototype.end=function(e){void 0!==e&&this.write(e)},s.prototype.destroy=function(){},t.IO=o,t.Messages=s},76172:e=>{"use strict";var t=/([!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+)/,n=/([^!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z])/g,r=RegExp(t.source+"(?:=(?:"+t.source+"|"+/"((?:\\[\x00-\x7f]|[^\x00-\x08\x0a-\x1f\x7f"\\])*)"/.source+"))?"),i=RegExp(t.source+"(?: *; *"+r.source+")*","g"),o=RegExp("^"+i.source+"(?: *, *"+i.source+")*$"),s=/^-?(0|[1-9][0-9]*)(\.[0-9]+)?$/,a=Object.prototype.hasOwnProperty,c=function(){this._byName={},this._inOrder=[]};c.prototype.push=function(e,t){a.call(this._byName,e)||(this._byName[e]=[]),this._byName[e].push(t),this._inOrder.push({name:e,params:t})},c.prototype.eachOffer=function(e,t){for(var n=this._inOrder,r=0,i=n.length;r<i;r++)e.call(t,n[r].name,n[r].params)},c.prototype.byName=function(e){return this._byName[e]||[]},c.prototype.toArray=function(){return this._inOrder.slice()},e.exports={parseHeader:function(e){var t=new c;if(""===e||void 0===e)return t;if(!o.test(e))throw SyntaxError("Invalid Sec-WebSocket-Extensions header: "+e);return e.match(i).forEach(function(e){var n=e.match(RegExp(r.source,"g")),i=n.shift(),o={};n.forEach(function(e){var t,n=e.match(r),i=n[1];t=void 0!==n[2]?n[2]:void 0===n[3]||n[3].replace(/\\/g,""),s.test(t)&&(t=parseFloat(t)),a.call(o,i)?(o[i]=[].concat(o[i]),o[i].push(t)):o[i]=t},this),t.push(i,o)},this),t},serializeParams:function(e,t){var r=[],i=function(e,t){t instanceof Array?t.forEach(function(t){i(e,t)}):!0===t?r.push(e):"number"==typeof t?r.push(e+"="+t):n.test(t)?r.push(e+'="'+t.replace(/"/g,'\\"')+'"'):r.push(e+"="+t)};for(var o in t)i(o,t[o]);return[e].concat(r).join("; ")}}},7902:(e,t,n)=>{"use strict";var r=n(9432),i=n(69321),o=function(e){this._ext=e[0],this._session=e[1],this._functors={incoming:new r(this._session,"processIncomingMessage"),outgoing:new r(this._session,"processOutgoingMessage")}};o.prototype.pending=function(e){var t=this._functors[e];t._stopped||(t.pending+=1)},o.prototype.incoming=function(e,t,n,r){this._exec("incoming",e,t,n,r)},o.prototype.outgoing=function(e,t,n,r){this._exec("outgoing",e,t,n,r)},o.prototype.close=function(){return this._closed=this._closed||new i,this._doClose(),this._closed},o.prototype._exec=function(e,t,n,r,i){this._functors[e].call(t,n,function(e,t){e&&(e.message=this._ext.name+": "+e.message),r.call(i,e,t),this._doClose()},this)},o.prototype._doClose=function(){var e=this._functors.incoming,t=this._functors.outgoing;this._closed&&e.pending+t.pending===0&&(this._session&&this._session.close(),this._session=null,this._closed.done())},e.exports=o},9432:(e,t,n)=>{"use strict";var r=n(25673),i=function(e,t){this._session=e,this._method=t,this._queue=new r(i.QUEUE_SIZE),this._stopped=!1,this.pending=0};i.QUEUE_SIZE=8,i.prototype.call=function(e,t,n,r){if(!this._stopped){var i={error:e,message:t,callback:n,context:r,done:!1},o=!1,s=this;if(this._queue.push(i),i.error)return i.done=!0,this._stop(),this._flushQueue();var a=function(e,t){o^(o=!0)&&(e?(s._stop(),i.error=e,i.message=null):i.message=t,i.done=!0,s._flushQueue())};try{this._session[this._method](t,a)}catch(e){a(e)}}},i.prototype._stop=function(){this.pending=this._queue.length,this._stopped=!0},i.prototype._flushQueue=function(){for(var e,t=this._queue;t.length>0&&t.peek().done;)(e=t.shift()).error?(this.pending=0,t.clear()):this.pending-=1,e.callback.call(e.context,e.error,e.message)},e.exports=i},41425:(e,t,n)=>{"use strict";var r=n(7902),i=n(69321),o=function(e){this._cells=e.map(function(e){return new r(e)}),this._stopped={incoming:!1,outgoing:!1}};o.prototype.processIncomingMessage=function(e,t,n){this._stopped.incoming||this._loop("incoming",this._cells.length-1,-1,-1,e,t,n)},o.prototype.processOutgoingMessage=function(e,t,n){this._stopped.outgoing||this._loop("outgoing",0,this._cells.length,1,e,t,n)},o.prototype.close=function(e,t){this._stopped={incoming:!0,outgoing:!0};var n=this._cells.map(function(e){return e.close()});e&&i.all(n).then(function(){e.call(t)})},o.prototype._loop=function(e,t,n,r,i,o,s){for(var a=this._cells,c=a.length,l=this;c--;)a[c].pending(e);var u=function(t,i,c){if(t===n)return o.call(s,i,c);a[t][e](i,c,function(n,i){n&&(l._stopped[e]=!0),u(t+r,n,i)})};u(t,null,i)},e.exports=o},69321:(e,t,n)=>{"use strict";var r=n(25673),i=function(){this._complete=!1,this._callbacks=new r(i.QUEUE_SIZE)};i.QUEUE_SIZE=4,i.all=function(e){var t=new i,n=e.length,r=n;for(0===n&&t.done();r--;)e[r].then(function(){0==(n-=1)&&t.done()});return t},i.prototype.then=function(e){this._complete?e():this._callbacks.push(e)},i.prototype.done=function(){this._complete=!0;for(var e,t=this._callbacks;e=t.shift();)e()},e.exports=i},25673:e=>{"use strict";var t=function(e){this._bufferSize=e,this.clear()};t.prototype.clear=function(){this._buffer=Array(this._bufferSize),this._ringOffset=0,this._ringSize=this._bufferSize,this._head=0,this._tail=0,this.length=0},t.prototype.push=function(e){var t=!1,n=!1;this._ringSize<this._bufferSize?t=0===this._tail:this._ringOffset===this._ringSize&&(t=!0,n=0===this._tail),t&&(this._tail=this._bufferSize,this._buffer=this._buffer.concat(Array(this._bufferSize)),this._bufferSize=this._buffer.length,n&&(this._ringSize=this._bufferSize)),this._buffer[this._tail]=e,this.length+=1,this._tail<this._ringSize&&(this._ringOffset+=1),this._tail=(this._tail+1)%this._bufferSize},t.prototype.peek=function(){if(0!==this.length)return this._buffer[this._head]},t.prototype.shift=function(){if(0!==this.length){var e=this._buffer[this._head];return this._buffer[this._head]=void 0,this.length-=1,this._ringOffset-=1,0===this._ringOffset&&this.length>0?(this._head=this._ringSize,this._ringOffset=this.length,this._ringSize=this._bufferSize):this._head=(this._head+1)%this._ringSize,e}},e.exports=t},27999:(e,t,n)=>{"use strict";var r=n(76172),i=n(41425),o=function(){this._rsv1=this._rsv2=this._rsv3=null,this._byName={},this._inOrder=[],this._sessions=[],this._index={}};o.MESSAGE_OPCODES=[1,2];var s={add:function(e){if("string"!=typeof e.name)throw TypeError("extension.name must be a string");if("permessage"!==e.type)throw TypeError('extension.type must be "permessage"');if("boolean"!=typeof e.rsv1)throw TypeError("extension.rsv1 must be true or false");if("boolean"!=typeof e.rsv2)throw TypeError("extension.rsv2 must be true or false");if("boolean"!=typeof e.rsv3)throw TypeError("extension.rsv3 must be true or false");if(this._byName.hasOwnProperty(e.name))throw TypeError('An extension with name "'+e.name+'" is already registered');this._byName[e.name]=e,this._inOrder.push(e)},generateOffer:function(){var e=[],t=[],n={};return this._inOrder.forEach(function(i){var o=i.createClientSession();if(o){var s=[i,o];e.push(s),n[i.name]=s;var a=o.generateOffer();(a=a?[].concat(a):[]).forEach(function(e){t.push(r.serializeParams(i.name,e))},this)}},this),this._sessions=e,this._index=n,t.length>0?t.join(", "):null},activate:function(e){var t=r.parseHeader(e),n=[];t.eachOffer(function(e,t){var i=this._index[e];if(!i)throw Error('Server sent an extension response for unknown extension "'+e+'"');var o=i[0],s=i[1],a=this._reserved(o);if(a)throw Error("Server sent two extension responses that use the RSV"+a[0]+' bit: "'+a[1]+'" and "'+o.name+'"');if(!0!==s.activate(t))throw Error("Server sent unacceptable extension parameters: "+r.serializeParams(e,t));this._reserve(o),n.push(i)},this),this._sessions=n,this._pipeline=new i(n)},generateResponse:function(e){var t=[],n=[],o=r.parseHeader(e);return this._inOrder.forEach(function(e){var i=o.byName(e.name);if(!(0===i.length||this._reserved(e))){var s=e.createServerSession(i);s&&(this._reserve(e),t.push([e,s]),n.push(r.serializeParams(e.name,s.generateResponse())))}},this),this._sessions=t,this._pipeline=new i(t),n.length>0?n.join(", "):null},validFrameRsv:function(e){var t,n={rsv1:!1,rsv2:!1,rsv3:!1};if(o.MESSAGE_OPCODES.indexOf(e.opcode)>=0)for(var r=0,i=this._sessions.length;r<i;r++)t=this._sessions[r][0],n.rsv1=n.rsv1||t.rsv1,n.rsv2=n.rsv2||t.rsv2,n.rsv3=n.rsv3||t.rsv3;return(n.rsv1||!e.rsv1)&&(n.rsv2||!e.rsv2)&&(n.rsv3||!e.rsv3)},processIncomingMessage:function(e,t,n){this._pipeline.processIncomingMessage(e,t,n)},processOutgoingMessage:function(e,t,n){this._pipeline.processOutgoingMessage(e,t,n)},close:function(e,t){if(!this._pipeline)return e.call(t);this._pipeline.close(e,t)},_reserve:function(e){this._rsv1=this._rsv1||e.rsv1&&e.name,this._rsv2=this._rsv2||e.rsv2&&e.name,this._rsv3=this._rsv3||e.rsv3&&e.name},_reserved:function(e){return this._rsv1&&e.rsv1?[1,this._rsv1]:this._rsv2&&e.rsv2?[2,this._rsv2]:!!this._rsv3&&!!e.rsv3&&[3,this._rsv3]}};for(var a in s)o.prototype[a]=s[a];e.exports=o},9280:e=>{function t(){}e.exports=t,t.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,n){this.callbacks=this.callbacks||{};var r=3==arguments.length,i=r?arguments[1]:void 0,o=r?arguments[2]:arguments[1];return o._groupName=i,(this.callbacks[e]=this.callbacks[e]||[]).push(o),this},t.once=function(e,t,n){var r=this,i=3==arguments.length,o=i?arguments[1]:void 0,s=i?arguments[2]:arguments[1];return this.on(e,o,function t(){r.off(e,t),s.apply(this,arguments)}),this},t.releaseGroup=function(e){var t,n,r,i;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(n=0,r=(i=this.callbacks[t]).length;n<r;n++)i[n]._groupName===e&&(i.splice(n,1),n--,r--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var n,r=this.callbacks[e];return r&&(1==arguments.length?delete this.callbacks[e]:-1!==(n=r.indexOf(t))&&(r.splice(n,1),0===r.length&&delete this.callbacks[e])),this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,n,r,i=[].slice.call(arguments,1),o=this.callbacks[e],s=this.getWildcardCallbacks(e);if(o)for(t=0,n=(r=o.slice()).length;t<n&&r[t];++t)r[t].apply(this,i);if(s)for(t=0,n=s.length,n=(r=s.slice()).length;t<n&&r[t];++t)r[t].apply(this,[e].concat(i));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,r=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(r=r.concat(this.callbacks[t]));return r}},t.mixin(t)},51594:function(e,t,n){var r;!function(t){"use strict";function i(){}var o=i.prototype,s=t.EventEmitter;function a(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return -1}function c(e){return function(){return this[e].apply(this,arguments)}}o.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp)for(n in t={},r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n]);else t=r[e]||(r[e]=[]);return t},o.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},o.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},o.addListener=function(e,t){if(!function e(t){return"function"==typeof t||t instanceof RegExp||!!t&&"object"==typeof t&&e(t.listener)}(t))throw TypeError("listener must be a function");var n,r=this.getListenersAsObject(e),i="object"==typeof t;for(n in r)r.hasOwnProperty(n)&&-1===a(r[n],t)&&r[n].push(i?t:{listener:t,once:!1});return this},o.on=c("addListener"),o.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},o.once=c("addOnceListener"),o.defineEvent=function(e){return this.getListeners(e),this},o.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},o.removeListener=function(e,t){var n,r,i=this.getListenersAsObject(e);for(r in i)i.hasOwnProperty(r)&&-1!==(n=a(i[r],t))&&i[r].splice(n,1);return this},o.off=c("removeListener"),o.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},o.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},o.manipulateListeners=function(e,t,n){var r,i,o=e?this.removeListener:this.addListener,s=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)o.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"==typeof i?o.call(this,r,i):s.call(this,r,i));return this},o.removeEvent=function(e){var t,n=this._getEvents();if("string"==typeof e)delete n[e];else if(e instanceof RegExp)for(t in n)n.hasOwnProperty(t)&&e.test(t)&&delete n[t];else delete this._events;return this},o.removeAllListeners=c("removeEvent"),o.emitEvent=function(e,t){var n,r,i,o,s=this.getListenersAsObject(e);for(o in s)if(s.hasOwnProperty(o))for(i=0,n=s[o].slice(0);i<n.length;i++)!0===(r=n[i]).once&&this.removeListener(e,r.listener),r.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},o.trigger=c("emitEvent"),o.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},o.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},o._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},o._getEvents=function(){return this._events||(this._events={})},i.noConflict=function(){return t.EventEmitter=s,i},void 0!==(r=(function(){return i}).call(t,n,t,e))&&(e.exports=r)}(this||{})},70941:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});var r=n(95344),i=n(39515);function o({children:e}){return r.jsx(i.eA,{children:e})}},56314:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var r=n(95344),i=n(20783),o=n.n(i),s=n(39515),a=n(22254);function c({isLogin:e}){let t=(0,a.useRouter)(),n=(0,a.usePathname)().split("/");if(n.includes("playroom")||n.includes("guestroom"))return null;let i="text-white font-semibold text-2xl text-center bg-main hover:bg-maindark rounded-[2rem] px-6 py-3";return r.jsx(r.Fragment,{children:e?r.jsx("button",{title:"로그아웃",type:"button",onClick:()=>{(0,s.w7)({redirect:!1}).then(()=>{t.refresh()})},className:i,children:"로그아웃"}):r.jsx(o(),{href:"/signup",children:r.jsx("button",{title:"회원가입",type:"button",className:i,children:"회원가입"})})})}},7494:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ed});var r,i,o=n(95344);n(36323);var s=n(20783),a=n.n(s),c=n(41223),l=n.n(c),u=n(3729);let d={src:"/_next/static/media/VideoTag.64b5334d.svg",height:477,width:763,blurWidth:0,blurHeight:0},h={src:"/_next/static/media/LeftArrow.6dd47569.svg",height:40,width:17,blurWidth:0,blurHeight:0},p={src:"/_next/static/media/RightArrow.d977ca5e.svg",height:40,width:17,blurWidth:0,blurHeight:0};function f({streamManager:e}){let t=(0,u.useRef)(null);return(0,u.useEffect)(()=>{e&&t.current&&e.addVideoElement(t.current)},[e]),o.jsx("video",{autoPlay:!0,ref:t,className:"z-10 w-full"})}function m({streamManager:e}){return o.jsx("div",{className:"z-10 w-full",children:void 0!==e?(0,o.jsxs)("div",{className:"z-10 w-full",children:[o.jsx(f,{streamManager:e}),o.jsx("div",{children:o.jsx("p",{children:JSON.parse(e.stream.connection.data).clientData})})]}):null})}function v(e){let[t,n]=(0,u.useState)(0),[r,i]=(0,u.useState)(e.subscribers),[s,a]=(0,u.useState)(e.call);return o.jsx("div",{className:"topcontainer",children:(0,o.jsxs)("div",{className:"top-1/2 left-1/2 mx-auto text-center w-full",children:[(0,o.jsxs)("p",{className:"my-10 text-3xl w-full",children:[e.depart,"의 ",e.title]}),o.jsx("div",{className:"flex flex-row w-8/9",children:(0,o.jsxs)("div",{className:"mx-auto flex flex-row space-x-10  w-full  ",children:[o.jsx(l(),{alt:"왼쪽 화살표",src:h,onClick:()=>{n(e=>e>0?e-1:e),console.log(t)},className:"w-1/18"}),o.jsx("div",{className:"flex flex-row space-x-4 overflow-x-hidden overflow-hidden w-full  ",children:e.subscribers.length>0?o.jsx("div",{className:" carousel ",style:{left:`-${20*t}%`},children:e.ENTRY.map((e,t)=>o.jsx("div",{className:"w-1/5 p-3",children:e.camera?o.jsx("div",{className:"",children:o.jsx(m,{streamManager:e.camera},t)}):o.jsx(l(),{src:d,className:" rounded",alt:"..."})},t))}):(0,o.jsxs)("div",{className:"mx-auto flex flex-row space-x-10  w-full ",children:[o.jsx(l(),{src:d,className:"max-w-96 rounded",alt:"..."}),o.jsx(l(),{src:d,className:"max-w-96 rounded",alt:"..."}),o.jsx(l(),{src:d,className:"max-w-96 rounded",alt:"..."}),o.jsx(l(),{src:d,className:"max-w-96 rounded",alt:"..."})]})}),o.jsx(l(),{src:p,alt:"오른쪽 화살표",onClick:()=>{n(t=>t<e.subscribers.length-5?t+1:t),console.log(t)},className:"w-1/18"})]})})]})})}var g=n(53608);let b={src:"/_next/static/media/piggie.bfe12cd4.svg",height:49,width:50,blurWidth:0,blurHeight:0};function E(e){return(0,o.jsxs)("div",{className:"flex flex-row justify-between ",children:[o.jsx(l(),{alt:"역할 사진",src:e.img,className:"mr-10 "}),(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-gray-700 dark:text-gray-400",children:e.name}),o.jsx("p",{className:"text-gray-700 dark:text-gray-400",children:e.actor})]})]})}let y=[{img:b,name:"첫째 돼지",actor:""},{img:b,name:"첫째 돼지",actor:""},{img:b,name:"첫째 돼지",actor:""},{img:b,name:"첫째 돼지",actor:""},{img:b,name:"첫째 돼지",actor:""},{img:b,name:"첫째 돼지",actor:""}];function S(){return(0,o.jsxs)("div",{className:"h-3/5 rounded-md bg-white mb-5 p-5",children:[o.jsx("div",{children:o.jsx("h1",{className:"p-5",children:"연극 대본 고르기"})}),o.jsx("div",{className:" overflow-auto scroll-auto p-5 h-4/5 ",children:y.map((e,t)=>o.jsx(E,{img:e.img,name:e.name,actor:e.actor},t))})]})}function _(e){return o.jsx("div",{className:" ",children:o.jsx("div",{className:"rounded-md p-3 bg-gray",children:o.jsx("p",{className:"text-gray-700 dark:text-gray-400",children:e.name})})})}let w=[{name:"신데렐라"},{name:"엄마"},{name:"마법사"},{name:"왕"},{name:"왕자"}];function x(e){let[t,n]=(0,u.useState)([]),[r,i]=(0,u.useState)(Array(t.length).fill(t[0])),[s,a]=(0,u.useState)([...t]);return(0,u.useEffect)(()=>{n(e.ENTRY.map(e=>({name:e.name,isSelected:!1})))},[e.ENTRY]),(0,o.jsxs)("div",{className:"h-2/5  bg-white rounded-md mb-5 p-5",children:[o.jsx("div",{children:o.jsx("h1",{children:"역할 정하기"})}),o.jsx("div",{className:" overflow-auto scroll-auto p-5 h-4/5 ",children:w.map((r,i)=>(0,o.jsxs)("span",{className:"flex justify-between",children:[o.jsx(_,{name:r.name},i),(0,o.jsxs)("select",{className:" border text-sm rounded-lg block w-1/3 p-2.5 ",id:`roleSelect_${i}`,onChange:i=>{!function(r,i){if(t[i].isSelected){alert("이미 선택된 친구에요");return}n(function(e){return e.map((e,t)=>(t===i&&(e.isSelected=!0),e))});let o={code:300,name:t[i].name,role:r};e.client.publish({destination:`/sub/channel/${e.roomId}`,body:JSON.stringify(o)})}(r.name,Number(i.target.value))},children:[o.jsx("option",{selected:!0,children:"아이를 선택하세요"}),t.map((e,t)=>o.jsx("option",{className:e.isSelected?"bg-gray-500":"",value:t,disabled:e.isSelected,children:e.name},t))]})]},i))})]})}function O(e){return(0,o.jsxs)("div",{className:"h-[55rem] my-auto",children:[o.jsx(x,{ENTRY:e.ENTRY,client:e.client,roomId:e.roomId}),o.jsx(S,{})]})}function C(e){return o.jsx("div",{className:"col-span-3 ",children:(0,o.jsxs)("div",{className:"w-11/12 mx-auto h-full flex flex-col justify-between",children:[e.streamManager?o.jsx(m,{streamManager:e.streamManager}):o.jsx("div",{className:"mx-auto my-5 h-full",children:o.jsx("video",{controls:!0,muted:!0,className:"h-full",children:o.jsx("source",{src:"https://mongo-jelly.s3.ap-northeast-2.amazonaws.com/frontSampleVideo.mp4",type:"video/mp4"})})}),(0,o.jsxs)("div",{className:"flex justify-between",children:[(0,o.jsxs)("div",{id:"leftbox",className:"flex flex-row",children:[o.jsx("button",{type:"button",className:"h-14   text-white bg-yellow-400 hover:bg-yellow-500 focus:outline-none focus:ring-4 focus:ring-yellow-300 font-medium rounded-full text-sm px-5 py-2.5 text-center me-2 mb-2 dark:focus:ring-yellow-900",children:"Yellow"}),o.jsx("button",{type:"button",className:"text-white bg-yellow-400 hover:bg-yellow-500 focus:outline-none focus:ring-4 focus:ring-yellow-300 font-medium rounded-full text-sm px-5 py-2.5 text-center me-2 mb-2 dark:focus:ring-yellow-900",children:"Yellow"})]}),(0,o.jsxs)("div",{id:"rightbox",className:"flex flex-row ",children:[o.jsx("button",{type:"button",className:"text-white bg-blue-700 hover:bg-blue-800 focus:bg-blue-800 font-medium rounded-full text-xl px-5 py-2.5 text-center me-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:bg-blue-800",children:"종료하기"}),o.jsx("button",{type:"button",onClick:function(){e.client.publish({destination:`/sub/channel/${e.roomId}`,body:JSON.stringify({code:400})})},className:"text-white bg-blue-700 hover:bg-blue-800 focus:bg-blue-800 font-medium rounded-full text-xl px-5 py-2.5 text-center me-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:bg-blue-800",children:"시작하기"})]})]})]})})}let I={src:"/_next/static/media/BasicUser.d3155757.svg",height:57,width:57,blurWidth:0,blurHeight:0},R=[{src:"/_next/static/media/status201.32fc4db4.svg",height:121,width:118,blurWidth:0,blurHeight:0},{src:"/_next/static/media/status202.c37e1366.svg",height:126,width:84,blurWidth:0,blurHeight:0},{src:"/_next/static/media/status203.e67f2467.svg",height:101,width:111,blurWidth:0,blurHeight:0},{src:"/_next/static/media/status204.3fa83de2.svg",height:153,width:149,blurWidth:0,blurHeight:0}];function k(e){return console.log(e.ENTRY),o.jsx("div",{className:" rounded-md bg-white mb-5 p-5 h-full",children:o.jsx("div",{className:"max-w-md divide-y divide-gray-200 ",children:e.ENTRY.map((e,t)=>o.jsx("div",{className:"py-3",children:(0,o.jsxs)("div",{className:"flex items-center space-x-4 rtl:space-x-reverse justify-between",children:[o.jsx("div",{className:"flex-shrink-0 flex",children:o.jsx(l(),{src:I,alt:"프로필 사진",className:"h-[5rem] w-[5rem] "})}),(0,o.jsxs)("div",{className:"flex flex-col",children:[o.jsx("p",{className:"text-wrap",children:e.name}),o.jsx("p",{className:"text-left",children:e.role?e.role:"아직 역할이 없어요"})]}),e.status?o.jsx("div",{children:o.jsx(l(),{src:R[e.status-201],alt:"상태사진",className:"h-[5rem] w-[5rem]"})}):o.jsx("span",{className:"h-[5rem] w-[5rem]"})]})},t))})})}function N(e){return o.jsx("div",{className:"bottomcontainer",children:(0,o.jsxs)("div",{className:"grid grid-cols-5",children:[o.jsx(O,{ENTRY:e.ENTRY,client:e.client,roomId:e.roomId}),o.jsx(C,{client:e.client,roomId:e.roomId,streamManager:e.streamManager}),o.jsx(k,{ENTRY:e.ENTRY})]})})}function T(e){function t(t){let n={code:t,id:e.userId};e.client.publish({destination:`/sub/channel/${e.roomId}`,body:JSON.stringify(n)})}return console.log("UserActionSection",e.role),(0,o.jsxs)("div",{className:" ml-[7rem] mr-[2rem] mt-[2rem] w-[60rem]",children:[(0,o.jsxs)("div",{className:"flex flex-row h-[8rem]  my-[2rem] ml-[2rem] ",children:[o.jsx(l(),{src:b,alt:"배역사진",className:"h-[8rem] w-[8rem] object-cover mr-[6rem]"}),o.jsx("div",{className:"inline-block my-auto mr-[6rem]",children:(0,o.jsxs)("div",{className:"inline-block ",children:[o.jsx("h1",{className:"block text-4xl",children:"나의 역할은"}),e.role?(0,o.jsxs)("h2",{className:"block text-5xl",children:[" ",o.jsx("strong",{className:"text-6xl",children:e.role}),"에요"]}):o.jsx("h2",{className:"block text-4xl",children:"아직 정해지지 않았어요"})]})}),o.jsx("div",{className:" h-[8rem] block relative ",children:(0,o.jsxs)("div",{id:"rightbox",className:"flex flex-row absolute bottom-0 z-2",children:[o.jsx("button",{type:"button",className:"w-[7rem] h-[4rem] text-white bg-yellow-400 hover:bg-yellow-500 focus:outline-none focus:ring-4 focus:ring-yellow-300 font-medium rounded-full text-sm px-5 py-2.5 text-center me-2 mb-2 dark:focus:ring-yellow-900",children:"Yellow"}),o.jsx("button",{type:"button",className:" w-[7rem] h-[4rem] text-white bg-yellow-400 hover:bg-yellow-500 focus:outline-none focus:ring-4 focus:ring-yellow-300 font-medium rounded-full text-sm px-5 py-2.5 text-center me-2 mb-2 dark:focus:ring-yellow-900",children:"Yellow"})]})})]}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-[1rem] mu-[2rem] h-[35rem] w-[55rem]",children:[(0,o.jsxs)("div",{onClick:()=>t(201),className:" hover:bg-gray-300  flex flex-col justify-center items-center h-[calc(50% - 1rem)] default-component-color ml-[0.5rem] mt-[0.5rem] rounded-[2rem]",children:[o.jsx("p",{className:"text-5xl w-[20rem] wrap text-center",children:"선생님"}),o.jsx("p",{className:"text-5xl w-[20rem] wrap text-center",children:"할 말 있어요"})]}),(0,o.jsxs)("div",{onClick:()=>t(202),className:"  hover:bg-gray-300 flex flex-col justify-center items-center h-[calc(50% - 1rem)] default-component-color ml-[0.5rem] mt-[0.5rem] rounded-[2rem]",children:[o.jsx("p",{className:"text-5xl w-[20rem] wrap text-center",children:"화장실에 "}),o.jsx("p",{className:"text-5xl w-[20rem] wrap text-center",children:"가고 싶어요"})]}),(0,o.jsxs)("div",{onClick:()=>t(203),className:"  hover:bg-gray-300 flex flex-col justify-center items-center h-[calc(50% - 1rem)] default-component-color ml-[0.5rem] mt-[0.5rem] rounded-[2rem]",children:[o.jsx("p",{className:"text-5xl w-[20rem] wrap text-center",children:"저는"}),o.jsx("p",{className:"text-5xl w-[20rem] wrap text-center",children:"준비됐어요"})]}),(0,o.jsxs)("div",{onClick:()=>t(204),className:"  hover:bg-gray-300 flex flex-col justify-center items-center h-[calc(50% - 1rem)] default-component-color ml-[0.5rem] mt-[0.5rem] rounded-[2rem]",children:[o.jsx("p",{className:"text-5xl w-[20rem] wrap text-center",children:"응급 상황! "}),o.jsx("p",{className:"text-5xl w-[20rem] wrap text-center",children:"확인해 주세요"})]})]})]})}function A(){return(0,o.jsxs)("div",{className:"ml-[7rem] mt-[2rem] w-[68rem]",children:[o.jsx("h1",{className:"text-6xl text-center my-[1rem]",children:" 우리 선생님 화면 "}),o.jsx(l(),{alt:"메인화면",src:d,className:"h-[42rem]"})]})}function P(e){return o.jsx("div",{className:"bottomcontainer bg-white ",children:(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-[1rem]",children:[o.jsx(A,{}),o.jsx(T,{client:e.client,roomId:e.roomId,userId:e.userId,role:e.role})]})})}var L=n(57847),D=n.n(L);let M={scene:[{sequence:1,title:"가족집",dialogs:[{img:"",role:"신데렐라",dialog:"안녕하세요, 제 이름은 신데렐라에요!"},{img:"",role:"엄마",dialog:"신데렐라, 일 좀 해봐. 청소 좀 해!"},{img:"",role:"신데렐라",dialog:"네, 엄마. 하지만 저 오늘은 왕궁에서 열리는 무도회에 가고 싶어요."},{img:"",role:"엄마",dialog:"무도회? 니가 그런 곳에 가면 안 돼. 청소 좀 해봐!"}]},{sequence:2,title:"마법사 출현",dialogs:[{img:"",role:"마법사",dialog:"안녕, 신데렐라. 내 마법 지팡이로 네 소원을 들어주마!"},{img:"",role:"신데렐라",dialog:"정말요? 그럼 제발 무도회에 가고 싶어요!"},{img:"",role:"마법사",dialog:"좋아, 그럼 너는 저 들려라! 밤 12시가 되면 돌아와야 해!"}]},{sequence:3,title:"왕궁 무도회",dialogs:[{img:"",role:"왕",dialog:"신데렐라, 네가 진짜 예쁘다!"},{img:"",role:"왕자",dialog:"나와 춤춰줄래?"}]},{sequence:4,title:"밤 12시",dialogs:[{img:"",role:"신데렐라",dialog:"아이고, 벌써 12시! 돌아가야 해요!"}]},{sequence:5,title:"가족집으로 돌아오는 신데렐라",dialogs:[{img:"",role:"신데렐라",dialog:"그래도 너무 행복한 하루였어요."},{img:"",role:"엄마",dialog:"넌 어디서 왔어? 무도회에서 늦게까지 뭐 하는 거야?"},{img:"",role:"신데렐라",dialog:"아, 그런데 12시에 돌아와야 했는데… (아쉬움)"}]},{sequence:6,title:"왕궁",dialogs:[{img:"",role:"왕",dialog:"이 유리 구두의 주인과 결혼하겠다!"},{img:"",role:"왕자",dialog:"그럼 이 구두의 주인은 바로 나의 신데렐라야!"},{img:"",role:"신데렐라",dialog:"아쉽게도 12시에 돌아가야 해요..."}]}],title:"신데렐라 연극",duration:"약 10분",thumbnail:"",person:5,roles:[{img:"",role:"신데렐라"},{img:"",role:"엄마"},{img:"",role:"마법사"},{img:"",role:"왕"},{img:"",role:"왕자"}]},j=M.scene.length,V=M.scene.map(e=>e.dialogs.length),B=()=>{let[e,t]=(0,u.useState)({scene:0,dialog:0,idx:0}),n=(0,u.useRef)([]);return{script:M,curIdx:e,refs:n,moveScript:function(){e.dialog<V[e.scene]-1?t(e=>({...e,dialog:e.dialog+1,idx:e.idx+1})):e.scene<j-1&&t({scene:e.scene+1,dialog:0,idx:e.idx+1}),n.current.length>0&&n.current[e.idx]?.scrollIntoView({behavior:"smooth",block:"center"})}}};var U=n(17704),F=n(35814),H=n(80135),W=n(54349);let q={src:"/_next/static/media/ForestJpeg.6b2076be.jpg",height:2350,width:3e3,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAGAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAv/aAAwDAQACEAMQAAABmhP/xAAWEAEBAQAAAAAAAAAAAAAAAAADAhL/2gAIAQEAAQUChcl//8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAC/9oACAEDAQE/AXJf/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8Br//EABgQAAIDAAAAAAAAAAAAAAAAAAABITFR/9oACAEBAAY/AoV6f//EABcQAQEBAQAAAAAAAAAAAAAAAAExABH/2gAIAQEAAT8hJmTkO//aAAwDAQACAAMAAAAQC//EABURAQEAAAAAAAAAAAAAAAAAAABR/9oACAEDAQE/EIH/xAAWEQEBAQAAAAAAAAAAAAAAAAABADH/2gAIAQIBAT8QEG3/xAAXEAEBAQEAAAAAAAAAAAAAAAABETEA/9oACAEBAAE/EF91kiLuJJO//9k=",blurWidth:8,blurHeight:6};function G(e){let t=0,[n,r]=(0,u.useState)([]),{script:i,curIdx:s,refs:a,moveScript:c}=B(),d=(e,t)=>{if(e===s.scene&&t===s.dialog)return"rounded-xl border-8 border-main font-semibold p-2"};return(0,u.useEffect)(()=>{let t=new Set;M.scene[s.scene].dialogs.forEach(e=>{t.add(e.role)}),console.log(t),r(e.ENTRY.filter(e=>t.has(e.role)))},[s.scene]),(0,o.jsxs)("div",{className:"flex h-3/5 w-full relative justify-between",children:[(0,o.jsxs)("div",{className:"bg-white m-4 h-full",children:[(0,o.jsxs)("div",{className:"flex items-center m-4",children:[o.jsx(l(),{src:U.Z,width:24,height:24,alt:"현재 연극 대본"}),o.jsx("p",{className:"text-3xl",children:"현재 연극 대본"})]}),o.jsx("div",{className:"overflow-auto w-[36rem] h-full  p-4",id:D().scroll,children:o.jsx("div",{children:i.scene.map((e,n)=>(0,o.jsxs)("div",{children:[o.jsx("p",{className:"sticky top-0 text-lg bg-gray-100 p-2 my-2",children:`${e.sequence}번째 씬`}),e.dialogs.map((e,r)=>(0,o.jsxs)("div",{ref:e=>{a.current[t++]=e},className:`flex items-center py-2 ${d(n,r)}`,children:[o.jsx("div",{className:"shrink-0 bg-gray-200 rounded-full size-12 m-2",children:e.img}),o.jsx("p",{className:"text-xl",children:`${e.role}: ${e.dialog}`})]},r))]},n))})})]}),(0,o.jsxs)("div",{className:"w-3/5 h-full",children:[(0,o.jsxs)("div",{className:"w-full justify-center p-3 relative h-full",children:[o.jsx(l(),{src:q,alt:"배경화면",className:"object-fill w-full h-full"}),e.streamManager?o.jsx("div",{className:"absolute top-0 left-0 p-[3rem]  w-full h-full grid grid-cols-4 gap-4 flex",children:n.map((e,t)=>o.jsx("div",{className:"z-10 w-full self-end",children:o.jsx(f,{streamManager:e.camera})},t))}):o.jsx("div",{className:"absolute top-0 left-0 p-[3rem]  w-full h-full",children:o.jsx("video",{controls:!0,muted:!0,className:" z-10 w-[40rem] h-[30rem]",children:o.jsx("source",{src:"https://mongo-jelly.s3.ap-northeast-2.amazonaws.com/frontSampleVideo.mp4",type:"video/mp4",className:"z-10"})})})]}),(0,o.jsxs)("div",{className:"flex flex-row justify-between px-[5rem]",children:[(0,o.jsxs)("div",{id:"leftbox",className:"flex flex-row",children:[o.jsx("button",{type:"button",className:"text-white bg-yellow-400 hover:bg-yellow-500 focus:outline-none focus:ring-4 focus:ring-yellow-300 font-medium rounded-full text-sm px-5 py-2.5 text-center me-2 mb-2 dark:focus:ring-yellow-900",children:"Yellow"}),o.jsx("button",{type:"button",className:"text-white bg-yellow-400 hover:bg-yellow-500 focus:outline-none focus:ring-4 focus:ring-yellow-300 font-medium rounded-full text-sm px-5 py-2.5 text-center me-2 mb-2 dark:focus:ring-yellow-900",children:"Yellow"}),o.jsx("button",{onClick:function(){e.client.publish({destination:`/sub/channel/${e.roomId}`,body:JSON.stringify({code:500})}),c()},children:o.jsx(F.Z,{className:"size-20"})}),o.jsx("button",{children:o.jsx(H.Z,{className:"size-20"})}),o.jsx("button",{children:o.jsx(W.Z,{className:"size-20"})})]}),o.jsx("div",{className:"flex flex-row"}),(0,o.jsxs)("div",{id:"rightbox",className:"flex flex-row ",children:[o.jsx("button",{type:"button",className:"text-white bg-blue-700 hover:bg-blue-800 focus:bg-blue-800 font-medium rounded-full text-xl px-5 py-2.5 text-center me-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:bg-blue-800",children:"종료하기"}),o.jsx("button",{type:"button",className:"text-white bg-blue-700 hover:bg-blue-800 focus:bg-blue-800 font-medium rounded-full text-xl px-5 py-2.5 text-center me-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:bg-blue-800",children:"시작하기"})]})]})]}),o.jsx("div",{className:"w-1/5 h-full",children:o.jsx(k,{ENTRY:e.ENTRY})})]})}class z{constructor(e){this.versions=e}supportedVersions(){return this.versions.join(",")}protocolVersions(){return this.versions.map(e=>`v${e.replace(".","")}.stomp`)}}z.V1_0="1.0",z.V1_1="1.1",z.V1_2="1.2",z.default=new z([z.V1_2,z.V1_1,z.V1_0]);let $={LF:"\n",NULL:"\x00"};class J{constructor(e){let{command:t,headers:n,body:r,binaryBody:i,escapeHeaderValues:o,skipContentLengthHeader:s}=e;this.command=t,this.headers=Object.assign({},n||{}),i?(this._binaryBody=i,this.isBinaryBody=!0):(this._body=r||"",this.isBinaryBody=!1),this.escapeHeaderValues=o||!1,this.skipContentLengthHeader=s||!1}get body(){return!this._body&&this.isBinaryBody&&(this._body=new TextDecoder().decode(this._binaryBody)),this._body||""}get binaryBody(){return this._binaryBody||this.isBinaryBody||(this._binaryBody=new TextEncoder().encode(this._body)),this._binaryBody}static fromRawFrame(e,t){let n={},r=e=>e.replace(/^\s+|\s+$/g,"");for(let i of e.headers.reverse()){i.indexOf(":");let o=r(i[0]),s=r(i[1]);t&&"CONNECT"!==e.command&&"CONNECTED"!==e.command&&(s=J.hdrValueUnEscape(s)),n[o]=s}return new J({command:e.command,headers:n,binaryBody:e.binaryBody,escapeHeaderValues:t})}toString(){return this.serializeCmdAndHeaders()}serialize(){let e=this.serializeCmdAndHeaders();return this.isBinaryBody?J.toUnit8Array(e,this._binaryBody).buffer:e+this._body+$.NULL}serializeCmdAndHeaders(){let e=[this.command];for(let t of(this.skipContentLengthHeader&&delete this.headers["content-length"],Object.keys(this.headers||{}))){let n=this.headers[t];this.escapeHeaderValues&&"CONNECT"!==this.command&&"CONNECTED"!==this.command?e.push(`${t}:${J.hdrValueEscape(`${n}`)}`):e.push(`${t}:${n}`)}return!this.isBinaryBody&&(this.isBodyEmpty()||this.skipContentLengthHeader)||e.push(`content-length:${this.bodyLength()}`),e.join($.LF)+$.LF+$.LF}isBodyEmpty(){return 0===this.bodyLength()}bodyLength(){let e=this.binaryBody;return e?e.length:0}static sizeOfUTF8(e){return e?new TextEncoder().encode(e).length:0}static toUnit8Array(e,t){let n=new TextEncoder().encode(e),r=new Uint8Array([0]),i=new Uint8Array(n.length+t.length+r.length);return i.set(n),i.set(t,n.length),i.set(r,n.length+t.length),i}static marshall(e){return new J(e).serialize()}static hdrValueEscape(e){return e.replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/:/g,"\\c")}static hdrValueUnEscape(e){return e.replace(/\\r/g,"\r").replace(/\\n/g,"\n").replace(/\\c/g,":").replace(/\\\\/g,"\\")}}class Y{constructor(e,t){this.onFrame=e,this.onIncomingPing=t,this._encoder=new TextEncoder,this._decoder=new TextDecoder,this._token=[],this._initState()}parseChunk(e,t=!1){let n;if(n="string"==typeof e?this._encoder.encode(e):new Uint8Array(e),t&&0!==n[n.length-1]){let e=new Uint8Array(n.length+1);e.set(n,0),e[n.length]=0,n=e}for(let e=0;e<n.length;e++){let t=n[e];this._onByte(t)}}_collectFrame(e){if(0!==e&&13!==e){if(10===e){this.onIncomingPing();return}this._onByte=this._collectCommand,this._reinjectByte(e)}}_collectCommand(e){if(13!==e){if(10===e){this._results.command=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaders;return}this._consumeByte(e)}}_collectHeaders(e){if(13!==e){if(10===e){this._setupCollectBody();return}this._onByte=this._collectHeaderKey,this._reinjectByte(e)}}_reinjectByte(e){this._onByte(e)}_collectHeaderKey(e){if(58===e){this._headerKey=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaderValue;return}this._consumeByte(e)}_collectHeaderValue(e){if(13!==e){if(10===e){this._results.headers.push([this._headerKey,this._consumeTokenAsUTF8()]),this._headerKey=void 0,this._onByte=this._collectHeaders;return}this._consumeByte(e)}}_setupCollectBody(){let e=this._results.headers.filter(e=>"content-length"===e[0])[0];e?(this._bodyBytesRemaining=parseInt(e[1],10),this._onByte=this._collectBodyFixedSize):this._onByte=this._collectBodyNullTerminated}_collectBodyNullTerminated(e){if(0===e){this._retrievedBody();return}this._consumeByte(e)}_collectBodyFixedSize(e){if(0==this._bodyBytesRemaining--){this._retrievedBody();return}this._consumeByte(e)}_retrievedBody(){this._results.binaryBody=this._consumeTokenAsRaw();try{this.onFrame(this._results)}catch(e){console.log("Ignoring an exception thrown by a frame handler. Original exception: ",e)}this._initState()}_consumeByte(e){this._token.push(e)}_consumeTokenAsUTF8(){return this._decoder.decode(this._consumeTokenAsRaw())}_consumeTokenAsRaw(){let e=new Uint8Array(this._token);return this._token=[],e}_initState(){this._results={command:void 0,headers:[],binaryBody:void 0},this._token=[],this._headerKey=void 0,this._onByte=this._collectFrame}}(function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"})(r=r||(r={})),function(e){e[e.ACTIVE=0]="ACTIVE",e[e.DEACTIVATING=1]="DEACTIVATING",e[e.INACTIVE=2]="INACTIVE"}(i=i||(i={}));class X{constructor(e,t,n){this._client=e,this._webSocket=t,this._connected=!1,this._serverFrameHandlers={CONNECTED:e=>{this.debug(`connected to server ${e.headers.server}`),this._connected=!0,this._connectedVersion=e.headers.version,this._connectedVersion===z.V1_2&&(this._escapeHeaderValues=!0),this._setupHeartbeat(e.headers),this.onConnect(e)},MESSAGE:e=>{let t=e.headers.subscription,n=this._subscriptions[t]||this.onUnhandledMessage,r=this,i=this._connectedVersion===z.V1_2?e.headers.ack:e.headers["message-id"];e.ack=(e={})=>r.ack(i,t,e),e.nack=(e={})=>r.nack(i,t,e),n(e)},RECEIPT:e=>{let t=this._receiptWatchers[e.headers["receipt-id"]];t?(t(e),delete this._receiptWatchers[e.headers["receipt-id"]]):this.onUnhandledReceipt(e)},ERROR:e=>{this.onStompError(e)}},this._counter=0,this._subscriptions={},this._receiptWatchers={},this._partialData="",this._escapeHeaderValues=!1,this._lastServerActivityTS=Date.now(),this.debug=n.debug,this.stompVersions=n.stompVersions,this.connectHeaders=n.connectHeaders,this.disconnectHeaders=n.disconnectHeaders,this.heartbeatIncoming=n.heartbeatIncoming,this.heartbeatOutgoing=n.heartbeatOutgoing,this.splitLargeFrames=n.splitLargeFrames,this.maxWebSocketChunkSize=n.maxWebSocketChunkSize,this.forceBinaryWSFrames=n.forceBinaryWSFrames,this.logRawCommunication=n.logRawCommunication,this.appendMissingNULLonIncoming=n.appendMissingNULLonIncoming,this.discardWebsocketOnCommFailure=n.discardWebsocketOnCommFailure,this.onConnect=n.onConnect,this.onDisconnect=n.onDisconnect,this.onStompError=n.onStompError,this.onWebSocketClose=n.onWebSocketClose,this.onWebSocketError=n.onWebSocketError,this.onUnhandledMessage=n.onUnhandledMessage,this.onUnhandledReceipt=n.onUnhandledReceipt,this.onUnhandledFrame=n.onUnhandledFrame}get connectedVersion(){return this._connectedVersion}get connected(){return this._connected}start(){let e=new Y(e=>{let t=J.fromRawFrame(e,this._escapeHeaderValues);this.logRawCommunication||this.debug(`<<< ${t}`),(this._serverFrameHandlers[t.command]||this.onUnhandledFrame)(t)},()=>{this.debug("<<< PONG")});this._webSocket.onmessage=t=>{if(this.debug("Received data"),this._lastServerActivityTS=Date.now(),this.logRawCommunication){let e=t.data instanceof ArrayBuffer?new TextDecoder().decode(t.data):t.data;this.debug(`<<< ${e}`)}e.parseChunk(t.data,this.appendMissingNULLonIncoming)},this._webSocket.onclose=e=>{this.debug(`Connection closed to ${this._webSocket.url}`),this._cleanUp(),this.onWebSocketClose(e)},this._webSocket.onerror=e=>{this.onWebSocketError(e)},this._webSocket.onopen=()=>{let e=Object.assign({},this.connectHeaders);this.debug("Web Socket Opened..."),e["accept-version"]=this.stompVersions.supportedVersions(),e["heart-beat"]=[this.heartbeatOutgoing,this.heartbeatIncoming].join(","),this._transmit({command:"CONNECT",headers:e})}}_setupHeartbeat(e){if(e.version!==z.V1_1&&e.version!==z.V1_2||!e["heart-beat"])return;let[t,n]=e["heart-beat"].split(",").map(e=>parseInt(e,10));if(0!==this.heartbeatOutgoing&&0!==n){let e=Math.max(this.heartbeatOutgoing,n);this.debug(`send PING every ${e}ms`),this._pinger=setInterval(()=>{this._webSocket.readyState===r.OPEN&&(this._webSocket.send($.LF),this.debug(">>> PING"))},e)}if(0!==this.heartbeatIncoming&&0!==t){let e=Math.max(this.heartbeatIncoming,t);this.debug(`check PONG every ${e}ms`),this._ponger=setInterval(()=>{let t=Date.now()-this._lastServerActivityTS;t>2*e&&(this.debug(`did not receive server activity for the last ${t}ms`),this._closeOrDiscardWebsocket())},e)}}_closeOrDiscardWebsocket(){this.discardWebsocketOnCommFailure?(this.debug("Discarding websocket, the underlying socket may linger for a while"),this.discardWebsocket()):(this.debug("Issuing close on the websocket"),this._closeWebsocket())}forceDisconnect(){this._webSocket&&(this._webSocket.readyState===r.CONNECTING||this._webSocket.readyState===r.OPEN)&&this._closeOrDiscardWebsocket()}_closeWebsocket(){this._webSocket.onmessage=()=>{},this._webSocket.close()}discardWebsocket(){if("function"!=typeof this._webSocket.terminate){var e,t;e=this._webSocket,t=e=>this.debug(e),e.terminate=function(){let n=()=>{};this.onerror=n,this.onmessage=n,this.onopen=n;let r=new Date,i=Math.random().toString().substring(2,8),o=this.onclose;this.onclose=e=>{let n=new Date().getTime()-r.getTime();t(`Discarded socket (#${i})  closed after ${n}ms, with code/reason: ${e.code}/${e.reason}`)},this.close(),o?.call(e,{code:4001,reason:`Quick discarding socket (#${i}) without waiting for the shutdown sequence.`,wasClean:!1})}}this._webSocket.terminate()}_transmit(e){let{command:t,headers:n,body:r,binaryBody:i,skipContentLengthHeader:o}=e,s=new J({command:t,headers:n,body:r,binaryBody:i,escapeHeaderValues:this._escapeHeaderValues,skipContentLengthHeader:o}),a=s.serialize();if(this.logRawCommunication?this.debug(`>>> ${a}`):this.debug(`>>> ${s}`),this.forceBinaryWSFrames&&"string"==typeof a&&(a=new TextEncoder().encode(a)),"string"==typeof a&&this.splitLargeFrames){let e=a;for(;e.length>0;){let t=e.substring(0,this.maxWebSocketChunkSize);e=e.substring(this.maxWebSocketChunkSize),this._webSocket.send(t),this.debug(`chunk sent = ${t.length}, remaining = ${e.length}`)}}else this._webSocket.send(a)}dispose(){if(this.connected)try{let e=Object.assign({},this.disconnectHeaders);e.receipt||(e.receipt=`close-${this._counter++}`),this.watchForReceipt(e.receipt,e=>{this._closeWebsocket(),this._cleanUp(),this.onDisconnect(e)}),this._transmit({command:"DISCONNECT",headers:e})}catch(e){this.debug(`Ignoring error during disconnect ${e}`)}else(this._webSocket.readyState===r.CONNECTING||this._webSocket.readyState===r.OPEN)&&this._closeWebsocket()}_cleanUp(){this._connected=!1,this._pinger&&(clearInterval(this._pinger),this._pinger=void 0),this._ponger&&(clearInterval(this._ponger),this._ponger=void 0)}publish(e){let{destination:t,headers:n,body:r,binaryBody:i,skipContentLengthHeader:o}=e,s=Object.assign({destination:t},n);this._transmit({command:"SEND",headers:s,body:r,binaryBody:i,skipContentLengthHeader:o})}watchForReceipt(e,t){this._receiptWatchers[e]=t}subscribe(e,t,n={}){(n=Object.assign({},n)).id||(n.id=`sub-${this._counter++}`),n.destination=e,this._subscriptions[n.id]=t,this._transmit({command:"SUBSCRIBE",headers:n});let r=this;return{id:n.id,unsubscribe:e=>r.unsubscribe(n.id,e)}}unsubscribe(e,t={}){t=Object.assign({},t),delete this._subscriptions[e],t.id=e,this._transmit({command:"UNSUBSCRIBE",headers:t})}begin(e){let t=e||`tx-${this._counter++}`;this._transmit({command:"BEGIN",headers:{transaction:t}});let n=this;return{id:t,commit(){n.commit(t)},abort(){n.abort(t)}}}commit(e){this._transmit({command:"COMMIT",headers:{transaction:e}})}abort(e){this._transmit({command:"ABORT",headers:{transaction:e}})}ack(e,t,n={}){n=Object.assign({},n),this._connectedVersion===z.V1_2?n.id=e:n["message-id"]=e,n.subscription=t,this._transmit({command:"ACK",headers:n})}nack(e,t,n={}){return n=Object.assign({},n),this._connectedVersion===z.V1_2?n.id=e:n["message-id"]=e,n.subscription=t,this._transmit({command:"NACK",headers:n})}}class K{constructor(e={}){this.stompVersions=z.default,this.connectionTimeout=0,this.reconnectDelay=5e3,this.heartbeatIncoming=1e4,this.heartbeatOutgoing=1e4,this.splitLargeFrames=!1,this.maxWebSocketChunkSize=8192,this.forceBinaryWSFrames=!1,this.appendMissingNULLonIncoming=!1,this.discardWebsocketOnCommFailure=!1,this.state=i.INACTIVE;let t=()=>{};this.debug=t,this.beforeConnect=t,this.onConnect=t,this.onDisconnect=t,this.onUnhandledMessage=t,this.onUnhandledReceipt=t,this.onUnhandledFrame=t,this.onStompError=t,this.onWebSocketClose=t,this.onWebSocketError=t,this.logRawCommunication=!1,this.onChangeState=t,this.connectHeaders={},this._disconnectHeaders={},this.configure(e)}get webSocket(){return this._stompHandler?._webSocket}get disconnectHeaders(){return this._disconnectHeaders}set disconnectHeaders(e){this._disconnectHeaders=e,this._stompHandler&&(this._stompHandler.disconnectHeaders=this._disconnectHeaders)}get connected(){return!!this._stompHandler&&this._stompHandler.connected}get connectedVersion(){return this._stompHandler?this._stompHandler.connectedVersion:void 0}get active(){return this.state===i.ACTIVE}_changeState(e){this.state=e,this.onChangeState(e)}configure(e){Object.assign(this,e)}activate(){let e=()=>{if(this.active){this.debug("Already ACTIVE, ignoring request to activate");return}this._changeState(i.ACTIVE),this._connect()};this.state===i.DEACTIVATING?(this.debug("Waiting for deactivation to finish before activating"),this.deactivate().then(()=>{e()})):e()}async _connect(){if(await this.beforeConnect(),this._stompHandler){this.debug("There is already a stompHandler, skipping the call to connect");return}if(!this.active){this.debug("Client has been marked inactive, will not attempt to connect");return}this.connectionTimeout>0&&(this._connectionWatcher&&clearTimeout(this._connectionWatcher),this._connectionWatcher=setTimeout(()=>{this.connected||(this.debug(`Connection not established in ${this.connectionTimeout}ms, closing socket`),this.forceDisconnect())},this.connectionTimeout)),this.debug("Opening Web Socket...");let e=this._createWebSocket();this._stompHandler=new X(this,e,{debug:this.debug,stompVersions:this.stompVersions,connectHeaders:this.connectHeaders,disconnectHeaders:this._disconnectHeaders,heartbeatIncoming:this.heartbeatIncoming,heartbeatOutgoing:this.heartbeatOutgoing,splitLargeFrames:this.splitLargeFrames,maxWebSocketChunkSize:this.maxWebSocketChunkSize,forceBinaryWSFrames:this.forceBinaryWSFrames,logRawCommunication:this.logRawCommunication,appendMissingNULLonIncoming:this.appendMissingNULLonIncoming,discardWebsocketOnCommFailure:this.discardWebsocketOnCommFailure,onConnect:e=>{if(this._connectionWatcher&&(clearTimeout(this._connectionWatcher),this._connectionWatcher=void 0),!this.active){this.debug("STOMP got connected while deactivate was issued, will disconnect now"),this._disposeStompHandler();return}this.onConnect(e)},onDisconnect:e=>{this.onDisconnect(e)},onStompError:e=>{this.onStompError(e)},onWebSocketClose:e=>{this._stompHandler=void 0,this.state===i.DEACTIVATING&&this._changeState(i.INACTIVE),this.onWebSocketClose(e),this.active&&this._schedule_reconnect()},onWebSocketError:e=>{this.onWebSocketError(e)},onUnhandledMessage:e=>{this.onUnhandledMessage(e)},onUnhandledReceipt:e=>{this.onUnhandledReceipt(e)},onUnhandledFrame:e=>{this.onUnhandledFrame(e)}}),this._stompHandler.start()}_createWebSocket(){let e;if(this.webSocketFactory)e=this.webSocketFactory();else if(this.brokerURL)e=new WebSocket(this.brokerURL,this.stompVersions.protocolVersions());else throw Error("Either brokerURL or webSocketFactory must be provided");return e.binaryType="arraybuffer",e}_schedule_reconnect(){this.reconnectDelay>0&&(this.debug(`STOMP: scheduling reconnection in ${this.reconnectDelay}ms`),this._reconnector=setTimeout(()=>{this._connect()},this.reconnectDelay))}async deactivate(e={}){let t;let n=e.force||!1,o=this.active;if(this.state===i.INACTIVE)return this.debug("Already INACTIVE, nothing more to do"),Promise.resolve();if(this._changeState(i.DEACTIVATING),this._reconnector&&(clearTimeout(this._reconnector),this._reconnector=void 0),!this._stompHandler||this.webSocket.readyState===r.CLOSED)return this._changeState(i.INACTIVE),Promise.resolve();{let e=this._stompHandler.onWebSocketClose;t=new Promise((t,n)=>{this._stompHandler.onWebSocketClose=n=>{e(n),t()}})}return n?this._stompHandler?.discardWebsocket():o&&this._disposeStompHandler(),t}forceDisconnect(){this._stompHandler&&this._stompHandler.forceDisconnect()}_disposeStompHandler(){this._stompHandler&&this._stompHandler.dispose()}publish(e){this._checkConnection(),this._stompHandler.publish(e)}_checkConnection(){if(!this.connected)throw TypeError("There is no underlying STOMP connection")}watchForReceipt(e,t){this._checkConnection(),this._stompHandler.watchForReceipt(e,t)}subscribe(e,t,n={}){return this._checkConnection(),this._stompHandler.subscribe(e,t,n)}unsubscribe(e,t={}){this._checkConnection(),this._stompHandler.unsubscribe(e,t)}begin(e){return this._checkConnection(),this._stompHandler.begin(e)}commit(e){this._checkConnection(),this._stompHandler.commit(e)}abort(e){this._checkConnection(),this._stompHandler.abort(e)}ack(e,t,n={}){this._checkConnection(),this._stompHandler.ack(e,t,n)}nack(e,t,n={}){this._checkConnection(),this._stompHandler.nack(e,t,n)}}class Q{constructor(e){this.client=e}get outgoing(){return this.client.heartbeatOutgoing}set outgoing(e){this.client.heartbeatOutgoing=e}get incoming(){return this.client.heartbeatIncoming}set incoming(e){this.client.heartbeatIncoming=e}}class Z extends K{constructor(e){super(),this.maxWebSocketFrameSize=16384,this._heartbeatInfo=new Q(this),this.reconnect_delay=0,this.webSocketFactory=e,this.debug=(...e)=>{console.log(...e)}}_parseConnect(...e){let t,n,r;let i={};if(e.length<2)throw Error("Connect requires at least 2 arguments");return"function"==typeof e[1]?[i,n,r,t]=e:6===e.length?[i.login,i.passcode,n,r,t,i.host]=e:[i.login,i.passcode,n,r,t]=e,[i,n,r,t]}connect(...e){let t=this._parseConnect(...e);t[0]&&(this.connectHeaders=t[0]),t[1]&&(this.onConnect=t[1]),t[2]&&(this.onStompError=t[2]),t[3]&&(this.onWebSocketClose=t[3]),super.activate()}disconnect(e,t={}){e&&(this.onDisconnect=e),this.disconnectHeaders=t,super.deactivate()}send(e,t={},n=""){let r=!1===(t=Object.assign({},t))["content-length"];r&&delete t["content-length"],this.publish({destination:e,headers:t,body:n,skipContentLengthHeader:r})}set reconnect_delay(e){this.reconnectDelay=e}get ws(){return this.webSocket}get version(){return this.connectedVersion}get onreceive(){return this.onUnhandledMessage}set onreceive(e){this.onUnhandledMessage=e}get onreceipt(){return this.onUnhandledReceipt}set onreceipt(e){this.onUnhandledReceipt=e}get heartbeat(){return this._heartbeatInfo}set heartbeat(e){this.heartbeatIncoming=e.incoming,this.heartbeatOutgoing=e.outgoing}}class ee{static client(e,t){return null==t&&(t=z.default.protocolVersions()),new Z(()=>new(ee.WebSocketClass||WebSocket)(e,t))}static over(e){let t;return"function"==typeof e?t=e:(console.warn("Stomp.over did not receive a factory, auto reconnect will not work. Please see https://stomp-js.github.io/api-docs/latest/classes/Stomp.html#over"),t=()=>e),new Z(t)}}ee.WebSocketClass=null;var et=n(4015),en=n.n(et),er=n(71705),ei=n(58568),eo=n.n(ei);let es={scene:[{sequence:1,title:"가족집",dialogs:[{img:"",role:"신데렐라",dialog:"안녕하세요, 제 이름은 신데렐라에요!"},{img:"",role:"엄마",dialog:"신데렐라, 일 좀 해봐. 청소 좀 해!"},{img:"",role:"신데렐라",dialog:"네, 엄마. 하지만 저 오늘은 왕궁에서 열리는 무도회에 가고 싶어요."},{img:"",role:"엄마",dialog:"무도회? 니가 그런 곳에 가면 안 돼. 청소 좀 해봐!"}]},{sequence:2,title:"마법사 출현",dialogs:[{img:"",role:"마법사",dialog:"안녕, 신데렐라. 내 마법 지팡이로 네 소원을 들어주마!"},{img:"",role:"신데렐라",dialog:"정말요? 그럼 제발 무도회에 가고 싶어요!"},{img:"",role:"마법사",dialog:"좋아, 그럼 너는 저 들려라! 밤 12시가 되면 돌아와야 해!"}]},{sequence:3,title:"왕궁 무도회",dialogs:[{img:"",role:"왕",dialog:"신데렐라, 네가 진짜 예쁘다!"},{img:"",role:"왕자",dialog:"나와 춤춰줄래?"}]},{sequence:4,title:"밤 12시",dialogs:[{img:"",role:"신데렐라",dialog:"아이고, 벌써 12시! 돌아가야 해요!"}]},{sequence:5,title:"가족집으로 돌아오는 신데렐라",dialogs:[{img:"",role:"신데렐라",dialog:"그래도 너무 행복한 하루였어요."},{img:"",role:"엄마",dialog:"넌 어디서 왔어? 무도회에서 늦게까지 뭐 하는 거야?"},{img:"",role:"신데렐라",dialog:"아, 그런데 12시에 돌아와야 했는데… (아쉬움)"}]},{sequence:6,title:"왕궁",dialogs:[{img:"",role:"왕",dialog:"이 유리 구두의 주인과 결혼하겠다!"},{img:"",role:"왕자",dialog:"그럼 이 구두의 주인은 바로 나의 신데렐라야!"},{img:"",role:"신데렐라",dialog:"아쉽게도 12시에 돌아가야 해요..."}]}],title:"신데렐라 연극",duration:"약 10분",thumbnail:"",person:5,roles:[{img:"",role:"신데렐라"},{img:"",role:"엄마"},{img:"",role:"마법사"},{img:"",role:"왕"},{img:"",role:"왕자"}]},ea=es.scene.length,ec=es.scene.map(e=>e.dialogs.length),el=()=>{let[e,t]=(0,u.useState)({scene:0,dialog:0,idx:0}),n=(0,u.useRef)([]);return{script:es,curIdx:e,refs:n,moveScript:function(){e.dialog<ec[e.scene]-1?t(e=>({...e,dialog:e.dialog+1,idx:e.idx+1})):e.scene<ea-1&&t({scene:e.scene+1,dialog:0,idx:e.idx+1}),n.current.length>0&&n.current[e.idx]?.scrollIntoView({behavior:"smooth",block:"center"})}}};function eu(e){let t=0,[n,r]=(0,u.useState)([]),{script:i,curIdx:s,refs:a,moveScript:c}=el(),d=(e,t)=>{if(e===s.scene&&t===s.dialog)return"rounded-xl border-8 border-main font-semibold p-2"};function h(t){let n={code:t,id:e.userId};e.client.publish({destination:`/sub/channel/${e.roomId}`,body:JSON.stringify(n)})}return(0,u.useEffect)(()=>{let t=new Set;es.scene[s.scene].dialogs.forEach(e=>{t.add(e.role)}),console.log(t),r(e.ENTRY.filter(e=>t.has(e.role))),console.log(e.ENTRY,n)},[s.scene]),(0,u.useEffect)(()=>{e.goNext&&c()},[e.goNext]),(0,o.jsxs)("div",{className:"flex h-full w-full relative justify-between px-[5rem]",children:[(0,o.jsxs)("div",{className:"bg-white m-4 h-4/5",children:[(0,o.jsxs)("div",{className:"flex items-center m-4",children:[o.jsx(l(),{src:U.Z,width:24,height:24,alt:"현재 연극 대본"}),o.jsx("p",{className:"text-3xl",children:"현재 연극 대본"})]}),o.jsx("div",{className:"overflow-auto w-[36rem] h-full  p-4",id:eo().scroll,children:o.jsx("div",{children:i.scene.map((e,n)=>(0,o.jsxs)("div",{children:[o.jsx("p",{className:"sticky top-0 text-lg bg-gray-100 p-2 my-2",children:`${e.sequence}번째 씬`}),e.dialogs.map((e,r)=>(0,o.jsxs)("div",{ref:e=>{a.current[t++]=e},className:`flex items-center py-2 ${d(n,r)}`,children:[o.jsx("div",{className:"shrink-0 bg-gray-200 rounded-full size-12 m-2",children:e.img}),o.jsx("p",{className:"text-xl",children:`${e.role}: ${e.dialog}`})]},r))]},n))})})]}),(0,o.jsxs)("div",{className:"w-3/5 h-full",children:[(0,o.jsxs)("div",{className:"w-full h-4/5 justify-center p-3 relative ",children:[o.jsx(l(),{src:q,alt:"배경화면",className:"object-fill w-full h-full"}),e.streamManager?o.jsx("div",{className:"absolute top-0 left-0 p-[3rem]  w-full h-full grid grid-cols-4 gap-4 flex",children:n.map((e,t)=>o.jsx("div",{className:"z-10 w-full self-end",children:o.jsx(f,{streamManager:e.camera})},t))}):o.jsx("div",{className:"absolute top-0 left-0 p-[3rem]  w-full h-full",children:o.jsx("video",{controls:!0,muted:!0,className:" z-10 w-[40rem] h-[30rem]",children:o.jsx("source",{src:"https://mongo-jelly.s3.ap-northeast-2.amazonaws.com/frontSampleVideo.mp4",type:"video/mp4",className:"z-10"})})})]}),o.jsx("div",{className:"flex justify-center items-center bg-white w-full h-1/5  p-3 default-component-color",children:o.jsx("p",{className:"text-3xl",children:i.scene[s.scene].dialogs[s.dialog].dialog})})]}),o.jsx("div",{className:"w-1/5 h-4/5",children:(0,o.jsxs)("div",{className:"grid grid-cols-1 mu-[2rem] h-full w-full",children:[(0,o.jsxs)("div",{onClick:()=>h(201),className:" hover:bg-gray-300 default-component-color flex flex-col justify-center items-center h-[calc(50% - 1rem)]  ml-[0.5rem] mt-[0.5rem] rounded-[2rem] p-[3rem]",children:[o.jsx("p",{className:"text-5xl wrap text-center",children:"선생님"}),o.jsx("p",{className:"text-5xl wrap text-center",children:"할 말 있어요"})]}),(0,o.jsxs)("div",{onClick:()=>h(202),className:"  hover:bg-gray-300 flex flex-col justify-center items-center h-[calc(50% - 1rem)] default-component-color ml-[0.5rem] mt-[0.5rem] rounded-[2rem] p-[3rem]",children:[o.jsx("p",{className:"text-5xl wrap text-center",children:"화장실에 "}),o.jsx("p",{className:"text-5xl wrap text-center",children:"가고 싶어요"})]}),(0,o.jsxs)("div",{onClick:()=>h(203),className:"  hover:bg-gray-300 flex flex-col justify-center items-center h-[calc(50% - 1rem)] default-component-color ml-[0.5rem] mt-[0.5rem] rounded-[2rem] p-[3rem]",children:[o.jsx("p",{className:"text-5xl wrap text-center",children:"저는"}),o.jsx("p",{className:"text-5xl wrap text-center",children:"준비됐어요"})]}),(0,o.jsxs)("div",{onClick:()=>h(204),className:"  hover:bg-gray-300 flex flex-col justify-center items-center h-[calc(50% - 1rem)] default-component-color ml-[0.5rem] mt-[0.5rem] rounded-[2rem] p-[3rem]",children:[o.jsx("p",{className:"text-5xl wrap text-center",children:"응급 상황! "}),o.jsx("p",{className:"text-5xl wrap text-center",children:"확인해 주세요"})]})]})})]})}function ed({params:{roomId:e}}){let[t,n]=(0,u.useState)(!1),[r,i]=(0,u.useState)(!1),[s,c]=(0,u.useState)([]),[l,d]=(0,u.useState)(`Participant${Math.floor(100*Math.random())}`),[h,p]=(0,u.useState)(void 0),[f,m]=(0,u.useState)(void 0),[b,E]=(0,u.useState)([]),[y,S]=(0,u.useState)(void 0),[_,w]=(0,u.useState)(null),[x,O]=(0,u.useState)(""),[C,I]=(0,u.useState)(""),[R,k]=(0,u.useState)(!1),[T,A]=(0,u.useState)(!1),[L,D]=(0,u.useState)(!1),M=(0,u.useRef)(!1),[j,V]=(0,u.useState)(0),B=(0,u.useRef)({}),U=(0,u.useRef)(new er.OpenVidu);function F(e){try{let t=JSON.parse(e.body);100==t.code?c(e=>{let n=[];return void 0===e.find(e=>e.name===t.id)&&(n=[{name:t.id,status:0,role:"",camera:null}].concat(e)),n}):101==t.code?(t.videoid,c(e=>e.filter(e=>e.name!=t.id))):200<=t.code&&t.code<300?(c(e=>e.map(e=>(e.name===t.id&&(e.status=t.code),e))),I(t.id),c(e=>{let n=[];if(e.find(e=>e.name===t.id)){let r=e.find(e=>e.name===t.id);r&&(r.status=t.code,n=[r].concat(e.filter(e=>e.name!=t.id)))}else n=e;return n})):300===Number(t.code)?(c(e=>(e[e.findIndex(e=>e.name==t.name)].role=t.role,e.map(e=>e))),M.current||l!==t.name||O(t.role)):400===t.code?(k(!0),setTimeout(()=>{A(!0),setTimeout(()=>{D(!0),setTimeout(()=>{k(!1),A(!1),D(!1),i(!0)},5e3)},2e3)},1e3)):500===t.code&&V(e=>e>8?1:e+1)}catch(e){console.error("Error parsing received message:",e)}}let H=async e=>(await g.Z.post(`/openvidu/api/sessions/${e}/connection `,{headers:{Authorization:"Basic T1BFTlZJRFVBUFA6bWFuZ28=","Content-Type":"application/json"}})).data;return(0,u.useEffect)(()=>{let t=U.current.initSession();t.on("streamCreated",e=>{let n=JSON.parse(e.stream.inboundStreamOpts.connection.data),r=t.subscribe(e.stream,void 0),i={userId:n.clientData,Subscriber:r};n.clientData!==l&&(E(e=>[...e,i]),c(e=>{let t=[];if(void 0!==e.find(e=>e.name===n.clientData)){let i=e.find(e=>e.name===n.clientData);i&&(i.camera=r,t=[i].concat(e.filter(e=>e.name!==n.clientData)))}else t=[{name:n.clientData,status:0,role:"",camera:r}].concat(e);return t}))}),t.on("exception",e=>{console.warn(e)}),window.addEventListener("beforeunload",r),window.addEventListener("beforeunload",()=>{t.disconnect()}),H(e).then(async e=>{try{await t.connect(e.token,{clientData:l});let n=await U.current.initPublisherAsync(void 0,{audioSource:void 0,videoSource:void 0,publishAudio:!1,publishVideo:!0,resolution:"1280x720",frameRate:30,insertMode:"APPEND",mirror:!1});t.publish(n);let r=(await U.current.getDevices()).filter(e=>"videoinput"===e.kind),i=n.stream.getMediaStream().getVideoTracks()[0].getSettings().deviceId,o=r.find(e=>e.deviceId===i);p(n),S(n),w(o)}catch(e){console.log("There was an error connecting to the session:",e.code,e.message)}});let n=()=>{B.current.subscribe(`/sub/channel/${e}`,F)};function r(){let t={code:101,id:l,videoid:`${l}`};B.current.publish({destination:`/sub/channel/${e}`,body:JSON.stringify(t)})}B.current=ee.over(function(){return new(en())("https://mangotail.shop/ws")}),B.current.onConnect=()=>{n(),function(){let t={code:100,id:l,videoid:`${l}`};B.current.publish({destination:`/sub/channel/${e}`,body:JSON.stringify(t)})}()},B.current.onDisconnect=()=>{r()},B.current.activate()},[l,e]),(0,o.jsxs)("div",{className:"flex flex-col items-center px-[15rem] h-lvh ",children:[R?o.jsx("div",{className:"fadeoutcomponent",style:{opacity:T?1:0},children:L?o.jsx("video",{className:"w-full h-full",controls:!0,autoPlay:!0,children:o.jsx("source",{src:".curtainsclosing.mp4",type:"video/mp4"})}):null}):null,(0,o.jsxs)("div",{className:"relative h-full w-full",children:[t||!r?o.jsx(v,{depart:"꿈나무 유치원",title:"망고 연극반",call:C,ENTRY:s,subscribers:b}):null,o.jsx("p",{className:"text-center",children:(0,o.jsxs)("button",{type:"button",onClick:()=>{n(e=>!e),M.current=!M.current},className:"text-white bg-blue-700 hover:bg-blue-800 active:bg-blue-800   font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800",children:[t?"Host":"Guest","  "]})}),(0,o.jsxs)("div",{className:"relative h-full w-full",children:[t?r?o.jsx(G,{ENTRY:s,client:B.current,roomId:e,streamManager:h}):o.jsx(N,{ENTRY:s,client:B.current,roomId:e,streamManager:h}):null,t?null:r?o.jsx(eu,{client:B.current,userId:l||"",ENTRY:s,roomId:e,subscribers:b,streamManager:h,goNext:j}):o.jsx(P,{client:B.current,roomId:e,role:x,userId:l||""}),o.jsx(a(),{href:"/scenario/1",children:"링크"})]})]})]})}},58568:e=>{e.exports={scroll:"scrollbar_scroll__emU76"}},57847:e=>{e.exports={scroll:"scrollbar_scroll__WKuze"}},85279:(e,t,n)=>{"use strict";function r(){return null}n.r(t),n.d(t,{default:()=>r})},19459:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>w,metadata:()=>_});var r=n(25036),i=n(82448),o=n.n(i);n(5023),n(40002);var s=n(40646),a=n.n(s),c=n(15904),l=n.n(c);let u={src:"/_next/static/media/AppMainLogo.a6fabb54.png",height:160,width:984,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAABCAMAAADU3h9xAAAADFBMVEXvtgDrswDfrAXiqwIwNv0iAAAABHRSTlNnXJF0T/ZwigAAAAlwSFlzAAAsSwAALEsBpT2WqQAAABFJREFUeJxjYGJmYGBgYGQEAAAxAAhaF8fwAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:1};var d=n(86843);let h=(0,d.createProxy)(String.raw`C:\Users\SSAFY\Desktop\projects\Frontend\src\app\_component\LoginButton.tsx`),{__esModule:p,$$typeof:f}=h,m=h.default;var v=n(81147);async function g(){let e=await (0,v.I8)();return r.jsx("header",{children:r.jsx("nav",{className:"flex justify-center bg-white px-12 py-4 shadow",children:(0,r.jsxs)("div",{className:"grow flex flex-wrap justify-between items-center lg:mx-64 max-w-screen-xl",children:[r.jsx(a(),{href:"/",children:r.jsx(l(),{src:u,width:196,height:32,alt:"망고테일"})}),r.jsx("div",{className:"lg:order-2",children:r.jsx(m,{isLogin:!!e})})]})})})}let b=(0,d.createProxy)(String.raw`C:\Users\SSAFY\Desktop\projects\Frontend\src\app\_component\AuthSession.tsx`),{__esModule:E,$$typeof:y}=b,S=b.default,_={title:"mangotail",description:"mangotail"};function w({children:e,modal:t}){return r.jsx("html",{lang:"en",children:r.jsx("body",{className:o().className,children:r.jsx("div",{className:"bg-cover bg-background min-h-screen",children:(0,r.jsxs)(S,{children:[r.jsx(g,{}),t,e]})})})})}},27976:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(25036),i=n(15904),o=n.n(i);let s={src:"/_next/static/media/errorImg.db197cdc.svg",height:724,width:724,blurWidth:0,blurHeight:0},a=()=>(0,r.jsxs)("div",{className:"absolute top-0 size-full bg-[#AFAFAF]",children:[(0,r.jsxs)("div",{className:"mt-48 ml-52",children:[r.jsx("div",{className:"text-9xl font-black mb-12",children:"Oops!"}),r.jsx("div",{className:"text-6xl mb-12",children:"404 Not Found"}),r.jsx("div",{className:"text-3xl mb-2",children:"죄송합니다. 페이지를 찾을 수 없습니다."}),r.jsx("div",{className:"text-3xl mb-12",children:"입력하신 주소가 정확한지 다시 확인해 주세요."}),r.jsx("a",{href:"/",children:r.jsx("button",{className:"text-3xl text-white text-center bg-[#E6B559] hover:bg-[#DAA94C] rounded-[2rem] w-56 h-20 m-2 shadow",children:"메인 페이지로"})})]}),r.jsx(o(),{src:s,width:640,height:640,alt:"에러페이지",className:"absolute bottom-0 right-0"}),r.jsx("div",{})]})},7927:(e,t,n)=>{"use strict";n.r(t),n.d(t,{$$typeof:()=>o,__esModule:()=>i,default:()=>s});let r=(0,n(86843).createProxy)(String.raw`C:\Users\SSAFY\Desktop\projects\Frontend\src\app\playroom\[roomId]\page.tsx`),{__esModule:i,$$typeof:o}=r,s=r.default},81147:(e,t,n)=>{"use strict";n.d(t,{HT:()=>o,I8:()=>a,a4:()=>s});var r=n(37577),i=n(3133);let{handlers:{GET:o,POST:s},auth:a,signIn:c}=(0,r.Z)({pages:{signIn:"/login",newUser:"/signup"},providers:[(0,i.Z)({name:"mango-server",async authorize(e){try{let t=await fetch(`${process.env.AUTH_URL}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.username,password:e.password})});if(!t.ok)return console.log("authResponse not ok"),null;let n=await t.json();return console.log(n),n}catch(e){console.log("error",e)}}})],callbacks:{jwt:async({user:e,token:t})=>(e&&(t.Authorization=e?.data.accessToken,t.refreshToken=e?.data.refreshToken,t.nickname=e?.data.nickName,console.log(t)),t),session:async({token:e,session:t})=>(t.Authorization=e.Authorization,t.refreshToken=e.refreshToken,t.user.name=e.nickname,console.log(t),t)}})},84753:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});let r={src:"/_next/static/media/AppMainLogo.a6fabb54.png",height:160,width:984,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAABCAMAAADU3h9xAAAADFBMVEXvtgDrswDfrAXiqwIwNv0iAAAABHRSTlNnXJF0T/ZwigAAAAlwSFlzAAAsSwAALEsBpT2WqQAAABFJREFUeJxjYGJmYGBgYGQEAAAxAAhaF8fwAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:1}},17704:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});let r={src:"/_next/static/media/CookieHouse.fc0af9b3.png",height:343,width:316,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAICAMAAAAC2hU0AAAAb1BMVEXNqo2LZTutiV+RWinXqYVzbSbd08lMaXHWjFDbz8TbzsK3hVzOwLJ9UCiEdDPEfkvUnHLHjl7Osp6EcEzVysDDnn98USmpim/CuK64imC4knPlupfdn2/OmW3Zu6Sod07kq4Gph0dOZBTCkmrn29GRIO2pAAAAHHRSTlP+1Zap/f7RAP78eu1JfvrXnNnwTZ/+vvj94Lj93zg33wAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAEFJREFUeJwFwQUCwCAMBLDD2xlzLUz//8YlCGHE7jVCweshChVjYjHwmQjfhv4mSXlB6xqLd4Z+3GWTwaBiV571D2OSA1OqRaamAAAAAElFTkSuQmCC",blurWidth:7,blurHeight:8}},41516:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});let r={src:"/_next/static/media/errorImg.db197cdc.svg",height:724,width:724,blurWidth:0,blurHeight:0}},73881:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var r=n(70337);let i=e=>[{type:"image/x-icon",sizes:"168x160",url:(0,r.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{},36323:()=>{},80135:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(3729);let i=r.forwardRef(function({title:e,titleId:t,...n},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},n),e?r.createElement("title",{id:t},e):null,r.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12ZM9 8.25a.75.75 0 0 0-.75.75v6c0 .414.336.75.75.75h.75a.75.75 0 0 0 .75-.75V9a.75.75 0 0 0-.75-.75H9Zm5.25 0a.75.75 0 0 0-.75.75v6c0 .414.336.75.75.75H15a.75.75 0 0 0 .75-.75V9a.75.75 0 0 0-.75-.75h-.75Z",clipRule:"evenodd"}))})},35814:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(3729);let i=r.forwardRef(function({title:e,titleId:t,...n},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},n),e?r.createElement("title",{id:t},e):null,r.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm14.024-.983a1.125 1.125 0 0 1 0 1.966l-5.603 3.113A1.125 1.125 0 0 1 9 15.113V8.887c0-.857.921-1.4 1.671-.983l5.603 3.113Z",clipRule:"evenodd"}))})},54349:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(3729);let i=r.forwardRef(function({title:e,titleId:t,...n},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},n),e?r.createElement("title",{id:t},e):null,r.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 0 1-1.313-1.313V9.564Z",clipRule:"evenodd"}))})},47611:e=>{"use strict";e.exports=JSON.parse('["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302","stun.ekiga.net","stun.ideasip.com","stun.schlund.de","stun.stunprotocol.org:3478","stun.voiparound.com","stun.voipbuster.com","stun.voipstunt.com","stun.voxgratia.org"]')},58217:e=>{"use strict";e.exports=[]},48942:e=>{"use strict";e.exports=JSON.parse('{"author":"OpenVidu","dependencies":{"freeice":"2.2.2","hark":"1.2.3","jsnlog":"2.30.0","mime":"3.0.0","platform":"1.3.6","semver":"7.3.8","uuid":"9.0.0","wolfy87-eventemitter":"5.2.9","events":"3.3.0","inherits":"2.0.4"},"description":"OpenVidu Browser","devDependencies":{"@types/node":"18.11.9","@types/platform":"1.3.4","browserify":"17.0.0","grunt":"1.5.3","grunt-cli":"1.4.3","grunt-contrib-copy":"1.0.0","grunt-contrib-sass":"2.0.0","grunt-contrib-uglify":"5.2.2","grunt-contrib-watch":"1.1.0","grunt-postcss":"0.9.0","grunt-string-replace":"1.3.3","grunt-ts":"6.0.0-beta.22","terser":"5.15.1","tsify":"5.0.4","tslint":"6.1.3","typedoc":"0.23.21","typescript":"4.9.3"},"license":"Apache-2.0","main":"lib/index.js","name":"openvidu-browser","repository":{"type":"git","url":"git://github.com/OpenVidu/openvidu"},"scripts":{"browserify":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js Main.ts -p [ tsify ] --exclude kurento-browser-extensions --debug -o ../static/js/openvidu-browser-$VERSION.js -v","browserify-prod":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js --debug Main.ts -p [ tsify ] --exclude kurento-browser-extensions | ../node_modules/terser/bin/terser --source-map content=inline --output ../static/js/openvidu-browser-$VERSION.min.js","build":"cd src/OpenVidu && ./../../node_modules/typescript/bin/tsc && cd ../.. && ./node_modules/typescript/bin/tsc --declaration src/index.ts --outDir ./lib --sourceMap --target es5 --lib dom,es5,es2015.promise,scripthost && rm -rf ./ts4.4 && mkdir -p ./ts4.4/lib && cp -r ./lib ./ts4.4 && find ./ts4.4/lib -type f ! -iname \'*.d.ts\' -delete && ./config/replace_for_ts44.sh","docs":"./generate-docs.sh"},"types":"lib/index.d.ts","typesVersions":{"<4.4":{"*":["ts4.4/*"]}},"version":"2.29.1"}')}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[638,706,920,608],()=>n(79594));module.exports=r})();